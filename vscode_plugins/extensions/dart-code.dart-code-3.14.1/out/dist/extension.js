module.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=44)}([function(e,t){e.exports=require("vscode")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSlashes=t.areSameFolder=t.mkDirRecursive=t.getRandomInt=t.tryDeleteFile=t.findProjectFolders=t.isFlutterRepoAsync=t.hasCreateTriggerFileAsync=t.hasPubspecAsync=t.hasPubspec=t.hasPackagesFile=t.readDirAsync=t.getChildFolders=t.isWithinPath=t.forceWindowsDriveLetterToUppercase=t.fsPath=void 0;const r=i(5),s=i(2),o=i(4),a=i(3),c=i(21);function l(e){return e&&o.isWin&&s.isAbsolute(e)&&e.charAt(0)===e.charAt(0).toLowerCase()&&(e=e.substr(0,1).toUpperCase()+e.substr(1)),e}function u(e,t){return n(this,void 0,void 0,(function*(){if(!r.existsSync(e))return[];return(yield d(e)).filter(e=>e.isDirectory()).filter(e=>"bin"!==e.name||t&&t.allowBin).filter(e=>"cache"!==e.name||t&&t.allowCache).map(t=>s.join(e,t.name))}))}function d(e){return new Promise((t,i)=>r.readdir(e,{withFileTypes:!0},(e,n)=>{e?i(e):t(n)}))}function h(e){return n(this,void 0,void 0,(function*(){return yield p(s.join(e,"pubspec.yaml"))}))}function f(e){return n(this,void 0,void 0,(function*(){return yield p(s.join(e,o.FLUTTER_CREATE_PROJECT_TRIGGER_FILE))}))}function g(e){return n(this,void 0,void 0,(function*(){return(yield p(s.join(e,"bin/flutter")))&&(yield p(s.join(e,"bin/cache/dart-sdk")))}))}function p(e){return n(this,void 0,void 0,(function*(){try{return yield r.promises.access(e),!0}catch(e){return!1}}))}t.fsPath=function(e){return l("string"==typeof e?e:e.fsPath)},t.forceWindowsDriveLetterToUppercase=l,t.isWithinPath=function(e,t){const i=s.relative(t,e);return!!i&&!i.startsWith("..")&&!s.isAbsolute(i)},t.getChildFolders=u,t.readDirAsync=d,t.hasPackagesFile=function(e){return r.existsSync(s.join(e,".packages"))},t.hasPubspec=function(e){return r.existsSync(s.join(e,"pubspec.yaml"))},t.hasPubspecAsync=h,t.hasCreateTriggerFileAsync=f,t.isFlutterRepoAsync=g,t.findProjectFolders=function(e,t={}){return n(this,void 0,void 0,(function*(){const i=yield a.flatMapAsync(e,u),r=yield a.flatMapAsync(i,u),s=e.concat(i).concat(r).map(e=>n(this,void 0,void 0,(function*(){return{exists:t&&t.requirePubspec?yield h(e):(yield h(e))||(yield f(e))||(yield g(e)),folder:e}}))),o=(yield Promise.all(s)).filter(e=>e.exists).map(e=>e.folder);return t&&t.sort?c.sortBy(o,e=>e.toLowerCase()):o}))},t.tryDeleteFile=function(e){if(r.existsSync(e))try{r.unlinkSync(e)}catch(e){console.warn("Failed to delete file $path.")}},t.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e))+e},t.mkDirRecursive=function e(t){const i=s.dirname(t);r.existsSync(i)||e(i),r.existsSync(t)||r.mkdirSync(t)},t.areSameFolder=function(e,t){return(e=e.replace(/[\\/]+$/,""))===(t=t.replace(/[\\/]+$/,""))},t.normalizeSlashes=function(e){return e.replace(/[\\/]/g,s.sep)}},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.escapeDartString=t.generateTestNameFromFileName=t.clamp=t.asHex=t.asHexColor=t.notUndefined=t.BufferedLogger=t.errorString=t.usingCustomScript=t.isStableSdk=t.pubVersionIsAtLeast=t.versionIsAtLeast=t.isDartSdkFromFlutter=t.uriToFilePath=t.findFileInAncestor=t.PromiseCompleter=t.escapeRegExp=t.filenameSafe=t.flatMapAsync=t.flatMap=t.uniq=void 0;const r=i(5),s=i(2),o=i(67),a=i(4);t.uniq=function(e){return e.filter((t,i)=>e.indexOf(t)===i)},t.flatMap=function(e,t){return e.reduce((e,i)=>e.concat(t(i)),[])},t.flatMapAsync=function(e,t){return n(this,void 0,void 0,(function*(){let i=[];for(const n of e)i=i.concat(yield t(n));return i}))},t.filenameSafe=function(e){return e.replace(/[^a-z0-9]+/gi,"_").toLowerCase()},t.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};function c(e,t){return o.gte(e,t)}t.PromiseCompleter=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}},t.findFileInAncestor=function(e,t){let i,n=t;for(;n&&n.length>1&&n!==i;){for(const t of e){const e=s.join(n,t);if(r.existsSync(e))return e}i=n,n=s.dirname(n)}},t.uriToFilePath=function(e,t=a.isWin){let i=e;return e.startsWith("file://")?i=decodeURI(e.substring(7)):e.startsWith("file:")&&(i=decodeURI(e.substring(5))),t?(i=i.replace(/\//g,"\\"),"\\"===i[0]&&(i=i.substring(1))):"/"!==i[0]&&(i="/"+i),i},t.isDartSdkFromFlutter=function(e){const t=s.join(s.dirname(s.dirname(s.dirname(e))),"bin");return r.existsSync(s.join(t,a.flutterExecutableName))},t.versionIsAtLeast=c,t.pubVersionIsAtLeast=function(e,t){return!!o.gt(e,t)||!o.lt(e,t)&&(-1!==e.indexOf("+")&&-1===t.indexOf("+")||(-1!==e.indexOf("+")||-1===t.indexOf("+"))&&c(e=e.replace("+",-1===e.indexOf("-")?"-":"."),t=t.replace("+",-1===t.indexOf("-")?"-":".")))},t.isStableSdk=function(e){return!(!e||o.prerelease(e))},t.usingCustomScript=function(e,t,i){return i&&(e=i.script,t=t.slice(i.replacesArgs)),{binPath:e,binArgs:t}},t.errorString=function(e){return e?e instanceof Error?e.message+(e.stack?"\n"+e.stack:""):"string"==typeof e?e:e.message||"<empty error message>":"<empty error>"};function l(e){return Math.round(e).toString(16).padStart(2,"0")}function u(e,t,i){return Math.min(Math.max(t,e),i)}t.BufferedLogger=class{constructor(){this.buffer=[]}info(e,t){this.buffer.push({type:"info",message:e,category:t})}warn(e,t){this.buffer.push({type:"warn",message:e,category:t})}error(e,t){this.buffer.push({type:"error",message:e,category:t})}flushTo(e){if(this.buffer.length){e.info("Flushing log messages...");for(const t of this.buffer)switch(t.type){case"info":e.info(t.message,t.category);break;case"warn":e.warn(t.message,t.category);break;case"error":e.error(t.message,t.category)}e.info("Done flushing log messages...")}}},t.notUndefined=function(e){return void 0!==e},t.asHexColor=function({r:e,g:t,b:i,a:n}){return e=u(e,0,255),t=u(t,0,255),i=u(i,0,255),`${l(n=u(n,0,255))}${l(e)}${l(t)}${l(i)}`.toLowerCase()},t.asHex=l,t.clamp=u,t.generateTestNameFromFileName=function(e){return s.basename(e).replace("_test.dart","").replace(/_/g," ")},t.escapeDartString=function(e){return e.replace(/(['"\\])/g,"\\$1")}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dartRecommendedConfig=t.devToolsPages=t.cancelAction=t.runFlutterCreateDotAction=t.runFlutterCreateDotPrompt=t.vmServiceHttpLinkPattern=t.vmServiceListeningBannerPattern=t.reactivateDevToolsAction=t.openSettingsAction=t.recommendedSettingsUrl=t.showRecommendedSettingsAction=t.skipAction=t.noAction=t.yesAction=t.useRecommendedSettingsPromptKey=t.installFlutterExtensionPromptKey=t.userPromptContextPrefix=t.debugAnywayAction=t.showErrorsAction=t.isInFlutterProfileModeDebugSessionContext=t.isInFlutterDebugModeDebugSessionContext=t.HAS_LAST_TEST_DEBUG_CONFIG=t.HAS_LAST_DEBUG_CONFIG=t.TRACK_WIDGET_CREATION_ENABLED=t.REFACTOR_ANYWAY=t.REFACTOR_FAILED_DOC_MODIFIED=t.FLUTTER_CREATE_PROJECT_TRIGGER_FILE=t.DART_STAGEHAND_PROJECT_TRIGGER_FILE=t.CHROME_OS_VM_SERVICE_PORT=t.CHROME_OS_DEVTOOLS_PORT=t.pleaseReportBug=t.longRepeatPromptThreshold=t.noRepeatPromptThreshold=t.fortyHoursInMs=t.twentyHoursInMs=t.twoHoursInMs=t.twentyMinutesInMs=t.tenMinutesInMs=t.fiveMinutesInMs=t.initializingFlutterMessage=t.initializeSnapPrompt=t.modifyingFilesOutsideWorkspaceInfoUrl=t.skipThisSurveyAction=t.takeSurveyAction=t.flutterSurveyAnalyticsText=t.flutterSurveyDataUrl=t.moreInfoAction=t.doNotAskAgainAction=t.notTodayAction=t.alwaysOpenAction=t.openDevToolsAction=t.wantToTryDevToolsPrompt=t.issueTrackerUri=t.issueTrackerAction=t.stagehandInstallationInstructionsUrl=t.pubGlobalDocsUrl=t.debugTerminatingProgressId=t.debugLaunchProgressId=t.restartReasonSave=t.restartReasonManual=t.showLogAction=t.stopLoggingAction=t.IS_RUNNING_LOCALLY_CONTEXT=t.PUB_OUTDATED_SUPPORTED_CONTEXT=t.DART_IS_CAPTURING_LOGS_CONTEXT=t.DART_DEP_FILE_NODE_CONTEXT=t.DART_DEP_FOLDER_NODE_CONTEXT=t.DART_DEP_PACKAGE_NODE_CONTEXT=t.DART_DEP_PROJECT_NODE_CONTEXT=t.DART_TEST_TEST_NODE_CONTEXT=t.DART_TEST_GROUP_NODE_CONTEXT=t.DART_TEST_SUITE_NODE_CONTEXT=t.IS_LSP_CONTEXT=t.FLUTTER_DOWNLOAD_URL=t.DART_DOWNLOAD_URL=t.androidStudioPaths=t.flutterSnapScript=t.flutterPath=t.analyzerSnapshotPath=t.pubSnapshotPath=t.pubPath=t.dartVMPath=t.androidStudioExecutableNames=t.flutterExecutableName=t.pubExecutableName=t.dartExecutableName=t.platformEol=t.platformDisplayName=t.dartPlatformName=t.isChromeOS=t.isLinux=t.isMac=t.isWin=t.debugAdapterPath=t.flutterExtensionIdentifier=t.dartCodeExtensionIdentifier=void 0;const n=i(5);t.dartCodeExtensionIdentifier="Dart-Code.dart-code",t.flutterExtensionIdentifier="Dart-Code.flutter",t.debugAdapterPath="out/dist/debug.js",t.isWin=/^win/.test(process.platform),t.isMac="darwin"===process.platform,t.isLinux=!t.isWin&&!t.isMac,t.isChromeOS=t.isLinux&&n.existsSync("/dev/.cros_milestone"),t.dartPlatformName=t.isWin?"win":t.isMac?"mac":"linux",t.platformDisplayName=t.isWin?"win":t.isMac?"mac":t.isChromeOS?"chromeos":"linux",t.platformEol=t.isWin?"\r\n":"\n",t.dartExecutableName=t.isWin?"dart.exe":"dart",t.pubExecutableName=t.isWin?"pub.bat":"pub",t.flutterExecutableName=t.isWin?"flutter.bat":"flutter",t.androidStudioExecutableNames=t.isWin?["studio64.exe"]:["studio.sh","studio"],t.dartVMPath="bin/"+t.dartExecutableName,t.pubPath="bin/"+t.pubExecutableName,t.pubSnapshotPath="bin/snapshots/pub.dart.snapshot",t.analyzerSnapshotPath="bin/snapshots/analysis_server.dart.snapshot",t.flutterPath="bin/"+t.flutterExecutableName,t.flutterSnapScript="/snap/flutter/current/flutter.sh",t.androidStudioPaths=t.androidStudioExecutableNames.map(e=>"bin/"+e),t.DART_DOWNLOAD_URL="https://dart.dev/get-dart",t.FLUTTER_DOWNLOAD_URL="https://flutter.dev/setup/",t.IS_LSP_CONTEXT="dart-code:isLsp",t.DART_TEST_SUITE_NODE_CONTEXT="dart-code:testSuiteNode",t.DART_TEST_GROUP_NODE_CONTEXT="dart-code:testGroupNode",t.DART_TEST_TEST_NODE_CONTEXT="dart-code:testTestNode",t.DART_DEP_PROJECT_NODE_CONTEXT="dart-code:depProjectNode",t.DART_DEP_PACKAGE_NODE_CONTEXT="dart-code:depPackageNode",t.DART_DEP_FOLDER_NODE_CONTEXT="dart-code:depFolderNode",t.DART_DEP_FILE_NODE_CONTEXT="dart-code:depFileNode",t.DART_IS_CAPTURING_LOGS_CONTEXT="dart-code:isCapturingLogs",t.PUB_OUTDATED_SUPPORTED_CONTEXT="dart-code:pubOutdatedSupported",t.IS_RUNNING_LOCALLY_CONTEXT="dart-code:isRunningLocally",t.stopLoggingAction="Stop Logging",t.showLogAction="Show Log",t.restartReasonManual="manual",t.restartReasonSave="save",t.debugLaunchProgressId="launch",t.debugTerminatingProgressId="terminate",t.pubGlobalDocsUrl="https://www.dartlang.org/tools/pub/cmd/pub-global",t.stagehandInstallationInstructionsUrl="https://github.com/dart-lang/stagehand#installation",t.issueTrackerAction="Issue Tracker",t.issueTrackerUri="https://github.com/Dart-Code/Dart-Code/issues",t.wantToTryDevToolsPrompt="Dart DevTools includes additional tools for debugging and profiling Flutter apps, including a Widget Inspector. Try it?",t.openDevToolsAction="Open",t.alwaysOpenAction="Always Open",t.notTodayAction="Not Now",t.doNotAskAgainAction="Never Ask",t.moreInfoAction="More Info",t.flutterSurveyDataUrl="https://flutter.dev/f/flutter-survey-metadata.json",t.flutterSurveyAnalyticsText="By clicking on this link you agree to share feature usage along with the survey responses.",t.takeSurveyAction="Take Survey",t.skipThisSurveyAction="Skip This Survey",t.modifyingFilesOutsideWorkspaceInfoUrl="https://dartcode.org/docs/modifying-files-outside-workspace/",t.initializeSnapPrompt="The Flutter snap is installed but not initialized. Would you like to initialize it now?",t.initializingFlutterMessage="Initializing Flutter. This may take a few minutes.",t.fiveMinutesInMs=3e5,t.tenMinutesInMs=6e5,t.twentyMinutesInMs=12e5,t.twoHoursInMs=72e5,t.twentyHoursInMs=72e6,t.fortyHoursInMs=144e6,t.noRepeatPromptThreshold=t.twentyHoursInMs,t.longRepeatPromptThreshold=t.fortyHoursInMs,t.pleaseReportBug="Please raise a bug against the Dart extension for VS Code.",t.CHROME_OS_DEVTOOLS_PORT=8080,t.CHROME_OS_VM_SERVICE_PORT=8085,t.DART_STAGEHAND_PROJECT_TRIGGER_FILE="dart.sh.create",t.FLUTTER_CREATE_PROJECT_TRIGGER_FILE="flutter.create",t.REFACTOR_FAILED_DOC_MODIFIED="This refactor cannot be applied because the document has changed.",t.REFACTOR_ANYWAY="Refactor Anyway",t.TRACK_WIDGET_CREATION_ENABLED="dart-code:trackWidgetCreationEnabled",t.HAS_LAST_DEBUG_CONFIG="dart-code:hasLastDebugConfig",t.HAS_LAST_TEST_DEBUG_CONFIG="dart-code:hasLastTestDebugConfig",t.isInFlutterDebugModeDebugSessionContext="dart-code:isInFlutterDebugModeDebugSession",t.isInFlutterProfileModeDebugSessionContext="dart-code:isInFlutterProfileModeDebugSession",t.showErrorsAction="Show Errors",t.debugAnywayAction="Debug Anyway",t.userPromptContextPrefix="hasPrompted.",t.installFlutterExtensionPromptKey="install_flutter_extension_3",t.useRecommendedSettingsPromptKey="use_recommended_settings",t.yesAction="Yes",t.noAction="No",t.skipAction="Skip",t.showRecommendedSettingsAction="Show Recommended Settings",t.recommendedSettingsUrl="https://dartcode.org/docs/recommended-settings/",t.openSettingsAction="Open Settings File",t.reactivateDevToolsAction="Reactivate DevTools",t.vmServiceListeningBannerPattern=new RegExp("Observatory (?:listening on|.* is available at:) (http:.+)"),t.vmServiceHttpLinkPattern=new RegExp("(http://[\\d\\.:]+/)"),t.runFlutterCreateDotPrompt=e=>`You must run 'flutter create .' to create the files required to use the ${e} device for this project.`,t.runFlutterCreateDotAction="Run 'flutter create .'",t.cancelAction="Cancel",t.devToolsPages=["Inspector","Timeline","Memory","Performance","Network","Logging"],t.dartRecommendedConfig={"editor.formatOnSave":!0,"editor.formatOnType":!0,"editor.rulers":[80],"editor.selectionHighlight":!1,"editor.suggest.snippetsPreventQuickSuggestions":!1,"editor.suggestSelection":"first","editor.tabCompletion":"onlySnippets","editor.wordBasedSuggestions":!1}},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.firstEditorColumn=t.firstNonEditorColumn=t.envUtils=t.warnIfPathCaseMismatch=t.trimTrailingSlashes=t.showCode=t.toRangeOnLine=t.lspToPosition=t.toPosition=t.lspToRange=t.toRange=t.isDartWorkspaceFolder=t.getDartWorkspaceFolders=t.isRunningLocally=t.SourceSortMembersCodeActionKind=void 0;const r=i(5),s=i(29),o=i(0),a=i(0),c=i(4),l=i(13),u=i(3),d=i(1);t.SourceSortMembersCodeActionKind=a.CodeActionKind.Source.append("sortMembers");const h=a.extensions.getExtension(c.dartCodeExtensionIdentifier);function f(e){return!(!e||"file"!==e.uri.scheme)}function g(e){return new a.Position(e.startLine-1,e.startColumn-1)}function p(e){return new a.Position(e.line,e.character)}function m(e){return e.replace(/[\/\\]+$/,"")}t.isRunningLocally=!h||h.extensionKind===a.ExtensionKind.UI,t.getDartWorkspaceFolders=function(){return a.workspace.workspaceFolders?a.workspace.workspaceFolders.filter(f):[]},t.isDartWorkspaceFolder=f,t.toRange=function(e,t,i){return new a.Range(e.positionAt(t),e.positionAt(t+i))},t.lspToRange=function(e){return new a.Range(p(e.start),p(e.end))},t.toPosition=g,t.lspToPosition=p,t.toRangeOnLine=function(e){const t=g(e);return new a.Range(t,t.translate(0,e.length))},t.showCode=function(e,t,i,n){n&&(e.selection=new a.Selection(n.start,n.end)),e.revealRange(t,a.TextEditorRevealType.InCenterIfOutsideViewport)},t.trimTrailingSlashes=m,t.warnIfPathCaseMismatch=function(e,t,i,n){const s=m(d.forceWindowsDriveLetterToUppercase(t)),a=r.existsSync(s)&&m(d.forceWindowsDriveLetterToUppercase(r.realpathSync.native(s)));if(s&&a&&s.toLowerCase()===a.toLowerCase()&&s!==a){const t=`The casing of ${i} does not match the casing on disk; please ${n}. Expected ${a} but got ${s}`;return e.warn(t),o.window.showWarningMessage(t),!0}return!1};function v(e){return e.toString().replace(/%24/g,"$").replace(/%5B/g,"[")}function y(){return new Set(o.window.visibleTextEditors.map(e=>e.viewColumn).filter(u.notUndefined))}t.envUtils=new class{openInBrowser(e,t=l.nullLogger){return n(this,void 0,void 0,(function*(){return t.info("Opening external URL: "+e),a.env.openExternal(a.Uri.parse(e))}))}exposeUrl(e,t=l.nullLogger){return n(this,void 0,void 0,(function*(){t.info("Exposing URL: "+e.toString());const i="ws"===e.scheme||"wss"===e.scheme,n="wss"===e.scheme||"https"===e.scheme;let r=e.scheme;i&&(r=n?"https":"http");const o=new s.URL(v(e));let c=e.authority;o.port||(c=`${o.hostname}:${n?"443":"80"}`);const l=e.with({scheme:r,authority:c});t.info("Mapping URL: "+l.toString());const u=yield a.env.asExternalUri(l);t.info("Mapped URL: "+u.toString());let d=u.scheme;i&&(d="https"===u.scheme?"wss":"ws");const h=v(u.with({scheme:d}));t.info("Final URI: "+h);const f=new s.URL(h).toString();return t.info("Final URL: "+f),f}))}},t.firstNonEditorColumn=function(){const e=y();for(let t=1;t<=9;t++)if(!e.has(t))return t},t.firstEditorColumn=function(){const e=y();for(let t=1;t<=9;t++)if(e.has(t))return t}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.openLogContents=t.logTime=t.promptToReloadExtension=t.escapeShell=t.getLatestSdkVersion=t.isValidEntryFile=t.isInsideFolderNamed=t.isDartFile=t.projectShouldUsePubForTests=t.isTestFolder=t.isPubRunnableTestFile=t.isTestFile=t.isTestFileOrFolder=t.isWithinWorkspace=t.isAnalyzableAndInWorkspace=t.shouldHotReloadFor=t.isAnalyzable=t.getSdkVersion=t.createFolderForFile=t.homeRelativePath=t.resolvePaths=t.isFlutterProjectFolder=t.isInsideFlutterProject=t.isFlutterWorkspaceFolder=void 0;const r=i(5),s=i(39),o=i(18),a=i(2),c=i(0),l=i(4),u=i(1),d=i(6),h=i(10),f=i(44),g=i(49),p=i(92);function m(e){return!!(e&&d.isDartWorkspaceFolder(e)&&v(u.fsPath(e.uri)))}function v(e){return p.referencesFlutterSdk(e)}function y(e){if(e.isUntitled||!u.fsPath(e.uri)||"file"!==e.uri.scheme)return!1;const t=["dart","htm","html"].concat(h.config.additionalAnalyzerFileExtensions),i=a.extname(u.fsPath(e.uri)),n=i?i.substr(1):void 0;return e.languageId&&["dart","html"].indexOf(e.languageId)>=0||[".analysis_options","analysis_options.yaml","pubspec.yaml"].indexOf(a.basename(u.fsPath(e.uri)))>=0||void 0!==n&&t.includes(n)}function b(e){return!!c.workspace.getWorkspaceFolder(c.Uri.file(e))}function C(e){return!!e&&S(e)&&(T(e,"test")||T(e,"test_driver")||h.config.allowTestsOutsideTestFolder)&&e.toLowerCase().endsWith("_test.dart")}function w(e){return!!e&&T(e,"test")&&r.existsSync(e)&&r.statSync(e).isDirectory()}function S(e){return!!e&&".dart"===a.extname(e.toLowerCase())&&r.existsSync(e)&&r.statSync(e).isFile()}function T(e,t){if(!e)return!1;const i=c.workspace.getWorkspaceFolder(c.Uri.file(e));if(!i)return!1;return-1!==a.relative(u.fsPath(i.uri),e).toLowerCase().split(a.sep).indexOf(t.toLowerCase())}t.isFlutterWorkspaceFolder=m,t.isInsideFlutterProject=function(e){if(!e)return!1;const t=g.locateBestProjectRoot(u.fsPath(e));return t?v(t):m(c.workspace.getWorkspaceFolder(e))},t.isFlutterProjectFolder=v,t.resolvePaths=function(e){if("string"==typeof e)return e.startsWith("~/")?a.join(o.homedir(),e.substr(2)):!a.isAbsolute(e)&&c.workspace.workspaceFolders&&c.workspace.workspaceFolders.length?a.join(u.fsPath(c.workspace.workspaceFolders[0].uri),e):e},t.homeRelativePath=function(e){if(!e)return;const t=o.homedir();return u.isWithinPath(e,t)?a.join("~",a.relative(t,e)):e},t.createFolderForFile=function(e){try{if(!e||!a.isAbsolute(e))return;const t=a.dirname(e);return r.existsSync(t)||u.mkDirRecursive(t),e}catch(t){return void console.warn("Ignoring invalid file path "+e)}},t.getSdkVersion=function(e,{sdkRoot:t,versionFile:i}){if((t||i)&&(i||(i=a.join(t,"version")),r.existsSync(i)))try{return r.readFileSync(i,"utf8").trim().split("\n").filter(e=>e).filter(e=>"#"!==e.trim().substr(0,1)).join("\n").trim()}catch(t){return void e.error(t)}},t.isAnalyzable=y,t.shouldHotReloadFor=function(e){if(e.isUntitled||!u.fsPath(e.uri)||"file"!==e.uri.scheme)return!1;const t=a.extname(u.fsPath(e.uri)),i=t?t.substr(1):void 0;return void 0!==i&&["dart","htm","html","css"].includes(i)},t.isAnalyzableAndInWorkspace=function(e){return y(e)&&b(u.fsPath(e.uri))},t.isWithinWorkspace=b,t.isTestFileOrFolder=function(e){return!!e&&(C(e)||w(e))},t.isTestFile=C,t.isPubRunnableTestFile=function(e){return!!e&&S(e)&&e.toLowerCase().endsWith("_test.dart")},t.isTestFolder=w,t.projectShouldUsePubForTests=function(e,t){return u.hasPubspec(e)&&!t.useVmForTests},t.isDartFile=S,t.isInsideFolderNamed=T,t.isValidEntryFile=function(e){return e&&S(e)&&(C(e)||T(e,"bin")||T(e,"tool")||T(e,"test_driver")||e.endsWith(`lib${a.sep}main.dart`))},t.getLatestSdkVersion=function(){return new Promise((e,t)=>{s.request({hostname:"storage.googleapis.com",method:"GET",path:"/dart-archive/channels/stable/release/latest/VERSION",port:443},i=>{!i||!i.statusCode||i.statusCode<200||i.statusCode>300?t({message:`Failed to get Dart SDK Version ${i&&i.statusCode}: ${i&&i.statusMessage}`}):i.on("data",t=>{e(JSON.parse(t.toString()).version)})}).end()})},t.escapeShell=function(e){const t=[];return e.forEach(e=>{/[^A-Za-z0-9_\/:=-]/.test(e)&&(e=(e="'"+e.replace(/'/g,"'\\''")+"'").replace(/^(?:'')+/g,"").replace(/\\'''/g,"\\'")),t.push(e)}),t.join(" ")},t.promptToReloadExtension=function(e,t,i){return n(this,void 0,void 0,(function*(){const n=t||"Restart",r=i?[n,l.showLogAction]:[n],s=f.ringLog.toString(),o=e&&(yield c.window.showInformationMessage(e,...r));o===l.showLogAction?E(void 0,s):e&&o!==n||c.commands.executeCommand("_dart.reloadExtension")}))};process.hrtime.bigint();function E(e="txt",t){const i=a.join(o.tmpdir(),`log-${u.getRandomInt(4096,65536).toString(16)}.${e}`);r.writeFileSync(i,t),c.workspace.openTextDocument(i).then(c.window.showTextDocument)}t.logTime=e=>{},t.openLogContents=E},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DebugOption=t.debugOptionNames=t.LogSeverity=t.LogCategory=t.VersionStatus=t.VmService=t.VmServiceExtension=t.TestStatus=t.DebuggerType=void 0,function(e){e[e.Dart=0]="Dart",e[e.PubTest=1]="PubTest",e[e.Flutter=2]="Flutter",e[e.FlutterTest=3]="FlutterTest",e[e.Web=4]="Web",e[e.WebTest=5]="WebTest"}(t.DebuggerType||(t.DebuggerType={})),function(e){e[e.Waiting=0]="Waiting",e[e.Passed=1]="Passed",e[e.Skipped=2]="Skipped",e[e.Unknown=3]="Unknown",e[e.Failed=4]="Failed",e[e.Errored=5]="Errored",e[e.Running=6]="Running"}(t.TestStatus||(t.TestStatus={})),function(e){e.PlatformOverride="ext.flutter.platformOverride",e.DebugBanner="ext.flutter.debugAllowBanner",e.CheckElevations="ext.flutter.debugCheckElevationsEnabled",e.DebugPaint="ext.flutter.debugPaint",e.Driver="ext.flutter.driver",e.PaintBaselines="ext.flutter.debugPaintBaselinesEnabled",e.InspectorSelectMode="ext.flutter.inspector.show",e.InspectorSetPubRootDirectories="ext.flutter.inspector.setPubRootDirectories",e.InspectorStructuredErrors="ext.flutter.inspector.structuredErrors",e.BrightnessOverride="ext.flutter.brightnessOverride",e.RepaintRainbow="ext.flutter.repaintRainbow",e.PerformanceOverlay="ext.flutter.showPerformanceOverlay",e.SlowAnimations="ext.flutter.timeDilation"}(t.VmServiceExtension||(t.VmServiceExtension={})),function(e){e.HotReload="reloadSources",e.HotRestart="hotRestart",e.LaunchDevTools="launchDevTools"}(t.VmService||(t.VmService={})),function(e){e[e.NotInstalled=0]="NotInstalled",e[e.UpdateRequired=1]="UpdateRequired",e[e.UpdateAvailable=2]="UpdateAvailable",e[e.Valid=3]="Valid"}(t.VersionStatus||(t.VersionStatus={})),function(e){e[e.General=0]="General",e[e.CI=1]="CI",e[e.CommandProcesses=2]="CommandProcesses",e[e.DevTools=3]="DevTools",e[e.Analyzer=4]="Analyzer",e[e.PubTest=5]="PubTest",e[e.FlutterDaemon=6]="FlutterDaemon",e[e.FlutterRun=7]="FlutterRun",e[e.FlutterTest=8]="FlutterTest",e[e.VmService=9]="VmService",e[e.WebDaemon=10]="WebDaemon"}(t.LogCategory||(t.LogCategory={})),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error"}(t.LogSeverity||(t.LogSeverity={})),t.debugOptionNames=["my code","my code + packages","my code + packages + SDK","my code + SDK"],function(e){e[e.MyCode=0]="MyCode",e[e.MyCodePackages=1]="MyCodePackages",e[e.MyCodePackagesSdk=2]="MyCodePackagesSdk",e[e.MyCodeSdk=3]="MyCodeSdk"}(t.DebugOption||(t.DebugOption={}))},function(e,t,i){const n=i(25),{MAX_LENGTH:r,MAX_SAFE_INTEGER:s}=i(24),{re:o,t:a}=i(16),{compareIdentifiers:c}=i(31);class l{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof l){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>r)throw new TypeError(`version is longer than ${r} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const i=e.trim().match(t.loose?o[a.LOOSE]:o[a.FULL]);if(!i)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<s)return t}return e}):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof l)){if("string"==typeof e&&e===this.version)return 0;e=new l(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof l||(e=new l(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof l||(e=new l(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const i=this.prerelease[t],r=e.prerelease[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return c(i,r)}while(++t)}compareBuild(e){e instanceof l||(e=new l(e,this.options));let t=0;do{const i=this.build[t],r=e.build[t];if(n("prerelease compare",t,i,r),void 0===i&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===i)return-1;if(i!==r)return c(i,r)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=l},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0;const r=i(0),s=i(7),o=i(111),a=i(15);class c{constructor(e){this.uri=e,this.config=r.workspace.getConfiguration("dart",this.uri)}getConfig(e,t){return o.nullToUndefined(this.config.get(e,t))}get analysisExcludedFolders(){return this.getConfig("analysisExcludedFolders",[])}get analyzerInstrumentationLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("analyzerInstrumentationLogFile",null)))}get analyzerLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("analyzerLogFile",null)))}get analyzerPath(){return s.resolvePaths(this.getConfig("analyzerPath",null))}get devToolsLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("devToolsLogFile",null)))}get doNotFormat(){return this.getConfig("doNotFormat",[])}get enableCompletionCommitCharacters(){return this.getConfig("enableCompletionCommitCharacters",!1)}get evaluateGettersInDebugViews(){return this.getConfig("evaluateGettersInDebugViews",!0)}get extensionLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("extensionLogFile",null)))}get flutterAdditionalArgs(){return this.getConfig("flutterAdditionalArgs",[])}get flutterDaemonLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterDaemonLogFile",null)))}get flutterRunLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterRunLogFile",null)))}get flutterScreenshotPath(){return s.resolvePaths(this.getConfig("flutterScreenshotPath",null))}get flutterSdkPath(){return s.resolvePaths(this.getConfig("flutterSdkPath",null))}get flutterSdkPaths(){return this.getConfig("flutterSdkPaths",[]).map(s.resolvePaths)}get flutterStructuredErrors(){return this.getConfig("flutterStructuredErrors",!0)}get flutterTestLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterTestLogFile",null)))}get flutterTrackWidgetCreation(){return this.getConfig("flutterTrackWidgetCreation",!0)}get insertArgumentPlaceholders(){return this.getConfig("insertArgumentPlaceholders",!0)}get lineLength(){return this.getConfig("lineLength",80)}get promptToGetPackages(){return this.getConfig("promptToGetPackages",!0)}get pubAdditionalArgs(){return this.getConfig("pubAdditionalArgs",[])}get pubTestLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("pubTestLogFile",null)))}get runPubGetOnPubspecChanges(){return this.getConfig("runPubGetOnPubspecChanges",!0)}get sdkPath(){return s.resolvePaths(this.getConfig("sdkPath",null))}get sdkPaths(){return this.getConfig("sdkPaths",[]).map(s.resolvePaths)}get showDartDeveloperLogs(){return this.getConfig("showDartDeveloperLogs",!0)}get vmAdditionalArgs(){return this.getConfig("vmAdditionalArgs",[])}get vmServiceLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("vmServiceLogFile",null)))}get webDaemonLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("webDaemonLogFile",null)))}}t.config=new class{constructor(){r.workspace.onDidChangeConfiguration(e=>this.reloadConfig()),this.config=r.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}reloadConfig(){this.config=r.workspace.getConfiguration("dart"),a.setupToolEnv(this.env)}getConfig(e,t){const i=this.config.get(e,t);return o.nullToUndefined(i)}getWorkspaceConfig(e){const t=this.config.inspect(e);return t&&t.workspaceValue?o.nullToUndefined(t.workspaceValue):t&&t.workspaceFolderValue?o.nullToUndefined(t.workspaceFolderValue):void 0}setConfig(e,t,i){return n(this,void 0,void 0,(function*(){yield this.config.update(e,t,i)}))}get additionalAnalyzerFileExtensions(){return this.getConfig("additionalAnalyzerFileExtensions",[])}get allowAnalytics(){return this.getConfig("allowAnalytics",!0)}get allowTestsOutsideTestFolder(){return this.getConfig("allowTestsOutsideTestFolder",!1)}get analysisServerFolding(){return this.getConfig("analysisServerFolding",!0)}get analyzeAngularTemplates(){return this.getConfig("analyzeAngularTemplates",!0)}get analyzerAdditionalArgs(){return this.getConfig("analyzerAdditionalArgs",[])}get analyzerDiagnosticsPort(){return this.getConfig("analyzerDiagnosticsPort",null)}get analyzerInstrumentationLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("analyzerInstrumentationLogFile",null)))}get analyzerLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("analyzerLogFile",null)))}get analyzerPath(){return s.resolvePaths(this.getConfig("analyzerPath",null))}get analyzerSshHost(){return this.getConfig("analyzerSshHost",null)}get analyzerVmServicePort(){return this.getConfig("analyzerVmServicePort",null)}get autoImportCompletions(){return this.getConfig("autoImportCompletions",!0)}get buildRunnerAdditionalArgs(){return this.getConfig("buildRunnerAdditionalArgs",[])}get checkForSdkUpdates(){return this.getConfig("checkForSdkUpdates",!0)}get closingLabels(){return this.getConfig("closingLabels",!0)}get debugExtensionBackendProtocol(){return this.getConfig("debugExtensionBackendProtocol","ws")}get debugExternalLibraries(){return this.getConfig("debugExternalLibraries",!1)}get debugSdkLibraries(){return this.getConfig("debugSdkLibraries",!1)}get devToolsLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("devToolsLogFile",null)))}get devToolsPort(){return this.getConfig("devToolsPort",null)}get devToolsReuseWindows(){return this.getConfig("devToolsReuseWindows",!0)}get devToolsTheme(){return this.getConfig("devToolsTheme","dark")}get embedDevTools(){return this.getConfig("embedDevTools",!0)}get enableSdkFormatter(){return this.getConfig("enableSdkFormatter",!0)}get enableSnippets(){return this.getConfig("enableSnippets",!0)}get env(){return this.getConfig("env",{})}get evaluateToStringInDebugViews(){return this.getConfig("evaluateToStringInDebugViews",!0)}get extensionLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("extensionLogFile",null)))}get flutterAdbConnectOnChromeOs(){return this.getConfig("flutterAdbConnectOnChromeOs",!1)}get flutterAndroidX(){return this.getConfig("flutterAndroidX",!1)}get flutterCreateAndroidLanguage(){return this.getConfig("flutterCreateAndroidLanguage","kotlin")}get flutterCreateIOSLanguage(){return this.getConfig("flutterCreateIOSLanguage","swift")}get flutterCreateOffline(){return this.getConfig("flutterCreateOffline",!1)}get flutterCreateOrganization(){return this.getConfig("flutterCreateOrganization",null)}get flutterCustomEmulators(){return this.getConfig("flutterCustomEmulators",[])}get flutterDaemonLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterDaemonLogFile",null)))}get flutterGutterIcons(){return this.getConfig("flutterGutterIcons",!0)}get flutterHotReloadOnSave(){return this.getConfig("flutterHotReloadOnSave",!0)}get flutterHotRestartOnSave(){return this.getConfig("flutterHotRestartOnSave",!0)}get flutterOutline(){return this.getConfig("flutterOutline",!0)}get flutterRunLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterRunLogFile",null)))}get flutterScreenshotPath(){return s.resolvePaths(this.getConfig("flutterScreenshotPath",null))}get flutterSdkPath(){return s.resolvePaths(this.getConfig("flutterSdkPath",null))}get flutterSdkPaths(){return this.getConfig("flutterSdkPaths",[]).map(s.resolvePaths)}get flutterSelectDeviceWhenConnected(){return this.getConfig("flutterSelectDeviceWhenConnected",!0)}get flutterTestLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("flutterTestLogFile",null)))}get maxLogLineLength(){return this.getConfig("maxLogLineLength",2e3)}get notifyAnalyzerErrors(){return this.getConfig("notifyAnalyzerErrors",!0)}get openDevTools(){return this.getConfig("openDevTools","never")}get openTestView(){return this.getConfig("openTestView",["testRunStart"])}get previewBazelWorkspaceCustomScripts(){return this.getConfig("previewBazelWorkspaceCustomScripts",!1)}get previewBuildRunnerTasks(){return this.getConfig("previewBuildRunnerTasks",!1)}get previewFlutterUiGuides(){return this.getConfig("previewFlutterUiGuides",!1)}get previewFlutterUiGuidesCustomTracking(){return this.getConfig("previewFlutterUiGuidesCustomTracking",!1)}get previewHotReloadOnSaveWatcher(){return this.getConfig("previewHotReloadOnSaveWatcher",!1)}get previewLsp(){return this.getConfig("previewLsp",!1)}get promptToRunIfErrors(){return this.getConfig("promptToRunIfErrors",!0)}get pubTestLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("pubTestLogFile",null)))}get sdkPath(){return s.resolvePaths(this.getConfig("sdkPath",null))}get sdkPaths(){return this.getConfig("sdkPaths",[]).map(s.resolvePaths)}get showDartPadSampleCodeLens(){return this.getConfig("showDartPadSampleCodeLens",!0)}get showIgnoreQuickFixes(){return this.getConfig("showIgnoreQuickFixes",!0)}get showMainCodeLens(){return this.getConfig("showMainCodeLens",!0)}get showTestCodeLens(){return this.getConfig("showTestCodeLens",!0)}get showTodos(){return this.getConfig("showTodos",!0)}get triggerSignatureHelpAutomatically(){return this.getConfig("triggerSignatureHelpAutomatically",!1)}get updateImportsOnRename(){return this.getConfig("updateImportsOnRename",!0)}get useKnownChromeOSPorts(){return this.getConfig("useKnownChromeOSPorts",!0)}get vmServiceLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("vmServiceLogFile",null)))}get warnWhenEditingFilesOutsideWorkspace(){return this.getConfig("warnWhenEditingFilesOutsideWorkspace",!0)}get warnWhenEditingFilesInPubCache(){return this.getConfig("warnWhenEditingFilesInPubCache",!0)}get webDaemonLogFile(){return s.createFolderForFile(s.resolvePaths(this.getConfig("webDaemonLogFile",null)))}get useDevToolsDarkTheme(){return"dark"===this.devToolsTheme}get openTestViewOnFailure(){return-1!==this.openTestView.indexOf("testFailure")}get openTestViewOnStart(){return-1!==this.openTestView.indexOf("testRunStart")}get workspaceSdkPath(){return s.resolvePaths(this.getWorkspaceConfig("sdkPath"))}get workspaceFlutterSdkPath(){return s.resolvePaths(this.getWorkspaceConfig("flutterSdkPath"))}setCheckForSdkUpdates(e){return this.setConfig("checkForSdkUpdates",e,r.ConfigurationTarget.Global)}setFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,r.ConfigurationTarget.Workspace)}setGlobalDartSdkPath(e){return this.setConfig("sdkPath",e,r.ConfigurationTarget.Global)}setGlobalDebugSdkLibraries(e){return this.setConfig("debugSdkLibraries",e,r.ConfigurationTarget.Global)}setGlobalDebugExternalLibraries(e){return this.setConfig("debugExternalLibraries",e,r.ConfigurationTarget.Global)}setGlobalFlutterSdkPath(e){return this.setConfig("flutterSdkPath",e,r.ConfigurationTarget.Global)}setOpenDevTools(e){return this.setConfig("openDevTools",e,r.ConfigurationTarget.Global)}setSdkPath(e){return this.setConfig("sdkPath",e,r.ConfigurationTarget.Workspace)}setWarnWhenEditingFilesOutsideWorkspace(e){return this.setConfig("warnWhenEditingFilesOutsideWorkspace",e,r.ConfigurationTarget.Global)}setWarnWhenEditingFilesInPubCache(e){return this.setConfig("warnWhenEditingFilesInPubCache",e,r.ConfigurationTarget.Global)}for(e){return new c(e)}}},function(e,t,i){const n=i(9);e.exports=(e,t,i)=>new n(e,i).compare(new n(t,i))},function(e,t,i){class n{constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=this.options.loose;e=e.trim();const i=t?a[c.HYPHENRANGELOOSE]:a[c.HYPHENRANGE];e=e.replace(i,T(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(a[c.COMPARATORTRIM],l),s("comparator trim",e,a[c.COMPARATORTRIM]),e=(e=(e=e.replace(a[c.TILDETRIM],u)).replace(a[c.CARETTRIM],d)).split(/\s+/).join(" ");const n=t?a[c.COMPARATORLOOSE]:a[c.COMPARATOR];return e.split(" ").map(e=>f(e,this.options)).join(" ").split(/\s+/).map(e=>S(e,this.options)).filter(this.options.loose?e=>!!e.match(n):()=>!0).map(e=>new r(e,this.options))}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(i=>h(i,t)&&e.set.some(e=>h(e,t)&&i.every(i=>e.every(e=>i.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(E(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const r=i(27),s=i(25),o=i(9),{re:a,t:c,comparatorTrimReplace:l,tildeTrimReplace:u,caretTrimReplace:d}=i(16),h=(e,t)=>{let i=!0;const n=e.slice();let r=n.pop();for(;i&&n.length;)i=n.every(e=>r.intersects(e,t)),r=n.pop();return i},f=(e,t)=>(s("comp",e,t),e=v(e,t),s("caret",e),e=p(e,t),s("tildes",e),e=b(e,t),s("xrange",e),e=w(e,t),s("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,p=(e,t)=>e.trim().split(/\s+/).map(e=>m(e,t)).join(" "),m=(e,t)=>{const i=t.loose?a[c.TILDELOOSE]:a[c.TILDE];return e.replace(i,(t,i,n,r,o)=>{let a;return s("tilde",e,t,i,n,r,o),g(i)?a="":g(n)?a=`>=${i}.0.0 <${+i+1}.0.0-0`:g(r)?a=`>=${i}.${n}.0 <${i}.${+n+1}.0-0`:o?(s("replaceTilde pr",o),a=`>=${i}.${n}.${r}-${o} <${i}.${+n+1}.0-0`):a=`>=${i}.${n}.${r} <${i}.${+n+1}.0-0`,s("tilde return",a),a})},v=(e,t)=>e.trim().split(/\s+/).map(e=>y(e,t)).join(" "),y=(e,t)=>{s("caret",e,t);const i=t.loose?a[c.CARETLOOSE]:a[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(i,(t,i,r,o,a)=>{let c;return s("caret",e,t,i,r,o,a),g(i)?c="":g(r)?c=`>=${i}.0.0${n} <${+i+1}.0.0-0`:g(o)?c="0"===i?`>=${i}.${r}.0${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.0${n} <${+i+1}.0.0-0`:a?(s("replaceCaret pr",a),c="0"===i?"0"===r?`>=${i}.${r}.${o}-${a} <${i}.${r}.${+o+1}-0`:`>=${i}.${r}.${o}-${a} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${o}-${a} <${+i+1}.0.0-0`):(s("no pr"),c="0"===i?"0"===r?`>=${i}.${r}.${o}${n} <${i}.${r}.${+o+1}-0`:`>=${i}.${r}.${o}${n} <${i}.${+r+1}.0-0`:`>=${i}.${r}.${o} <${+i+1}.0.0-0`),s("caret return",c),c})},b=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map(e=>C(e,t)).join(" ")),C=(e,t)=>{e=e.trim();const i=t.loose?a[c.XRANGELOOSE]:a[c.XRANGE];return e.replace(i,(i,n,r,o,a,c)=>{s("xRange",e,i,n,r,o,a,c);const l=g(r),u=l||g(o),d=u||g(a),h=d;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",l?i=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(u&&(o=0),a=0,">"===n?(n=">=",u?(r=+r+1,o=0,a=0):(o=+o+1,a=0)):"<="===n&&(n="<",u?r=+r+1:o=+o+1),"<"===n&&(c="-0"),i=`${n+r}.${o}.${a}${c}`):u?i=`>=${r}.0.0${c} <${+r+1}.0.0-0`:d&&(i=`>=${r}.${o}.0${c} <${r}.${+o+1}.0-0`),s("xRange return",i),i})},w=(e,t)=>(s("replaceStars",e,t),e.trim().replace(a[c.STAR],"")),S=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,i,n,r,s,o,a,c,l,u,d,h,f)=>`${i=g(n)?"":g(r)?`>=${n}.0.0${e?"-0":""}`:g(s)?`>=${n}.${r}.0${e?"-0":""}`:o?">="+i:`>=${i}${e?"-0":""}`} ${c=g(l)?"":g(u)?`<${+l+1}.0.0-0`:g(d)?`<${l}.${+u+1}.0-0`:h?`<=${l}.${u}.${d}-${h}`:e?`<${l}.${u}.${+d+1}-0`:"<="+c}`.trim(),E=(e,t,i)=>{for(let i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!i.includePrerelease){for(let i=0;i<e.length;i++)if(s(e[i].semver),e[i].semver!==r.ANY&&e[i].semver.prerelease.length>0){const n=e[i].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingLog=t.captureLogs=t.logToConsole=t.logProcess=t.nullLogger=t.CategoryLogger=t.EmittingLogger=void 0;const n=i(38),r=i(5),s=i(18),o=i(2),a=i(8),c=i(3);class l extends n.EventEmitter{fire(e){this.emit("log",e)}onLog(e){return this.on("log",e),{dispose:()=>{this.removeListener("log",e)}}}}t.EmittingLogger=class{constructor(){this.onLogEmitter=new l,this.onLog=e=>this.onLogEmitter.onLog(e)}log(e,t,i=a.LogCategory.General){this.onLogEmitter.fire(new u(e,t,i))}info(e,t){this.log(e,a.LogSeverity.Info,t)}warn(e,t){this.log(c.errorString(e),a.LogSeverity.Warn,t)}error(e,t){this.log(c.errorString(e),a.LogSeverity.Error,t)}dispose(){this.onLogEmitter.removeAllListeners()}};class u{constructor(e,t,i){this.message=e,this.severity=t,this.category=i}toLine(e){const t=(e&&this.message&&this.message.length>e?this.message.substring(0,e)+"â€¦":this.message||"<empty message>").trimRight();return`${`[${(new Date).toLocaleTimeString()}]`} ${`[${a.LogCategory[this.category]}] [${a.LogSeverity[this.severity]}]`} ${t}`}}t.CategoryLogger=class{constructor(e,t){this.base=e,this.defaultCategory=t}info(e,t=this.defaultCategory){this.base.info(e,t)}warn(e,t=this.defaultCategory){this.base.warn(e,t)}error(e,t=this.defaultCategory){this.base.error(e,t)}};t.nullLogger=new class{info(e,t){}warn(e,t){}error(e,t){}},t.logProcess=function(e,t,i){const n=`(PROC ${i.pid})`;e.info(n+" Logging data for process...",t),i.stdout.on("data",i=>e.info(`${n} ${i}`,t)),i.stderr.on("data",i=>e.info(`${n} ${i}`,t)),i.on("close",(i,r)=>e.info(`${n} closed (${i}, ${r})`,t)),i.on("exit",(i,r)=>e.info(`${n} exited (${i}, ${r})`,t))},t.logToConsole=function(e){e.onLog(e=>{e.severity===a.LogSeverity.Error?console.error(e.toLine(1e3)):e.severity===a.LogSeverity.Warn&&console.warn(e.toLine(1e3))})},t.captureLogs=function(e,t,i,n,c,l=!1){if(!t||!o.isAbsolute(t))throw new Error("Path passed to logTo must be an absolute path");const u=(e=!1)=>e?`[${(new Date).toTimeString()}] `:`[${(new Date).toLocaleTimeString()}] `;let d=r.createWriteStream(t);i&&d.write(i),d.write(`${(new Date).toDateString()} ${u(!0)}Log file started${s.EOL}`);let h=e.onLog(e=>{if(!d)return;(!c||(l?-1===c.indexOf(e.category):-1!==c.indexOf(e.category))||e.severity===a.LogSeverity.Warn||e.severity===a.LogSeverity.Error)&&d.write(`${e.toLine(n)}${s.EOL}`)});return{dispose:()=>(h&&(h.dispose(),h=void 0),new Promise(e=>{d&&(d.write(`${(new Date).toDateString()} ${u(!0)}Log file ended${s.EOL}`),d.end(e),d=void 0)}))}};t.RingLog=class{constructor(e){this.size=e,this.pointer=0,this.lines=new Array(this.size)}get rawLines(){return this.lines}log(e){this.lines[this.pointer]=e,this.pointer=(this.pointer+1)%this.size}toString(){return this.lines.slice(this.pointer,this.size).concat(this.lines.slice(0,this.pointer)).filter(e=>e).join("\n")}}},function(e,t,i){"use strict";function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});const r=i(23);t.ErrorCodes=r.ErrorCodes,t.ResponseError=r.ResponseError,t.CancellationToken=r.CancellationToken,t.CancellationTokenSource=r.CancellationTokenSource,t.Disposable=r.Disposable,t.Event=r.Event,t.Emitter=r.Emitter,t.Trace=r.Trace,t.TraceFormat=r.TraceFormat,t.SetTraceNotification=r.SetTraceNotification,t.LogTraceNotification=r.LogTraceNotification,t.RequestType=r.RequestType,t.RequestType0=r.RequestType0,t.NotificationType=r.NotificationType,t.NotificationType0=r.NotificationType0,t.MessageReader=r.MessageReader,t.MessageWriter=r.MessageWriter,t.ConnectionStrategy=r.ConnectionStrategy,t.StreamMessageReader=r.StreamMessageReader,t.StreamMessageWriter=r.StreamMessageWriter,t.IPCMessageReader=r.IPCMessageReader,t.IPCMessageWriter=r.IPCMessageWriter,t.createClientPipeTransport=r.createClientPipeTransport,t.createServerPipeTransport=r.createServerPipeTransport,t.generateRandomPipeName=r.generateRandomPipeName,t.createClientSocketTransport=r.createClientSocketTransport,t.createServerSocketTransport=r.createServerSocketTransport,t.ProgressType=r.ProgressType,n(i(158)),n(i(159));const s=i(170),o=i(171);!function(e){let t,i,n,r,a,c;!function(e){e.method=s.CallHierarchyPrepareRequest.method,e.type=s.CallHierarchyPrepareRequest.type}(t=e.CallHierarchyPrepareRequest||(e.CallHierarchyPrepareRequest={})),function(e){e.method=s.CallHierarchyIncomingCallsRequest.method,e.type=s.CallHierarchyIncomingCallsRequest.type}(i=e.CallHierarchyIncomingCallsRequest||(e.CallHierarchyIncomingCallsRequest={})),function(e){e.method=s.CallHierarchyOutgoingCallsRequest.method,e.type=s.CallHierarchyOutgoingCallsRequest.type}(n=e.CallHierarchyOutgoingCallsRequest||(e.CallHierarchyOutgoingCallsRequest={})),e.SemanticTokenTypes=o.SemanticTokenTypes,e.SemanticTokenModifiers=o.SemanticTokenModifiers,e.SemanticTokens=o.SemanticTokens,function(e){e.method=o.SemanticTokensRequest.method,e.type=o.SemanticTokensRequest.type}(r=e.SemanticTokensRequest||(e.SemanticTokensRequest={})),function(e){e.method=o.SemanticTokensEditsRequest.method,e.type=o.SemanticTokensEditsRequest.type}(a=e.SemanticTokensEditsRequest||(e.SemanticTokensEditsRequest={})),function(e){e.method=o.SemanticTokensRangeRequest.method,e.type=o.SemanticTokensRangeRequest.type}(c=e.SemanticTokensRangeRequest||(e.SemanticTokensRangeRequest={}))}(t.Proposed||(t.Proposed={})),t.createProtocolConnection=function(e,t,i,n){return r.createMessageConnection(e,t,i,n)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RunProcessResult=t.runProcess=t.safeToolSpawn=t.setupToolEnv=t.getGlobalFlutterArgs=t.getToolEnv=void 0;const n=i(8),r=i(13),s=i(40),o=i(111);let a={},c=[];function l(e){a={},c=[],a.FLUTTER_HOST="VSCode",a.PUB_ENVIRONMENT=(a.PUB_ENVIRONMENT?a.PUB_ENVIRONMENT+":":"")+"vscode.dart-code",process.env.DART_CODE_IS_TEST_RUN&&(a.PUB_ENVIRONMENT+=".test.bot",c.push("--suppress-analytics")),e&&(a=Object.assign(a,e))}function u(e,t,i,n){return s.safeSpawn(e,t,i,{envOverrides:n,toolEnv:a})}t.getToolEnv=function(){return a},t.getGlobalFlutterArgs=function(){return c},t.setupToolEnv=l,l(),t.safeToolSpawn=u,t.runProcess=function(e,t,i,s,a){return new Promise(c=>{e.info(`Spawning ${i} with args ${JSON.stringify(s)} in ${t} with env ${JSON.stringify(a)}`);const l=u(t,i,s,a);r.logProcess(e,n.LogCategory.CommandProcesses,l);const h=[],f=[];l.stdout.on("data",e=>h.push(e.toString())),l.stderr.on("data",e=>f.push(e.toString())),l.on("exit",e=>{c(new d(o.nullToUndefined(e),h.join(""),f.join("")))})})};class d{constructor(e,t,i){this.exitCode=e,this.stdout=t,this.stderr=i}}t.RunProcessResult=d},function(e,t,i){const{MAX_SAFE_COMPONENT_LENGTH:n}=i(24),r=i(25),s=(t=e.exports={}).re=[],o=t.src=[],a=t.t={};let c=0;const l=(e,t,i)=>{const n=c++;r(n,t),a[e]=n,o[n]=t,s[n]=new RegExp(t,i?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})\\.(${o[a.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})\\.(${o[a.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${o[a.NUMERICIDENTIFIER]}|${o[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${o[a.NUMERICIDENTIFIERLOOSE]}|${o[a.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${o[a.PRERELEASEIDENTIFIER]}(?:\\.${o[a.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${o[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[a.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${o[a.BUILDIDENTIFIER]}(?:\\.${o[a.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${o[a.MAINVERSION]}${o[a.PRERELEASE]}?${o[a.BUILD]}?`),l("FULL",`^${o[a.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${o[a.MAINVERSIONLOOSE]}${o[a.PRERELEASELOOSE]}?${o[a.BUILD]}?`),l("LOOSE",`^${o[a.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",o[a.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",o[a.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:\\.(${o[a.XRANGEIDENTIFIER]})(?:${o[a.PRERELEASE]})?${o[a.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[a.XRANGEIDENTIFIERLOOSE]})(?:${o[a.PRERELEASELOOSE]})?${o[a.BUILD]}?)?)?`),l("XRANGE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${o[a.GTLT]}\\s*${o[a.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),l("COERCERTL",o[a.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${o[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${o[a.LONETILDE]}${o[a.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${o[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${o[a.LONECARET]}${o[a.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${o[a.LONECARET]}${o[a.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${o[a.GTLT]}\\s*(${o[a.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${o[a.GTLT]}\\s*(${o[a.LOOSEPLAIN]}|${o[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${o[a.XRANGEPLAIN]})\\s+-\\s+(${o[a.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${o[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[a.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,i){const{MAX_LENGTH:n}=i(24),{re:r,t:s}=i(16),o=i(9);e.exports=(e,t)=>{if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?r[s.LOOSE]:r[s.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},function(e,t){e.exports=require("os")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cleanDartdoc=t.checkHasFlutterExtension=t.readJson=t.docsIconPathFormat=t.hasFlutterExtension=t.isDevExtension=t.vsCodeVersionConstraint=t.extensionVersion=t.extensionPath=void 0;const n=i(5),r=i(2),s=i(0),o=i(4),a=i(107);function c(e){return JSON.parse(n.readFileSync(e).toString())}function l(){return void 0!==s.extensions.getExtension(o.flutterExtensionIdentifier)}t.extensionPath=s.extensions.getExtension(o.dartCodeExtensionIdentifier).extensionPath,t.extensionVersion=c(r.join(t.extensionPath,"package.json")).version,t.vsCodeVersionConstraint=c(r.join(t.extensionPath,"package.json")).engines.vscode,t.isDevExtension=t.extensionVersion.endsWith("-dev"),t.hasFlutterExtension=l(),t.docsIconPathFormat=s.Uri.file(r.join(t.extensionPath,"media/doc-icons/")).toString()+"$1%402x.png",t.readJson=c,t.checkHasFlutterExtension=l,t.cleanDartdoc=function(e){return a.cleanDartdoc(e,t.docsIconPathFormat)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23);class r extends n.RequestType0{constructor(e){super(e)}}t.ProtocolRequestType0=r;class s extends n.RequestType{constructor(e){super(e)}}t.ProtocolRequestType=s;class o extends n.NotificationType{constructor(e){super(e)}}t.ProtocolNotificationType=o;class a extends n.NotificationType0{constructor(e){super(e)}}t.ProtocolNotificationType0=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arraysEqual=t.unique=t.not=t.sortBy=void 0,t.sortBy=function(e,t){return e.sort((e,i)=>{const n=t(e),r=t(i);return n<r?-1:n>r?1:0})},t.not=function(e){return t=>!e(t)},t.unique=function(e){return Array.from(new Set(e))},t.arraysEqual=function(e,t){return e.length===t.length&&e.every((e,i)=>e===t[i])}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(172),o=i(173),a=i(53),c=i(174),l=i(116),u=i(117);!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(14));class d{error(e){console.error(e)}warn(e){console.warn(e)}info(e){console.info(e)}log(e){console.log(e)}}var h,f,g,p,m;!function(e){e[e.Continue=1]="Continue",e[e.Shutdown=2]="Shutdown"}(h=t.ErrorAction||(t.ErrorAction={})),function(e){e[e.DoNotRestart=1]="DoNotRestart",e[e.Restart=2]="Restart"}(f=t.CloseAction||(t.CloseAction={}));class v{constructor(e){this.name=e,this.restarts=[]}error(e,t,i){return i&&i<=3?h.Continue:h.Shutdown}closed(){if(this.restarts.push(Date.now()),this.restarts.length<5)return f.Restart;return this.restarts[this.restarts.length-1]-this.restarts[0]<=18e4?(n.window.showErrorMessage(`The ${this.name} server crashed 5 times in the last 3 minutes. The server will not be restarted.`),f.DoNotRestart):(this.restarts.shift(),f.Restart)}}!function(e){e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.Never=4]="Never"}(g=t.RevealOutputChannelOn||(t.RevealOutputChannelOn={})),function(e){e[e.Stopped=1]="Stopped",e[e.Starting=3]="Starting",e[e.Running=2]="Running"}(p=t.State||(t.State={})),function(e){e[e.Initial=0]="Initial",e[e.Starting=1]="Starting",e[e.StartFailed=2]="StartFailed",e[e.Running=3]="Running",e[e.Stopping=4]="Stopping",e[e.Stopped=5]="Stopped"}(m||(m={}));const y=[r.SymbolKind.File,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Package,r.SymbolKind.Class,r.SymbolKind.Method,r.SymbolKind.Property,r.SymbolKind.Field,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.Interface,r.SymbolKind.Function,r.SymbolKind.Variable,r.SymbolKind.Constant,r.SymbolKind.String,r.SymbolKind.Number,r.SymbolKind.Boolean,r.SymbolKind.Array,r.SymbolKind.Object,r.SymbolKind.Key,r.SymbolKind.Null,r.SymbolKind.EnumMember,r.SymbolKind.Struct,r.SymbolKind.Event,r.SymbolKind.Operator,r.SymbolKind.TypeParameter],b=[r.CompletionItemKind.Text,r.CompletionItemKind.Method,r.CompletionItemKind.Function,r.CompletionItemKind.Constructor,r.CompletionItemKind.Field,r.CompletionItemKind.Variable,r.CompletionItemKind.Class,r.CompletionItemKind.Interface,r.CompletionItemKind.Module,r.CompletionItemKind.Property,r.CompletionItemKind.Unit,r.CompletionItemKind.Value,r.CompletionItemKind.Enum,r.CompletionItemKind.Keyword,r.CompletionItemKind.Snippet,r.CompletionItemKind.Color,r.CompletionItemKind.File,r.CompletionItemKind.Reference,r.CompletionItemKind.Folder,r.CompletionItemKind.EnumMember,r.CompletionItemKind.Constant,r.CompletionItemKind.Struct,r.CompletionItemKind.Event,r.CompletionItemKind.Operator,r.CompletionItemKind.TypeParameter];function C(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var w;!function(e){e.is=function(e){let t=e;return t&&a.func(t.register)&&a.func(t.unregister)&&a.func(t.dispose)&&void 0!==t.messages}}(w||(w={}));class S{constructor(e,t,i,n,r,s){this._client=e,this._event=t,this._type=i,this._middleware=n,this._createParams=r,this._selectorFilter=s,this._selectors=new Map}static textDocumentFilter(e,t){for(const i of e)if(n.languages.match(i,t))return!0;return!1}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){this._selectorFilter&&!this._selectorFilter(this._selectors.values(),e)||(this._middleware?this._middleware(e,e=>this._client.sendNotification(this._type,this._createParams(e))):this._client.sendNotification(this._type,this._createParams(e)),this.notificationSent(e))}notificationSent(e){}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(const t of this._selectors.values())if(n.languages.match(t,e))return{send:e=>{this.callback(e)}};throw new Error("No provider available for the given text document")}}class T extends S{constructor(e,t){super(e,n.workspace.onDidOpenTextDocument,r.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,t=>e.code2ProtocolConverter.asOpenTextDocumentParams(t),S.textDocumentFilter),this._syncedDocuments=t}get messages(){return r.DidOpenTextDocumentNotification.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){if(super.register(e,t),!t.registerOptions.documentSelector)return;let i=t.registerOptions.documentSelector;n.workspace.textDocuments.forEach(e=>{let t=e.uri.toString();if(!this._syncedDocuments.has(t)&&n.languages.match(i,e)){let i=this._client.clientOptions.middleware,n=e=>{this._client.sendNotification(this._type,this._createParams(e))};i.didOpen?i.didOpen(e,n):n(e),this._syncedDocuments.set(t,e)}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.set(e.uri.toString(),e)}}class E extends S{constructor(e,t){super(e,n.workspace.onDidCloseTextDocument,r.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,t=>e.code2ProtocolConverter.asCloseTextDocumentParams(t),S.textDocumentFilter),this._syncedDocuments=t}get messages(){return r.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.openClose&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e){super.notificationSent(e),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let i=this._selectors.values();this._syncedDocuments.forEach(e=>{if(n.languages.match(t,e)&&!this._selectorFilter(i,e)){let t=this._client.clientOptions.middleware,i=e=>{this._client.sendNotification(this._type,this._createParams(e))};this._syncedDocuments.delete(e.uri.toString()),t.didClose?t.didClose(e,i):i(e)}})}}class P{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1}get messages(){return r.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&void 0!==i.change&&i.change!==r.TextDocumentSyncKind.None&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:i.change})})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=n.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(t.id,{documentSelector:t.registerOptions.documentSelector,syncKind:t.registerOptions.syncKind}))}callback(e){if(0!==e.contentChanges.length)for(const t of this._changeData.values())if(n.languages.match(t.documentSelector,e.document)){let i=this._client.clientOptions.middleware;if(t.syncKind===r.TextDocumentSyncKind.Incremental){let t=this._client.code2ProtocolConverter.asChangeTextDocumentParams(e);i.didChange?i.didChange(e,()=>this._client.sendNotification(r.DidChangeTextDocumentNotification.type,t)):this._client.sendNotification(r.DidChangeTextDocumentNotification.type,t)}else if(t.syncKind===r.TextDocumentSyncKind.Full){let t=e=>{this._changeDelayer?(this._changeDelayer.uri!==e.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=e.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(r.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))})):(this._changeDelayer={uri:e.document.uri.toString(),delayer:new c.Delayer(200)},this._changeDelayer.delayer.trigger(()=>{this._client.sendNotification(r.DidChangeTextDocumentNotification.type,this._client.code2ProtocolConverter.asChangeTextDocumentParams(e.document))},-1))};i.didChange?i.didChange(e,t):t(e)}}}unregister(e){this._changeData.delete(e),0===this._changeData.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!this._forcingDelivery&&this._changeDelayer)try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(const t of this._changeData.values())if(n.languages.match(t.documentSelector,e))return{send:e=>{this.callback(e)}};throw new Error("No provider available for the given text document")}}class R extends S{constructor(e){super(e,n.workspace.onWillSaveTextDocument,r.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(e,t)=>S.textDocumentFilter(e,t.document))}get messages(){return r.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").willSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSave&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}}class D{constructor(e){this._client=e,this._selectors=new Map}get messages(){return r.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").willSaveWaitUntil=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.willSaveWaitUntil&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{documentSelector:t}})}register(e,t){t.registerOptions.documentSelector&&(this._listener||(this._listener=n.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(t.id,t.registerOptions.documentSelector))}callback(e){if(S.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,i=e=>this._client.sendRequest(r.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(e)).then(e=>{let t=this._client.protocol2CodeConverter.asTextEdits(e);return void 0===t?[]:t});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,i):i(e))}}unregister(e){this._selectors.delete(e),0===this._selectors.size&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}}class k extends S{constructor(e){super(e,n.workspace.onDidSaveTextDocument,r.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),S.textDocumentFilter)}get messages(){return r.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){C(C(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let i=e.resolvedTextDocumentSync;t&&i&&i.save&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{includeText:!!i.save.includeText})})}register(e,t){this._includeText=!!t.registerOptions.includeText,super.register(e,t)}}class x{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get messages(){return r.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){C(C(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e,t){if(!Array.isArray(t.registerOptions.watchers))return;let i=[];for(let e of t.registerOptions.watchers){if(!a.string(e.globPattern))continue;let t=!0,s=!0,o=!0;void 0!==e.kind&&null!==e.kind&&(t=0!=(e.kind&r.WatchKind.Create),s=0!=(e.kind&r.WatchKind.Change),o=0!=(e.kind&r.WatchKind.Delete));let c=n.workspace.createFileSystemWatcher(e.globPattern,!t,!s,!o);this.hookListeners(c,t,s,o),i.push(c)}this._watchers.set(t.id,i)}registerRaw(e,t){let i=[];for(let e of t)this.hookListeners(e,!0,!0,!0,i);this._watchers.set(e,i)}hookListeners(e,t,i,n,s){t&&e.onDidCreate(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Created}),null,s),i&&e.onDidChange(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Changed}),null,s),n&&e.onDidDelete(e=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(e),type:r.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let e of t)e.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}}class F{constructor(e,t){this._client=e,this._message=t,this._registrations=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wrong feature. Requested ${e.method} but reached feature ${this.messages.method}`);if(!t.registerOptions.documentSelector)return;let i=this.registerLanguageProvider(t.registerOptions);this._registrations.set(t.id,{disposable:i[0],data:t,provider:i[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(!t)return[void 0,void 0];if(r.TextDocumentRegistrationOptions.is(t)){const i=r.StaticRegistrationOptions.hasId(t)?t.id:l.generateUuid(),n=t.documentSelector||e;if(n)return[i,Object.assign({},t,{documentSelector:n})]}else if(a.boolean(t)&&!0===t||r.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let i=a.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[l.generateUuid(),i]}return[void 0,void 0]}getRegistrationOptions(e,t){if(e&&t)return a.boolean(t)&&!0===t?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(const t of this._registrations.values()){let i=t.data.registerOptions.documentSelector;if(null!==i&&n.languages.match(i,e))return t.provider}throw new Error("The feature has no registration for the provided text document "+e.uri.toString())}}t.TextDocumentFeature=F;class O extends F{constructor(e){super(e,r.CompletionRequest.type)}fillClientCapabilities(e){let t=C(C(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[r.CompletionItemTag.Deprecated]}},t.completionItemKind={valueSet:b}}initialize(e,t){const i=this.getRegistrationOptions(t,e.completionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t=e.triggerCharacters||[],i={provideCompletionItems:(e,t,i,n)=>{const s=this._client,o=this._client.clientOptions.middleware,a=(e,t,i,n)=>s.sendRequest(r.CompletionRequest.type,s.code2ProtocolConverter.asCompletionParams(e,t,i),n).then(s.protocol2CodeConverter.asCompletionResult,e=>(s.logFailedRequest(r.CompletionRequest.type,e),Promise.resolve([])));return o.provideCompletionItem?o.provideCompletionItem(e,t,n,i,a):a(e,t,n,i)},resolveCompletionItem:e.resolveProvider?(e,t)=>{const i=this._client,n=this._client.clientOptions.middleware,s=(e,t)=>i.sendRequest(r.CompletionResolveRequest.type,i.code2ProtocolConverter.asCompletionItem(e),t).then(i.protocol2CodeConverter.asCompletionItem,t=>(i.logFailedRequest(r.CompletionResolveRequest.type,t),Promise.resolve(e)));return n.resolveCompletionItem?n.resolveCompletionItem(e,t,s):s(e,t)}:void 0};return[n.languages.registerCompletionItemProvider(e.documentSelector,i,...t),i]}}class _ extends F{constructor(e){super(e,r.HoverRequest.type)}fillClientCapabilities(e){const t=C(C(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[r.MarkupKind.Markdown,r.MarkupKind.PlainText]}initialize(e,t){const i=this.getRegistrationOptions(t,e.hoverProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideHover:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.HoverRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asHover,e=>(n.logFailedRequest(r.HoverRequest.type,e),Promise.resolve(null))),o=n.clientOptions.middleware;return o.provideHover?o.provideHover(e,t,i,s):s(e,t,i)}};return[n.languages.registerHoverProvider(e.documentSelector,t),t]}}class A extends F{constructor(e){super(e,r.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=C(C(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[r.MarkupKind.Markdown,r.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.contextSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.signatureHelpProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideSignatureHelp:(e,t,i,n)=>{const s=this._client,o=(e,t,i,n)=>s.sendRequest(r.SignatureHelpRequest.type,s.code2ProtocolConverter.asSignatureHelpParams(e,t,i),n).then(s.protocol2CodeConverter.asSignatureHelp,e=>(s.logFailedRequest(r.SignatureHelpRequest.type,e),Promise.resolve(null))),a=s.clientOptions.middleware;return a.provideSignatureHelp?a.provideSignatureHelp(e,t,n,i,o):o(e,t,n,i)}};let i;if(void 0===e.retriggerCharacters){const r=e.triggerCharacters||[];i=n.languages.registerSignatureHelpProvider(e.documentSelector,t,...r)}else{const r={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};i=n.languages.registerSignatureHelpProvider(e.documentSelector,t,r)}return[i,t]}}class I extends F{constructor(e){super(e,r.DefinitionRequest.type)}fillClientCapabilities(e){let t=C(C(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.definitionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDefinition:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.DefinitionRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDefinitionResult,e=>(n.logFailedRequest(r.DefinitionRequest.type,e),Promise.resolve(null))),o=n.clientOptions.middleware;return o.provideDefinition?o.provideDefinition(e,t,i,s):s(e,t,i)}};return[n.languages.registerDefinitionProvider(e.documentSelector,t),t]}}class L extends F{constructor(e){super(e,r.ReferencesRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.referencesProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideReferences:(e,t,i,n)=>{const s=this._client,o=(e,t,i,n)=>s.sendRequest(r.ReferencesRequest.type,s.code2ProtocolConverter.asReferenceParams(e,t,i),n).then(s.protocol2CodeConverter.asReferences,e=>(s.logFailedRequest(r.ReferencesRequest.type,e),Promise.resolve([]))),a=s.clientOptions.middleware;return a.provideReferences?a.provideReferences(e,t,i,n,o):o(e,t,i,n)}};return[n.languages.registerReferenceProvider(e.documentSelector,t),t]}}class N extends F{constructor(e){super(e,r.DocumentHighlightRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentHighlightProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentHighlights:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.DocumentHighlightRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDocumentHighlights,e=>(n.logFailedRequest(r.DocumentHighlightRequest.type,e),Promise.resolve([]))),o=n.clientOptions.middleware;return o.provideDocumentHighlights?o.provideDocumentHighlights(e,t,i,s):s(e,t,i)}};return[n.languages.registerDocumentHighlightProvider(e.documentSelector,t),t]}}class M extends F{constructor(e){super(e,r.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=C(C(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y},t.hierarchicalDocumentSymbolSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentSymbolProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentSymbols:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.DocumentSymbolRequest.type,i.code2ProtocolConverter.asDocumentSymbolParams(e),t).then(e=>{if(null!==e){if(0===e.length)return[];{let t=e[0];return r.DocumentSymbol.is(t)?i.protocol2CodeConverter.asDocumentSymbols(e):i.protocol2CodeConverter.asSymbolInformations(e)}}},e=>(i.logFailedRequest(r.DocumentSymbolRequest.type,e),Promise.resolve([]))),s=i.clientOptions.middleware;return s.provideDocumentSymbols?s.provideDocumentSymbols(e,t,n):n(e,t)}};return[n.languages.registerDocumentSymbolProvider(e.documentSelector,t),t]}}class j extends class{constructor(e,t){this._client=e,this._message=t,this._registrations=new Map}get messages(){return this._message}register(e,t){if(e.method!==this.messages.method)throw new Error(`Register called on wron feature. Requested ${e.method} but reached feature ${this.messages.method}`);const i=this.registerLanguageProvider(t.registerOptions);this._registrations.set(t.id,{disposable:i[0],provider:i[1]})}unregister(e){let t=this._registrations.get(e);void 0!==t&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){const e=[];for(const t of this._registrations.values())e.push(t.provider);return e}}{constructor(e){super(e,r.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=C(C(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:y}}initialize(e){e.workspaceSymbolProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:!0===e.workspaceSymbolProvider?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){const t={provideWorkspaceSymbols:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.WorkspaceSymbolRequest.type,{query:e},t).then(i.protocol2CodeConverter.asSymbolInformations,e=>(i.logFailedRequest(r.WorkspaceSymbolRequest.type,e),Promise.resolve([]))),s=i.clientOptions.middleware;return s.provideWorkspaceSymbols?s.provideWorkspaceSymbols(e,t,n):n(e,t)}};return[n.languages.registerWorkspaceSymbolProvider(t),t]}}class U extends F{constructor(e){super(e,r.CodeActionRequest.type)}fillClientCapabilities(e){const t=C(C(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.codeActionLiteralSupport={codeActionKind:{valueSet:[r.CodeActionKind.Empty,r.CodeActionKind.QuickFix,r.CodeActionKind.Refactor,r.CodeActionKind.RefactorExtract,r.CodeActionKind.RefactorInline,r.CodeActionKind.RefactorRewrite,r.CodeActionKind.Source,r.CodeActionKind.SourceOrganizeImports]}}}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeActionProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideCodeActions:(e,t,i,n)=>{const s=this._client,o=(e,t,i,n)=>{const o={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),range:s.code2ProtocolConverter.asRange(t),context:s.code2ProtocolConverter.asCodeActionContext(i)};return s.sendRequest(r.CodeActionRequest.type,o,n).then(e=>{if(null===e)return;const t=[];for(let i of e)r.Command.is(i)?t.push(s.protocol2CodeConverter.asCommand(i)):t.push(s.protocol2CodeConverter.asCodeAction(i));return t},e=>(s.logFailedRequest(r.CodeActionRequest.type,e),Promise.resolve([])))},a=s.clientOptions.middleware;return a.provideCodeActions?a.provideCodeActions(e,t,i,n,o):o(e,t,i,n)}};return[n.languages.registerCodeActionsProvider(e.documentSelector,t,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),t]}}class q extends F{constructor(e){super(e,r.CodeLensRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"codeLens").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideCodeLenses:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.CodeLensRequest.type,i.code2ProtocolConverter.asCodeLensParams(e),t).then(i.protocol2CodeConverter.asCodeLenses,e=>(i.logFailedRequest(r.CodeLensRequest.type,e),Promise.resolve([]))),s=i.clientOptions.middleware;return s.provideCodeLenses?s.provideCodeLenses(e,t,n):n(e,t)},resolveCodeLens:e.resolveProvider?(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.CodeLensResolveRequest.type,i.code2ProtocolConverter.asCodeLens(e),t).then(i.protocol2CodeConverter.asCodeLens,t=>(i.logFailedRequest(r.CodeLensResolveRequest.type,t),e)),s=i.clientOptions.middleware;return s.resolveCodeLens?s.resolveCodeLens(e,t,n):n(e,t)}:void 0};return[n.languages.registerCodeLensProvider(e.documentSelector,t),t]}}class $ extends F{constructor(e){super(e,r.DocumentFormattingRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentFormattingEdits:(e,t,i)=>{const n=this._client,s=(e,t,i)=>{const s={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),options:n.code2ProtocolConverter.asFormattingOptions(t)};return n.sendRequest(r.DocumentFormattingRequest.type,s,i).then(n.protocol2CodeConverter.asTextEdits,e=>(n.logFailedRequest(r.DocumentFormattingRequest.type,e),Promise.resolve([])))},o=n.clientOptions.middleware;return o.provideDocumentFormattingEdits?o.provideDocumentFormattingEdits(e,t,i,s):s(e,t,i)}};return[n.languages.registerDocumentFormattingEditProvider(e.documentSelector,t),t]}}class W extends F{constructor(e){super(e,r.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentRangeFormattingEdits:(e,t,i,n)=>{const s=this._client,o=(e,t,i,n)=>{let o={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),range:s.code2ProtocolConverter.asRange(t),options:s.code2ProtocolConverter.asFormattingOptions(i)};return s.sendRequest(r.DocumentRangeFormattingRequest.type,o,n).then(s.protocol2CodeConverter.asTextEdits,e=>(s.logFailedRequest(r.DocumentRangeFormattingRequest.type,e),Promise.resolve([])))};let a=s.clientOptions.middleware;return a.provideDocumentRangeFormattingEdits?a.provideDocumentRangeFormattingEdits(e,t,i,n,o):o(e,t,i,n)}};return[n.languages.registerDocumentRangeFormattingEditProvider(e.documentSelector,t),t]}}class G extends F{constructor(e){super(e,r.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){C(C(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideOnTypeFormattingEdits:(e,t,i,n,s)=>{const o=this._client,a=(e,t,i,n,s)=>{let a={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(e),position:o.code2ProtocolConverter.asPosition(t),ch:i,options:o.code2ProtocolConverter.asFormattingOptions(n)};return o.sendRequest(r.DocumentOnTypeFormattingRequest.type,a,s).then(o.protocol2CodeConverter.asTextEdits,e=>(o.logFailedRequest(r.DocumentOnTypeFormattingRequest.type,e),Promise.resolve([])))},c=o.clientOptions.middleware;return c.provideOnTypeFormattingEdits?c.provideOnTypeFormattingEdits(e,t,i,n,s,a):a(e,t,i,n,s)}},i=e.moreTriggerCharacter||[];return[n.languages.registerOnTypeFormattingEditProvider(e.documentSelector,t,e.firstTriggerCharacter,...i),t]}}class z extends F{constructor(e){super(e,r.RenameRequest.type)}fillClientCapabilities(e){let t=C(C(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.renameProvider);i&&(a.boolean(e.renameProvider)&&(i.prepareProvider=!1),this.register(this.messages,{id:l.generateUuid(),registerOptions:i}))}registerLanguageProvider(e){const t={provideRenameEdits:(e,t,i,n)=>{const s=this._client,o=(e,t,i,n)=>{let o={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(e),position:s.code2ProtocolConverter.asPosition(t),newName:i};return s.sendRequest(r.RenameRequest.type,o,n).then(s.protocol2CodeConverter.asWorkspaceEdit,e=>(s.logFailedRequest(r.RenameRequest.type,e),Promise.reject(new Error(e.message))))},a=s.clientOptions.middleware;return a.provideRenameEdits?a.provideRenameEdits(e,t,i,n,o):o(e,t,i,n)},prepareRename:e.prepareProvider?(e,t,i)=>{const n=this._client,s=(e,t,i)=>{let s={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),position:n.code2ProtocolConverter.asPosition(t)};return n.sendRequest(r.PrepareRenameRequest.type,s,i).then(e=>r.Range.is(e)?n.protocol2CodeConverter.asRange(e):e&&r.Range.is(e.range)?{range:n.protocol2CodeConverter.asRange(e.range),placeholder:e.placeholder}:Promise.reject(new Error("The element can't be renamed.")),e=>(n.logFailedRequest(r.PrepareRenameRequest.type,e),Promise.reject(new Error(e.message))))},o=n.clientOptions.middleware;return o.prepareRename?o.prepareRename(e,t,i,s):s(e,t,i)}:void 0};return[n.languages.registerRenameProvider(e.documentSelector,t),t]}}class H extends F{constructor(e){super(e,r.DocumentLinkRequest.type)}fillClientCapabilities(e){const t=C(C(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){const i=this.getRegistrationOptions(t,e.documentLinkProvider);i&&this.register(this.messages,{id:l.generateUuid(),registerOptions:i})}registerLanguageProvider(e){const t={provideDocumentLinks:(e,t)=>{const i=this._client,n=(e,t)=>i.sendRequest(r.DocumentLinkRequest.type,i.code2ProtocolConverter.asDocumentLinkParams(e),t).then(i.protocol2CodeConverter.asDocumentLinks,e=>(i.logFailedRequest(r.DocumentLinkRequest.type,e),Promise.resolve([]))),s=i.clientOptions.middleware;return s.provideDocumentLinks?s.provideDocumentLinks(e,t,n):n(e,t)},resolveDocumentLink:e.resolveProvider?(e,t)=>{const i=this._client;let n=(e,t)=>i.sendRequest(r.DocumentLinkResolveRequest.type,i.code2ProtocolConverter.asDocumentLink(e),t).then(i.protocol2CodeConverter.asDocumentLink,t=>(i.logFailedRequest(r.DocumentLinkResolveRequest.type,t),Promise.resolve(e)));const s=i.clientOptions.middleware;return s.resolveDocumentLink?s.resolveDocumentLink(e,t,n):n(e,t)}:void 0};return[n.languages.registerDocumentLinkProvider(e.documentSelector,t),t]}}class V{constructor(e){this._client=e,this._listeners=new Map}get messages(){return r.DidChangeConfigurationNotification.type}fillClientCapabilities(e){C(C(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;void 0!==e&&this.register(this.messages,{id:l.generateUuid(),registerOptions:{section:e}})}register(e,t){let i=n.workspace.onDidChangeConfiguration(e=>{this.onDidChangeConfiguration(t.registerOptions.section,e)});this._listeners.set(t.id,i),void 0!==t.registerOptions.section&&this.onDidChangeConfiguration(t.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let i;if(i=a.string(e)?[e]:e,void 0!==i&&void 0!==t){if(!i.some(e=>t.affectsConfiguration(e)))return}let n=e=>{void 0!==e?this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(e)}):this._client.sendNotification(r.DidChangeConfigurationNotification.type,{settings:null})},s=this.getMiddleware();s?s(i,n):n(i)}extractSettingsInformation(e){function t(e,t){let i=e;for(let e=0;e<t.length-1;e++){let n=i[t[e]];n||(n=Object.create(null),i[t[e]]=n),i=n}return i}let i=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,r=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(c=a>=0?n.workspace.getConfiguration(o.substr(0,a),i).get(o.substr(a+1)):n.workspace.getConfiguration(o,i),c){let i=e[s].split(".");t(r,i)[i[i.length-1]]=c}}return r}getMiddleware(){let e=this._client.clientOptions.middleware;return e.workspace&&e.workspace.didChangeConfiguration?e.workspace.didChangeConfiguration:void 0}}class K{constructor(e){this._client=e,this._commands=new Map}get messages(){return r.ExecuteCommandRequest.type}fillClientCapabilities(e){C(C(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register(this.messages,{id:l.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e,t){const i=this._client,s=i.clientOptions.middleware,o=(e,t)=>{let n={command:e,arguments:t};return i.sendRequest(r.ExecuteCommandRequest.type,n).then(void 0,e=>{i.logFailedRequest(r.ExecuteCommandRequest.type,e)})};if(t.registerOptions.commands){const e=[];for(const i of t.registerOptions.commands)e.push(n.commands.registerCommand(i,(...e)=>s.executeCommand?s.executeCommand(i,e,o):o(i,e)));this._commands.set(t.id,e)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(e=>e.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(e=>e.dispose())}),this._commands.clear()}}!function(e){e.is=function(e){return e&&r.MessageReader.is(e.reader)&&r.MessageWriter.is(e.writer)}}(t.MessageTransports||(t.MessageTransports={}));class B{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}}t.BaseLanguageClient=class{constructor(e,t,i){this._traceFormat=r.TraceFormat.Text,this._features=[],this._method2Message=new Map,this._dynamicFeatures=new Map,this._id=e,this._name=t,i=i||{},this._clientOptions={documentSelector:i.documentSelector||[],synchronize:i.synchronize||{},diagnosticCollectionName:i.diagnosticCollectionName,outputChannelName:i.outputChannelName||this._name,revealOutputChannelOn:i.revealOutputChannelOn||g.Error,stdioEncoding:i.stdioEncoding||"utf8",initializationOptions:i.initializationOptions,initializationFailedHandler:i.initializationFailedHandler,progressOnInitialization:!!i.progressOnInitialization,errorHandler:i.errorHandler||new v(this._name),middleware:i.middleware||{},uriConverters:i.uriConverters,workspaceFolder:i.workspaceFolder},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this.state=m.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,i.outputChannel?(this._outputChannel=i.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=i.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new c.Delayer(250),this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new B(e,t)}),this._onStop=void 0,this._telemetryEmitter=new r.Emitter,this._stateChangeEmitter=new r.Emitter,this._tracer={log:(e,t)=>{a.string(e)?this.logTrace(e,t):this.logObjectTrace(e)}},this._c2p=s.createConverter(i.uriConverters?i.uriConverters.code2Protocol:void 0),this._p2c=o.createConverter(i.uriConverters?i.uriConverters.protocol2Code:void 0),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let i=this.getPublicState();i!==t&&this._stateChangeEmitter.fire({oldState:t,newState:i})}getPublicState(){return this.state===m.Running?p.Running:this.state===m.Starting?p.Starting:p.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(t){throw this.error(`Sending request ${a.string(e)?e:e.method} failed.`,t),t}}onRequest(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onRequest(e,t)}catch(t){throw this.error(`Registering request handler ${a.string(e)?e:e.method} failed.`,t),t}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendNotification(e,t)}catch(t){throw this.error(`Sending notification ${a.string(e)?e:e.method} failed.`,t),t}}onNotification(e,t){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{this._resolvedConnection.onNotification(e,t)}catch(t){throw this.error(`Registering notification handler ${a.string(e)?e:e.method} failed.`,t),t}}onProgress(e,t,i){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");try{return this._resolvedConnection.onProgress(e,t,i)}catch(e){throw this.error(`Registering progress handler for token ${t} failed.`,e),e}}sendProgress(e,t,i){if(!this.isConnectionActive())throw new Error("Language client is not ready yet");this.forceDocumentSync();try{this._resolvedConnection.sendProgress(e,t,i)}catch(e){throw this.error(`Sending progress for token ${t} failed.`,e),e}}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=n.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(){return new v(this._name)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(e=>{e.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})})},()=>{})}data2String(e){if(e instanceof r.ResponseError){const t=e;return`  Message: ${t.message}\n  Code: ${t.code} ${t.data?"\n"+t.data.toString():""}`}return e instanceof Error?a.string(e.stack)?e.stack:e.message:a.string(e)?e:e.toString()}info(e,t,i=!0){this.outputChannel.appendLine(`[Info  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Info&&this.showNotificationMessage()}warn(e,t,i=!0){this.outputChannel.appendLine(`[Warn  - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Warn&&this.showNotificationMessage()}error(e,t,i=!0){this.outputChannel.appendLine(`[Error - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.outputChannel.appendLine(this.data2String(t)),i&&this._clientOptions.revealOutputChannelOn<=g.Error&&this.showNotificationMessage()}showNotificationMessage(){n.window.showInformationMessage("A request has failed. See the output for more information.","Go to output").then(()=>{this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${(new Date).toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${(new Date).toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${(new Date).toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(""+JSON.stringify(e))}needsStart(){return this.state===m.Initial||this.state===m.Stopping||this.state===m.Stopped}needsStop(){return this.state===m.Starting||this.state===m.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===m.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new B(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?n.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):n.languages.createDiagnosticCollection()),this.state=m.Starting,this.resolveConnection().then(e=>(e.onLogMessage(e=>{switch(e.type){case r.MessageType.Error:this.error(e.message,void 0,!1);break;case r.MessageType.Warning:this.warn(e.message,void 0,!1);break;case r.MessageType.Info:this.info(e.message,void 0,!1);break;default:this.outputChannel.appendLine(e.message)}}),e.onShowMessage(e=>{switch(e.type){case r.MessageType.Error:n.window.showErrorMessage(e.message);break;case r.MessageType.Warning:n.window.showWarningMessage(e.message);break;case r.MessageType.Info:n.window.showInformationMessage(e.message);break;default:n.window.showInformationMessage(e.message)}}),e.onRequest(r.ShowMessageRequest.type,e=>{let t;switch(e.type){case r.MessageType.Error:t=n.window.showErrorMessage;break;case r.MessageType.Warning:t=n.window.showWarningMessage;break;case r.MessageType.Info:t=n.window.showInformationMessage;break;default:t=n.window.showInformationMessage}let i=e.actions||[];return t(e.message,...i)}),e.onTelemetry(e=>{this._telemetryEmitter.fire(e)}),e.listen(),this.initialize(e))).then(void 0,e=>{this.state=m.StartFailed,this._onReadyCallbacks.reject(e),this.error("Starting client failed",e),n.window.showErrorMessage("Couldn't start client "+this._name)}),new n.Disposable(()=>{this.needsStop()&&this.stop()})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,i=this._clientOptions.workspaceFolder?this._clientOptions.workspaceFolder.uri.fsPath:this._clientGetRootPath(),s={processId:process.pid,clientInfo:{name:"vscode",version:n.version},rootPath:i||null,rootUri:i?this._c2p.asUri(n.Uri.file(i)):null,capabilities:this.computeClientCapabilities(),initializationOptions:a.func(t)?t():t,trace:r.Trace.toString(this._trace),workspaceFolders:null};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){const t=l.generateUuid(),i=new u.ProgressPart(e,t);return s.workDoneToken=t,this.doInitialize(e,s).then(e=>(i.done(),e),e=>{throw i.cancel(),e})}return this.doInitialize(e,s)}doInitialize(e,t){return e.initialize(t).then(t=>{this._resolvedConnection=e,this._initializeResult=t,this.state=m.Running;let i=void 0;return a.number(t.capabilities.textDocumentSync)?i=t.capabilities.textDocumentSync===r.TextDocumentSyncKind.None?{openClose:!1,change:r.TextDocumentSyncKind.None,save:void 0}:{openClose:!0,change:t.capabilities.textDocumentSync,save:{includeText:!1}}:void 0!==t.capabilities.textDocumentSync&&null!==t.capabilities.textDocumentSync&&(i=t.capabilities.textDocumentSync),this._capabilities=Object.assign({},t.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(e=>this.handleDiagnostics(e)),e.onRequest(r.RegistrationRequest.type,e=>this.handleRegistrationRequest(e)),e.onRequest("client/registerFeature",e=>this.handleRegistrationRequest(e)),e.onRequest(r.UnregistrationRequest.type,e=>this.handleUnregistrationRequest(e)),e.onRequest("client/unregisterFeature",e=>this.handleUnregistrationRequest(e)),e.onRequest(r.ApplyWorkspaceEditRequest.type,e=>this.handleApplyWorkspaceEdit(e)),e.sendNotification(r.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),t}).then(void 0,t=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(t)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(t)):t instanceof r.ResponseError&&t.data&&t.data.retry?n.window.showErrorMessage(t.message,{title:"Retry",id:"retry"}).then(i=>{i&&"retry"===i.id?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(t))}):(t&&t.message&&n.window.showErrorMessage(t.message),this.error("Server initialization failed.",t),this.stop(),this._onReadyCallbacks.reject(t)),t})}_clientGetRootPath(){let e=n.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}stop(){return this._initializeResult=void 0,this._connectionPromise?this.state===m.Stopping&&this._onStop?this._onStop:(this.state=m.Stopping,this.cleanUp(!1),this._onStop=this.resolveConnection().then(e=>e.shutdown().then(()=>{e.exit(),e.dispose(),this.state=m.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0}))):(this.state=m.Stopped,Promise.resolve())}cleanUp(e=!0,t=!0){this._listeners&&(this._listeners.forEach(e=>e.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(e=>e.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let e of this._dynamicFeatures.values())e.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var t,i;const n=this;function r(e){n._fileEvents.push(e),n._fileEventDelayer.trigger(()=>{n.onReady().then(()=>{n.resolveConnection().then(e=>{n.isConnectionActive()&&(n.forceDocumentSync(),e.didChangeWatchedFiles({changes:n._fileEvents})),n._fileEvents=[]})},e=>{n.error("Notify file events failed.",e)})})}const s=null===(t=this.clientOptions.middleware)||void 0===t?void 0:t.workspace;(null===(i=s)||void 0===i?void 0:i.didChangeWatchedFile)?s.didChangeWatchedFile(e,r):r(e)}forceDocumentSync(){this._dynamicFeatures.get(r.DidChangeTextDocumentNotification.type.method).forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=this._p2c.asUri(e.uri),i=this._p2c.asDiagnostics(e.diagnostics),n=this.clientOptions.middleware;n.handleDiagnostics?n.handleDiagnostics(t,i,(e,t)=>this.setDiagnostics(e,t)):this.setDiagnostics(t,i)}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}createConnection(){let e=(e,t,i)=>{this.handleConnectionError(e,t,i)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(i=>function(e,t,i,n){let s=new d,o=r.createProtocolConnection(e,t,s);return o.onError(e=>{i(e[0],e[1],e[2])}),o.onClose(n),{listen:()=>o.listen(),sendRequest:(e,...t)=>o.sendRequest(a.string(e)?e:e.method,...t),onRequest:(e,t)=>o.onRequest(a.string(e)?e:e.method,t),sendNotification:(e,t)=>o.sendNotification(a.string(e)?e:e.method,t),onNotification:(e,t)=>o.onNotification(a.string(e)?e:e.method,t),onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(e,t,i)=>{const n={sendNotification:!1,traceFormat:r.TraceFormat.Text};void 0===i?o.trace(e,t,n):(a.boolean(i),o.trace(e,t,i))},initialize:e=>o.sendRequest(r.InitializeRequest.type,e),shutdown:()=>o.sendRequest(r.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(r.ExitNotification.type),onLogMessage:e=>o.onNotification(r.LogMessageNotification.type,e),onShowMessage:e=>o.onNotification(r.ShowMessageNotification.type,e),onTelemetry:e=>o.onNotification(r.TelemetryEventNotification.type,e),didChangeConfiguration:e=>o.sendNotification(r.DidChangeConfigurationNotification.type,e),didChangeWatchedFiles:e=>o.sendNotification(r.DidChangeWatchedFilesNotification.type,e),didOpenTextDocument:e=>o.sendNotification(r.DidOpenTextDocumentNotification.type,e),didChangeTextDocument:e=>o.sendNotification(r.DidChangeTextDocumentNotification.type,e),didCloseTextDocument:e=>o.sendNotification(r.DidCloseTextDocumentNotification.type,e),didSaveTextDocument:e=>o.sendNotification(r.DidSaveTextDocumentNotification.type,e),onDiagnostics:e=>o.onNotification(r.PublishDiagnosticsNotification.type,e),dispose:()=>o.dispose()}}(i.reader,i.writer,e,t))}handleConnectionClosed(){if(this.state===m.Stopping||this.state===m.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch(e){}let e=f.DoNotRestart;try{e=this._clientOptions.errorHandler.closed()}catch(e){}this._connectionPromise=void 0,this._resolvedConnection=void 0,e===f.DoNotRestart?(this.error("Connection to server got closed. Server will not be restarted."),this.state=m.Stopped,this.cleanUp(!1,!0)):e===f.Restart&&(this.info("Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=m.Initial,this.start())}handleConnectionError(e,t,i){this._clientOptions.errorHandler.error(e,t,i)===h.Shutdown&&(this.error("Connection to server is erroring. Shutting down server."),this.stop())}hookConfigurationChanged(e){n.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let i=n.workspace.getConfiguration(this._id),s=r.Trace.Off,o=r.TraceFormat.Text;if(i){const e=i.get("trace.server","off");"string"==typeof e?s=r.Trace.fromString(e):(s=r.Trace.fromString(i.get("trace.server.verbosity","off")),o=r.TraceFormat.fromString(i.get("trace.server.format","text")))}this._trace=s,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t,i=this._clientOptions.synchronize.fileEvents;i&&(t=a.array(i)?i:[i],t&&this._dynamicFeatures.get(r.DidChangeWatchedFilesNotification.type.method).registerRaw(l.generateUuid(),t))}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),w.is(e)){let t=e.messages;if(Array.isArray(t))for(let i of t)this._method2Message.set(i.method,i),this._dynamicFeatures.set(i.method,e);else this._method2Message.set(t.method,t),this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new V(this)),this.registerFeature(new T(this,this._syncedDocuments)),this.registerFeature(new P(this)),this.registerFeature(new R(this)),this.registerFeature(new D(this)),this.registerFeature(new k(this)),this.registerFeature(new E(this,this._syncedDocuments)),this.registerFeature(new x(this,e=>this.notifyFileEvent(e))),this.registerFeature(new O(this)),this.registerFeature(new _(this)),this.registerFeature(new A(this)),this.registerFeature(new I(this)),this.registerFeature(new L(this)),this.registerFeature(new N(this)),this.registerFeature(new M(this)),this.registerFeature(new j(this)),this.registerFeature(new U(this)),this.registerFeature(new q(this)),this.registerFeature(new $(this)),this.registerFeature(new W(this)),this.registerFeature(new G(this)),this.registerFeature(new z(this)),this.registerFeature(new H(this)),this.registerFeature(new K(this))}fillInitializeParams(e){for(let t of this._features)a.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};C(e,"workspace").applyEdit=!0;let t=C(C(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[r.ResourceOperationKind.Create,r.ResourceOperationKind.Rename,r.ResourceOperationKind.Delete],t.failureHandling=r.FailureHandlingKind.TextOnlyTransactional;let i=C(C(e,"textDocument"),"publishDiagnostics");i.relatedInformation=!0,i.versionSupport=!1,i.tagSupport={valueSet:[r.DiagnosticTag.Unnecessary,r.DiagnosticTag.Deprecated]};for(let t of this._features)t.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let e of this._features)e.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,i)=>{for(let t of e.registrations){const e=this._dynamicFeatures.get(t.method);if(!e)return void i(new Error(`No feature implementation for ${t.method} found. Registration failed.`));const n=t.registerOptions||{};n.documentSelector=n.documentSelector||this._clientOptions.documentSelector;const r={id:t.id,registerOptions:n};e.register(this._method2Message.get(t.method),r)}t()})}handleUnregistrationRequest(e){return new Promise((t,i)=>{for(let t of e.unregisterations){const e=this._dynamicFeatures.get(t.method);if(!e)return void i(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));e.unregister(t.id)}t()})}handleApplyWorkspaceEdit(e){let t=e.edit,i=new Map;n.workspace.textDocuments.forEach(e=>i.set(e.uri.toString(),e));let s=!1;if(t.documentChanges)for(const e of t.documentChanges)if(r.TextDocumentEdit.is(e)&&e.textDocument.version&&e.textDocument.version>=0){let t=i.get(e.textDocument.uri);if(t&&t.version!==e.textDocument.version){s=!0;break}}return s?Promise.resolve({applied:!1}):a.asPromise(n.workspace.applyEdit(this._p2c.asWorkspaceEdit(e.edit)).then(e=>({applied:e})))}logFailedRequest(e,t){t instanceof r.ResponseError&&(t.code===r.ErrorCodes.RequestCancelled||t.code===r.ErrorCodes.ContentModified)||this.error(`Request ${e.method} failed.`,t)}}},function(e,t,i){"use strict";function n(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}Object.defineProperty(t,"__esModule",{value:!0});const r=i(50),s=i(153);t.RequestType=s.RequestType,t.RequestType0=s.RequestType0,t.RequestType1=s.RequestType1,t.RequestType2=s.RequestType2,t.RequestType3=s.RequestType3,t.RequestType4=s.RequestType4,t.RequestType5=s.RequestType5,t.RequestType6=s.RequestType6,t.RequestType7=s.RequestType7,t.RequestType8=s.RequestType8,t.RequestType9=s.RequestType9,t.ResponseError=s.ResponseError,t.ErrorCodes=s.ErrorCodes,t.NotificationType=s.NotificationType,t.NotificationType0=s.NotificationType0,t.NotificationType1=s.NotificationType1,t.NotificationType2=s.NotificationType2,t.NotificationType3=s.NotificationType3,t.NotificationType4=s.NotificationType4,t.NotificationType5=s.NotificationType5,t.NotificationType6=s.NotificationType6,t.NotificationType7=s.NotificationType7,t.NotificationType8=s.NotificationType8,t.NotificationType9=s.NotificationType9;const o=i(94);t.MessageReader=o.MessageReader,t.StreamMessageReader=o.StreamMessageReader,t.IPCMessageReader=o.IPCMessageReader,t.SocketMessageReader=o.SocketMessageReader;const a=i(95);t.MessageWriter=a.MessageWriter,t.StreamMessageWriter=a.StreamMessageWriter,t.IPCMessageWriter=a.IPCMessageWriter,t.SocketMessageWriter=a.SocketMessageWriter;const c=i(59);t.Disposable=c.Disposable,t.Event=c.Event,t.Emitter=c.Emitter;const l=i(154);t.CancellationTokenSource=l.CancellationTokenSource,t.CancellationToken=l.CancellationToken;const u=i(155);var d,h,f,g,p,m,v,y;n(i(156)),n(i(157)),function(e){e.type=new s.NotificationType("$/cancelRequest")}(d||(d={})),function(e){e.type=new s.NotificationType("$/progress")}(h||(h={}));t.ProgressType=class{constructor(){}},t.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}}),function(e){e[e.Off=0]="Off",e[e.Messages=1]="Messages",e[e.Verbose=2]="Verbose"}(f=t.Trace||(t.Trace={})),function(e){e.fromString=function(t){if(!r.string(t))return e.Off;switch(t=t.toLowerCase()){case"off":return e.Off;case"messages":return e.Messages;case"verbose":return e.Verbose;default:return e.Off}},e.toString=function(t){switch(t){case e.Off:return"off";case e.Messages:return"messages";case e.Verbose:return"verbose";default:return"off"}}}(f=t.Trace||(t.Trace={})),function(e){e.Text="text",e.JSON="json"}(t.TraceFormat||(t.TraceFormat={})),function(e){e.fromString=function(t){return"json"===(t=t.toLowerCase())?e.JSON:e.Text}}(g=t.TraceFormat||(t.TraceFormat={})),function(e){e.type=new s.NotificationType("$/setTraceNotification")}(p=t.SetTraceNotification||(t.SetTraceNotification={})),function(e){e.type=new s.NotificationType("$/logTraceNotification")}(m=t.LogTraceNotification||(t.LogTraceNotification={})),function(e){e[e.Closed=1]="Closed",e[e.Disposed=2]="Disposed",e[e.AlreadyListening=3]="AlreadyListening"}(v=t.ConnectionErrors||(t.ConnectionErrors={}));class b extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,b.prototype)}}function C(e,t,i,n){let o=0,a=0,C=0;let w,S,T=void 0,E=Object.create(null),P=void 0,R=Object.create(null),D=new Map,k=new u.LinkedMap,x=Object.create(null),F=Object.create(null),O=f.Off,_=g.Text,A=y.New,I=new c.Emitter,L=new c.Emitter,N=new c.Emitter,M=new c.Emitter,j=new c.Emitter;function U(e){return"req-"+e.toString()}function q(e,t){var i;s.isRequestMessage(t)?e.set(U(t.id),t):s.isResponseMessage(t)?e.set(null===(i=t.id)?"res-unknown-"+(++C).toString():"res-"+i.toString(),t):e.set("not-"+(++a).toString(),t)}function $(e){}function W(){return A===y.Listening}function G(){return A===y.Closed}function z(){return A===y.Disposed}function H(){A!==y.New&&A!==y.Listening||(A=y.Closed,L.fire(void 0))}function V(){w||0===k.size||(w=setImmediate(()=>{w=void 0,function(){if(0===k.size)return;let e=k.shift();try{s.isRequestMessage(e)?function(e){if(z())return;function i(i,n,r){let o={jsonrpc:"2.0",id:e.id};i instanceof s.ResponseError?o.error=i.toJson():o.result=void 0===i?null:i,B(o,n,r),t.write(o)}function n(i,n,r){let s={jsonrpc:"2.0",id:e.id,error:i.toJson()};B(s,n,r),t.write(s)}!function(e){if(O===f.Off||!S)return;if(_===g.Text){let t=void 0;O===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),S.log(`Received request '${e.method} - (${e.id})'.`,t)}else X("receive-request",e)}(e);let o,a,c=E[e.method];c&&(o=c.type,a=c.handler);let u=Date.now();if(a||T){let c=new l.CancellationTokenSource,d=String(e.id);F[d]=c;try{let l;l=void 0===e.params||void 0!==o&&0===o.numberOfParams?a?a(c.token):T(e.method,c.token):r.array(e.params)&&(void 0===o||o.numberOfParams>1)?a?a(...e.params,c.token):T(e.method,...e.params,c.token):a?a(e.params,c.token):T(e.method,e.params,c.token);let h=l;l?h.then?h.then(t=>{delete F[d],i(t,e.method,u)},t=>{delete F[d],t instanceof s.ResponseError?n(t,e.method,u):t&&r.string(t.message)?n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}):(delete F[d],i(l,e.method,u)):(delete F[d],function(i,n,r){void 0===i&&(i=null);let s={jsonrpc:"2.0",id:e.id,result:i};B(s,n,r),t.write(s)}(l,e.method,u))}catch(t){delete F[d],t instanceof s.ResponseError?i(t,e.method,u):t&&r.string(t.message)?n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed with message: ${t.message}`),e.method,u):n(new s.ResponseError(s.ErrorCodes.InternalError,`Request ${e.method} failed unexpectedly without providing any details.`),e.method,u)}}else n(new s.ResponseError(s.ErrorCodes.MethodNotFound,"Unhandled method "+e.method),e.method,u)}(e):s.isNotificationMessage(e)?function(e){if(z())return;let t,n=void 0;if(e.method===d.type.method)t=e=>{let t=e.id,i=F[String(t)];i&&i.cancel()};else{let i=R[e.method];i&&(t=i.handler,n=i.type)}if(t||P)try{!function(e){if(O===f.Off||!S||e.method===m.type.method)return;if(_===g.Text){let t=void 0;O===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),S.log(`Received notification '${e.method}'.`,t)}else X("receive-notification",e)}(e),void 0===e.params||void 0!==n&&0===n.numberOfParams?t?t():P(e.method):r.array(e.params)&&(void 0===n||n.numberOfParams>1)?t?t(...e.params):P(e.method,...e.params):t?t(e.params):P(e.method,e.params)}catch(t){t.message?i.error(`Notification handler '${e.method}' failed with message: ${t.message}`):i.error(`Notification handler '${e.method}' failed unexpectedly.`)}else N.fire(e)}(e):s.isResponseMessage(e)?function(e){if(z())return;if(null===e.id)e.error?i.error("Received response message without id: Error is: \n"+JSON.stringify(e.error,void 0,4)):i.error("Received response message without id. No further error information provided.");else{let t=String(e.id),n=x[t];if(function(e,t){if(O===f.Off||!S)return;if(_===g.Text){let i=void 0;if(O===f.Verbose&&(e.error&&e.error.data?i=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?i=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(i="No result returned.\n\n")),t){let n=e.error?` Request failed: ${e.error.message} (${e.error.code}).`:"";S.log(`Received response '${t.method} - (${e.id})' in ${Date.now()-t.timerStart}ms.${n}`,i)}else S.log(`Received response ${e.id} without active response promise.`,i)}else X("receive-response",e)}(e,n),n){delete x[t];try{if(e.error){let t=e.error;n.reject(new s.ResponseError(t.code,t.message,t.data))}else{if(void 0===e.result)throw new Error("Should never happen.");n.resolve(e.result)}}catch(e){e.message?i.error(`Response handler '${n.method}' failed with message: ${e.message}`):i.error(`Response handler '${n.method}' failed unexpectedly.`)}}}}(e):function(e){if(!e)return void i.error("Received empty message.");i.error("Received message which is neither a response nor a notification message:\n"+JSON.stringify(e,null,4));let t=e;if(r.string(t.id)||r.number(t.id)){let e=String(t.id),i=x[e];i&&i.reject(new Error("The received response has neither a result nor an error property."))}}(e)}finally{V()}}()}))}e.onClose(H),e.onError((function(e){I.fire([e,void 0,void 0])})),t.onClose(H),t.onError((function(e){I.fire(e)}));let K=e=>{try{if(s.isNotificationMessage(e)&&e.method===d.type.method){let i=U(e.params.id),r=k.get(i);if(s.isRequestMessage(r)){let s=n&&n.cancelUndispatched?n.cancelUndispatched(r,$):void 0;if(s&&(void 0!==s.error||void 0!==s.result))return k.delete(i),s.id=r.id,B(s,e.method,Date.now()),void t.write(s)}}q(k,e)}finally{V()}};function B(e,t,i){if(O!==f.Off&&S)if(_===g.Text){let n=void 0;O===f.Verbose&&(e.error&&e.error.data?n=`Error data: ${JSON.stringify(e.error.data,null,4)}\n\n`:e.result?n=`Result: ${JSON.stringify(e.result,null,4)}\n\n`:void 0===e.error&&(n="No result returned.\n\n")),S.log(`Sending response '${t} - (${e.id})'. Processing request took ${Date.now()-i}ms`,n)}else X("send-response",e)}function X(e,t){if(!S||O===f.Off)return;const i={isLSPMessage:!0,type:e,message:t,timestamp:Date.now()};S.log(i)}function J(){if(G())throw new b(v.Closed,"Connection is closed.");if(z())throw new b(v.Disposed,"Connection is disposed.")}function Y(e){return void 0===e?null:e}function Q(e,t){let i,n=e.numberOfParams;switch(n){case 0:i=null;break;case 1:i=Y(t[0]);break;default:i=[];for(let e=0;e<t.length&&e<n;e++)i.push(Y(t[e]));if(t.length<n)for(let e=t.length;e<n;e++)i.push(null)}return i}let Z={sendNotification:(e,...i)=>{let n,s;if(J(),r.string(e))switch(n=e,i.length){case 0:s=null;break;case 1:s=i[0];break;default:s=i}else n=e.method,s=Q(e,i);let o={jsonrpc:"2.0",method:n,params:s};!function(e){if(O!==f.Off&&S)if(_===g.Text){let t=void 0;O===f.Verbose&&(t=e.params?`Params: ${JSON.stringify(e.params,null,4)}\n\n`:"No parameters provided.\n\n"),S.log(`Sending notification '${e.method}'.`,t)}else X("send-notification",e)}(o),t.write(o)},onNotification:(e,t)=>{J(),r.func(e)?P=e:t&&(r.string(e)?R[e]={type:void 0,handler:t}:R[e.method]={type:e,handler:t})},onProgress:(e,t,i)=>{if(D.has(t))throw new Error(`Progress handler for token ${t} already registered`);return D.set(t,i),{dispose:()=>{D.delete(t)}}},sendProgress:(e,t,i)=>{Z.sendNotification(h.type,{token:t,value:i})},onUnhandledProgress:M.event,sendRequest:(e,...i)=>{let n,a;J(),function(){if(!W())throw new Error("Call listen() first.")}();let c=void 0;if(r.string(e))switch(n=e,i.length){case 0:a=null;break;case 1:l.CancellationToken.is(i[0])?(a=null,c=i[0]):a=Y(i[0]);break;default:const e=i.length-1;l.CancellationToken.is(i[e])?(c=i[e],a=2===i.length?Y(i[0]):i.slice(0,e).map(e=>Y(e))):a=i.map(e=>Y(e))}else{n=e.method,a=Q(e,i);let t=e.numberOfParams;c=l.CancellationToken.is(i[t])?i[t]:void 0}let u=o++,h=new Promise((e,i)=>{let r={jsonrpc:"2.0",id:u,method:n,params:a},o={method:n,timerStart:Date.now(),resolve:e,reject:i};!function(e){if(O!==f.Off&&S)if(_===g.Text){let t=void 0;O===f.Verbose&&e.params&&(t=`Params: ${JSON.stringify(e.params,null,4)}\n\n`),S.log(`Sending request '${e.method} - (${e.id})'.`,t)}else X("send-request",e)}(r);try{t.write(r)}catch(e){o.reject(new s.ResponseError(s.ErrorCodes.MessageWriteError,e.message?e.message:"Unknown reason")),o=null}o&&(x[String(u)]=o)});return c&&c.onCancellationRequested(()=>{Z.sendNotification(d.type,{id:u})}),h},onRequest:(e,t)=>{J(),r.func(e)?T=e:t&&(r.string(e)?E[e]={type:void 0,handler:t}:E[e.method]={type:e,handler:t})},trace:(e,t,i)=>{let n=!1,s=g.Text;void 0!==i&&(r.boolean(i)?n=i:(n=i.sendNotification||!1,s=i.traceFormat||g.Text)),O=e,_=s,S=O===f.Off?void 0:t,!n||G()||z()||Z.sendNotification(p.type,{value:f.toString(e)})},onError:I.event,onClose:L.event,onUnhandledNotification:N.event,onDispose:j.event,dispose:()=>{if(z())return;A=y.Disposed,j.fire(void 0);let i=new Error("Connection got disposed.");Object.keys(x).forEach(e=>{x[e].reject(i)}),x=Object.create(null),F=Object.create(null),k=new u.LinkedMap,r.func(t.dispose)&&t.dispose(),r.func(e.dispose)&&e.dispose()},listen:()=>{J(),function(){if(W())throw new b(v.AlreadyListening,"Connection is already listening")}(),A=y.Listening,e.listen(K)},inspect:()=>{console.log("inspect")}};return Z.onNotification(m.type,e=>{O!==f.Off&&S&&S.log(e.message,O===f.Verbose?e.verbose:void 0)}),Z.onNotification(h.type,e=>{const t=D.get(e.token);t?t(e.value):M.fire(e)}),Z}t.ConnectionError=b,function(e){e.is=function(e){let t=e;return t&&r.func(t.cancelUndispatched)}}(t.ConnectionStrategy||(t.ConnectionStrategy={})),function(e){e[e.New=1]="New",e[e.Listening=2]="Listening",e[e.Closed=3]="Closed",e[e.Disposed=4]="Disposed"}(y||(y={})),t.createMessageConnection=function(e,i,n,r){var s;return n||(n=t.NullLogger),C(void 0!==(s=e).listen&&void 0===s.read?e:new o.StreamMessageReader(e),function(e){return void 0!==e.write&&void 0===e.end}(i)?i:new a.StreamMessageWriter(i),n,r)}},function(e,t){const i=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:i,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t){const i="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=i},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>n(e,t,i)>0},function(e,t,i){const n=Symbol("SemVer ANY");class r{static get ANY(){return n}constructor(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?s[o.COMPARATORLOOSE]:s[o.COMPARATOR],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new l(i[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}return a(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new u(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new u(this.value,t).test(e.semver);const i=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),c=a(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),l=a(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return i||n||s&&o||c||l}}e.exports=r;const{re:s,t:o}=i(16),a=i(46),c=i(25),l=i(9),u=i(12)},function(e,t,i){const n=i(12);e.exports=(e,t,i)=>{try{t=new n(t,i)}catch(e){return!1}return t.test(e)}},function(e,t){e.exports=require("url")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.waitFor=t.resolvedPromise=void 0,t.resolvedPromise=Promise.resolve(!0),t.waitFor=function(e,t=100,i=1e4,r){return n(this,void 0,void 0,(function*(){let n=i;for(;n>0&&(!r||!r.isCancellationRequested);){const i=yield e();if(i)return i;yield new Promise(e=>setTimeout(e,t)),n-=t}}))}},function(e,t){const i=/^[0-9]+$/,n=(e,t)=>{const n=i.test(e),r=i.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>0===n(e,t,i)},function(e,t,i){const n=i(9);e.exports=(e,t,i)=>{const r=new n(e,i),s=new n(t,i);return r.compare(s)||r.compareBuild(s)}},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>n(e,t,i)<0},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>n(e,t,i)>=0},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>n(e,t,i)<=0},function(e,t,i){const n=i(9),r=i(27),{ANY:s}=r,o=i(12),a=i(28),c=i(26),l=i(34),u=i(36),d=i(35);e.exports=(e,t,i,h)=>{let f,g,p,m,v;switch(e=new n(e,h),t=new o(t,h),i){case">":f=c,g=u,p=l,m=">",v=">=";break;case"<":f=l,g=d,p=c,m="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let i=0;i<t.set.length;++i){const n=t.set[i];let o=null,a=null;if(n.forEach(e=>{e.semver===s&&(e=new r(">=0.0.0")),o=o||e,a=a||e,f(e.semver,o.semver,h)?o=e:p(e.semver,a.semver,h)&&(a=e)}),o.operator===m||o.operator===v)return!1;if((!a.operator||a.operator===m)&&g(e,a.semver))return!1;if(a.operator===v&&p(e,a.semver))return!1}return!0}},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("https")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSpawn=void 0;const n=i(47);t.safeSpawn=function(e,t,i,r){const s=Object.assign({},process.env,r.toolEnv,r.envOverrides),o=i.map(e=>`"${e.replace(/"/g,'\\"')}"`);return n.spawn(`"${t}"`,o,{cwd:e,env:s,shell:!0})}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StdIOService=void 0;const r=i(5),s=i(40);t.StdIOService=class{constructor(e,t,i=!1,n=!1,r=!1,s){this.logger=e,this.maxLogLineLength=t,this.messagesWrappedInBrackets=i,this.treatHandlingErrorsAsUnhandledMessages=n,this.treatCarriageReturnsAsNewlines=r,this.logFile=s,this.disposables=[],this.additionalPidsToTerminate=[],this.nextRequestID=1,this.activeRequests={},this.messageBuffers=[],this.requestErrorSubscriptions=[],this.processExited=!1}createProcess(e,t,i,n){this.logTraffic(`Spawning ${t} with args ${JSON.stringify(i)}`),e&&this.logTraffic("..  in "+e),(n.envOverrides||n.toolEnv)&&this.logTraffic("..  with "+JSON.stringify(n)),this.process=s.safeSpawn(e,t,i,n),this.logTraffic("    PID: "+process.pid),this.process.stdout.on("data",e=>this.handleStdOut(e)),this.process.stderr.on("data",e=>this.handleStdErr(e)),this.process.on("exit",(e,t)=>this.handleExit(e,t)),this.process.on("error",e=>this.handleError(e))}normalizeNewlines(e){const t=this.treatCarriageReturnsAsNewlines?Buffer.from(e.toString().replace(/\r/g,"\n")):e;return Buffer.from(t)}handleStdOut(e){e=this.normalizeNewlines(e),this.messageBuffers.push(e),e.indexOf("\n")>=0&&this.processMessageBuffer()}handleStdErr(e){this.logTraffic(""+e.toString(),!0)}handleExit(e,t){this.logTraffic(`Process terminated! ${e}, ${t}`),this.processExited=!0}handleError(e){this.logTraffic("Process errored! "+e)}buildRequest(e,t,i){return{id:e.toString(),method:t,params:i}}sendRequest(e,t){const i=this.nextRequestID++;return new Promise((n,r)=>{this.activeRequests[i.toString()]=[n,r,e];const s=this.buildRequest(i,e,t),o=this.messagesWrappedInBrackets?"["+JSON.stringify(s)+"]\r\n":JSON.stringify(s)+"\r\n";this.sendMessage(o)})}cancelAllRequests(){Object.keys(this.activeRequests).forEach(e=>this.activeRequests[e]="CANCELLED")}sendMessage(e){this.logTraffic("==> "+e),this.process?this.process.stdin.write(e):this.logTraffic("  (not sent: no process)")}processMessageBuffer(){let e=Buffer.concat(this.messageBuffers);this.messageBuffers=[];const t=e.lastIndexOf("\n");if(t!==e.length-1){const i=e.slice(t+1);e=e.slice(0,t),this.messageBuffers.push(i)}e.toString().split("\n").filter(e=>""!==e.trim()).forEach(e=>this.handleMessage(e+"\n"))}processUnhandledMessage(e){return n(this,void 0,void 0,(function*(){}))}handleMessage(e){return n(this,void 0,void 0,(function*(){if(this.logTraffic(`<== ${e.trimRight()}\r\n`),!this.shouldHandleMessage(e.trim()))return this.processUnhandledMessage(e);let t;try{t=JSON.parse(e),this.messagesWrappedInBrackets&&t&&1===t.length&&(t=t[0])}catch(t){if(this.treatHandlingErrorsAsUnhandledMessages)return this.logger.error(`Unexpected non-JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),this.processUnhandledMessage(e);throw t}try{t&&this.isNotification(t)?this.handleNotification(t).catch(e=>this.logger.error(e)):t&&this.isRequest(t)?this.processServerRequest(t).catch(e=>this.logger.error(e)):t&&this.isResponse(t)?this.handleResponse(t).catch(e=>this.logger.error(e)):(this.logger.error("Unexpected JSON message, assuming normal stdout : "+e),this.processUnhandledMessage(e).catch(e=>this.logger.error(e)))}catch(t){if(!this.treatHandlingErrorsAsUnhandledMessages)throw t;this.logger.error(`Failed to handle JSON message, assuming normal stdout (${t})\n\n${t.stack}\n\n${e}`),this.processUnhandledMessage(e).catch(e=>this.logger.error(e))}}))}handleRequest(e,t){return n(this,void 0,void 0,(function*(){}))}isNotification(e){return!!e.event}isRequest(e){return!!e.method&&!!e.id}isResponse(e){return!!e.id}processServerRequest(e){return n(this,void 0,void 0,(function*(){let t,i;try{t=yield this.handleRequest(e.method,e.params)}catch(e){i=e}const n={id:e.id,result:t,error:i},r=this.messagesWrappedInBrackets?"["+JSON.stringify(n)+"]\r\n":JSON.stringify(n)+"\r\n";this.sendMessage(r)}))}handleResponse(e){return n(this,void 0,void 0,(function*(){const t=this.activeRequests[e.id];if(delete this.activeRequests[e.id],"CANCELLED"===t)return void this.logger.info(`Ignoring response to ${e.id} because it was cancelled:\n\n${JSON.stringify(e,void 0,4)}`);if(!t)return void this.logger.error(`Unable to handle response with ID ${e.id} because its handler is not available`);const i=t[2],n=e.error;n&&"SERVER_ERROR"===n.code&&(n.method=i,this.notify(this.requestErrorSubscriptions,n).catch(e=>this.logger.error(e))),n?yield t[1](n):yield t[0](e.result)}))}notify(e,t){return Promise.all(e.slice().map(e=>e(t))).catch(e=>console.error(e))}subscribe(e,t){e.push(t);const i={dispose:()=>{let n=e.indexOf(t);n>=0&&e.splice(n,1),n=this.disposables.indexOf(i),n>=0&&this.disposables.splice(n,1)}};return this.disposables.push(i),i}registerForRequestError(e){return this.subscribe(this.requestErrorSubscriptions,e)}logTraffic(e,t=!1){t?this.logger.error(e):this.logger.info(e),this.openLogFile!==this.logFile&&this.logStream&&(this.logStream.end(),this.logStream=void 0,this.openLogFile=void 0),this.logFile&&(this.logStream||(this.logStream=r.createWriteStream(this.logFile),this.openLogFile=this.logFile),this.logStream.write(`[${(new Date).toLocaleTimeString()}]: `),this.maxLogLineLength&&e.length>this.maxLogLineLength?this.logStream.write(e.substring(0,this.maxLogLineLength)+"â€¦\r\n"):this.logStream.write(e.trim()+"\r\n"))}dispose(){for(const e of this.additionalPidsToTerminate)try{process.kill(e)}catch(e){this.logger.error({message:e.toString()})}this.additionalPidsToTerminate.length=0;try{this.processExited||!this.process||this.process.killed||this.process.kill()}catch(e){}this.process=void 0,this.disposables.forEach(e=>n(this,void 0,void 0,(function*(){try{return yield e.dispose()}catch(e){this.logger.error({message:e.toString()})}}))),this.disposables.length=0,this.logFile=void 0,this.logStream&&(this.logStream.end(),this.logStream=void 0,this.openLogFile=void 0)}}},,,function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deactivate=t.activate=t.ringLog=t.SERVICE_CONTEXT_PREFIX=t.SERVICE_EXTENSION_CONTEXT_PREFIX=t.FLUTTER_SUPPORTS_ATTACH=void 0;const r=i(2),s=i(0),o=i(66),a=i(55),c=i(4),l=i(8),u=i(139),d=i(13),h=i(140),f=i(141),g=i(3),p=i(1),m=i(142),v=i(19),y=i(143),b=i(6),C=i(145),w=i(48),S=i(151),T=i(188),E=i(189),P=i(190),R=i(191),D=i(193),k=i(194),x=i(195),F=i(196),O=i(197),_=i(198),A=i(199),I=i(200),L=i(99),N=i(206),M=i(100),j=i(207),U=i(119),q=i(208),$=i(121),W=i(209),G=i(210),z=i(123),H=i(215),V=i(216),K=i(10),B=i(125),X=i(217),J=i(220),Y=i(222),Q=i(223),Z=i(225),ee=i(226),te=i(227),ie=i(228),ne=i(230),re=i(231),se=i(232),oe=i(233),ae=i(234),ce=i(235),le=i(102),ue=i(236),de=i(237),he=i(238),fe=i(243),ge=i(244),pe=i(245),me=i(246),ve=i(247),ye=i(248),be=i(249),Ce=i(250),we=i(251),Se=i(253),Te=i(255),Ee=i(256),Pe=i(257),Re=i(101),De=i(258),ke=i(259),xe=i(260),Fe=i(261),Oe=i(262),_e=i(263),Ae=i(264),Ie=i(92),Le=i(265),Ne=i(7),Me=i(122),je=i(15),Ue=i(266),qe=i(129),$e={language:"dart",scheme:"file"},We={language:"html",scheme:"file"};t.FLUTTER_SUPPORTS_ATTACH="dart-code:flutterSupportsAttach";let Ge,ze,He;t.SERVICE_EXTENSION_CONTEXT_PREFIX="dart-code:serviceExtension.",t.SERVICE_CONTEXT_PREFIX="dart-code:service.";const Ve=o.DartCapabilities.empty,Ke=a.FlutterCapabilities.empty;let Be,Xe,Je,Ye=[];const Qe=[],Ze=new d.EmittingLogger;function et(e,t){e&&Qe.push(d.captureLogs(Ze,e,Me.getLogHeader(),K.config.maxLogLineLength,[t]))}function tt(e,t){if(Me.clearLogHeader(),Me.addToLogHeader(()=>"!! PLEASE REVIEW THIS LOG FOR SENSITIVE INFORMATION BEFORE SHARING !!"),Me.addToLogHeader(()=>""),Me.addToLogHeader(()=>"Dart Code extension: "+v.extensionVersion),Me.addToLogHeader(()=>{const e=s.extensions.getExtension(c.flutterExtensionIdentifier);return`Flutter extension: ${e.packageJSON.version} (${e.isActive?"":"not "}activated)`}),Me.addToLogHeader(()=>""),Me.addToLogHeader(()=>"App: "+s.env.appName),s.env.remoteName&&Me.addToLogHeader(()=>"Remote: "+s.env.remoteName),Me.addToLogHeader(()=>"Version: "+s.version),Me.addToLogHeader(()=>"Platform: "+c.platformDisplayName),t){Me.addToLogHeader(()=>""),Me.addToLogHeader(()=>"Workspace type: "+t.workspaceTypeDescription),Me.addToLogHeader(()=>"Analyzer type: "+(t.config.useLsp?"LSP":"DAS")),Me.addToLogHeader(()=>"Multi-root?: "+(s.workspace.workspaceFolders&&s.workspace.workspaceFolders.length>1));const e=t.sdks;Me.addToLogHeader(()=>""),Me.addToLogHeader(()=>`Dart SDK:\n    Loc: ${e.dart}\n    Ver: ${e.dartVersion}`),Me.addToLogHeader(()=>`Flutter SDK:\n    Loc: ${e.flutter}\n    Ver: ${e.flutterVersion}`)}Me.addToLogHeader(()=>""),Me.addToLogHeader(()=>"HTTP_PROXY: "+process.env.HTTP_PROXY),Me.addToLogHeader(()=>"NO_PROXY: "+process.env.NO_PROXY),null==e||e.info(Me.getLogHeader())}function it(){Ye=b.getDartWorkspaceFolders().map(e=>p.fsPath(e.uri));const e=[];if(c.isWin){const t=t=>{if(!t||!r.isAbsolute(t))return;const i=Ye.find(e=>p.isWithinPath(t,e));i&&(Ze.info(`Excluding folder ${t} from analysis roots as it is a child of analysis root ${i} and may cause performance issues.`),e.push(t))};t(process.env.PUB_CACHE),t(process.env.APPDATA),t(process.env.LOCALAPPDATA)}b.getDartWorkspaceFolders().forEach(t=>{const i=K.config.for(t.uri).analysisExcludedFolders,n=p.fsPath(t.uri);i&&Array.isArray(i)&&i.forEach(t=>{r.isAbsolute(t)||(t=r.join(n,t)),e.push(t)})}),Ge.client.analysisSetAnalysisRoots({excluded:e,included:Ye})}function nt(){var e,t;return"CONF-"+K.config.sdkPath+(null===(e=K.config.sdkPaths)||void 0===e?void 0:e.length)+K.config.analyzerPath+K.config.analyzerDiagnosticsPort+K.config.analyzerVmServicePort+K.config.analyzerInstrumentationLogFile+K.config.extensionLogFile+K.config.analyzerAdditionalArgs+K.config.flutterSdkPath+(null===(t=K.config.flutterSdkPaths)||void 0===t?void 0:t.length)+K.config.flutterSelectDeviceWhenConnected+K.config.closingLabels+K.config.analyzeAngularTemplates+K.config.analysisServerFolding+K.config.showMainCodeLens+K.config.showTestCodeLens+K.config.previewBuildRunnerTasks+K.config.updateImportsOnRename+K.config.previewBazelWorkspaceCustomScripts+K.config.flutterOutline+K.config.triggerSignatureHelpAutomatically+K.config.flutterAdbConnectOnChromeOs}function rt(e=!1){return n(this,void 0,void 0,(function*(){st(!1),yield Ge.dispose(),s.commands.executeCommand("setContext",t.FLUTTER_SUPPORTS_ATTACH,!1),e||(s.commands.executeCommand("setContext",c.HAS_LAST_DEBUG_CONFIG,!1),s.commands.executeCommand("setContext",c.HAS_LAST_TEST_DEBUG_CONFIG,!1),yield Be.logExtensionShutdown(),Qe&&(yield Promise.all(Qe.map(e=>e.dispose())),Qe.length=0))}))}function st(e,t){s.commands.executeCommand("setContext","dart-code:dartProjectLoaded",e),s.commands.executeCommand("setContext","dart-code:anyFlutterProjectLoaded",e&&t&&t.hasAnyFlutterProjects),s.commands.executeCommand("setContext","dart-code:flutterMobileProjectLoaded",e&&t&&t.hasAnyFlutterMobileProjects),s.commands.executeCommand("setContext","dart-code:WebProjectLoaded",e&&t&&t.hasAnyWebProjects)}t.ringLog=new d.RingLog(200),t.activate=function e(i,o=!1){return n(this,void 0,void 0,(function*(){o||(v.isDevExtension&&d.logToConsole(Ze),Ze.onLog(e=>t.ringLog.log(e.toLine(500)))),s.commands.executeCommand("setContext",c.IS_RUNNING_LOCALLY_CONTEXT,b.isRunningLocally),tt(),et(Me.getExtensionLogPath(),l.LogCategory.General);const Qe=C.Context.for(i),ot=new u.WebClient(v.extensionVersion);Ne.logTime("Code called activate"),i.subscriptions.push(s.commands.registerCommand("_dart.reloadExtension",t=>n(this,void 0,void 0,(function*(){Ze.info("Performing silent extension reload..."),yield rt(!0);const t=i.subscriptions.slice();i.subscriptions.length=0;for(const e of t)try{e.dispose()}catch(e){Ze.error(e)}yield e(i,!0),Ze.info("Done!")})))),Xe=K.config.showTodos,Je=nt();const at=new Date;Ne.logTime();const ct=new Ie.SdkUtils(Ze),lt=!(!K.config.previewLsp&&!process.env.DART_CODE_FORCE_LSP),ut=yield ct.scanWorkspace(lt);if(Ne.logTime("initWorkspace"),tt(Ze,ut),et(K.config.analyzerLogFile,l.LogCategory.Analyzer),et(K.config.flutterDaemonLogFile,l.LogCategory.FlutterDaemon),et(K.config.devToolsLogFile,l.LogCategory.DevTools),Be=new R.Analytics(Ze,ut),!ut.sdks.dart||ut.hasAnyFlutterProjects&&!ut.sdks.flutter)return ct.handleMissingSdks(i,Be,ut);const dt=ut,ht=dt.sdks;ht.flutterVersion&&(Ke.version=ht.flutterVersion,Be.flutterSdkVersion=ht.flutterVersion),s.commands.executeCommand("setContext",c.IS_LSP_CONTEXT,dt.config.useLsp),ht.dartVersion&&(Ve.version=ht.dartVersion,Be.sdkVersion=ht.dartVersion,Ae.checkForStandardDartSdkUpdates(Ze,dt),i.subscriptions.push(new _e.StatusBarVersionTracker(dt,lt))),s.commands.executeCommand("setContext",c.PUB_OUTDATED_SUPPORTED_CONTEXT,Ve.supportsPubOutdated);const ft=new Date;Ge=lt?new S.LspAnalyzer(Ze,ht,Ve,dt):new w.DasAnalyzer(Ze,Be,ht,Ve,dt);const gt=lt?Ge:void 0,pt=lt?void 0:Ge,mt=pt?pt.client:void 0,vt=mt?void 0:Ge.client;let yt;i.subscriptions.push(Ge),Ge.onReady.then(()=>{const e=new Date;Be.logAnalyzerStartupTime(e.getTime()-ft.getTime())});const bt=Ge.onAnalysisStatusChange.listen(e=>{if(e.isAnalyzing&&!yt&&(yt=new Date),!e.isAnalyzing&&yt){const e=new Date;Be.logAnalyzerFirstAnalysisTime(e.getTime()-yt.getTime()),bt.dispose()}});vt&&i.subscriptions.push(new se.LspClosingLabelsDecorations(vt));const Ct=lt||!mt?void 0:new ce.DartCompletionItemProvider(Ze,mt),wt=lt||!mt?void 0:new ve.DartReferenceProvider(mt),St=[$e];K.config.analyzeAngularTemplates&&St.push(We);for(const e of g.uniq(K.config.additionalAnalyzerFileExtensions))"dart"===e||K.config.analyzeAngularTemplates&&("htm"===e||"html"===e)||St.push({scheme:"file",pattern:"**/*."+e});const Tt=new Re.RankingCodeActionProvider,Et=".(${'\"/\\".split("");if(!lt&&mt){i.subscriptions.push(s.languages.registerHoverProvider(St,new ge.DartHoverProvider(Ze,mt)));const e=new he.DartFormattingEditProvider(Ze,mt,Qe);i.subscriptions.push(e),e.registerDocumentFormatter(St),e.registerTypingFormatter($e,"}",";")}let Pt;if(Ct&&i.subscriptions.push(s.languages.registerCompletionItemProvider(St,Ct,...Et)),wt&&(i.subscriptions.push(s.languages.registerDefinitionProvider(St,wt)),i.subscriptions.push(s.languages.registerReferenceProvider(St,wt))),!lt&&mt&&pt){if(i.subscriptions.push(s.languages.registerDocumentHighlightProvider(St,new fe.DartDocumentHighlightProvider(pt.fileTracker))),Tt.registerProvider(new ae.AssistCodeActionProvider(Ze,St,mt)),Tt.registerProvider(new Te.FixCodeActionProvider(Ze,St,mt)),Tt.registerProvider(new De.RefactorCodeActionProvider(St,mt)),Pt=new ye.DartRenameProvider(mt),i.subscriptions.push(s.languages.registerRenameProvider(St,Pt)),i.subscriptions.push(s.languages.registerCodeActionsProvider($e,new xe.SourceCodeActionProvider,xe.SourceCodeActionProvider.metadata)),i.subscriptions.push(s.languages.registerImplementationProvider($e,new pe.DartImplementationProvider(pt))),K.config.showMainCodeLens){const e=new F.MainCodeLensProvider(Ze,pt);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}if(K.config.showTestCodeLens){const e=new _.TestCodeLensProvider(Ze,pt);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}if(K.config.showDartPadSampleCodeLens&&ht.flutter){const e=new k.FlutterDartPadSamplesCodeLensProvider(Ze,pt,ht);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}}if(lt&&vt&&gt){if(K.config.showMainCodeLens){const e=new O.LspMainCodeLensProvider(Ze,gt);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}if(K.config.showTestCodeLens){const e=new A.LspTestCodeLensProvider(Ze,gt);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}if(K.config.showDartPadSampleCodeLens&&ht.flutter){const e=new x.LspFlutterDartPadSamplesCodeLensProvider(Ze,gt,ht);i.subscriptions.push(e),i.subscriptions.push(s.languages.registerCodeLensProvider($e,e))}}if(Tt.registerProvider(new Ee.IgnoreLintCodeActionProvider(St)),i.subscriptions.push(s.languages.registerCodeActionsProvider(St,Tt,Tt.metadata)),K.config.previewBuildRunnerTasks){const e=new Fe.PubBuildRunnerTaskProvider(ht);i.subscriptions.push(s.tasks.registerTaskProvider(e.type,e))}if(i.subscriptions.push(s.languages.registerCompletionItemProvider($e,new ke.SnippetCompletionItemProvider("snippets/dart.json",e=>!0))),i.subscriptions.push(s.languages.registerCompletionItemProvider($e,new ke.SnippetCompletionItemProvider("snippets/flutter.json",e=>Ne.isInsideFlutterProject(e)))),i.subscriptions.push(s.languages.setLanguageConfiguration($e.language,new me.DartLanguageConfiguration)),vt&&new re.LspAnalyzerStatusReporter(Ge),mt&&new T.AnalyzerStatusReporter(Ze,mt,dt,Be),i.subscriptions.push(new P.FileChangeWarnings),!lt&&mt){const e=s.languages.createDiagnosticCollection("dart");i.subscriptions.push(e);new le.DartDiagnosticProvider(mt,e);const t=mt.registerForServerConnected(e=>{t.dispose(),s.workspace.workspaceFolders&&it();let n=!1;const r=e=>{n||"dart"!==e.languageId||"file"!==e.uri.scheme||0!==Ye.length||(n=!0,s.window.showWarningMessage("For full Dart language support, please open a folder containing your Dart files instead of individual loose files"))};i.subscriptions.push(s.workspace.onDidOpenTextDocument(e=>r(e))),s.window.visibleTextEditors.forEach(e=>r(e.document))});i.subscriptions.push(new E.FileChangeHandler(mt))}dt.hasAnyFlutterMobileProjects&&ht.flutter&&(ze=new te.FlutterDaemon(Ze,dt),He=new m.FlutterDeviceManager(Ze,ze,K.config),i.subscriptions.push(He),i.subscriptions.push(ze),ee.setUpDaemonMessageHandler(Ze,i,ze),i.subscriptions.push(s.commands.registerCommand("flutter.selectDevice",He.showDevicePicker,He)),i.subscriptions.push(s.commands.registerCommand("flutter.launchEmulator",He.promptForAndLaunchEmulator,He))),Ne.logTime("All other stuff before debugger..");const Rt=new h.PubApi(ot),Dt=new Oe.PubGlobal(Ze,Qe,ht,Rt),kt=new Se.DebugConfigProvider(Ze,dt,Be,Dt,ze,He,Ve,Ke);if(i.subscriptions.push(s.debug.registerDebugConfigurationProvider("dart",kt)),i.subscriptions.push(s.debug.registerDebugAdapterDescriptorFactory("dart",new we.DartDebugAdapterDescriptorFactory(i))),i.subscriptions.push(s.debug.registerDebugConfigurationProvider("dart",new Se.InitialLaunchJsonDebugConfigProvider,s.DebugConfigurationProviderTriggerKind.Initial)),i.subscriptions.push(s.debug.registerDebugConfigurationProvider("dart",new Se.DynamicDebugConfigProvider,s.DebugConfigurationProviderTriggerKind.Dynamic)),K.config.flutterGutterIcons&&i.subscriptions.push(new X.FlutterColorDecorations(Ze,r.join(i.globalStoragePath,"flutterColors"))),!lt&&mt&&pt){K.config.previewFlutterUiGuides&&i.subscriptions.push(new Q.FlutterUiGuideDecorationsDas(pt)),K.config.flutterGutterIcons&&i.subscriptions.push(new J.FlutterIconDecorationsDas(Ze,pt));const e=mt.registerForServerConnected(t=>n(this,void 0,void 0,(function*(){e.dispose(),i.subscriptions.push(new G.RefactorCommands(Ze,i,mt)),mt.capabilities.supportsClosingLabels&&K.config.closingLabels&&i.subscriptions.push(new B.ClosingLabelsDecorations(mt)),mt.capabilities.supportsGetDeclerations?i.subscriptions.push(s.languages.registerWorkspaceSymbolProvider(new Ce.DartWorkspaceSymbolProvider(Ze,mt))):i.subscriptions.push(s.languages.registerWorkspaceSymbolProvider(new Pe.LegacyDartWorkspaceSymbolProvider(Ze,mt))),mt.capabilities.supportsCustomFolding&&K.config.analysisServerFolding&&i.subscriptions.push(s.languages.registerFoldingRangeProvider(St,new de.DartFoldingProvider(pt))),mt.capabilities.supportsGetSignature&&i.subscriptions.push(s.languages.registerSignatureHelpProvider($e,new be.DartSignatureHelpProvider(mt),...K.config.triggerSignatureHelpAutomatically?["(",","]:[]));const t=new ue.DartDocumentSymbolProvider(Ze,pt.fileTracker);St.forEach(e=>{i.subscriptions.push(s.languages.registerDocumentSymbolProvider(e,t))}),mt.capabilities.supportsAvailableSuggestions&&K.config.autoImportCompletions&&(yield mt.completionSetSubscriptions({subscriptions:["AVAILABLE_SUGGESTION_SETS"]}))})))}else lt&&vt&&gt&&(K.config.previewFlutterUiGuides&&i.subscriptions.push(new Z.FlutterUiGuideDecorationsLsp(gt)),K.config.flutterGutterIcons&&i.subscriptions.push(new Y.FlutterIconDecorationsLsp(Ze,gt)));i.subscriptions.push(s.workspace.onDidChangeConfiguration(()=>function(e){const t=K.config.showTodos,i=Xe!==t;Xe=t;const n=nt(),r=Je!==n;Je=n,i&&Ge instanceof w.DasAnalyzer&&Ge.client.analysisReanalyze();r&&Ne.promptToReloadExtension()}()));new I.AnalyzerCommands(i,Ze,Ge,Be);const xt=new z.SdkCommands(Ze,i,dt,ct,Dt,Ke,He),Ft=new L.DebugCommands(Ze,Qe,dt,Be,Dt);i.subscriptions.push(new ne.HotReloadOnSaveHandler(Ft,Ke)),i.subscriptions.push(s.window.registerUriHandler(new y.DartUriHandler(Ke))),i.subscriptions.push(new $.LoggingCommands(Ze,i.logPath)),i.subscriptions.push(new W.OpenInOtherEditorCommands(Ze,ht)),pt&&i.subscriptions.push(new H.DasTestCommands(Ze,dt,pt.fileTracker)),gt&&i.subscriptions.push(new H.LspTestCommands(Ze,dt,gt.fileTracker)),vt&&gt&&i.subscriptions.push(new oe.LspGoToSuperCommand(gt)),i.subscriptions.push(new N.EditCommands),mt&&pt?(i.subscriptions.push(new M.DasEditCommands(Ze,i,mt)),i.subscriptions.push(new V.TypeHierarchyCommand(Ze,mt)),i.subscriptions.push(new q.GoToSuperCommand(pt))):vt&&gt&&i.subscriptions.push(new j.LspEditCommands(gt));const Ot=new Ue.DartPackagesProvider(Ze),_t=s.window.createTreeView("dartPackages",{treeDataProvider:Ot});i.subscriptions.push(Ot,_t);const At=new qe.TestResultsProvider(Ze),It=s.window.createTreeView("dartTestTree",{treeDataProvider:At});let Lt;if(i.subscriptions.push(At,It,At.onDidStartTests(e=>{K.config.openTestViewOnStart&&It.reveal(e)}),At.onFirstFailure(e=>{K.config.openTestViewOnFailure&&It.reveal(e)}),It.onDidChangeSelection(e=>{At.setSelectedNodes(e.selection&&1===e.selection.length?e.selection[0]:void 0)})),K.config.flutterOutline){Lt=pt?new ie.DasFlutterOutlineProvider(pt):new ie.LspFlutterOutlineProvider(gt);const e=s.window.createTreeView("dartFlutterOutline",{treeDataProvider:Lt,showCollapseAll:!0});e.onDidChangeSelection(e=>n(this,void 0,void 0,(function*(){yield Lt.setContexts(e.selection)}))),i.subscriptions.push(s.window.onDidChangeTextEditorSelection(t=>{if(t.selections&&t.selections.length){const i=Lt.getNodeAt(t.textEditor.document.uri,t.selections[0].start);i&&e.visible&&e.reveal(i,{select:!0,focus:!1,expand:!0})}})),i.subscriptions.push(e),i.subscriptions.push(Lt);new U.FlutterOutlineCommands(e,i)}if(i.subscriptions.push(s.commands.registerCommand("dart.package.openFile",e=>{e&&s.workspace.openTextDocument(e).then(e=>{s.window.showTextDocument(e,{preview:!0})},e=>Ze.error(e))})),s.workspace.workspaceFolders&&s.workspace.workspaceFolders.length)for(const e of s.workspace.workspaceFolders)if(b.warnIfPathCaseMismatch(Ze,p.fsPath(e.uri),"the open workspace folder","re-open the folder using the File Open dialog"))break;function Nt(){dt.config.disableAutomaticPackageGet||xt.fetchPackagesOrPrompt(void 0,{alwaysPrompt:!0})}if(o||Le.showUserPrompts(Ze,Qe,ot,dt),st(!0,dt),s.commands.executeCommand("setContext","dart-code:dartPlatformName",c.dartPlatformName),o||Nt(),dt.shouldLoadFlutterExtension){const e=s.extensions.getExtension(c.flutterExtensionIdentifier);e&&(Ze.info(`Activating Flutter extension for ${dt.workspaceTypeDescription} project...`),e.activate().then(()=>tt(Ze,ut)))}const Mt=new Date;return o?Be.logExtensionRestart(Mt.getTime()-at.getTime()):Be.logExtensionStartup(Mt.getTime()-at.getTime()),i.subscriptions.push(s.workspace.onDidChangeWorkspaceFolders(e=>n(this,void 0,void 0,(function*(){const e=yield ct.scanWorkspace(lt);e.hasAnyFlutterProjects===dt.hasAnyFlutterProjects&&e.hasProjectsInFuchsiaTree===dt.hasProjectsInFuchsiaTree?(Ot.refresh(),it(),Nt()):Ne.promptToReloadExtension()})))),Object.assign(Object.assign({},new D.DartExtensionApi),{[f.internalApiSymbol]:{analyzer:Ge,analyzerCapabilities:mt&&mt.capabilities,cancelAllAnalysisRequests:()=>mt&&mt.cancelAllRequests(),completionItemProvider:Ct,context:Qe,currentAnalysis:()=>Ge.onCurrentAnalysisComplete,daemonCapabilities:ze?ze.capabilities:a.DaemonCapabilities.empty,dartCapabilities:Ve,debugCommands:Ft,debugProvider:kt,debugSessions:L.debugSessions,envUtils:b.envUtils,fileTracker:pt?pt.fileTracker:gt?gt.fileTracker:void 0,flutterCapabilities:Ke,flutterOutlineTreeProvider:Lt,get cursorIsInTest(){return H.cursorIsInTest},get isInImplementationFileThatCanHaveTest(){return H.isInImplementationFileThatCanHaveTest},get isInTestFileThatHasImplementation(){return H.isInTestFileThatHasImplementation},getLogHeader:Me.getLogHeader,initialAnalysis:Ge.onInitialAnalysis,isLsp:lt,logger:Ze,nextAnalysis:()=>Ge.onNextAnalysisComplete,packagesTreeProvider:Ot,pubGlobal:Dt,renameProvider:Pt,safeToolSpawn:je.safeToolSpawn,testTreeProvider:At,webClient:ot,workspaceContext:dt}})}))},t.deactivate=rt},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>0!==n(e,t,i)},function(e,t,i){const n=i(32),r=i(45),s=i(26),o=i(35),a=i(34),c=i(36);e.exports=(e,t,i,l)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return n(e,i,l);case"!=":return r(e,i,l);case">":return s(e,i,l);case">=":return o(e,i,l);case"<":return a(e,i,l);case"<=":return c(e,i,l);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t){e.exports=require("child_process")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getSymbolKindForElementKind=t.DasAnalyzerClient=t.DasAnalyzer=t.AnalyzerCapabilities=void 0;const r=i(2),s=i(0),o=i(110),a=i(4),c=i(8),l=i(13),u=i(3),d=i(10),h=i(7),f=i(15),g=i(112),p=i(149),m=i(150);class v{constructor(e){this.version=e}static get empty(){return new v("0.0.0")}get hasCompleteStatementFix(){return u.versionIsAtLeast(this.version,"1.20.2")}get supportsPriorityFilesOutsideAnalysisRoots(){return u.versionIsAtLeast(this.version,"1.18.2")}get supportsDiagnostics(){return u.versionIsAtLeast(this.version,"1.18.1")}get supportsClosingLabels(){return u.versionIsAtLeast(this.version,"1.18.4")}get supportsCustomFolding(){return u.versionIsAtLeast(this.version,"1.20.3")}get supportsFlutterOutline(){return u.versionIsAtLeast(this.version,"1.26.0")}get supportsGetDeclerations(){return u.versionIsAtLeast(this.version,"1.18.7")}get supportsGetDeclerationsForFile(){return u.versionIsAtLeast(this.version,"1.19.0")}get supportsGetSignature(){return u.versionIsAtLeast(this.version,"1.20.5")}get supportsMoveFile(){return u.versionIsAtLeast(this.version,"1.27.0")}get isDart2(){return u.versionIsAtLeast(this.version,"1.19.0")}get hasNewSignatureFormat(){return u.versionIsAtLeast(this.version,"1.27.1")}get hasNewHoverLibraryFormat(){return u.versionIsAtLeast(this.version,"1.27.1")}get supportsAvailableSuggestions(){return u.versionIsAtLeast(this.version,"1.26.0")}get supportsIncludedImports(){return u.versionIsAtLeast(this.version,"1.27.1")}}t.AnalyzerCapabilities=v;class y extends o.Analyzer{constructor(e,t,i,n,r){super(new l.CategoryLogger(e,c.LogCategory.Analyzer)),this.client=new b(this.logger,i,n),this.fileTracker=new m.DasFileTracker(e,this.client,r),this.disposables.push(this.client),this.disposables.push(this.fileTracker);const s=this.client.registerForServerConnected(e=>{t.analysisServerVersion=e.version,this.onReadyCompleter.resolve(),s.dispose()});this.client.registerForServerStatus(e=>{e.analysis&&this.onAnalysisStatusChangeEmitter.fire({isAnalyzing:e.analysis.isAnalyzing})})}getDiagnosticServerPort(){return this.client.diagnosticGetServerPort()}forceReanalyze(){return n(this,void 0,void 0,(function*(){yield this.client.analysisReanalyze()}))}}t.DasAnalyzer=y;class b extends p.AnalyzerGen{constructor(e,t,i){var n;super(e,d.config.maxLogLineLength),this.isAnalyzing=!1,this.capabilities=v.empty,this.resolvedPromise=Promise.resolve(),this.serverTerminatedSubscriptions=[],this.launchArgs=g.getAnalyzerArgs(e,t,i,!1),this.registerForServerError(e=>this.requestDiagnosticsUpdate()),this.registerForRequestError(e=>this.requestDiagnosticsUpdate()),this.registerForServerConnected(e=>{this.version=e.version,this.capabilities.version=this.version});const s=r.join(t.dart,a.dartVMPath);let o=s,c=this.launchArgs.slice();d.config.analyzerSshHost&&(o="ssh",c.unshift(s),c=["-q",d.config.analyzerSshHost,h.escapeShell(c)]),this.createProcess(void 0,o,c,{toolEnv:f.getToolEnv()}),null===(n=this.process)||void 0===n||n.on("exit",(e,t)=>this.notify(this.serverTerminatedSubscriptions,void 0)),this.registerForServerStatus(e=>{e.analysis&&(e.analysis.isAnalyzing?this.isAnalyzing=!0:(this.isAnalyzing=!1,this.currentAnalysisCompleter&&(this.currentAnalysisCompleter.resolve(),this.currentAnalysisCompleter=void 0)))}),this.serverSetSubscriptions({subscriptions:["STATUS"]})}get currentAnalysis(){return this.isAnalyzing?(this.currentAnalysisCompleter||(this.currentAnalysisCompleter=new u.PromiseCompleter),this.currentAnalysisCompleter.promise):this.resolvedPromise}sendMessage(e){try{super.sendMessage(e)}catch(e){const t=this.version?"The Dart Analyzer has terminated.":"The Dart Analyzer could not be started.";throw h.promptToReloadExtension(t,void 0,!0),e}}shouldHandleMessage(e){return!(e.startsWith("--- ")||e.startsWith("+++ ")||e.startsWith("Observatory listening on")||e.startsWith("Observatory server"))}requestDiagnosticsUpdate(){return n(this,void 0,void 0,(function*(){this.lastDiagnostics=void 0,this.capabilities.supportsDiagnostics&&(this.lastDiagnostics=(yield this.diagnosticGetDiagnostics()).contexts)}))}getLastDiagnostics(){return this.lastDiagnostics}getAnalyzerLaunchArgs(){return this.launchArgs}forceNotificationsFor(e){const t={};t[e]={edits:[{offset:0,length:0,replacement:"",id:""}],type:"change"},this.analysisUpdateContent({files:t})}completionGetSuggestionsResults(e){return this.requestWithStreamedResults(()=>this.completionGetSuggestions(e),this.registerForCompletionResults)}searchFindElementReferencesResults(e){return this.requestWithStreamedResults(()=>this.searchFindElementReferences(e),this.registerForSearchResults)}searchFindTopLevelDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindTopLevelDeclarations(e),this.registerForSearchResults)}searchFindMemberDeclarationsResults(e){return this.requestWithStreamedResults(()=>this.searchFindMemberDeclarations(e),this.registerForSearchResults)}requestWithStreamedResults(e,t){return new Promise((i,n)=>{const r=[];let s;const o=t.bind(this)(e=>{s&&e.id===s&&e.isLast?(o.dispose(),i(e)):!s&&e.isLast&&r.push(e)});e.bind(this)().then(e=>{e.id||(o.dispose(),n()),s=e.id;const t=r.find(e=>e.id===s);t&&(o.dispose(),i(t))},()=>n())})}registerForServerTerminated(e){return this.subscribe(this.serverTerminatedSubscriptions,e)}}t.DasAnalyzerClient=b,t.getSymbolKindForElementKind=function(e,t){switch(t){case"CLASS":case"CLASS_TYPE_ALIAS":case"MIXIN":return s.SymbolKind.Class;case"COMPILATION_UNIT":case"EXTENSION":return s.SymbolKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return s.SymbolKind.Constructor;case"ENUM":return s.SymbolKind.Enum;case"ENUM_CONSTANT":return s.SymbolKind.EnumMember;case"FIELD":return s.SymbolKind.Field;case"FILE":return s.SymbolKind.File;case"FUNCTION":case"FUNCTION_INVOCATION":case"FUNCTION_TYPE_ALIAS":return s.SymbolKind.Function;case"GETTER":return s.SymbolKind.Property;case"LABEL":return s.SymbolKind.Module;case"LIBRARY":return s.SymbolKind.Namespace;case"LOCAL_VARIABLE":return s.SymbolKind.Variable;case"METHOD":return s.SymbolKind.Method;case"PARAMETER":case"PREFIX":return s.SymbolKind.Variable;case"SETTER":return s.SymbolKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return s.SymbolKind.Variable;case"UNIT_TEST_GROUP":return s.SymbolKind.Module;case"UNIT_TEST_TEST":return s.SymbolKind.Method;case"UNKNOWN":return s.SymbolKind.Object;default:return e.error("Unknown kind: "+t,c.LogCategory.Analyzer),s.SymbolKind.Object}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locateBestProjectRoot=t.UPGRADE_TO_WORKSPACE_FOLDERS=void 0;const n=i(2),r=i(1),s=i(7);t.UPGRADE_TO_WORKSPACE_FOLDERS="Mark Projects as Workspace Folders",t.locateBestProjectRoot=function(e){if(!e||!s.isWithinWorkspace(e))return;let t=e;for(;t!==n.dirname(t);){if(r.hasPubspec(t)||r.hasPackagesFile(t))return t;t=n.dirname(t)}}},function(e,t,i){"use strict";function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every(e=>n(e))}},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("net")},function(e,t,i){"use strict";function n(e){return"string"==typeof e||e instanceof String}function r(e){return"function"==typeof e}function s(e){return Array.isArray(e)}function o(e){return e&&r(e.then)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=r,t.array=s,t.stringArray=function(e){return s(e)&&e.every(e=>n(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.thenable=o,t.asPromise=function(e){return e instanceof Promise?e:o(e)?new Promise((t,i)=>{e.then(e=>t(e),e=>i(e))}):Promise.resolve(e)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveDartEditor=t.isDartDocument=void 0;const n=i(0);t.isDartDocument=function(e){return e&&"dart"===e.languageId},t.getActiveDartEditor=function(){const e=n.window.activeTextEditor;if(e&&"dart"===e.document.languageId)return e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DaemonCapabilities=t.FlutterCapabilities=void 0;const n=i(3);class r{constructor(e){this.version=e}static get empty(){return new r("0.0.0")}get supportsPidFileForMachine(){return n.versionIsAtLeast(this.version,"0.10.0")}get supportsCreatingSamples(){return n.versionIsAtLeast(this.version,"1.0.0")}get supportsMultipleSamplesPerElement(){return n.versionIsAtLeast(this.version,"1.2.2")}get supportsDevTools(){return n.versionIsAtLeast(this.version,"1.1.0")}get hasTestGroupFix(){return n.versionIsAtLeast(this.version,"1.3.4")}get hasEvictBug(){return!n.versionIsAtLeast(this.version,"1.2.2")}get hasLatestStructuredErrorsWork(){return n.versionIsAtLeast(this.version,"1.21.0-5.0")}get supportsFlutterCreateListSamples(){return n.versionIsAtLeast(this.version,"1.3.10")}get supportsWsVmService(){return n.versionIsAtLeast(this.version,"1.18.0-5")}get supportsWsDebugBackend(){return n.versionIsAtLeast(this.version,"1.21.0-0")}get supportsExposeUrl(){return n.versionIsAtLeast(this.version,"1.18.0-5")}get supportsDartDefine(){return n.versionIsAtLeast(this.version,"1.17.0")}get supportsRestartDebounce(){return n.versionIsAtLeast(this.version,"1.21.0-0")}get webSupportsDebugging(){return!1}}t.FlutterCapabilities=r;class s{constructor(e){this.version=e}static get empty(){return new s("0.0.0")}get canCreateEmulators(){return n.versionIsAtLeast(this.version,"0.4.0")}get canFlutterAttach(){return n.versionIsAtLeast(this.version,"0.4.1")}get providesPlatformTypes(){return n.versionIsAtLeast(this.version,"0.5.2")}}t.DaemonCapabilities=s},function(e,t){e.exports=require("http")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageMap=void 0;const n=i(5),r=i(2),s=i(29),o=i(3),a=i(1);class c{static findPackagesFile(e){if("string"!=typeof e)return;return o.findFileInAncestor([r.join(".dart_tool/package_config.json"),".packages"],e)}static load(e,t){if(!t)return new l;try{return".packages"===r.basename(t).toLowerCase()?new u(t):new d(e,t)}catch(t){return e.error(t),new l}}getPackagePath(e){return this.packages[e]}resolvePackageUri(e){if(!e)return;let t=e;t.startsWith("package:")&&(t=t.substring(8));const i=t.indexOf("/");if(-1===i)return;const n=t.substring(i+1);t=t.substring(0,i);const s=this.getPackagePath(t);return s?r.join(s,n):void 0}}t.PackageMap=c;class l extends c{get packages(){return{}}getPackagePath(e){}resolvePackageUri(e){}}class u extends c{constructor(e){if(super(),this.map={},!e)return;this.localPackageRoot=r.dirname(e);const t=n.readFileSync(e,{encoding:"utf8"}).split("\n");for(let e of t){if(e=e.trim(),0===e.length||e.startsWith("#"))continue;const t=e.indexOf(":");if(-1!==t){const i=e.substr(0,t),n=e.substring(t+1);n.startsWith("file:")?this.map[i]=o.uriToFilePath(n):this.map[i]=r.join(this.localPackageRoot,n)}}}get packages(){return Object.assign({},this.map)}}class d extends c{constructor(e,t){super(),this.logger=e,this.packageConfigPath=t,this.map={};const i=n.readFileSync(this.packageConfigPath,"utf8");this.config=JSON.parse(i);for(const t of this.config.packages)try{const e=r.dirname(this.packageConfigPath),i=this.getPathForUri(t.rootUri),n=this.getPathForUri(t.packageUri);this.map[t.name]=r.resolve(e,null!=i?i:"",null!=n?n:"")}catch(i){e.error(`Failed to resolve path for package ${t.name}: ${i}`)}}getPathForUri(e){if(!e)return;const t=a.normalizeSlashes(e.startsWith("file:")?s.fileURLToPath(e):unescape(e));return t.endsWith(r.sep)?t:`${t}${r.sep}`}get packages(){return Object.assign({},this.map)}getPackagePath(e){return this.map[e]}}},function(e,t){e.exports=require("stream")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.create=function(e){return{dispose:e}}}(t.Disposable||(t.Disposable={})),function(e){const t={dispose(){}};e.None=function(){return t}}(t.Event||(t.Event={}));class n{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(this._callbacks){for(var i=!1,n=0,r=this._callbacks.length;n<r;n++)if(this._callbacks[n]===e){if(this._contexts[n]===t)return this._callbacks.splice(n,1),void this._contexts.splice(n,1);i=!0}if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}}invoke(...e){if(!this._callbacks)return[];for(var t=[],i=this._callbacks.slice(0),n=this._contexts.slice(0),r=0,s=i.length;r<s;r++)try{t.push(i[r].apply(n[r],e))}catch(e){console.error(e)}return t}isEmpty(){return!this._callbacks||0===this._callbacks.length}dispose(){this._callbacks=void 0,this._contexts=void 0}}class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{let s;return this._callbacks||(this._callbacks=new n),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t),s={dispose:()=>{this._callbacks.remove(e,t),s.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this)}},Array.isArray(i)&&i.push(s),s}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}}t.Emitter=r,r._noop=function(){}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTemplateOfType=t.getTemplatedLaunchConfigs=void 0;const n=i(2),r=i(0),s=i(3),o=i(1),a=new RegExp(s.escapeRegExp("${debugType}"),"gi");function c(e,t){var i;const n=(null===(i=e.codeLens)||void 0===i?void 0:i.for)||e.template;return!!n&&("string"==typeof n&&n===t||Array.isArray(n)&&-1!==n.indexOf(t))}t.getTemplatedLaunchConfigs=function(e,t){var i,s;const l=r.workspace.getConfiguration("launch",e.uri).get("configurations")||[],u=["run-"+t,"debug-"+t],d=o.fsPath(e.uri),h=null===(i=r.workspace.getWorkspaceFolder(e.uri))||void 0===i?void 0:i.uri,f=h?o.fsPath(h):void 0,g=[];for(const e of u){const t=l.filter(t=>"dart"===t.type&&c(t,e)).filter(e=>{var t,i,r;return(null===(t=e.codeLens)||void 0===t?void 0:t.path)&&f?o.isWithinPath(d,n.join(f,null===(i=e.codeLens)||void 0===i?void 0:i.path)):!(null===(r=e.codeLens)||void 0===r?void 0:r.path)});for(const i of t)g.push(Object.assign(Object.assign({},i),{name:((null===(s=i.codeLens)||void 0===s?void 0:s.title)||i.name||"${debugType}").replace(a,0===e.indexOf("run-")?"Run":"Debug"),template:e}))}return g},t.isTemplateOfType=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runProcessInChannel=t.getChannel=t.createChannel=void 0;const n=i(0),r={};function s(e){return r[e]&&(r[e].hide(),r[e].dispose()),r[e]=n.window.createOutputChannel(e),r[e]}t.createChannel=s,t.getChannel=function(e){return r[e]?r[e]:s(e)},t.runProcessInChannel=function(e,t){e.stdout.on("data",e=>t.append(e.toString())),e.stderr.on("data",e=>t.append(e.toString())),e.on("close",e=>t.appendLine("exit code "+e))}},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartCapabilities=void 0;const n=i(3);class r{constructor(e){this.version=e}static get empty(){return new r("0.0.0")}get generatesCodeWithUnimplementedError(){return n.versionIsAtLeast(this.version,"2.8.0-dev.0.0")}get supportsDevTools(){return n.versionIsAtLeast(this.version,"2.1.0")}get includesSourceForSdkLibs(){return n.versionIsAtLeast(this.version,"2.2.1")}get handlesBreakpointsInPartFiles(){return n.versionIsAtLeast(this.version,"2.2.1-edge")}get hasDocumentationInCompletions(){return!n.versionIsAtLeast(this.version,"2.5.1")}get supportsDisableServiceTokens(){return n.versionIsAtLeast(this.version,"2.2.1-dev.4.2")}get supportsWriteServiceInfo(){return n.versionIsAtLeast(this.version,"2.7.1")}get supportsDebugInternalLibraries(){return n.versionIsAtLeast(this.version,"2.9.0-a")}get supportsPubOutdated(){return n.versionIsAtLeast(this.version,"2.8.0-a")}get hasUpdatedCompletionRanking(){return n.versionIsAtLeast(this.version,"2.10.0-0")}get webSupportsEvaluation(){return!1}get webSupportsDebugging(){return!1}}t.DartCapabilities=r},function(e,t,i){const n=i(16);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:i(24).SEMVER_SPEC_VERSION,SemVer:i(9),compareIdentifiers:i(31).compareIdentifiers,rcompareIdentifiers:i(31).rcompareIdentifiers,parse:i(17),valid:i(68),clean:i(69),inc:i(70),diff:i(71),major:i(72),minor:i(73),patch:i(74),prerelease:i(75),compare:i(11),rcompare:i(76),compareLoose:i(77),compareBuild:i(33),sort:i(78),rsort:i(79),gt:i(26),lt:i(34),eq:i(32),neq:i(45),gte:i(35),lte:i(36),cmp:i(46),coerce:i(80),Comparator:i(27),Range:i(12),satisfies:i(28),toComparators:i(81),maxSatisfying:i(82),minSatisfying:i(83),minVersion:i(84),validRange:i(85),outside:i(37),gtr:i(86),ltr:i(87),intersects:i(88),simplifyRange:i(89),subset:i(90)}},function(e,t,i){const n=i(17);e.exports=(e,t)=>{const i=n(e,t);return i?i.version:null}},function(e,t,i){const n=i(17);e.exports=(e,t)=>{const i=n(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null}},function(e,t,i){const n=i(9);e.exports=(e,t,i,r)=>{"string"==typeof i&&(r=i,i=void 0);try{return new n(e,i).inc(t,r).version}catch(e){return null}}},function(e,t,i){const n=i(17),r=i(32);e.exports=(e,t)=>{if(r(e,t))return null;{const i=n(e),r=n(t),s=i.prerelease.length||r.prerelease.length,o=s?"pre":"",a=s?"prerelease":"";for(const e in i)if(("major"===e||"minor"===e||"patch"===e)&&i[e]!==r[e])return o+e;return a}}},function(e,t,i){const n=i(9);e.exports=(e,t)=>new n(e,t).major},function(e,t,i){const n=i(9);e.exports=(e,t)=>new n(e,t).minor},function(e,t,i){const n=i(9);e.exports=(e,t)=>new n(e,t).patch},function(e,t,i){const n=i(17);e.exports=(e,t)=>{const i=n(e,t);return i&&i.prerelease.length?i.prerelease:null}},function(e,t,i){const n=i(11);e.exports=(e,t,i)=>n(t,e,i)},function(e,t,i){const n=i(11);e.exports=(e,t)=>n(e,t,!0)},function(e,t,i){const n=i(33);e.exports=(e,t)=>e.sort((e,i)=>n(e,i,t))},function(e,t,i){const n=i(33);e.exports=(e,t)=>e.sort((e,i)=>n(i,e,t))},function(e,t,i){const n=i(9),r=i(17),{re:s,t:o}=i(16);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let i=null;if((t=t||{}).rtl){let t;for(;(t=s[o.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&t.index+t[0].length===i.index+i[0].length||(i=t),s[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;s[o.COERCERTL].lastIndex=-1}else i=e.match(s[o.COERCE]);return null===i?null:r(`${i[2]}.${i[3]||"0"}.${i[4]||"0"}`,t)}},function(e,t,i){const n=i(12);e.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,i){const n=i(9),r=i(12);e.exports=(e,t,i)=>{let s=null,o=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(s&&-1!==o.compare(e)||(s=e,o=new n(s,i)))}),s}},function(e,t,i){const n=i(9),r=i(12);e.exports=(e,t,i)=>{let s=null,o=null,a=null;try{a=new r(t,i)}catch(e){return null}return e.forEach(e=>{a.test(e)&&(s&&1!==o.compare(e)||(s=e,o=new n(s,i)))}),s}},function(e,t,i){const n=i(9),r=i(12),s=i(26);e.exports=(e,t)=>{e=new r(e,t);let i=new n("0.0.0");if(e.test(i))return i;if(i=new n("0.0.0-0"),e.test(i))return i;i=null;for(let t=0;t<e.set.length;++t){e.set[t].forEach(e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!s(i,t)||(i=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}})}return i&&e.test(i)?i:null}},function(e,t,i){const n=i(12);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,i){const n=i(37);e.exports=(e,t,i)=>n(e,t,">",i)},function(e,t,i){const n=i(37);e.exports=(e,t,i)=>n(e,t,"<",i)},function(e,t,i){const n=i(12);e.exports=(e,t,i)=>(e=new n(e,i),t=new n(t,i),e.intersects(t))},function(e,t,i){const n=i(28),r=i(11);e.exports=(e,t,i)=>{const s=[];let o=null,a=null;const c=e.sort((e,t)=>r(e,t,i));for(const e of c){n(e,t,i)?(a=e,o||(o=e)):(a&&s.push([o,a]),a=null,o=null)}o&&s.push([o,null]);const l=[];for(const[e,t]of s)e===t?l.push(e):t||e!==c[0]?t?e===c[0]?l.push("<="+t):l.push(`${e} - ${t}`):l.push(">="+e):l.push("*");const u=l.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},function(e,t,i){const n=i(12),{ANY:r}=i(27),s=i(28),o=i(11),a=(e,t,i)=>{if(1===e.length&&e[0].semver===r)return 1===t.length&&t[0].semver===r;const n=new Set;let a,u,d,h,f,g,p;for(const t of e)">"===t.operator||">="===t.operator?a=c(a,t,i):"<"===t.operator||"<="===t.operator?u=l(u,t,i):n.add(t.semver);if(n.size>1)return null;if(a&&u){if(d=o(a.semver,u.semver,i),d>0)return null;if(0===d&&(">="!==a.operator||"<="!==u.operator))return null}for(const e of n){if(a&&!s(e,String(a),i))return null;if(u&&!s(e,String(u),i))return null;for(const n of t)if(!s(e,String(n),i))return!1;return!0}for(const e of t){if(p=p||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,a)if(">"===e.operator||">="===e.operator){if(h=c(a,e,i),h===e)return!1}else if(">="===a.operator&&!s(a.semver,String(e),i))return!1;if(u)if("<"===e.operator||"<="===e.operator){if(f=l(u,e,i),f===e)return!1}else if("<="===u.operator&&!s(u.semver,String(e),i))return!1;if(!e.operator&&(u||a)&&0!==d)return!1}return!(a&&g&&!u&&0!==d)&&!(u&&p&&!a&&0!==d)},c=(e,t,i)=>{if(!e)return t;const n=o(e.semver,t.semver,i);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},l=(e,t,i)=>{if(!e)return t;const n=o(e.semver,t.semver,i);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,i)=>{e=new n(e,i),t=new n(t,i);let r=!1;e:for(const n of e.set){for(const e of t.set){const t=a(n,e,i);if(r=r||null!==t,t)continue e}if(r)return!1}return!0}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;const n=i(38);t.EventEmitter=class{constructor(){this.emitter=new n.EventEmitter}fire(e){this.emitter.emit("thing",e)}listen(e){return this.emitter.on("thing",e),{dispose:()=>{this.emitter.removeListener("thing",e)}}}get event(){return this}dispose(){this.emitter.removeAllListeners()}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hasDartAnalysisServer=t.referencesBuildRunner=t.referencesFlutterSdk=t.SdkUtils=void 0;const r=i(5),s=i(18),o=i(2),a=i(0),c=i(4),l=i(13),u=i(57),d=i(3),h=i(1),f=i(30),g=i(146),p=i(6),m=i(147),v=i(10),y=i(44),b=i(7),C=i(148);function w(e){if(e&&h.hasPubspec(e)){return new RegExp("sdk\\s*:\\s*flutter","i").test(r.readFileSync(o.join(e,"pubspec.yaml")).toString())}return!1}function S(e){if(!r.existsSync(e))return;let t=u.PackageMap.load(l.nullLogger,u.PackageMap.findPackagesFile(e)).getPackagePath("flutter");if(!t)return;c.isWin&&(t=t.replace(/\\/g,"/")),t.endsWith("/")||(t+="/");return t.endsWith("/packages/flutter/lib/")&&(t=t.substr(0,t.length-"/packages/flutter/lib/".length)),t.endsWith("/")||(t+="/"),t.endsWith("/bin/")||(t+="bin/"),c.isWin&&(t=t.replace(/\//g,"\\"),"\\"===t[0]&&(t=t.substring(1))),t}function T(e,t){return n(this,void 0,void 0,(function*(){return D(t,".jiri_root")}))}function E(e,t){return n(this,void 0,void 0,(function*(){return D(t,"WORKSPACE",!0)}))}function P(e,t){return n(this,void 0,void 0,(function*(){return D(t,".git")}))}function R(e,t){return n(this,void 0,void 0,(function*(){if(c.isLinux&&r.existsSync(c.flutterSnapScript)){e.info("Found Flutter snap script");const t=o.join(s.homedir(),"/snap/flutter/common/flutter");if(r.existsSync(t+"/.git")||(e.info("Flutter snap is not initialized, showing prompt"),yield C.initializeFlutterSdk(e,c.flutterSnapScript,c.initializeSnapPrompt)),r.existsSync(t+"/.git"))return e.info(`Returning ${t} as Flutter snap SDK root`),t}}))}function D(e,t,i=!1){if(e){let n=e;for(;n;){try{const e=r.statSync(o.join(n,t));if(i?e.isFile():e.isDirectory())return n}catch(e){}const e=o.dirname(n);if(n===e)break;n=e}}}t.SdkUtils=class{constructor(e){this.logger=e,this.hasShownActivationFailure=!1}handleMissingSdks(e,t,i){e.subscriptions.push(a.commands.registerCommand("flutter.createProject",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.createProject")})),e.subscriptions.push(a.commands.registerCommand("dart.createProject",e=>{this.showRelevantActivationFailureMessage(t,i,!1,"dart.createProject")})),e.subscriptions.push(a.commands.registerCommand("_dart.flutter.createSampleProject",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"_dart.flutter.createSampleProject")})),e.subscriptions.push(a.commands.registerCommand("flutter.doctor",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.doctor")})),e.subscriptions.push(a.commands.registerCommand("flutter.upgrade",e=>{this.showRelevantActivationFailureMessage(t,i,!0,"flutter.upgrade")})),setTimeout(()=>{this.hasShownActivationFailure||(i.hasAnyFlutterProjects?this.showRelevantActivationFailureMessage(t,i,!0):i.hasAnyStandardDartProjects?this.showRelevantActivationFailureMessage(t,i,!1):this.logger.error("No Dart or Flutter SDK was found. Suppressing prompt because it doesn't appear that a Dart/Flutter project is open."))},500)}showRelevantActivationFailureMessage(e,t,i,n){i&&t.sdks.flutter&&!t.sdks.dart?this.showFluttersDartSdkActivationFailure():i?this.showFlutterActivationFailure(n):this.showDartActivationFailure(n),this.hasShownActivationFailure||(e.logSdkDetectionFailure(),this.hasShownActivationFailure=!0)}showFluttersDartSdkActivationFailure(){b.promptToReloadExtension("Could not find Dart in your Flutter SDK. Please run 'flutter doctor' in the terminal then reload the project once all issues are resolved.","Reload",!0)}showFlutterActivationFailure(e){this.showSdkActivationFailure("Flutter",e=>this.findFlutterSdk(e),c.FLUTTER_DOWNLOAD_URL,e=>v.config.setGlobalFlutterSdkPath(e),e)}showDartActivationFailure(e){this.showSdkActivationFailure("Dart",e=>this.findDartSdk(e),c.DART_DOWNLOAD_URL,e=>v.config.setGlobalDartSdkPath(e),e)}showSdkActivationFailure(e,t,i,r,s){return n(this,void 0,void 0,(function*(){let n=`Could not find a ${e} SDK. Please ensure ${e.toLowerCase()} is installed and in your PATH (you may need to restart).`;for(;;){const o=y.ringLog.toString(),l=yield a.window.showErrorMessage(n,"Locate SDK","Download SDK",c.showLogAction);if("Locate SDK"!==l){if("Download SDK"===l){yield p.envUtils.openInBrowser(i);break}if(l===c.showLogAction){b.openLogContents(void 0,o);break}break}{const i=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:`Set ${e} SDK folder`});if(i&&i.length>0){const o=t(i.map(h.fsPath));if(o){yield r(o),yield b.promptToReloadExtension(),s&&a.commands.executeCommand(s);break}n=`That folder does not appear to be a ${e} SDK.`}}}}))}scanWorkspace(e){return n(this,void 0,void 0,(function*(){this.logger.info("Searching for SDKs...");const t=p.getDartWorkspaceFolders().map(e=>h.fsPath(e.uri)),i=process.env.DART_PATH_OVERRIDE||"",s=process.env.PATH||"",a=(i+o.delimiter+s).split(o.delimiter).filter(e=>e);this.logger.info("Environment PATH:");for(const e of a)this.logger.info("    "+e);if(v.config.analyzerSshHost)return new m.WorkspaceContext({dart:v.config.sdkPath,dartSdkIsFromFlutter:!1,flutter:void 0},{},!1,!1,!1,!1);let l,u=!1,y=!1,D=!1,k=!1;const x=yield h.findProjectFolders(t);for(const e of x){const t=h.hasPubspec(e),i=t&&w(e),n=!1,s=r.existsSync(o.join(e,c.FLUTTER_CREATE_PROJECT_TRIGGER_FILE)),a=r.existsSync(o.join(e,"bin/flutter"))&&r.existsSync(o.join(e,"bin/cache/dart-sdk"));yield f.resolvedPromise;const d=i||s||a;d&&this.logger.info(`Found Flutter project at ${e}:\n\t\t\tMobile? ${i}\n\t\t\tWeb? ${n}\n\t\t\tCreate Trigger? ${s}\n\t\t\tFlutter Repo? ${a}`),l=l||(d?e:void 0),u=u||d,y=y||i||s,D=D||n,k=k||!d&&t}const F={useLsp:e},O=(e,i)=>n(this,void 0,void 0,(function*(){for(const n of t){const t=yield e(this.logger,n);if(t)return i(this.logger,F,t),t}}));yield O(P,g.processKnownGitRepositories),yield O(E,(e,t,i)=>g.processBazelWorkspace(e,t,i,v.config.previewBazelWorkspaceCustomScripts));const _=yield O(T,g.processFuchsiaWorkspace);yield O(R,g.processFlutterSnap),_&&(this.logger.info("Found Fuchsia root at "+_),k&&this.logger.info("Found Fuchsia project that is not vanilla Flutter"));const A=[null==F?void 0:F.flutterSdkHome,v.config.flutterSdkPath,_&&o.join(_,"lib/flutter"),_&&o.join(_,"third_party/dart-pkg/git/flutter"),l,l&&S(l),l&&o.join(l,".flutter"),l&&o.join(l,"vendor/flutter"),process.env.FLUTTER_ROOT].concat(a).filter(d.notUndefined),I=this.findFlutterSdk(A);yield f.resolvedPromise;const L=[c.isMac?null==F?void 0:F.dartSdkHomeMac:null==F?void 0:F.dartSdkHomeLinux,_&&o.join(_,"topaz/tools/prebuilt-dart-sdk",c.dartPlatformName+"-x64"),_&&o.join(_,"third_party/dart/tools/sdks/dart-sdk"),_&&o.join(_,"third_party/dart/tools/sdks",c.dartPlatformName,"dart-sdk"),_&&o.join(_,"dart/tools/sdks",c.dartPlatformName,"dart-sdk"),l&&I&&o.join(I,"bin/cache/dart-sdk"),v.config.sdkPath].concat(a).concat([I&&o.join(I,"bin/cache/dart-sdk")]).filter(d.notUndefined),N=this.findDartSdk(L);if(yield f.resolvedPromise,u&&I){(!b.getSdkVersion(this.logger,{sdkRoot:I,versionFile:null==F?void 0:F.flutterVersionFile})||!r.existsSync(o.join(I,"bin/cache/dart-sdk")))&&(yield C.initializeFlutterSdk(this.logger,o.join(I,c.flutterPath)))}return new m.WorkspaceContext({dart:N,dartSdkIsFromFlutter:!!N&&d.isDartSdkFromFlutter(N),dartVersion:b.getSdkVersion(this.logger,{sdkRoot:N}),flutter:I,flutterVersion:b.getSdkVersion(this.logger,{sdkRoot:I,versionFile:null==F?void 0:F.flutterVersionFile})},F,y,D,k,!!_&&k)}))}findDartSdk(e){return this.searchPaths(e,c.dartExecutableName,e=>this.hasExecutable(e,c.dartVMPath)&&t.hasDartAnalysisServer(e))}findFlutterSdk(e){return this.searchPaths(e,c.flutterExecutableName,e=>this.hasExecutable(e,c.flutterPath))}hasExecutable(e,t){const i=o.join(e,t);return r.existsSync(i)&&r.statSync(i).isFile()}searchPaths(e,t,i){this.logger.info("Searching for "+t);let n=e.filter(e=>e).map(b.resolvePaths).filter(d.notUndefined);n=d.flatMap(n,e=>{return t=e,-1!==["bin","sbin"].indexOf(o.basename(t))?[e]:[e,o.join(e,"bin")];var t}),this.logger.info(`    Looking for ${t} in:`);for(const e of n)this.logger.info("        "+e);n=n.filter(e=>r.existsSync(o.join(e,t))),this.logger.info("    Found at:");for(const e of n)this.logger.info("        "+e);n=n.map(e=>{const i=o.join(e,t),n=e&&r.realpathSync(i);return n.toLowerCase()!==i.toLowerCase()&&this.logger.info(`Following symlink: ${i} ==> ${n}`),o.dirname(o.dirname(n))}),this.logger.info("    Candidate paths to be post-filtered:");for(const e of n)this.logger.info("        "+e);const s=n.find(i||(e=>!0));return s&&this.logger.info("    Found at "+s),this.logger.info(`    Returning SDK path ${s} for ${t}`),s}},t.referencesFlutterSdk=w,t.referencesBuildRunner=function(e){if(e&&h.hasPubspec(e)){return new RegExp("build_runner\\s*:","i").test(r.readFileSync(o.join(e,"pubspec.yaml")).toString())}return!1},t.hasDartAnalysisServer=e=>r.existsSync(o.join(e,c.analyzerSnapshotPath))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(47),r=i(5),s=i(152),o=i(22),a=i(0),c=i(14),l=i(175),u=i(176),d=i(177),h=i(178),f=i(179),g=i(180),p=i(181),m=i(182),v=i(183),y=i(184),b=i(185),C=i(53),w=i(186);!function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(22));var S,T,E,P,R,D,k;!function(e){e.is=function(e){return C.string(e.command)}}(S||(S={})),function(e){e[e.stdio=0]="stdio",e[e.ipc=1]="ipc",e[e.pipe=2]="pipe",e[e.socket=3]="socket"}(T=t.TransportKind||(t.TransportKind={})),function(e){e.isSocket=function(e){let t=e;return t&&t.kind===T.socket&&C.number(t.port)}}(E||(E={})),function(e){e.is=function(e){return C.string(e.module)}}(P||(P={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.writer&&void 0!==t.reader}}(R||(R={})),function(e){e.is=function(e){let t=e;return t&&void 0!==t.process&&"boolean"==typeof t.detached}}(D||(D={}));class x extends o.BaseLanguageClient{constructor(e,t,i,n,r){let s,o,a,c,l;C.string(t)?(s=e,o=t,a=i,c=n,l=!!r):(s=e.toLowerCase(),o=e,a=t,c=i,l=n),void 0===l&&(l=!1),super(s,o,c),this._serverOptions=a,this._forceDebug=l;try{this.checkVersion()}catch(e){throw C.string(e.message)&&this.outputChannel.appendLine(e.message),e}}checkVersion(){let e=s.parse(a.version);if(!e)throw new Error("No valid VS Code version detected. Version string is: "+a.version);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!s.satisfies(e,"^1.41.0"))throw new Error("The language client requires VS Code version ^1.41.0 but received version "+a.version)}stop(){return super.stop().then(()=>{if(this._serverProcess){let e=this._serverProcess;this._serverProcess=void 0,void 0!==this._isDetached&&this._isDetached||this.checkProcessDied(e),this._isDetached=void 0}})}checkProcessDied(e){e&&setTimeout(()=>{try{process.kill(e.pid,0),w.terminate(e)}catch(e){}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}createMessageTransports(e){function t(e,t){if(!e&&!t)return;let i=Object.create(null);return Object.keys(process.env).forEach(e=>i[e]=process.env[e]),t&&(i.ELECTRON_RUN_AS_NODE="1",i.ELECTRON_NO_ASAR="1"),e&&Object.keys(e).forEach(t=>i[t]=e[t]),i}const i=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],r=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(e){if(null===e.stdin||null===e.stdout||null===e.stderr)throw new Error("Process created without stdio streams")}let a,l=this._serverOptions;if(C.func(l))return l().then(t=>{if(o.MessageTransports.is(t))return this._isDetached=!!t.detached,t;if(R.is(t))return this._isDetached=!!t.detached,{reader:new c.StreamMessageReader(t.reader),writer:new c.StreamMessageWriter(t.writer)};{let i;return D.is(t)?(i=t.process,this._isDetached=t.detached):(i=t,this._isDetached=!1),i.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),{reader:new c.StreamMessageReader(i.stdout),writer:new c.StreamMessageWriter(i.stdin)}}});let u=l;return a=u.run||u.debug?this._forceDebug||function(){let e=process.execArgv;return!!e&&e.some(e=>i.some(t=>e.startsWith(t))||r.some(t=>e===t))}()?u.debug:u.run:l,this._getServerWorkingDir(a.options).then(i=>{if(P.is(a)&&a.module){let r=a,o=r.transport||T.stdio;if(!r.runtime){let a=void 0;return new Promise((l,u)=>{let d=r.args&&r.args.slice()||[];o===T.ipc?d.push("--node-ipc"):o===T.stdio?d.push("--stdio"):o===T.pipe?(a=c.generateRandomPipeName(),d.push("--pipe="+a)):E.isSocket(o)&&d.push("--socket="+o.port),d.push("--clientProcessId="+process.pid.toString());let h=r.options||Object.create(null);if(h.env=t(h.env,!0),h.execArgv=h.execArgv||[],h.cwd=i,h.silent=!0,o===T.ipc||o===T.stdio){let t=n.fork(r.module,d||[],h);s(t),this._serverProcess=t,t.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),o===T.ipc?(t.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),l({reader:new c.IPCMessageReader(this._serverProcess),writer:new c.IPCMessageWriter(this._serverProcess)})):l({reader:new c.StreamMessageReader(t.stdout),writer:new c.StreamMessageWriter(t.stdin)})}else o===T.pipe?c.createClientPipeTransport(a).then(t=>{let i=n.fork(r.module,d||[],h);s(i),this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),t.onConnected().then(e=>{l({reader:e[0],writer:e[1]})})}):E.isSocket(o)&&c.createClientSocketTransport(o.port).then(t=>{let i=n.fork(r.module,d||[],h);s(i),this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),t.onConnected().then(e=>{l({reader:e[0],writer:e[1]})})})})}{let s=[],a=r.options||Object.create(null);a.execArgv&&a.execArgv.forEach(e=>s.push(e)),s.push(r.module),r.args&&r.args.forEach(e=>s.push(e));let l=Object.create(null);l.cwd=i,l.env=t(a.env,!1);let u=void 0;if(o===T.ipc?(l.stdio=[null,null,null,"ipc"],s.push("--node-ipc")):o===T.stdio?s.push("--stdio"):o===T.pipe?(u=c.generateRandomPipeName(),s.push("--pipe="+u)):E.isSocket(o)&&s.push("--socket="+o.port),s.push("--clientProcessId="+process.pid.toString()),o===T.ipc||o===T.stdio){let t=n.spawn(r.runtime,s,l);return t&&t.pid?(this._serverProcess=t,t.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),o===T.ipc?(t.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),Promise.resolve({reader:new c.IPCMessageReader(t),writer:new c.IPCMessageWriter(t)})):Promise.resolve({reader:new c.StreamMessageReader(t.stdout),writer:new c.StreamMessageWriter(t.stdin)})):Promise.reject(`Launching server using runtime ${r.runtime} failed.`)}if(o===T.pipe)return c.createClientPipeTransport(u).then(t=>{let i=n.spawn(r.runtime,s,l);return i&&i.pid?(this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${r.runtime} failed.`)});if(E.isSocket(o))return c.createClientSocketTransport(o.port).then(t=>{let i=n.spawn(r.runtime,s,l);return i&&i.pid?(this._serverProcess=i,i.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),i.stdout.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),t.onConnected().then(e=>({reader:e[0],writer:e[1]}))):Promise.reject(`Launching server using runtime ${r.runtime} failed.`)})}}else if(S.is(a)&&a.command){let t=a,r=t.args||[],s=Object.assign({},t.options);s.cwd=s.cwd||i;let o=n.spawn(t.command,r,s);return o&&o.pid?(o.stderr.on("data",t=>this.outputChannel.append(C.string(t)?t:t.toString(e))),this._serverProcess=o,this._isDetached=!!s.detached,Promise.resolve({reader:new c.StreamMessageReader(o.stdout),writer:new c.StreamMessageWriter(o.stdin)})):Promise.reject(`Launching server using command ${t.command} failed.`)}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(l,null,4)))})}registerProposedFeatures(){this.registerFeatures(k.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new u.ConfigurationFeature(this)),this.registerFeature(new h.TypeDefinitionFeature(this)),this.registerFeature(new d.ImplementationFeature(this)),this.registerFeature(new l.ColorProviderFeature(this)),this.registerFeature(new f.WorkspaceFoldersFeature(this)),this.registerFeature(new g.FoldingRangeFeature(this)),this.registerFeature(new p.DeclarationFeature(this)),this.registerFeature(new m.SelectionRangeFeature(this)),this.registerFeature(new v.ProgressFeature(this))}_mainGetRootPath(){let e=a.workspace.workspaceFolders;if(!e||0===e.length)return;let t=e[0];return"file"===t.uri.scheme?t.uri.fsPath:void 0}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(e=>{r.lstat(t,(i,n)=>{e(!i&&n.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}}t.LanguageClient=x;t.SettingMonitor=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return a.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new a.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,i=e>=0?this._setting.substr(e+1):void 0,n=i?a.workspace.getConfiguration(t).get(i,!1):a.workspace.getConfiguration(t);n&&this._client.needsStart()?this._client.start():!n&&this._client.needsStop()&&this._client.stop()}},function(e){e.createAll=function(e){return[new y.CallHierarchyFeature(e),new b.SemanticTokensFeature(e)]}}(k=t.ProposedFeatures||(t.ProposedFeatures={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(59),r=i(50);let s=Buffer.from("\r","ascii")[0],o=Buffer.from("\n","ascii")[0];class a{constructor(e="utf8"){this.encoding=e,this.index=0,this.buffer=Buffer.allocUnsafe(8192)}append(e){var t=e;if("string"==typeof e){var i=e,n=Buffer.byteLength(i,this.encoding);(t=Buffer.allocUnsafe(n)).write(i,0,n,this.encoding)}if(this.buffer.length-this.index>=t.length)t.copy(this.buffer,this.index,0,t.length);else{var r=8192*(Math.ceil((this.index+t.length)/8192)+1);0===this.index?(this.buffer=Buffer.allocUnsafe(r),t.copy(this.buffer,0,0,t.length)):this.buffer=Buffer.concat([this.buffer.slice(0,this.index),t],r)}this.index+=t.length}tryReadHeaders(){let e=void 0,t=0;for(;t+3<this.index&&(this.buffer[t]!==s||this.buffer[t+1]!==o||this.buffer[t+2]!==s||this.buffer[t+3]!==o);)t++;if(t+3>=this.index)return e;e=Object.create(null),this.buffer.toString("ascii",0,t).split("\r\n").forEach(t=>{let i=t.indexOf(":");if(-1===i)throw new Error("Message header must separate key and value using :");let n=t.substr(0,i),r=t.substr(i+1).trim();e[n]=r});let i=t+4;return this.buffer=this.buffer.slice(i),this.index=this.index-i,e}tryReadContent(e){if(this.index<e)return null;let t=this.buffer.toString(this.encoding,0,e),i=e;return this.buffer.copy(this.buffer,0,i),this.index=this.index-i,t}get numberOfBytes(){return this.index}}!function(e){e.is=function(e){let t=e;return t&&r.func(t.listen)&&r.func(t.dispose)&&r.func(t.onError)&&r.func(t.onClose)&&r.func(t.onPartialMessage)}}(t.MessageReader||(t.MessageReader={}));class c{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter,this.partialMessageEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error("Reader received error. Reason: "+(r.string(e.message)?e.message:"unknown"))}}t.AbstractMessageReader=c;class l extends c{constructor(e,t="utf8"){super(),this.readable=e,this.buffer=new a(t),this._partialMessageTimeout=1e4}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e,this.readable.on("data",e=>{this.onData(e)}),this.readable.on("error",e=>this.fireError(e)),this.readable.on("close",()=>this.fireClose())}onData(e){for(this.buffer.append(e);;){if(-1===this.nextMessageLength){let e=this.buffer.tryReadHeaders();if(!e)return;let t=e["Content-Length"];if(!t)throw new Error("Header must provide a Content-Length property.");let i=parseInt(t);if(isNaN(i))throw new Error("Content-Length value must be a number.");this.nextMessageLength=i}var t=this.buffer.tryReadContent(this.nextMessageLength);if(null===t)return void this.setPartialMessageTimer();this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.messageToken++;var i=JSON.parse(t);this.callback(i)}}clearPartialMessageTimer(){this.partialMessageTimer&&(clearTimeout(this.partialMessageTimer),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),this._partialMessageTimeout<=0||(this.partialMessageTimer=setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}t.StreamMessageReader=l;t.IPCMessageReader=class extends c{constructor(e){super(),this.process=e;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose())}listen(e){this.process.on("message",e)}};t.SocketMessageReader=class extends l{constructor(e,t="utf-8"){super(e,t)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(59),r=i(50);!function(e){e.is=function(e){let t=e;return t&&r.func(t.dispose)&&r.func(t.onClose)&&r.func(t.onError)&&r.func(t.write)}}(t.MessageWriter||(t.MessageWriter={}));class s{constructor(){this.errorEmitter=new n.Emitter,this.closeEmitter=new n.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error("Writer received error. Reason: "+(r.string(e.message)?e.message:"unknown"))}}t.AbstractMessageWriter=s;t.StreamMessageWriter=class extends s{constructor(e,t="utf8"){super(),this.writable=e,this.encoding=t,this.errorCount=0,this.writable.on("error",e=>this.fireError(e)),this.writable.on("close",()=>this.fireClose())}write(e){let t=JSON.stringify(e),i=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.writable.write(i.join(""),"ascii"),this.writable.write(t,this.encoding),this.errorCount=0}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.IPCMessageWriter=class extends s{constructor(e){super(),this.process=e,this.errorCount=0,this.queue=[],this.sending=!1;let t=this.process;t.on("error",e=>this.fireError(e)),t.on("close",()=>this.fireClose)}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){try{this.process.send&&(this.sending=!0,this.process.send(e,void 0,void 0,t=>{this.sending=!1,t?(this.errorCount++,this.fireError(t,e,this.errorCount)):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())}))}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}};t.SocketMessageWriter=class extends s{constructor(e,t="utf8"){super(),this.socket=e,this.queue=[],this.sending=!1,this.encoding=t,this.errorCount=0,this.socket.on("error",e=>this.fireError(e)),this.socket.on("close",()=>this.fireClose())}dispose(){super.dispose(),this.socket.destroy()}write(e){this.sending||0!==this.queue.length?this.queue.push(e):this.doWriteMessage(e)}doWriteMessage(e){let t=JSON.stringify(e),i=["Content-Length: ",Buffer.byteLength(t,this.encoding).toString(),"\r\n","\r\n"];try{this.sending=!0,this.socket.write(i.join(""),"ascii",i=>{i&&this.handleError(i,e);try{this.socket.write(t,this.encoding,t=>{this.sending=!1,t?this.handleError(t,e):this.errorCount=0,this.queue.length>0&&this.doWriteMessage(this.queue.shift())})}catch(i){this.handleError(i,e)}})}catch(t){this.handleError(t,e)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompleteStatementRequest=t.ReanalyzeRequest=t.DiagnosticServerRequest=t.SuperRequest=t.PublishFlutterOutlineNotification=t.PublishOutlineNotification=t.PublishClosingLabelsNotification=t.AnalyzerStatusNotification=void 0;const n=i(93);class r{}t.AnalyzerStatusNotification=r,r.type=new n.NotificationType("$/analyzerStatus");class s{}t.PublishClosingLabelsNotification=s,s.type=new n.NotificationType("dart/textDocument/publishClosingLabels");class o{}t.PublishOutlineNotification=o,o.type=new n.NotificationType("dart/textDocument/publishOutline");class a{}t.PublishFlutterOutlineNotification=a,a.type=new n.NotificationType("dart/textDocument/publishFlutterOutline");class c{}t.SuperRequest=c,c.type=new n.RequestType("dart/textDocument/super");class l{}t.DiagnosticServerRequest=l,l.type=new n.RequestType("dart/diagnosticServer");class u{}t.ReanalyzeRequest=u,u.type=new n.RequestType("dart/reanalyze");class d{}t.CompleteStatementRequest=d,d.type=new n.RequestType("dart/completeStatement")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClassOutlineVisitor=t.TestOutlineVisitor=t.OutlineVisitor=void 0;class n{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){var t,i,n;switch(null===(t=null==e?void 0:e.element)||void 0===t?void 0:t.kind){case"CLASS":this.visitClass(e);break;case"CLASS_TYPE_ALIAS":this.visitClassTypeAlias(e);break;case"COMPILATION_UNIT":this.visitCompilationUnit(e);break;case"CONSTRUCTOR":this.visitConstructor(e);break;case"CONSTRUCTOR_INVOCATION":this.visitContructorInvocation(e);break;case"ENUM":this.visitEnum(e);break;case"ENUM_CONSTANT":this.visitEnumConstant(e);break;case"FIELD":this.visitField(e);break;case"FILE":this.visitFile(e);break;case"FUNCTION":this.visitFunction(e);break;case"FUNCTION_INVOCATION":this.visitFunctionInvocation(e);break;case"FUNCTION_TYPE_ALIAS":this.visitFunctionTypeAlias(e);break;case"GETTER":this.visitGetter(e);break;case"LABEL":this.visitLabel(e);break;case"LIBRARY":this.visitLibrary(e);break;case"LOCAL_VARIABLE":this.visitLocalVariable(e);break;case"METHOD":this.visitMethod(e);break;case"MIXIN":this.visitMixin(e);break;case"PARAMETER":this.visitParameter(e);break;case"PREFIX":this.visitPrefix(e);break;case"SETTER":this.visitSetter(e);break;case"TOP_LEVEL_VARIABLE":this.visitTopLevelVariable(e);break;case"TYPE_PARAMETER":this.visitTypeParameter(e);break;case"UNIT_TEST_GROUP":this.visitUnitTestGroup(e);break;case"UNIT_TEST_TEST":this.visitUnitTestTest(e);break;case"UNKNOWN":this.visitUnknown(e);break;default:this.logger.error(`Unknown Outline item! ${null===(i=null==e?void 0:e.element)||void 0===i?void 0:i.kind} (${null===(n=null==e?void 0:e.element)||void 0===n?void 0:n.name})`)}}visitClass(e){this.visitChildren(e)}visitClassTypeAlias(e){this.visitChildren(e)}visitCompilationUnit(e){this.visitChildren(e)}visitConstructor(e){this.visitChildren(e)}visitContructorInvocation(e){this.visitChildren(e)}visitEnum(e){this.visitChildren(e)}visitEnumConstant(e){this.visitChildren(e)}visitField(e){this.visitChildren(e)}visitFile(e){this.visitChildren(e)}visitFunction(e){this.visitChildren(e)}visitFunctionInvocation(e){this.visitChildren(e)}visitFunctionTypeAlias(e){this.visitChildren(e)}visitGetter(e){this.visitChildren(e)}visitLabel(e){this.visitChildren(e)}visitLibrary(e){this.visitChildren(e)}visitLocalVariable(e){this.visitChildren(e)}visitMixin(e){this.visitChildren(e)}visitMethod(e){this.visitChildren(e)}visitParameter(e){this.visitChildren(e)}visitPrefix(e){this.visitChildren(e)}visitSetter(e){this.visitChildren(e)}visitTopLevelVariable(e){this.visitChildren(e)}visitTypeParameter(e){this.visitChildren(e)}visitUnitTestGroup(e){this.visitChildren(e)}visitUnitTestTest(e){this.visitChildren(e)}visitUnknown(e){this.visitChildren(e)}}t.OutlineVisitor=n;t.TestOutlineVisitor=class extends n{constructor(){super(...arguments),this.tests=[],this.names=[]}visitUnitTestTest(e){this.addTest(e,super.visitUnitTestTest)}visitUnitTestGroup(e){this.addTest(e,super.visitUnitTestGroup)}addTest(e,t){const i=this.extractTestName(e.element.name);if(!i||!e.element.location)return;this.names.push(i);const n=this.names.join(" "),r="UNIT_TEST_GROUP"===e.element.kind;this.tests.push({file:e.element.location.file,fullName:n,isGroup:r,length:e.codeLength||e.element.location.length,offset:e.codeOffset||e.element.location.offset});try{t.bind(this)(e)}finally{this.names.pop()}}extractTestName(e){if(!e)return;const t=e.indexOf("("),i=e.lastIndexOf(")");return-1===t||-1===i||t>=i?void 0:(((e=e.substring(t+2,i-1)).startsWith("'")||e.startsWith('"'))&&(e.endsWith("'")||e.endsWith('"'))&&(e=e.substring(1,e.length-1)),e)}};t.ClassOutlineVisitor=class extends n{constructor(){super(...arguments),this.classes=[]}visitClass(e){this.addClass(e),super.visitClass(e)}visitMixin(e){this.addClass(e),super.visitMixin(e)}addClass(e){e.element&&e.element.location&&e.element.name&&this.classes.push({className:e.element.name,codeLength:e.codeLength,codeOffset:e.codeOffset,length:e.length,offset:e.offset})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LspClassOutlineVisitor=t.LspTestOutlineVisitor=t.LspOutlineVisitor=void 0;class n{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.element&&e.element.kind){case"CLASS":this.visitClass(e);break;case"CLASS_TYPE_ALIAS":this.visitClassTypeAlias(e);break;case"COMPILATION_UNIT":this.visitCompilationUnit(e);break;case"CONSTRUCTOR":this.visitConstructor(e);break;case"CONSTRUCTOR_INVOCATION":this.visitContructorInvocation(e);break;case"ENUM":this.visitEnum(e);break;case"ENUM_CONSTANT":this.visitEnumConstant(e);break;case"FIELD":this.visitField(e);break;case"FILE":this.visitFile(e);break;case"FUNCTION":this.visitFunction(e);break;case"FUNCTION_INVOCATION":this.visitFunctionInvocation(e);break;case"FUNCTION_TYPE_ALIAS":this.visitFunctionTypeAlias(e);break;case"GETTER":this.visitGetter(e);break;case"LABEL":this.visitLabel(e);break;case"LIBRARY":this.visitLibrary(e);break;case"LOCAL_VARIABLE":this.visitLocalVariable(e);break;case"METHOD":this.visitMethod(e);break;case"MIXIN":this.visitMixin(e);break;case"PARAMETER":this.visitParameter(e);break;case"PREFIX":this.visitPrefix(e);break;case"SETTER":this.visitSetter(e);break;case"TOP_LEVEL_VARIABLE":this.visitTopLevelVariable(e);break;case"TYPE_PARAMETER":this.visitTypeParameter(e);break;case"UNIT_TEST_GROUP":this.visitUnitTestGroup(e);break;case"UNIT_TEST_TEST":this.visitUnitTestTest(e);break;case"UNKNOWN":this.visitUnknown(e);break;default:this.logger.error("Unknown Outline item! "+(e&&e.element&&e.element.kind))}}visitClass(e){this.visitChildren(e)}visitClassTypeAlias(e){this.visitChildren(e)}visitCompilationUnit(e){this.visitChildren(e)}visitConstructor(e){this.visitChildren(e)}visitContructorInvocation(e){this.visitChildren(e)}visitEnum(e){this.visitChildren(e)}visitEnumConstant(e){this.visitChildren(e)}visitField(e){this.visitChildren(e)}visitFile(e){this.visitChildren(e)}visitFunction(e){this.visitChildren(e)}visitFunctionInvocation(e){this.visitChildren(e)}visitFunctionTypeAlias(e){this.visitChildren(e)}visitGetter(e){this.visitChildren(e)}visitLabel(e){this.visitChildren(e)}visitLibrary(e){this.visitChildren(e)}visitLocalVariable(e){this.visitChildren(e)}visitMethod(e){this.visitChildren(e)}visitMixin(e){this.visitChildren(e)}visitParameter(e){this.visitChildren(e)}visitPrefix(e){this.visitChildren(e)}visitSetter(e){this.visitChildren(e)}visitTopLevelVariable(e){this.visitChildren(e)}visitTypeParameter(e){this.visitChildren(e)}visitUnitTestGroup(e){this.visitChildren(e)}visitUnitTestTest(e){this.visitChildren(e)}visitUnknown(e){this.visitChildren(e)}}t.LspOutlineVisitor=n;t.LspTestOutlineVisitor=class extends n{constructor(e,t){super(e),this.file=t,this.tests=[],this.names=[]}visitUnitTestTest(e){this.addTest(e,super.visitUnitTestTest)}visitUnitTestGroup(e){this.addTest(e,super.visitUnitTestGroup)}addTest(e,t){const i=this.extractTestName(e.element.name);if(!i||!e.element.range)return;this.names.push(i);const n=this.names.join(" "),r="UNIT_TEST_GROUP"===e.element.kind;this.tests.push({file:this.file,fullName:n,isGroup:r,range:e.codeRange||e.range||(e.element?e.element.range:void 0)});try{t.bind(this)(e)}finally{this.names.pop()}}extractTestName(e){if(!e)return;const t=e.indexOf("("),i=e.lastIndexOf(")");return-1===t||-1===i||t>=i?void 0:e=e.substring(t+2,i-1)}};t.LspClassOutlineVisitor=class extends n{constructor(){super(...arguments),this.classes=[]}visitClass(e){this.addClass(e),super.visitClass(e)}visitMixin(e){this.addClass(e),super.visitMixin(e)}addClass(e){e.element&&e.element.range&&e.element.name&&this.classes.push({className:e.element.name,codeRange:e.codeRange,range:e.range})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugCommands=t.LastTestDebugSession=t.LastDebugSession=t.debugSessions=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(8),l=i(3),u=i(1),d=i(118),h=i(6),f=i(10),g=i(201),p=i(202),m=i(7),v=i(205);t.debugSessions=[];let y=[],b=!1;class C{}t.LastDebugSession=C;class w{}t.LastTestDebugSession=w;t.DebugCommands=class{constructor(e,i,l,d,m){this.logger=e,this.context=i,this.analytics=d,this.debugOptions=o.window.createStatusBarItem(o.StatusBarAlignment.Left,0),this.currentDebugOption=c.DebugOption.MyCode,this.debugMetrics=o.window.createStatusBarItem(o.StatusBarAlignment.Right,0),this.onWillHotReloadEmitter=new o.EventEmitter,this.onWillHotReload=this.onWillHotReloadEmitter.event,this.onWillHotRestartEmitter=new o.EventEmitter,this.onWillHotRestart=this.onWillHotRestartEmitter.event,this.onFirstFrameEmitter=new o.EventEmitter,this.onFirstFrame=this.onFirstFrameEmitter.event,this.onDebugSessionVmServiceAvailableEmitter=new o.EventEmitter,this.onDebugSessionVmServiceAvailable=this.onDebugSessionVmServiceAvailableEmitter.event,this.vmServices=new g.VmServiceExtensions(e,this.sendServiceSetting),this.devTools=new p.DevToolsManager(e,l,this,d,m),i.subscriptions.push(this.devTools),i.subscriptions.push(this.debugOptions),i.subscriptions.push(this.debugMetrics),i.subscriptions.push(o.debug.onDidChangeBreakpoints(e=>this.handleBreakpointChange(e))),i.subscriptions.push(o.debug.onDidStartDebugSession(e=>this.handleDebugSessionStart(e))),i.subscriptions.push(o.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),i.subscriptions.push(o.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),i.subscriptions.push(o.window.onDidChangeActiveTextEditor(e=>this.updateEditorContexts(e))),this.updateEditorContexts(o.window.activeTextEditor),i.subscriptions.push(o.commands.registerCommand("flutter.togglePlatform",()=>this.vmServices.toggle(c.VmServiceExtension.PlatformOverride,"iOS","android"))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugPainting",()=>this.vmServices.toggle(c.VmServiceExtension.DebugPaint))),i.subscriptions.push(o.commands.registerCommand("flutter.togglePerformanceOverlay",()=>this.vmServices.toggle(c.VmServiceExtension.PerformanceOverlay))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleBrightness",()=>this.vmServices.toggle(c.VmServiceExtension.BrightnessOverride,"Brightness.dark","Brightness.light"))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleRepaintRainbow",()=>this.vmServices.toggle(c.VmServiceExtension.RepaintRainbow))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleDebugModeBanner",()=>this.vmServices.toggle(c.VmServiceExtension.DebugBanner))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleCheckElevations",()=>this.vmServices.toggle(c.VmServiceExtension.CheckElevations))),i.subscriptions.push(o.commands.registerCommand("flutter.togglePaintBaselines",()=>this.vmServices.toggle(c.VmServiceExtension.PaintBaselines))),i.subscriptions.push(o.commands.registerCommand("flutter.toggleSlowAnimations",()=>this.vmServices.toggle(c.VmServiceExtension.SlowAnimations,g.timeDilationNormal,g.timeDilationSlow))),i.subscriptions.push(o.commands.registerCommand("flutter.inspectWidget",()=>this.vmServices.toggle(c.VmServiceExtension.InspectorSelectMode,!0,!0))),i.subscriptions.push(o.commands.registerCommand("flutter.cancelInspectWidget",()=>this.vmServices.toggle(c.VmServiceExtension.InspectorSelectMode,!1,!1))),i.subscriptions.push(o.commands.registerCommand("dart.openObservatory",()=>n(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return;const i=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();i&&!i.session.configuration.noDebug&&i.observatoryUri?(yield h.envUtils.openInBrowser(i.observatoryUri),d.logDebuggerOpenObservatory()):i&&e.warn("Cannot start Observatory for session without debug/observatoryUri")})))),i.subscriptions.push(o.commands.registerCommand("flutter.openTimeline",()=>n(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return;const i=1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();i&&!i.session.configuration.noDebug&&i.observatoryUri?(yield h.envUtils.openInBrowser(i.observatoryUri+"/#/timeline-dashboard"),d.logDebuggerOpenTimeline()):i&&e.warn("Cannot start Observatory for session without debug/observatoryUri")})))),i.subscriptions.push(o.commands.registerCommand("_dart.openDevTools.touchBar",()=>o.commands.executeCommand("dart.openDevTools"))),a.devToolsPages.forEach(e=>{i.subscriptions.push(o.commands.registerCommand("dart.openDevTools"+e,t=>n(this,void 0,void 0,(function*(){return t=Object.assign({},t,{page:e.toLowerCase()}),o.commands.executeCommand("dart.openDevTools",t)}))))}),i.subscriptions.push(o.commands.registerCommand("dart.openDevTools",e=>n(this,void 0,void 0,(function*(){if(!t.debugSessions.length)return void o.window.showInformationMessage("You must have an active debug session to start DevTools.");const i=e&&e.debugSessionId?t.debugSessions.find(t=>t.session.id===e.debugSessionId):1===t.debugSessions.length?t.debugSessions[0]:yield this.promptForDebugSession();if(!i)return;const n=!e||!0!==e.triggeredAutomatically,r=f.config.devToolsReuseWindows,s=null==e?void 0:e.page;if(i.vmServiceUri)return this.devTools.spawnForSession(i,{embed:f.config.embedDevTools,reuseWindows:r,notify:n,page:s});i.session.configuration.noDebug?o.window.showInformationMessage("You must start your app with debugging in order to use DevTools."):o.window.showInformationMessage("This debug session is not ready yet.")})))),i.subscriptions.push(o.commands.registerCommand("_flutter.hotReload.touchBar",e=>o.commands.executeCommand("flutter.hotReload",e))),i.subscriptions.push(o.commands.registerCommand("flutter.hotReload",e=>{t.debugSessions.length&&(this.onWillHotReloadEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotReload",e)),d.logDebuggerHotReload())})),i.subscriptions.push(o.commands.registerCommand("flutter.hotRestart",e=>{t.debugSessions.length&&(this.onWillHotRestartEmitter.fire(),t.debugSessions.forEach(t=>t.session.customRequest("hotRestart",e)),d.logDebuggerRestart())})),i.subscriptions.push(o.commands.registerCommand("dart.startDebugging",(e,t)=>{const i=Object.assign({name:"Dart ",noDebug:!1,request:"launch",type:"dart"},t,{program:u.fsPath(e)});o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),i)})),i.subscriptions.push(o.commands.registerCommand("dart.startWithoutDebugging",(e,t)=>{const i=Object.assign({name:"Dart ",noDebug:!0,request:"launch",type:"dart"},t,{program:u.fsPath(e)});o.debug.startDebugging(o.workspace.getWorkspaceFolder(e),i)})),i.subscriptions.push(o.commands.registerCommand("dart.runAllTestsWithoutDebugging",()=>n(this,void 0,void 0,(function*(){const e=h.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=(yield u.findProjectFolders(e,{requirePubspec:!0})).map(e=>s.join(e,"test")).filter(e=>r.existsSync(e));if(0!==t.length)for(const e of t){const t=o.workspace.getWorkspaceFolder(o.Uri.file(e)),i=s.basename(s.dirname(e));o.debug.startDebugging(t,{name:i+" tests",noDebug:!0,program:e,request:"launch",type:"dart"})}else o.window.showErrorMessage("Unable to find any test folders")})))),i.subscriptions.push(o.commands.registerCommand("dart.rerunLastDebugSession",()=>{C.debugConfig?o.debug.startDebugging(C.workspaceFolder,C.debugConfig):o.window.showErrorMessage("There is no previous debug session to run.")})),i.subscriptions.push(o.commands.registerCommand("dart.rerunLastTestDebugSession",()=>{w.debugConfig?o.debug.startDebugging(w.workspaceFolder,w.debugConfig):o.window.showErrorMessage("There is no previous test session to run.")})),i.subscriptions.push(o.commands.registerCommand("dart.attach",()=>{o.debug.startDebugging(void 0,{name:"Dart: Attach to Process",request:"attach",type:"dart"})})),i.subscriptions.push(o.commands.registerCommand("flutter.attachProcess",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Process",request:"attach",type:"dart",vmServiceUri:"${command:dart.promptForVmService}"})})),i.subscriptions.push(o.commands.registerCommand("flutter.attach",()=>{o.debug.startDebugging(void 0,{name:"Flutter: Attach to Device",request:"attach",type:"dart"})})),i.subscriptions.push(o.commands.registerCommand("dart.promptForVmService",e=>n(this,void 0,void 0,(function*(){const t="string"==typeof e?e:void 0;return o.window.showInputBox({ignoreFocusOut:!0,placeHolder:"Paste an VM Service URI",prompt:"Enter VM Service URI",validateInput:e=>{if(e&&(e=e.trim(),!Number.isInteger(parseFloat(e))))return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("ws://")||e.startsWith("wss://")?void 0:"Please enter a valid VM Service URI"},value:t})})))),f.config.debugSdkLibraries&&f.config.debugExternalLibraries?this.currentDebugOption=c.DebugOption.MyCodePackagesSdk:f.config.debugSdkLibraries?this.currentDebugOption=c.DebugOption.MyCodeSdk:f.config.debugExternalLibraries&&(this.currentDebugOption=c.DebugOption.MyCodePackages),i.subscriptions.push(o.commands.registerCommand("_dart.toggleDebugOptions",this.toggleDebugOptions,this)),this.debugOptions.text="Debug "+c.debugOptionNames[this.currentDebugOption],this.debugOptions.tooltip="Controls whether to step into or stop at breakpoints in only files in this workspace or also those in SDK and/or external Pub packages",this.debugOptions.command="_dart.toggleDebugOptions"}handleBreakpointChange(e){if(!b)for(const t of e.added)this.promptAboutDebuggerSettingsIfBreakpointOutsideWorkspace(t)}promptAboutDebuggerSettingsIfBreakpointOutsideWorkspace(e){if(f.config.debugSdkLibraries||f.config.debugExternalLibraries)return;if(b||this.context.breakpointOutsideWorkspaceDoNotShow||!(e instanceof o.SourceBreakpoint)||!e.enabled)return;if(!u.fsPath(e.location.uri).toLocaleLowerCase().endsWith(".dart"))return;if(o.workspace.getWorkspaceFolder(e.location.uri))return;b=!0;o.window.showWarningMessage("You have a breakpoint outside of your workspace but debug settings are set to 'my code'. Would you like to change settings? You can also change this from the status bar while debugging.","Debug just my code","Debug my code + packages + SDK",a.doNotAskAgainAction).then(e=>{e===a.doNotAskAgainAction&&(this.context.breakpointOutsideWorkspaceDoNotShow=!0),"Debug my code + packages + SDK"===e&&(this.currentDebugOption=c.DebugOption.MyCodePackagesSdk,this.applyNewDebugOption())})}handleDebugSessionStart(e){if("dart"!==e.type)return;const i=e.configuration?c.DebuggerType[e.configuration.debuggerType]:"<unknown>",n=new v.DartDebugSessionInformation(e,i);if(0===t.debugSessions.length&&this.vmServices.resetToDefaults(),t.debugSessions.push(n),e.configuration.debuggerType===c.DebuggerType.Flutter||e.configuration.debuggerType===c.DebuggerType.Web){const t=e.configuration.flutterMode;"debug"===t&&o.commands.executeCommand("setContext",a.isInFlutterDebugModeDebugSessionContext,!0),"profile"===t&&o.commands.executeCommand("setContext",a.isInFlutterProfileModeDebugSessionContext,!0)}const r=y.filter(t=>t.session.id===e.id);y=y.filter(t=>t.session.id!==e.id),r.forEach(e=>{this.logger.info(`Processing delayed event ${e.event} for session ${e.session.id}`),this.handleCustomEventWithSession(n,e)}),this.debugOptions.show()}handleDebugSessionCustomEvent(e){if(this.handleCustomEvent(e))return;const i=t.debugSessions.find(t=>t.session.id===e.session.id);if(!i)return this.logger.warn(`Did not find session ${e.session.id} to handle ${e.event}. There were ${t.debugSessions.length} sessions:\n${t.debugSessions.map(e=>"  "+e.session.id).join("\n")}`),this.logger.warn("Event will be queued and processed when the session start event fires"),void y.push(e);this.handleCustomEventWithSession(i,e)}handleDebugSessionEnd(e){var i;const n=t.debugSessions.findIndex(t=>t.session.id===e.id);if(-1===n)return;const r=t.debugSessions[n];r.hasEnded=!0,t.debugSessions.splice(n,1);for(const e of Object.keys(r.progress))null===(i=r.progress[e])||void 0===i||i.complete();const s=new Date;if(this.analytics.logDebugSessionDuration(r.debuggerType,s.getTime()-r.sessionStart.getTime()),0===t.debugSessions.length){this.vmServices.markAllServicesUnloaded(),this.debugOptions.hide(),this.debugMetrics.hide();for(const e of[a.isInFlutterDebugModeDebugSessionContext,a.isInFlutterProfileModeDebugSessionContext])o.commands.executeCommand("setContext",e,!1)}}handleCustomEvent(e){if("dart.log"===e.event){const t=e.body,i=`[${e.session.name}] ${t.message}`;switch(t.severity){case c.LogSeverity.Info:this.logger.info(i,t.category);break;case c.LogSeverity.Warn:this.logger.warn(i,t.category);break;case c.LogSeverity.Error:this.logger.error(i,t.category);break;default:this.logger.warn(`Failed to handle log event [${e.session.name}] ${JSON.stringify(t)}`)}}else if("dart.hotRestartRequest"===e.event)this.analytics.logDebuggerRestart(),this.onWillHotRestartEmitter.fire();else if("dart.hotReloadRequest"===e.event)this.analytics.logDebuggerHotReload(),this.onWillHotReloadEmitter.fire();else if("dart.flutter.firstFrame"===e.event)this.onFirstFrameEmitter.fire();else if("dart.debugMetrics"===e.event){const t=e.body.memory,i=`${Math.ceil(t.current/1024/1024)}MB of ${Math.ceil(t.total/1024/1024)}MB`;this.debugMetrics.text=i,this.debugMetrics.tooltip="This is the amount of memory being consumed by your applications heaps (out of what has been allocated).\n\nNote: memory usage shown in debug builds may not be indicative of usage in release builds. Use profile builds for more accurate figures when testing memory usage.",this.debugMetrics.show()}else{if("dart.navigate"!==e.event)return!1;e.body.file&&e.body.line&&e.body.column&&o.commands.executeCommand("_dart.jumpToLineColInUri",o.Uri.parse(e.body.file),e.body.line,e.body.column,e.body.inOtherEditorColumn)}return!0}handleCustomEventWithSession(e,t){var i,r,s;return n(this,void 0,void 0,(function*(){if(this.vmServices.handleDebugEvent(e,t).catch(e=>this.logger.error(e)),"dart.webLaunchUrl"===t.event){if(!!!t.body.launched)try{const e=o.Uri.parse(t.body.url,!0);yield h.envUtils.openInBrowser(e.toString())}catch(e){this.logger.error("Failed to parse URL from Flutter app.webLaunchUrl event: "+e.body.url)}}else if("dart.exposeUrl"===t.event){const i=t.body.url;try{const t=yield h.envUtils.exposeUrl(o.Uri.parse(i,!0),this.logger);e.session.customRequest("exposeUrlResponse",{originalUrl:i,exposedUrl:t})}catch(t){this.logger.error(`Failed to expose URL ${i}: ${t}`),e.session.customRequest("exposeUrlResponse",{originalUrl:i,exposedUrl:i})}}else if("dart.debuggerUris"===t.event){e.observatoryUri=t.body.observatoryUri,e.vmServiceUri=t.body.vmServiceUri,this.onDebugSessionVmServiceAvailableEmitter.fire(e);const i=e.session.configuration.debuggerType;if(i===c.DebuggerType.Dart||i===c.DebuggerType.Flutter||i===c.DebuggerType.Web)if("never"!==f.config.openDevTools){(i!==c.DebuggerType.Dart||"always"===f.config.openDevTools)&&o.commands.executeCommand("dart.openDevTools",{debugSessionId:e.session.id,triggeredAutomatically:!0})}else i===c.DebuggerType.Flutter&&d.showDevToolsNotificationIfAppropriate(this.context).then(e=>{e.shouldAlwaysOpen&&f.config.setOpenDevTools("flutter")})}else"dart.progressStart"===t.event?o.window.withProgress({location:o.ProgressLocation.Window},i=>{var n,r;null===(n=e.progress[t.body.progressID])||void 0===n||n.complete();const s=new l.PromiseCompleter;return e.progress[t.body.progressID]=new v.ProgressMessage(i,s),null===(r=e.progress[t.body.progressID])||void 0===r||r.report(t.body.message),s.promise}):"dart.progressUpdate"===t.event?null===(i=e.progress[t.body.progressID])||void 0===i||i.report(t.body.message):"dart.progressEnd"===t.event&&(t.body.message&&(null===(r=e.progress[t.body.progressID])||void 0===r||r.report(t.body.message),yield new Promise(e=>setTimeout(e,400))),null===(s=e.progress[t.body.progressID])||void 0===s||s.complete())}))}toggleDebugOptions(){this.currentDebugOption=(this.currentDebugOption+1)%(c.debugOptionNames.length-1),this.applyNewDebugOption()}applyNewDebugOption(){this.debugOptions.text="Debug "+c.debugOptionNames[this.currentDebugOption];const e=this.currentDebugOption===c.DebugOption.MyCodePackages||this.currentDebugOption===c.DebugOption.MyCodePackagesSdk,i=this.currentDebugOption===c.DebugOption.MyCodeSdk||this.currentDebugOption===c.DebugOption.MyCodePackagesSdk;f.config.setGlobalDebugExternalLibraries(e),f.config.setGlobalDebugSdkLibraries(i),t.debugSessions.forEach(t=>{t.session.customRequest("updateDebugOptions",{debugExternalLibraries:e,debugSdkLibraries:i})})}promptForDebugSession(){return n(this,void 0,void 0,(function*(){const e=yield o.window.showQuickPick(t.debugSessions.map(e=>({description:e.session.workspaceFolder?e.session.workspaceFolder.name:void 0,detail:e.session.configuration.deviceName||"Started "+e.sessionStart.toLocaleTimeString(),label:e.session.name,session:e})),{placeHolder:"Which debug session?"});return e&&e.session}))}sendServiceSetting(e){t.debugSessions.forEach(t=>{t.session.customRequest("serviceExtension",e)})}updateEditorContexts(e){const t=!!(e&&e.document&&"file"===e.document.uri.scheme&&m.isValidEntryFile(u.fsPath(e.document.uri)));o.commands.executeCommand("setContext","dart-code:currentFileIsRunnable",t)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.hasOverlappingEdits=t.DasEditCommands=void 0;const r=i(5),s=i(0),o=i(1),a=i(54);function c(e){const t={};for(const i of e.edits){t[i.file]||(t[i.file]=[]);for(const e of i.edits){if(t[i.file].find(t=>t.offset<=e.offset))return!0;t[i.file].push(e)}}return!1}t.DasEditCommands=class{constructor(e,t,i){this.logger=e,this.context=t,this.analyzer=i,this.commands=[],this.commands.push(s.commands.registerCommand("_dart.organizeImports",this.organizeImports,this),s.commands.registerCommand("dart.sortMembers",this.sortMembers,this),s.commands.registerCommand("_dart.applySourceChange",this.applyEdits,this),s.commands.registerCommand("dart.completeStatement",this.completeStatement,this))}getActiveDoc(){return s.window.activeTextEditor&&s.window.activeTextEditor.document}organizeImports(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editOrganizeDirectives,"Organize Imports",e)}sortMembers(e){return e=e||this.getActiveDoc(),this.sendEdit(this.analyzer.editSortMembers,"Sort Members",e)}completeStatement(){return n(this,void 0,void 0,(function*(){const e=s.window.activeTextEditor;if(!e||!e.selection||!this.analyzer.capabilities.hasCompleteStatementFix)return;const t=e.document,i=o.fsPath(t.uri),n=t.offsetAt(e.selection.end),r=yield this.analyzer.editGetStatementCompletion({file:i,offset:n});r&&r.change&&(yield this.applyEdits(t,r.change))}))}sendEdit(e,t,i){return n(this,void 0,void 0,(function*(){if(!i||!a.isDartDocument(i))return void s.window.showWarningMessage("Not a Dart file.");const n=i.version;e=e.bind(this.analyzer);try{const r=(yield e({file:o.fsPath(i.uri)})).edit;if(0===r.edits.length)return;if(i.isClosed)return void s.window.showErrorMessage(`Error running ${t}: Document has been closed.`);if(i.version!==n)return void s.window.showErrorMessage(`Error running ${t}: Document has been modified.`);const a=new s.WorkspaceEdit;r.edits.forEach(e=>{const t=new s.Range(i.positionAt(e.offset),i.positionAt(e.offset+e.length));a.replace(i.uri,t,e.replacement)}),yield s.workspace.applyEdit(a)}catch(e){s.window.showErrorMessage(`Error running ${t}: ${e.message}.`)}}))}dispose(){for(const e of this.commands)e.dispose()}applyEdits(e,t){return n(this,void 0,void 0,(function*(){if(1===t.edits.length&&t.linkedEditGroups&&0!==t.linkedEditGroups.length)return this.applyEditsWithSnippets(e,t);const i=c(t);i&&this.logger.warn("Falling back to sequential edits due to overlapping edits in server.");const n=i;let o=n?void 0:new s.WorkspaceEdit;for(const e of t.edits){const t=s.Uri.file(e.file);if(!r.existsSync(e.file)&&e.edits.find(e=>0!==e.offset||0!==e.length)){this.logger.error(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`),s.window.showErrorMessage(`Unable to edit file ${e.file} because it does not exist and had an edit that was not the start of the file`);continue}const i=r.existsSync(e.file)?yield s.workspace.openTextDocument(t):void 0;o&&o.createFile(t,{ignoreIfExists:!0});for(const r of e.edits){o||(o=new s.WorkspaceEdit,o.createFile(t,{ignoreIfExists:!0}));const e=i?new s.Range(i.positionAt(r.offset),i.positionAt(r.offset+r.length)):new s.Range(new s.Position(0,0),new s.Position(0,0));o.replace(t,e,r.replacement),n&&(yield s.workspace.applyEdit(o),o=void 0)}}if(o&&(yield s.workspace.applyEdit(o)),t.selection){const e=s.Uri.file(t.selection.file),i=yield s.workspace.openTextDocument(e),n=yield s.window.showTextDocument(i),r=i.positionAt(t.selection.offset),o=new s.Selection(r,r);n.selection=o}}))}applyEditsWithSnippets(e,t){return n(this,void 0,void 0,(function*(){const i=t.edits[0],n=yield s.workspace.openTextDocument(i.file),r=yield s.window.showTextDocument(n);yield r.edit(e=>{i.edits.forEach(t=>{e.replace(new s.Range(n.positionAt(t.offset),n.positionAt(t.offset+t.length)),t.replacement)})});const o=r.document.getText(),a=[];let c=1;t.linkedEditGroups.forEach(e=>{e.positions.forEach(t=>{const i=o.substr(t.offset,e.length);let n=e.suggestions?e.suggestions.map(e=>e.value):void 0;i&&n&&-1===n.indexOf(i)&&(n=[i,...n]),a.push({offset:t.offset,length:e.length,defaultValue:i,choices:n,placeholderNumber:c})}),c++}),a.sort((e,t)=>e.offset-t.offset);const l=new s.SnippetString,u=a[0],d=a[a.length-1],h=u.offset,f=d.offset+d.length;let g=h;a.forEach(e=>{g!==e.offset&&l.appendText(o.substring(g,e.offset)),e.choices&&e.choices.length>1?l.appendChoice(e.choices,e.placeholderNumber):l.appendPlaceholder(e.defaultValue,e.placeholderNumber),g=e.offset+e.length}),yield r.insertSnippet(l,new s.Range(n.positionAt(h),n.positionAt(f))),yield s.window.showTextDocument(e)}))}snippetStringEscape(e){return e.replace(/\$|}|\\|,/g,"\\$&")}},t.hasOverlappingEdits=c},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getKindFor=t.RankingCodeActionProvider=void 0;const r=i(0),s=i(3),o=i(21);t.RankingCodeActionProvider=class{constructor(){this.codeActionProviders=[]}registerProvider(e){this.codeActionProviders.push(e),o.sortBy(this.codeActionProviders,e=>e.rank)}get metadata(){const e=s.flatMap(this.codeActionProviders,e=>e.metadata.providedCodeActionKinds||[]);return{providedCodeActionKinds:s.uniq(e)}}provideCodeActions(e,t,i,o){return n(this,void 0,void 0,(function*(){const n=this.codeActionProviders.filter(t=>r.languages.match(t.selector,e)).map(n=>n.provideCodeActions(e,t,i,o)),a=yield Promise.all(n);return s.flatMap(a,e=>e||[])}))}},t.getKindFor=function(e,t){if(!e)return t;const i=e.replace("dart.assist.","").replace("dart.fix.","").replace("analysisOptions.assist.","").replace("analysisOptions.fix.","");return t.append(i)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartDiagnostic=t.DartDiagnosticProvider=void 0;const n=i(0),r=i(6),s=i(10);class o{constructor(e,t){this.analyzer=e,this.diagnostics=t,this.analyzer.registerForAnalysisErrors(e=>this.handleErrors(e)),this.analyzer.registerForAnalysisFlushResults(e=>this.flushResults(e))}handleErrors(e){const t=JSON.stringify(e);if(this.lastErrorJson===t)return;let i=e.errors;s.config.showTodos||(i=i.filter(e=>"TODO"!==e.type)),this.diagnostics.set(n.Uri.file(e.file),i.map(e=>o.createDiagnostic(e))),this.lastErrorJson=t}static createDiagnostic(e){const t=new a(r.toRangeOnLine(e.location),e.message,o.getSeverity(e.severity,e.type),e.type);return t.code=e.url?{value:e.code,target:n.Uri.parse(e.url)}:e.code,t.source="dart",t.tags=o.getTags(e),e.correction&&(t.message+="\n"+e.correction),e.contextMessages&&e.contextMessages.length&&(t.relatedInformation=e.contextMessages.map(o.createRelatedInformation)),t}static createRelatedInformation(e){return new n.DiagnosticRelatedInformation(new n.Location(n.Uri.file(e.location.file),r.toRangeOnLine(e.location)),e.message)}static getSeverity(e,t){switch(e){case"ERROR":return n.DiagnosticSeverity.Error;case"WARNING":return n.DiagnosticSeverity.Warning;case"INFO":switch(t){case"TODO":default:return n.DiagnosticSeverity.Information}default:throw new Error("Unknown severity type: "+e)}}static getTags(e){const t=[];return"dead_code"!==e.code&&"unused_local_variable"!==e.code&&"unused_import"!==e.code||t.push(n.DiagnosticTag.Unnecessary),"deprecated_member_use"!==e.code&&"deprecated_member_use_from_same_package"!==e.code||t.push(n.DiagnosticTag.Deprecated),t}flushResults(e){this.lastErrorJson=void 0;const t=e.files.map(e=>[n.Uri.file(e),void 0]);this.diagnostics.set(t)}}t.DartDiagnosticProvider=o;class a extends n.Diagnostic{constructor(e,t,i,n){super(e,t,i),this.type=n}}t.DartDiagnostic=a},,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stripMarkdown=t.cleanDartdoc=void 0;const n=i(3),r=new RegExp(`(?:${n.escapeRegExp("<p>")})?`+n.escapeRegExp('<i class="material-icons md-36">')+"([\\w\\s_]+)"+n.escapeRegExp('</i> &#x2014; material icon named "')+"([\\w\\s_]+)"+n.escapeRegExp('".')+`(?:${n.escapeRegExp("</p>")})?`,"gi"),s=new RegExp("(\\n\\s*{@.*?}$)|(^{@.*?}\\s*\\n)|(^{@.*?}$)","gim"),o=new RegExp("(```\\w+) +\\w+","gi");t.cleanDartdoc=function(e,t){if(!e)return"";const i=e.indexOf("## Other resources");-1!==i&&(e=e.substring(0,i)),e=e.replace(/\[:\S+:\]/g,e=>`[${e.substring(2,e.length-2)}]`);const n=t.replace("$1","material/$1");return e=(e=(e=e.replace(r,`![$1](${n}|width=32,height=32)`)).replace(s,"")).replace(o,"$1")},t.stripMarkdown=function(e){return e?e=(e=e.replace(/\[(.+?)\]\(.+?\)/g,"$1")).replace(/\[(.+?)\]/g,"$1"):""}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createFlutterSampleInTempFolder=void 0;const n=i(5),r=i(18),s=i(2),o=i(0),a=i(4),c=i(1),l=i(109);t.createFlutterSampleInTempFolder=function(e,t,i){if(!e.supportsCreatingSamples)return void o.window.showErrorMessage("Opening sample projects requires Flutter v1.0 or later");const u=s.join(r.tmpdir(),a.dartCodeExtensionIdentifier,"flutter","sample",t,c.getRandomInt(4096,65536).toString(16));c.mkDirRecursive(u),n.writeFileSync(s.join(u,a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),t),i&&l.writeFlutterSdkSettingIntoProject(i,u);const d=!(!o.workspace.workspaceFolders||!o.workspace.workspaceFolders.length),h=o.Uri.file(u);return o.commands.executeCommand("vscode.openFolder",h,d),h}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeSettingIntoProject=t.writeFlutterSdkSettingIntoProject=t.writeDartSdkSettingIntoProject=void 0;const n=i(5),r=i(2);function s(e,t){const i=r.join(e,".vscode"),s=r.join(i,"settings.json");n.existsSync(i)||n.mkdirSync(i),n.existsSync(s)||n.writeFileSync(s,JSON.stringify(t,void 0,4))}t.writeDartSdkSettingIntoProject=function(e,t){s(t,{"dart.sdkPath":e})},t.writeFlutterSdkSettingIntoProject=function(e,t){s(t,{"dart.flutterSdkPath":e})},t.writeSettingIntoProject=s},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Analyzer=void 0;const r=i(91),s=i(3),o=i(30);t.Analyzer=class{constructor(e){this.logger=e,this.disposables=[],this.onReadyCompleter=new s.PromiseCompleter,this.onReady=this.onReadyCompleter.promise,this.onAnalysisCompleteCompleter=new s.PromiseCompleter,this.onInitialAnalysis=this.onAnalysisCompleteCompleter.promise,this.onAnalysisStatusChangeEmitter=new r.EventEmitter,this.onAnalysisStatusChange=this.onAnalysisStatusChangeEmitter.event,this.isAnalyzing=!1,this.disposables.push(this.onAnalysisStatusChangeEmitter),this.setup()}get onCurrentAnalysisComplete(){return this.isAnalyzing?this.onAnalysisCompleteCompleter.promise:o.resolvedPromise}get onNextAnalysisComplete(){return this.onAnalysisCompleteCompleter.promise}setup(){return n(this,void 0,void 0,(function*(){yield this.onReady,this.onAnalysisStatusChange.listen(e=>{this.isAnalyzing=e.isAnalyzing,e.isAnalyzing||(this.onAnalysisCompleteCompleter.resolve(),this.onAnalysisCompleteCompleter=new s.PromiseCompleter)})}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nullToUndefined=void 0,t.nullToUndefined=function(e){return null===e?void 0:e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAnalyzerArgs=void 0;const n=i(5),r=i(2),s=i(0),o=i(4),a=i(19),c=i(6),l=i(10);t.getAnalyzerArgs=function(e,t,i,u){const d=l.config.analyzerPath||r.join(t.dart,o.analyzerSnapshotPath);if(!l.config.analyzerSshHost&&!n.existsSync(d)){const t="Could not find a Dart Analysis Server at "+d;throw s.window.showErrorMessage(t),e.error(t),new Error(t)}return function(e,t,i){let n=[];l.config.analyzerVmServicePort&&(n.push("--enable-vm-service="+l.config.analyzerVmServicePort),n.push("-DSILENT_OBSERVATORY=true"),n.push("--disable-service-auth-codes"),s.window.showInformationMessage("The Dart Analysis server is running with the debugger accessible. Please disable (unset the `dart.analyzerVmServicePort` setting) when no longer required."));n.push(e),i&&n.push("--lsp");l.config.analyzerDiagnosticsPort&&n.push("--port="+l.config.analyzerDiagnosticsPort);const r=c.isRunningLocally?"VS-Code":"VS-Code-Remote";n.push("--client-id="+r),n.push("--client-version="+a.extensionVersion),l.config.analyzerInstrumentationLogFile&&n.push("--instrumentation-log-file="+l.config.analyzerInstrumentationLogFile);l.config.analyzerAdditionalArgs&&(n=n.concat(l.config.analyzerAdditionalArgs));return n}(d,0,u)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);class r extends n.CompletionItem{constructor(e){super(e)}}t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);class r extends n.CodeLens{constructor(e){super(e)}}t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0);class r extends n.DocumentLink{constructor(e,t){super(e,t)}}t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}}class r extends n{constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}}function s(){return new r}r._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"],r._timeHighBits=["8","9","a","b"],t.empty=new n("00000000-0000-0000-0000-000000000000"),t.v4=s;const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function a(e){return o.test(e)}t.isUUID=a,t.parse=function(e){if(!a(e))throw new Error("invalid uuid");return new n(e)},t.generateUuid=function(){return s().asHex()}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(53);t.ProgressPart=class{constructor(e,t){this._client=e,this._token=t,this._reported=0,this._disposable=this._client.onProgress(r.WorkDoneProgress.type,this._token,e=>{switch(e.kind){case"begin":this.begin(e);break;case"report":this.report(e);break;case"end":this.done()}})}begin(e){let t=e.cancellable?n.ProgressLocation.Notification:n.ProgressLocation.Window;n.window.withProgress({location:t,cancellable:e.cancellable,title:e.title},async(t,i)=>(this._progress=t,this._infinite=void 0===e.percentage,this._cancellationToken=i,this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(r.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((e,t)=>{this._resolve=e,this._reject=t})))}report(e){if(this._infinite&&s.string(e.message))this._progress.report({message:e.message});else if(s.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),i=Math.max(0,t-this._reported);this._progress.report({message:e.message,increment:i}),this._reported+=i}}cancel(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._reject&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this._disposable&&(this._disposable.dispose(),this._disposable=void 0),this._resolve&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.showDevToolsNotificationIfAppropriate=t.showFlutterSurveyNotificationIfAppropriate=void 0;const r=i(5),s=i(18),o=i(2),a=i(0),c=i(4);t.showFlutterSurveyNotificationIfAppropriate=function(e,t,i,l,u){return n(this,void 0,void 0,(function*(){let d;try{const e=yield t.fetch(c.flutterSurveyDataUrl),i=JSON.parse(e);if(d=Object.assign(Object.assign({},i),{endDate:new Date(i.endDate).getTime(),startDate:new Date(i.startDate).getTime()}),!d.uniqueId||!d.title||!d.url)throw new Error("Survey data did not include ID, Title or URL:\n"+e)}catch(e){return u.error(e),!1}if(l<=d.startDate||l>=d.endDate)return!1;const h=e.getFlutterSurveyNotificationLastShown(d.uniqueId);if(e.getFlutterSurveyNotificationDoNotShow(d.uniqueId))return!1;if(h&&l-h<c.longRepeatPromptThreshold)return!1;let f;try{const e=c.isWin&&process.env.APPDATA||s.homedir(),t=o.join(e,".flutter");if(r.existsSync(t)){const e=r.readFileSync(t).toString(),i=JSON.parse(e);!1!==i.enabled&&(f=i.clientId)}}catch(e){u.warn("Unable to read Flutter settings for preparing survey link")}const g=f?`${d.title} ${c.flutterSurveyAnalyticsText}`:d.title,p=-1!==d.url.indexOf("?")?"&":"?",m=`${d.url}${p}Source=VSCode${f?"&ClientID="+encodeURIComponent(f):""}`;return e.setFlutterSurveyNotificationLastShown(d.uniqueId,Date.now()),a.window.showInformationMessage(g,c.takeSurveyAction,c.skipThisSurveyAction).then(t=>n(this,void 0,void 0,(function*(){t===c.skipThisSurveyAction?e.setFlutterSurveyNotificationDoNotShow(d.uniqueId,!0):t===c.takeSurveyAction&&(e.setFlutterSurveyNotificationDoNotShow(d.uniqueId,!0),yield i(m))}))),!0}))},t.showDevToolsNotificationIfAppropriate=function(e){return n(this,void 0,void 0,(function*(){const t=e.devToolsNotificationLastShown;if(e.devToolsNotificationDoNotShow)return{didOpen:!1};if(t&&Date.now()-t<c.noRepeatPromptThreshold)return{didOpen:!1};e.devToolsNotificationLastShown=Date.now();const i=yield a.window.showInformationMessage(c.wantToTryDevToolsPrompt,c.openDevToolsAction,c.alwaysOpenAction,c.notTodayAction,c.doNotAskAgainAction);return i===c.doNotAskAgainAction?(e.devToolsNotificationDoNotShow=!0,{didOpen:!1}):i===c.alwaysOpenAction?(a.commands.executeCommand("dart.openDevTools"),{didOpen:!0,shouldAlwaysOpen:!0}):i===c.openDevToolsAction?(a.commands.executeCommand("dart.openDevTools"),{didOpen:!0}):{didOpen:!1}}))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterOutlineCommands=t.flutterOutlineCommands=void 0;const n=i(0);t.flutterOutlineCommands=["refactor.flutter.wrap.center","refactor.flutter.wrap.padding","refactor.flutter.wrap.column","refactor.flutter.move.up","refactor.flutter.move.down","refactor.flutter.removeWidget"];t.FlutterOutlineCommands=class{constructor(e,i){this.tree=e;for(const e of t.flutterOutlineCommands)i.subscriptions.push(n.commands.registerCommand("_flutter.outline."+e,()=>this.applyRefactoring(e)))}applyRefactoring(e){if(!this.tree.selection||1!==this.tree.selection.length)return void console.error("Invalid selection when running Flutter Outline refactor: "+e);const t=this.tree.selection[0].fixes.filter(e=>e.command).find(t=>t.kind&&t.kind.value.endsWith(e));t?t.command&&t.command.arguments?n.commands.executeCommand(t.command.command,...t.command.arguments):console.error("Flutter Outline fix was missing command/arguments"):console.error("Unable to find command for Flutter Outline: "+e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findNearestOutlineNode=void 0,t.findNearestOutlineNode=function(e,t,i,n=!1,r=["CLASS","METHOD","GETTER","SETTER"]){const s=e.getOutlineFor(t.uri);return s&&function e(t,i,n,r){if(!t)return;for(const s of t){const t=s.offset,o=s.offset+s.length;if(t>i||o<i)continue;const a=!n||!s.element||!s.element.location||i>=t&&i<=s.element.location.offset+s.element.location.length;return e(s.children,i,n,r)||(-1!==r.indexOf(s.element.kind)&&a?s:void 0)}}([s],t.offsetAt(i),n,r)}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingCommands=t.isLogging=void 0;const r=i(2),s=i(0),o=i(4),a=i(8),c=i(13),l=i(3),u=i(1),d=i(10),h=i(7),f=i(122);t.isLogging=!1;t.LoggingCommands=class{constructor(e,t){this.logger=e,this.extensionLogPath=t,this.disposables=[],this.disposables.push(s.commands.registerCommand("dart.startLogging",this.startLogging,this),s.commands.registerCommand("dart.openExtensionLog",this.openExtensionLog,this),s.commands.registerCommand("dart.stopLogging",this.stopLogging,this))}startLogging(){return n(this,void 0,void 0,(function*(){const e=r.join(u.forceWindowsDriveLetterToUppercase(this.extensionLogPath),this.generateFilename()),i=s.Uri.file(e);h.createFolderForFile(e);const n=yield s.window.showQuickPick(Object.keys(f.userSelectableLogCategories).map(e=>({label:e,logCategory:f.userSelectableLogCategories[e],picked:!0})),{canPickMany:!0,placeHolder:"Select which categories to include in the log"});if(!n||!n.length)return;const g=[a.LogCategory.General].concat(n.map(e=>e.logCategory)),p=c.captureLogs(this.logger,u.fsPath(i),f.getLogHeader(),d.config.maxLogLineLength,g);t.isLogging=!0,this.disposables.push(p),s.commands.executeCommand("setContext",o.DART_IS_CAPTURING_LOGS_CONTEXT,!0);const m=new l.PromiseCompleter;this.currentLogCompleter=m,yield s.window.withProgress({cancellable:!0,location:s.ProgressLocation.Notification,title:"Dart and Flutter logs are being captured. Reproduce your issue then click Cancel."},(e,t)=>(t.onCancellationRequested(()=>m.resolve()),m.promise)),t.isLogging=!1,yield p.dispose();const v=yield s.workspace.openTextDocument(i);return yield s.window.showTextDocument(v),e}))}openExtensionLog(){return n(this,void 0,void 0,(function*(){const e=yield s.workspace.openTextDocument(s.Uri.file(f.getExtensionLogPath()));yield s.window.showTextDocument(e)}))}stopLogging(){return n(this,void 0,void 0,(function*(){this.currentLogCompleter&&this.currentLogCompleter.resolve()}))}generateFilename(){const e=e=>("0"+e.toString()).slice(-2),t=new Date;return`Dart-Code-Log-${`${t.getFullYear()}-${e(t.getMonth())}-${e(t.getDay())} ${e(t.getHours())}-${e(t.getMinutes())}-${e(t.getSeconds())}`}.txt`}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addToLogHeader=t.getLogHeader=t.clearLogHeader=t.userSelectableLogCategories=t.getExtensionLogPath=void 0;const n=i(18),r=i(2),s=i(4),o=i(8),a=i(1),c=i(10);let l;t.getExtensionLogPath=function(){return l=l||c.config.extensionLogFile||r.join(process.env.DC_TEST_LOGS||n.tmpdir(),`dart-code-startup-log-${a.getRandomInt(4096,65536).toString(16)}.txt`),l},t.userSelectableLogCategories={"Analysis Server":o.LogCategory.Analyzer,"Command Processes":o.LogCategory.CommandProcesses,"Debugger and VM Service":o.LogCategory.VmService,DevTools:o.LogCategory.DevTools,"Flutter Device Daemon":o.LogCategory.FlutterDaemon,"Flutter Run":o.LogCategory.FlutterRun,"Flutter Test":o.LogCategory.FlutterTest,"Pub Run Test":o.LogCategory.PubTest,"Web Daemon":o.LogCategory.WebDaemon};const u=[];t.clearLogHeader=function(){u.length=0},t.getLogHeader=function(){return u.length?u.join(s.platformEol)+s.platformEol+s.platformEol:""},t.addToLogHeader=function(e){try{u.push(e().replace(/\r/g,"").replace(/\n/g,"\r\n"))}catch(e){}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.markProjectCreationEnded=t.markProjectCreationStarted=t.SdkCommands=void 0;const r=i(5),s=i(18),o=i(2),a=i(0),c=i(0),l=i(4),u=i(8),d=i(13),h=i(3),f=i(21),g=i(107),p=i(1),m=i(109),v=i(108),y=i(6),b=i(10),C=i(49),w=i(211),S=i(212),T=i(213),E=i(214),P=i(7),R=i(15),D=i(61),k=new RegExp("^[a-z][a-z0-9_]*$");let x,F,O=!1,_=0;t.SdkCommands=class{constructor(e,t,i,n,r,s,o){this.logger=e,this.context=t,this.workspace=i,this.sdkUtils=n,this.pubGlobal=r,this.flutterCapabilities=s,this.deviceManager=o,this.runningCommands={},this.sdks=i.sdks;const c=new E.DartSdkManager(this.logger,this.workspace.sdks);if(t.subscriptions.push(a.commands.registerCommand("dart.changeSdk",()=>c.changeSdk())),i.hasAnyFlutterProjects){const e=new E.FlutterSdkManager(this.logger,i.sdks);t.subscriptions.push(a.commands.registerCommand("dart.changeFlutterSdk",()=>e.changeSdk()))}t.subscriptions.push(a.commands.registerCommand("dart.getPackages",this.getPackages,this)),t.subscriptions.push(a.commands.registerCommand("dart.listOutdatedPackages",this.listOutdatedPackages,this)),t.subscriptions.push(a.commands.registerCommand("dart.upgradePackages",this.upgradePackages,this)),t.subscriptions.push(a.commands.registerCommand("pub.get",e=>a.commands.executeCommand("dart.getPackages",e))),t.subscriptions.push(a.commands.registerCommand("pub.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("pub.outdated",e=>a.commands.executeCommand("dart.listOutdatedPackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.get",this.flutterGetPackages,this)),t.subscriptions.push(a.commands.registerCommand("flutter.clean",this.flutterClean,this)),t.subscriptions.push(a.commands.registerCommand("_flutter.screenshot.touchBar",e=>a.commands.executeCommand("flutter.screenshot",e))),t.subscriptions.push(a.commands.registerCommand("flutter.screenshot",this.flutterScreenshot,this)),t.subscriptions.push(a.commands.registerCommand("flutter.packages.upgrade",e=>a.commands.executeCommand("dart.upgradePackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.packages.outdated",e=>a.commands.executeCommand("dart.listOutdatedPackages",e))),t.subscriptions.push(a.commands.registerCommand("flutter.doctor",this.flutterDoctor,this)),t.subscriptions.push(a.commands.registerCommand("flutter.upgrade",this.flutterUpgrade,this)),t.subscriptions.push(a.commands.registerCommand("flutter.createProject",this.createFlutterProject,this)),t.subscriptions.push(a.commands.registerCommand("_dart.flutter.createSampleProject",this.createFlutterSampleProject,this)),t.subscriptions.push(a.commands.registerCommand("dart.createProject",this.createDartProject,this)),t.subscriptions.push(a.commands.registerCommand("_dart.create",this.dartCreate,this)),t.subscriptions.push(a.commands.registerCommand("_flutter.create",this.flutterCreate,this)),t.subscriptions.push(a.commands.registerCommand("_flutter.clean",this.flutterClean,this)),this.setupPubspecWatcher(t)}getPackages(e){return n(this,void 0,void 0,(function*(){if(e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to get packages for")))return"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["pub","get"],e):this.runPub(["get"],e)}))}listOutdatedPackages(e){return n(this,void 0,void 0,(function*(){if(e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to check for outdated packages")))return"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["pub","outdated"],e,!0):this.runPub(["outdated"],e,!0)}))}upgradePackages(e){return n(this,void 0,void 0,(function*(){return e&&e instanceof c.Uri||(e=yield this.getFolderToRunCommandIn("Select which folder to upgrade packages in")),"string"==typeof e&&(e=a.Uri.file(e)),P.isInsideFlutterProject(e)?this.runFlutter(["pub","upgrade"],e):this.runPub(["upgrade"],e)}))}flutterGetPackages(e){return n(this,void 0,void 0,(function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter packages get" in',e);if(!t)return;e=a.Uri.file(t)}return e&&p.fsPath(e)===this.workspace.sdks.flutter?this.runFlutter(["update-packages"],e):this.runFlutter(["pub","get"],e)}))}flutterClean(e){return n(this,void 0,void 0,(function*(){if(!e){const t=yield this.getFolderToRunCommandIn('Select the folder to run "flutter clean" in',e,!0);if(!t)return;e=a.Uri.file(t)}return this.runFlutter(["clean"],e)}))}flutterScreenshot(){return n(this,void 0,void 0,(function*(){let e=!1;if((!this.flutterScreenshotPath||b.config.flutterScreenshotPath&&this.flutterScreenshotPath!==b.config.flutterScreenshotPath)&&(this.flutterScreenshotPath=b.config.flutterScreenshotPath,e=!0),!this.flutterScreenshotPath){const t=yield c.window.showOpenDialog({canSelectFolders:!0,openLabel:"Set screenshots folder"});if(!(t&&t.length>0))return;this.flutterScreenshotPath=t[0].path,e=!0}p.mkDirRecursive(this.flutterScreenshotPath);const t=this.deviceManager&&this.deviceManager.currentDevice?this.deviceManager.currentDevice.id:void 0,i=t?["screenshot","-d",t]:["screenshot"];if(yield this.runFlutterInFolder(this.flutterScreenshotPath,i,"screenshot",!0),e){(yield a.window.showInformationMessage("Screenshots will be saved to "+this.flutterScreenshotPath,"Show Folder"))&&(yield a.commands.executeCommand("revealFileInOS",c.Uri.file(this.flutterScreenshotPath)))}}))}dartCreate(e,t){const i=["global","run","stagehand",t];return this.runPubInFolder(e,i,t)}flutterDoctor(){var e,t;if(!this.workspace.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.doctor");const i=o.join(s.tmpdir(),"dart-code-cmd-run");return r.existsSync(i)||r.mkdirSync(i),this.runFlutterInFolder(i,["doctor","-v"],"flutter",!0,(null===(e=this.workspace.config)||void 0===e?void 0:e.flutterDoctorScript)||(null===(t=this.workspace.config)||void 0===t?void 0:t.flutterScript))}flutterUpgrade(){return n(this,void 0,void 0,(function*(){if(!this.workspace.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.upgrade");const e=o.join(s.tmpdir(),"dart-code-cmd-run");r.existsSync(e)||r.mkdirSync(e),yield this.runFlutterInFolder(e,["upgrade"],"flutter",!0),yield P.promptToReloadExtension()}))}flutterCreate(e,t,i){return n(this,void 0,void 0,(function*(){if(!e&&!(e=yield this.getFolderToRunCommandIn('Select the folder to run "flutter create" in',void 0,!0)))return;const n=["create"];return b.config.flutterCreateOffline&&n.push("--offline"),t&&(n.push("--project-name"),n.push(t)),b.config.flutterCreateOrganization&&(n.push("--org"),n.push(b.config.flutterCreateOrganization)),b.config.flutterCreateIOSLanguage&&(n.push("--ios-language"),n.push(b.config.flutterCreateIOSLanguage)),b.config.flutterCreateAndroidLanguage&&(n.push("--android-language"),n.push(b.config.flutterCreateAndroidLanguage)),b.config.flutterAndroidX&&n.push("--androidx"),i&&(n.push("--sample"),n.push(i),n.push("--overwrite")),n.push("."),this.runFlutterInFolder(e,n,t)}))}setupPubspecWatcher(e){e.subscriptions.push(a.workspace.onWillSaveTextDocument(e=>{"pubspec.yaml"===o.basename(p.fsPath(e.document.uri)).toLowerCase()&&(F=e.reason)}));const t=a.workspace.createFileSystemWatcher("**/pubspec.yaml");e.subscriptions.push(t),t.onDidChange(this.handlePubspecChange,this),t.onDidCreate(this.handlePubspecChange,this)}handlePubspecChange(e){const t=p.fsPath(e);if(-1!==t.indexOf(o.sep+".")||-1!==t.indexOf(`${o.sep}build${o.sep}`))return void this.logger.info("Skipping pubspec change for ignored folder "+t);this.logger.info(`Pubspec ${t} was modified`);if(!b.config.for(e).runPubGetOnPubspecChanges)return void this.logger.info('Automatically running "pub get" is disabled');if(this.workspace.config.disableAutomaticPackageGet)return void this.logger.info('Workspace suppresses automatic "pub get"');if(_>0)return void this.logger.info("Skipping package fetch because project creation is in progress");x&&clearTimeout(x);const i=F===a.TextDocumentSaveReason.FocusOut||F===a.TextDocumentSaveReason.AfterDelay?1e4:1e3;x=setTimeout(()=>{x=void 0,F=void 0,this.fetchPackagesOrPrompt(e)},i)}fetchPackagesOrPrompt(e,t){return n(this,void 0,void 0,(function*(){if(O)this.logger.info("Already running pub get, skipping!");else{O=!0;try{const i=t&&t.alwaysPrompt,n=y.getDartWorkspaceFolders().map(e=>p.fsPath(e.uri)),r=yield p.findProjectFolders(n,{requirePubspec:!0}),s=h.uniq(r).map(a.Uri.file).filter(e=>b.config.for(e).promptToGetPackages).filter(w.isPubGetProbablyRequired);this.logger.info(`Found ${s.length} folders requiring "pub get":${s.map(e=>"\n    "+p.fsPath(e)).join("")}`),i||0!==s.length?i||1!==s.length?s.length&&w.promptToRunPubGet(s):yield a.commands.executeCommand("dart.getPackages",s[0]):yield a.commands.executeCommand("dart.getPackages",e)}finally{O=!1}}}))}runCommandForWorkspace(e,t,i,r,s=!1){return n(this,void 0,void 0,(function*(){const n=yield this.getFolderToRunCommandIn(t,r);if(!n)return;const c=a.workspace.getWorkspaceFolder(a.Uri.file(n));if(!c)throw this.logger.error("Failed to get workspace folder for "+n),new Error("Failed to get workspace folder for "+n);const l=p.fsPath(c.uri),u=o.relative(l,n)||o.basename(n);return e(n,i,u,s)}))}getFolderToRunCommandIn(e,t,i=!1){return n(this,void 0,void 0,(function*(){let n=t&&p.fsPath(t);n=n||a.window.activeTextEditor&&p.fsPath(a.window.activeTextEditor.document.uri);const r=n&&C.locateBestProjectRoot(n);if(r)return r;const s=y.getDartWorkspaceFolders().map(e=>p.fsPath(e.uri)),o=(yield p.findProjectFolders(s,{requirePubspec:!0,sort:!0})).filter(i?P.isFlutterProjectFolder:()=>!0);if(o&&o.length)return this.showFolderPicker(o,e);{const e=i?"Flutter":"Dart/Flutter";a.window.showWarningMessage(`No ${e} projects were found.`)}}))}showFolderPicker(e,t){return n(this,void 0,void 0,(function*(){if(1===e.length)return e[0];const i=e.map(e=>{const t=a.workspace.getWorkspaceFolder(c.Uri.file(e));if(!t)return;const i=o.dirname(p.fsPath(t.uri));return{description:P.homeRelativePath(i),label:o.relative(i,e),path:e}}).filter(h.notUndefined),n=yield a.window.showQuickPick(i,{placeHolder:t});return n&&n.path}))}runFlutter(e,t,i=!1){return this.runCommandForWorkspace(this.runFlutterInFolder.bind(this),`Select the folder to run "flutter ${e.join(" ")}" in`,e,t,i)}runFlutterInFolder(e,t,i,n=!1,r){if(!this.sdks.flutter)throw new Error("Flutter SDK not available");const{binPath:s,binArgs:c}=h.usingCustomScript(o.join(this.sdks.flutter,l.flutterPath),t,r),u=R.getGlobalFlutterArgs().concat(b.config.for(a.Uri.file(e)).flutterAdditionalArgs).concat(c);return this.runCommandInFolder(i,e,s,u,n)}runPub(e,t,i=!1){return this.runCommandForWorkspace(this.runPubInFolder.bind(this),`Select the folder to run "pub ${e.join(" ")}" in`,e,t,i)}runPubInFolder(e,t,i,n=!1){if(!this.sdks.dart)throw new Error("Flutter SDK not available");const r=o.join(this.sdks.dart,l.pubPath);return t=t.concat(...b.config.for(a.Uri.file(e)).pubAdditionalArgs),this.runCommandInFolder(i,e,r,t,n)}runCommandInFolder(e,t,i,n,r){e=e||o.basename(t);const s=o.basename(i).split(".")[0],l=D.createChannel(`${s} (${e})`);r&&l.show();const h=`${t}|${s}|${n}`,f=this.runningCommands[h];return f&&!f.hasStarted?Promise.resolve(void 0):a.window.withProgress({cancellable:!0,location:c.ProgressLocation.Notification,title:`${s} ${n.join(" ")}`},(r,o)=>{f?(r.report({message:"terminating previous command..."}),f.cancel()):l.clear();const a=new A(()=>{l.appendLine(`[${e}] ${s} ${n.join(" ")}`),r.report({message:"running..."});const o=R.safeToolSpawn(t,i,n);D.runProcessInChannel(o,l),this.logger.info(`(PROC ${o.pid}) Spawned ${i} ${n.join(" ")} in ${t}`,u.LogCategory.CommandProcesses),d.logProcess(this.logger,u.LogCategory.CommandProcesses,o);const a=new Promise(e=>o.on("close",e)),c=new Promise(e=>setTimeout(()=>e(!0),1e4));return Promise.race([a,c]).then(e=>{e&&l.show(!0)}),o},f);return this.runningCommands[h]=a,o.onCancellationRequested(()=>a.cancel()),a.completed})}createDartProject(){return n(this,void 0,void 0,(function*(){return this.createStagehandProject("dart.createProject",l.DART_STAGEHAND_PROJECT_TRIGGER_FILE,!1)}))}createStagehandProject(e,t,i,s){return n(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.dart)return void this.sdkUtils.showDartActivationFailure(e);const n=new S.Stagehand(this.logger,this.sdks,this.pubGlobal);if(!(yield n.promptToInstallIfRequired()))return;let l;try{l=yield n.getTemplates()}catch(e){return void a.window.showErrorMessage("Unable to execute Stagehand. "+e)}const u=s?l.filter(s):l,d=f.sortBy(u,e=>e.label).map(e=>({description:e.name,detail:e.description,label:e.label,template:e})),h=i&&1===d.length?d[0]:yield a.window.showQuickPick(d,{matchOnDescription:!0,placeHolder:"Which Dart template?"});if(!h)return;const g=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateDartProjectName});if(!g)return;const v=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!v||1!==v.length)return;const y=v[0],C=c.Uri.file(o.join(p.fsPath(y),g));if(r.existsSync(p.fsPath(C)))return void a.window.showErrorMessage(`A folder named ${g} already exists in ${p.fsPath(y)}`);r.mkdirSync(p.fsPath(C)),r.writeFileSync(o.join(p.fsPath(C),t),JSON.stringify(h.template)),b.config.workspaceSdkPath&&m.writeDartSdkSettingIntoProject(b.config.workspaceSdkPath,p.fsPath(C));const w=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",C,w)}))}createFlutterProject(){return n(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("flutter.createProject");const e=yield a.window.showInputBox({prompt:"Enter a name for your new project",placeHolder:"hello_world",validateInput:this.validateFlutterProjectName});if(!e)return;const t=yield a.window.showOpenDialog({canSelectFolders:!0,openLabel:"Select a folder to create the project in"});if(!t||1!==t.length)return;const i=t[0],n=c.Uri.file(o.join(p.fsPath(i),e));if(r.existsSync(p.fsPath(n)))return void a.window.showErrorMessage(`A folder named ${e} already exists in ${p.fsPath(i)}`);r.mkdirSync(p.fsPath(n)),r.writeFileSync(o.join(p.fsPath(n),l.FLUTTER_CREATE_PROJECT_TRIGGER_FILE),""),b.config.workspaceFlutterSdkPath&&m.writeFlutterSdkSettingIntoProject(b.config.workspaceFlutterSdkPath,p.fsPath(n));const s=!(!a.workspace.workspaceFolders||!a.workspace.workspaceFolders.length);a.commands.executeCommand("vscode.openFolder",n,s)}))}createFlutterSampleProject(){return n(this,void 0,void 0,(function*(){if(!this.sdks||!this.sdks.flutter)return void this.sdkUtils.showFlutterActivationFailure("_dart.flutter.createSampleProject");let e;try{e=yield T.getFlutterSnippets(this.logger,this.sdks,this.flutterCapabilities)}catch(e){return void a.window.showErrorMessage("Unable to retrieve Flutter documentation snippets")}const t=f.sortBy(e,e=>e.element),i=yield a.window.showQuickPick(t.map(e=>({description:`${e.package}/${e.library}`,detail:g.stripMarkdown(e.description),label:e.element,snippet:e})),{matchOnDescription:!0,placeHolder:"Which Flutter sample?"});return i?v.createFlutterSampleInTempFolder(this.flutterCapabilities,i.snippet.id,b.config.workspaceFlutterSdkPath):void 0}))}validateDartProjectName(e){if(!k.test(e))return"Dart project names should be all lowercase, with underscores to separate words";return-1!==["dart","test"].indexOf(e)?`You may not use ${e} as the name for a dart project`:void 0}validateFlutterProjectName(e){if(!k.test(e))return"Flutter project names should be all lowercase, with underscores to separate words";return-1!==["flutter","flutter_test","test"].indexOf(e)?`You may not use ${e} as the name for a flutter project`:void 0}},t.markProjectCreationStarted=function(){_++},t.markProjectCreationEnded=function(){_--};class A{constructor(e,t){this.spawn=e,this.processNumber=A.processNumber++,this.completer=new h.PromiseCompleter,this.completed=this.completer.promise,this.isCancelled=!1,t?t.completed.then(()=>this.start()):this.start()}get hasStarted(){return void 0!==this.process}start(){if(this.process)throw new Error(this.processNumber+" Can't start an already started process!");this.isCancelled?this.completer.resolve(void 0):(this.process=this.spawn(),this.process.on("close",e=>this.completer.resolve(e)))}cancel(){this.isCancelled=!0}}A.processNumber=1},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultDartTestFileContents=t.defaultFlutterTestFileContents=t.defaultTestFileContents=t.createTestFileAction=t.makeRegexForTest=t.getLaunchConfig=void 0;const n=i(2),r=i(3);t.getLaunchConfig=function(e,t,i,n,r){return Object.assign({name:"Tests ",noDebug:e,request:"launch",type:"dart"},r,{args:(r&&r.args||[]).concat(i?["--name",o(i,n)]:[]),program:t})};const s=/\\\$(?:(?:\w+)|(?:\\\{.*\\\}))/g;function o(e,t){const i=t?"":"$";return`^${r.escapeRegExp(e).replace(s,".*")}${i}`}t.makeRegexForTest=o,t.createTestFileAction=e=>"Create "+n.basename(e),t.defaultTestFileContents=(e,t)=>e?a(t):c(t);function a(e){const t=`\nimport 'package:flutter_test/flutter_test.dart';\n\nvoid main() {\n  testWidgets('${e} ...', (tester) async {\n    // TODO: Implement test\n  });\n}\n`.trim();return{contents:t,selectionOffset:t.indexOf("// TODO: Implement test"),selectionLength:"// TODO: Implement test".length}}function c(e){const t=`\nimport 'package:test/test.dart';\n\nvoid main() {\n  test('${e} ...', () async {\n    // TODO: Implement test\n  });\n}\n`.trim();return{contents:t,selectionOffset:t.indexOf("// TODO: Implement test"),selectionLength:"// TODO: Implement test".length}}t.defaultFlutterTestFileContents=a,t.defaultDartTestFileContents=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClosingLabelsDecorations=t.validLastCharacters=void 0;const n=i(0),r=i(1),s=i(7);t.validLastCharacters=[")","]"];t.ClosingLabelsDecorations=class{constructor(e){this.analyzer=e,this.subscriptions=[],this.decorationType=n.window.createTextEditorDecorationType({after:{color:new n.ThemeColor("dart.closingLabels"),margin:"2px"},rangeBehavior:n.DecorationRangeBehavior.ClosedOpen}),this.subscriptions.push(this.analyzer.registerForAnalysisClosingLabels(e=>{this.activeEditor&&e.file===r.fsPath(this.activeEditor.document.uri)&&(this.closingLabels=e,this.update())})),this.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),n.window.activeTextEditor&&this.setTrackingFile(n.window.activeTextEditor)}update(){if(!this.closingLabels||!this.activeEditor||this.closingLabels.file!==r.fsPath(this.activeEditor.document.uri))return;const e=[];for(const i of this.closingLabels.labels){const r=this.activeEditor.document.positionAt(i.offset+i.length);if(r.character<1)return;const s=new n.Range(r.translate({characterDelta:-1}),r),o=this.activeEditor.document.getText(s);if(-1===t.validLastCharacters.indexOf(o))return;const a=this.activeEditor.document.lineAt(r).range.end,c=e[a.line];if(c)c.renderOptions.after.contentText=" // "+i.label+" "+c.renderOptions.after.contentText;else{const t={range:new n.Range(this.activeEditor.document.positionAt(i.offset),a),renderOptions:{after:{contentText:" // "+i.label}}};e[a.line]=t}}this.activeEditor.setDecorations(this.decorationType,Object.keys(e).map(e=>parseInt(e,10)).map(t=>e[t]))}setTrackingFile(e){var t;e&&s.isAnalyzable(e.document)&&(e!==this.activeEditor&&(null===(t=this.activeEditor)||void 0===t||t.setDecorations(this.decorationType,[])),e?(this.activeEditor=e,this.closingLabels=void 0,this.analyzer.forceNotificationsFor(r.fsPath(e.document.uri))):(this.activeEditor=void 0,this.closingLabels=void 0))}dispose(){var e;null===(e=this.activeEditor)||void 0===e||e.setDecorations(this.decorationType,[]),this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IconRangeComputerLsp=t.IconRangeComputer=void 0;const n=i(221),r=i(6);t.IconRangeComputer=class{constructor(e){this.logger=e}compute(e,t){const i=new s(this.logger);i.visit(t);const n={};return i.icons.forEach(t=>{const i=`${t.type}/${t.iconName}`;n[i]||(n[i]=[]),n[i].push(r.toRange(e,t.offset,t.length))}),n}};class s extends n.FlutterOutlineVisitor{constructor(){super(...arguments),this.icons=[],this.materialIconValuePattern=new RegExp("^Icons\\.([\\w_]+)$"),this.cupertinoIconValuePattern=new RegExp("^CupertinoIcons\\.([\\w_]+)$")}visitAttribute(e){if(e.label&&e.valueLocation){let t=this.materialIconValuePattern.exec(e.label);t&&this.icons.push({iconName:t[1],offset:e.valueLocation.offset,type:"material",length:e.valueLocation.length}),t=this.cupertinoIconValuePattern.exec(e.label),t&&this.icons.push({iconName:t[1],offset:e.valueLocation.offset,type:"cupertino",length:e.valueLocation.length})}}}t.IconRangeComputerLsp=class{constructor(e){this.logger=e}compute(e){const t=new o(this.logger);t.visit(e);const i={};return t.icons.forEach(e=>{const t=`${e.type}/${e.iconName}`;i[t]||(i[t]=[]),i[t].push(r.lspToRange(e.range))}),i}};class o extends n.FlutterOutlineVisitorLsp{constructor(){super(...arguments),this.icons=[],this.materialIconValuePattern=new RegExp("^Icons\\.([\\w_]+)$"),this.cupertinoIconValuePattern=new RegExp("^CupertinoIcons\\.([\\w_]+)$")}visitAttribute(e){if(e.label&&e.valueRange){let t=this.materialIconValuePattern.exec(e.label);t&&this.icons.push({iconName:t[1],range:e.valueRange,type:"material"}),t=this.cupertinoIconValuePattern.exec(e.label),t&&this.icons.push({iconName:t[1],range:e.valueRange,type:"cupertino"})}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterIconDecorations=void 0;const n=i(0),r=i(19),s=i(7);t.FlutterIconDecorations=class{constructor(e){this.logger=e,this.subscriptions=[],this.decorationTypes={},this.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>{this.setTrackingFile(e),this.update()})),setImmediate(()=>{this.setTrackingFile(n.window.activeTextEditor),this.update()})}render(e){if(this.activeEditor){for(const t of Object.keys(e))this.decorationTypes[t]||(this.decorationTypes[t]=n.window.createTextEditorDecorationType({gutterIconPath:n.Uri.parse(r.docsIconPathFormat.replace("$1",t)),gutterIconSize:"75%"}));for(const t of Object.keys(this.decorationTypes))this.activeEditor.setDecorations(this.decorationTypes[t],e[t]||[])}}setTrackingFile(e){e&&s.isAnalyzable(e.document)?this.activeEditor=e:this.activeEditor=void 0}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WidgetGuide=t.FlutterUiGuideDecorations=void 0;const n=i(0),r=i(3),s=i(224),o=i(10);t.FlutterUiGuideDecorations=class{constructor(){this.disposables=[],this.borderDecoration=n.window.createTextEditorDecorationType({rangeBehavior:n.DecorationRangeBehavior.OpenOpen}),this.disposables.push(n.window.onDidChangeActiveTextEditor(e=>this.buildForTextEditor(e))),o.config.previewFlutterUiGuidesCustomTracking&&(this.tracker=new c,this.disposables.push(this.tracker),this.tracker.onGuidesChanged(([e,t])=>this.buildFromUpdatedGuides(e,t))),setImmediate(()=>this.buildForTextEditor(n.window.activeTextEditor))}buildFromUpdatedGuides(e,t){n.window.activeTextEditor&&n.window.activeTextEditor.document===e&&this.renderGuides(n.window.activeTextEditor,t,"#A3A3A3")}renderGuides(e,t,i){const n={};for(const e of t)for(let t=e.start.line;t<=e.end.line;t++)n[t]=n[t]||[],n[t].push(e);const r=this.buildDecorations(e.document,e.options.tabSize,n,i);e.setDecorations(this.borderDecoration,r)}buildDecorations(e,t,i,r){const s=[];for(const o of Object.keys(i).map(e=>parseInt(e,10))){const a=e.lineAt(o),c=Math.min(...i[o].map(e=>Math.min(e.start.character,e.end.character))),l=Math.max(...i[o].map(e=>Math.max(e.start.character,e.end.character))),u=a.range.end.character,d=Math.max(u<c?0:c,0),h=new Array(l).fill("Â ");for(const e of i[o])if(o!==e.end.line)"Â "===h[e.start.character]?h[e.start.character]="â”‚":"â””"===h[e.start.character]&&(h[e.start.character]="â”œ");else for(let t=e.start.character;t<=e.end.character;t++)t===e.start.character?h[t]="â””":h[t]="â”€";h.fill("Â ",a.firstNonWhitespaceCharacterIndex,a.range.end.character),h.splice(0,d);const f=[];for(let e=0;e<h.length;e++)if(f.push(h[e]),"\t"===a.text[d+e]){const i="â”€"===h[e]||"â””"===h[e]||"â”œ"===h[e]?"â”€":"Â ";for(let e=0;e<t-1;e++)f.push(i)}s.push({range:new n.Range(new n.Position(o,d),new n.Position(o,d)),renderOptions:{before:{color:r,contentText:f.join(""),margin:"0 3px 0 -3px",width:"0"}}})}return s}firstNonWhitespace(e,t){return new n.Position(t,e.lineAt(t).firstNonWhitespaceCharacterIndex)}dispose(){this.disposables.forEach(e=>e.dispose())}};class a{constructor(e,t){this.start=e,this.end=t}}t.WidgetGuide=a;class c{constructor(){this.disposables=[],this.tracker=new s.DocumentPositionTracker,this.guideMap=new Map,this.onGuidesChangedEmitter=new n.EventEmitter,this.onGuidesChanged=this.onGuidesChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onPositionsChanged(([e,t])=>{const i=[];for(const e of this.guideMap.keys()){const n=this.guideMap.get(e),r=n[0],s=n[1],o=t.get(r),c=t.get(s);o&&c&&i.push(new a(o,c))}this.onGuidesChangedEmitter.fire([e,i])})}clear(){this.guideMap.clear(),this.tracker.clear()}trackDoc(e,t){this.guideMap.clear();for(const e of t)this.guideMap.set(e,[e.start,e.end]);const i=r.flatMap([...this.guideMap.values()],e=>[e[0],e[1]]);this.tracker.trackDoc(e,i)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SuiteTreeItem=t.TestItemTreeItem=t.TestResultsProvider=void 0;const r=i(2),s=i(0),o=i(4),a=i(8),c=i(3),l=i(21),u=i(1),d=i(124),h=i(19),f=i(61),g={};class p{constructor(e){this.logger=e,this.disposables=[],this.onDidChangeTreeDataEmitter=new s.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.onDidStartTestsEmitter=new s.EventEmitter,this.onDidStartTests=this.onDidStartTestsEmitter.event,this.onFirstFailureEmitter=new s.EventEmitter,this.onFirstFailure=this.onFirstFailureEmitter.event,this.owningDebugSessions={},this.disposables.push(s.debug.onDidReceiveDebugSessionCustomEvent(e=>this.handleDebugSessionCustomEvent(e))),this.disposables.push(s.debug.onDidTerminateDebugSession(e=>this.handleDebugSessionEnd(e))),this.disposables.push(s.commands.registerCommand("dart.startDebuggingTest",e=>{const t=e instanceof C?e.test.name:e instanceof b?e.group.name:void 0;s.debug.startDebugging(s.workspace.getWorkspaceFolder(e.resourceUri),d.getLaunchConfig(!1,u.fsPath(e.resourceUri),t,e instanceof b))})),this.disposables.push(s.commands.registerCommand("dart.startWithoutDebuggingTest",e=>{const t=e instanceof C?e.test.name:e instanceof b?e.group.name:void 0;s.debug.startDebugging(s.workspace.getWorkspaceFolder(e.resourceUri),d.getLaunchConfig(!0,u.fsPath(e.resourceUri),t,e instanceof b))})),this.disposables.push(s.commands.registerCommand("_dart.displaySuite",e=>s.commands.executeCommand("_dart.jumpToLineColInUri",s.Uri.file(e.suite.path)))),this.disposables.push(s.commands.registerCommand("_dart.displayGroup",e=>{if(e.group.url||e.group.root_url)return s.commands.executeCommand("_dart.jumpToLineColInUri",s.Uri.parse(e.group.url||e.group.root_url),e.group.root_line||e.group.line,e.group.root_column||e.group.column)})),this.disposables.push(s.commands.registerCommand("_dart.displayTest",e=>{if(this.writeTestOutput(e,!0),e.test.url||e.test.root_url)return s.commands.executeCommand("_dart.jumpToLineColInUri",s.Uri.parse(e.test.root_url||e.test.url),e.test.root_line||e.test.line,e.test.root_column||e.test.column)}))}static flagSuiteStart(e,t){if(p.isNewTestRun=!0,p.nextFailureIsFirst=!0,t&&e&&r.isAbsolute(e)){const t=g[u.fsPath(e)],i=t?[t]:Object.values(g);for(const e of i)e.getAllGroups().forEach(e=>e.isPotentiallyDeleted=!0),e.getAllTests().forEach(e=>e.isPotentiallyDeleted=!0)}Object.keys(g).forEach(e=>{const t=g[u.fsPath(e)];t.currentRunNumber++,t.getAllGroups().forEach(e=>e.isStale=!0),t.getAllTests().forEach(e=>e.isStale=!0)})}setSelectedNodes(e){this.currentSelectedNode=e}writeTestOutput(e,t=!1){const i=f.getChannel("Test Output");i.clear(),t&&i.show(!0),i.appendLine(e.test.name+":\n"),e.outputEvents.length||i.appendLine("(no output)");for(const t of e.outputEvents)this.appendTestOutput(t,i)}appendTestOutput(e,t=f.getChannel("Test Output")){"error"===e.type?(e=e,t.appendLine("ERROR: "+e.error),t.appendLine(e.stackTrace)):"print"===e.type?(e=e,t.appendLine(e.message)):t.appendLine(`Unknown message type '${e.type}'.`)}handleDebugSessionCustomEvent(e){"dart.testRunNotification"===e.event&&("suite"===e.body.notification.type&&(this.owningDebugSessions[e.body.suitePath]=e.session),this.handleNotification(e.body.suitePath,e.body.notification).catch(e=>this.logger.error(e)))}getTreeItem(e){return e}getChildren(e){let t=e?e instanceof y||e instanceof b?e.children:[]:Object.keys(g).map(e=>g[e].node);return t=t.filter(e=>e),e||(t=t.sort((e,t)=>{if(e.sort>t.sort)return 1;if(e.sort<t.sort)return-1;const i=e.label||(e.resourceUri?e.resourceUri.toString():""),n=t.label||(t.resourceUri?t.resourceUri.toString():"");return i>n?1:i<n?-1:0})),t}getParent(e){if(e instanceof C||e instanceof b)return e.parent}updateNode(e){this.onDidChangeTreeDataEmitter.fire(e)}updateAllStatuses(e){this.updateStatusFromChildren(e.node),this.updateNode()}updateStatusFromChildren(e){const t=e.children.length?e.children.filter(e=>e instanceof b&&!e.isPhantomGroup||e instanceof C&&!e.hidden).map(e=>e instanceof b?this.updateStatusFromChildren(e):e instanceof C?e.status:a.TestStatus.Unknown):[a.TestStatus.Unknown],i=Math.max.apply(Math,t);return i!==e.status&&(e.status=i,e.iconPath=w(e.status,!1),this.updateNode(e)),e.description=`${e.testPassCount}/${e.testCount} passed, ${e.duration}ms`,e.status}dispose(){this.disposables.forEach(e=>e.dispose())}handleNotification(e,t){return n(this,void 0,void 0,(function*(){const i=g[e];switch(t.type){case"suite":this.handleSuiteNotification(e,t);break;case"testStart":this.handleTestStartNotifcation(i,t);break;case"testDone":this.handleTestDoneNotification(i,t);break;case"group":this.handleGroupNotification(i,t);break;case"print":this.handlePrintNotification(i,t);break;case"error":this.handleErrorNotification(i,t)}}))}handleSuiteNotification(e,t){let i=g[t.suite.path];i||(i=new m(e,new y(t.suite)),g[t.suite.path]=i),i.node.status=a.TestStatus.Waiting,this.updateNode(i.node),this.updateNode(),p.isNewTestRun&&(p.isNewTestRun=!1,this.onDidStartTestsEmitter.fire(i.node))}handleTestStartNotifcation(e,t){let i;const n=e.getCurrentTest(t.test.id)||e.reuseMatchingTest(e.currentRunNumber,t.test,e=>i=e),r=n||new C(e,t.test);n||e.storeTest(t.test.id,r),r.test=t.test,r.testStartTime=t.time,r.test.name&&r.test.name.startsWith("loading ")&&r.parent instanceof y?r.hidden=!0:r.hidden=!1;const s=i&&i!==r.parent;i&&s&&(i.tests.splice(i.tests.indexOf(r),1),this.updateNode(i)),n&&!s||r.parent.tests.push(r),r.status=a.TestStatus.Running,this.updateNode(r),this.updateNode(r.parent),r.hidden||this.updateAllStatuses(e)}handleTestDoneNotification(e,t){const i=e.getCurrentTest(t.testID);i.hidden=t.hidden,t.skipped?i.status=a.TestStatus.Skipped:"success"===t.result?i.status=a.TestStatus.Passed:"failure"===t.result?i.status=a.TestStatus.Failed:"error"===t.result?i.status=a.TestStatus.Errored:i.status=a.TestStatus.Unknown,t.time&&i.testStartTime&&(i.duration=t.time-i.testStartTime,i.description=i.duration+"ms",i.testStartTime=void 0),this.updateNode(i),this.updateNode(i.parent),this.updateAllStatuses(e),i.status!==a.TestStatus.Failed&&i.status!==a.TestStatus.Errored||!p.nextFailureIsFirst||(p.nextFailureIsFirst=!1,this.onFirstFailureEmitter.fire(i))}handleGroupNotification(e,t){let i;const n=e.getCurrentGroup(t.group.id)||e.reuseMatchingGroup(e.currentRunNumber,t.group,e=>i=e),r=n||new b(e,t.group);n||e.storeGroup(t.group.id,r),r.group=t.group;const s=i&&i!==r.parent;i&&s&&(i.groups.splice(i.groups.indexOf(r),1),this.updateNode(i)),n&&!s||r.parent.groups.push(r),r.status=a.TestStatus.Running,this.updateNode(r),this.updateNode(r.parent)}handleDebugSessionEnd(e){const t=Object.keys(this.owningDebugSessions).filter(t=>{const i=this.owningDebugSessions[t];return e&&i&&i.id===e.id});for(const e of t)this.handleSuiteEnd(g[e]),this.owningDebugSessions[e]=void 0,delete this.owningDebugSessions[e]}handleSuiteEnd(e){e&&(e.getAllTests(!0).filter(e=>e.isPotentiallyDeleted||e.hidden).forEach(e=>{e.hidden=!0,this.updateNode(e.parent)}),e.getAllTests().filter(e=>e.status===a.TestStatus.Running).forEach(e=>{e.status=a.TestStatus.Unknown,this.updateNode(e)}),this.updateAllStatuses(e))}handlePrintNotification(e,t){const i=e.getCurrentTest(t.testID);i.outputEvents.push(t),i===this.currentSelectedNode&&this.appendTestOutput(t)}handleErrorNotification(e,t){const i=e.getCurrentTest(t.testID);i.outputEvents.push(t),i===this.currentSelectedNode&&this.appendTestOutput(t)}}t.TestResultsProvider=p,p.isNewTestRun=!0,p.nextFailureIsFirst=!0;class m{constructor(e,t){this.path=e,this.node=t,this.currentRunNumber=1,this.groups={},this.tests={}}getAllGroups(e=!1){return c.uniq(Object.keys(this.groups).map(e=>this.groups[e]).filter(t=>e||!t.hidden&&!t.isPhantomGroup))}getAllTests(e=!1){return c.uniq(Object.keys(this.tests).map(e=>this.tests[e]).filter(t=>e||!t.hidden))}getCurrentGroup(e){return this.groups[`${this.currentRunNumber}_${e}`]}getCurrentTest(e){return this.tests[`${this.currentRunNumber}_${e}`]}getMyGroup(e,t){return this.groups[`${e}_${t}`]}getMyTest(e,t){return this.tests[`${e}_${t}`]}storeGroup(e,t){return this.groups[`${this.currentRunNumber}_${e}`]=t}storeTest(e,t){return this.tests[`${this.currentRunNumber}_${e}`]=t}reuseMatchingGroup(e,t,i){const n=this.getAllGroups().filter(i=>i.group.name===t.name&&i.suiteRunNumber!==e).sort((e,i)=>Math.abs((e.group.line||0)-(t.line||0))-Math.abs((i.group.line||0)-(t.line||0))),r=n.length?n[0]:void 0;return r&&(i(r.parent),r.suiteRunNumber=this.currentRunNumber,this.storeGroup(t.id,r)),r}reuseMatchingTest(e,t,i){const n=this.getAllTests().filter(i=>i.test.name===t.name&&i.suiteRunNumber!==e),r=l.sortBy(n,e=>Math.abs((e.test.line||0)-(t.line||0))),s=r.length?r[0]:void 0;return s&&(i(s.parent),s.suiteRunNumber=this.currentRunNumber,this.storeTest(t.id,s)),s}}class v extends s.TreeItem{constructor(){super(...arguments),this._isStale=!1,this._status=a.TestStatus.Unknown,this._sort=S.Middle,this.suiteRunNumber=0,this.isPotentiallyDeleted=!1}get status(){return this._status}set status(e){this._status=e,this.iconPath=w(e,this.isStale),this.description=void 0,e!==a.TestStatus.Errored&&e!==a.TestStatus.Failed&&e!==a.TestStatus.Passed&&e!==a.TestStatus.Skipped||(this.isStale=!1,this.isPotentiallyDeleted=!1,this._sort=function(e){return e===a.TestStatus.Failed||e===a.TestStatus.Errored?S.Top:S.Middle}(e))}get isStale(){return this._isStale}set isStale(e){this._isStale=e,this.iconPath=w(this.status,this.isStale)}get sort(){return this._sort}}t.TestItemTreeItem=v;class y extends v{constructor(e){super(s.Uri.file(e.path),s.TreeItemCollapsibleState.Collapsed),this.suite=e,this.groups=[],this.tests=[],this.contextValue=o.DART_TEST_SUITE_NODE_CONTEXT,this.resourceUri=s.Uri.file(e.path),this.description=!0,this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_${this.suite.id}`,this.status=a.TestStatus.Unknown,this.command={command:"_dart.displaySuite",arguments:[this],title:""}}get testCount(){return this.children.map(e=>e.testCount).reduce((e,t)=>e+t,0)}get testPassCount(){return this.children.map(e=>e.testPassCount).reduce((e,t)=>e+t,0)}get duration(){return this.children.map(e=>e.duration).filter(c.notUndefined).reduce((e,t)=>e+t,0)}get children(){return[...c.flatMap(this.groups.filter(e=>e.isPhantomGroup),e=>e.children),...this.groups.filter(e=>!e.isPhantomGroup&&!e.hidden),...this.tests.filter(e=>!e.hidden)]}}t.SuiteTreeItem=y;class b extends v{constructor(e,t){super(t.name||"<unnamed>",s.TreeItemCollapsibleState.Collapsed),this.suite=e,this.groups=[],this.tests=[],this.suiteRunNumber=e.currentRunNumber,this._group=t,this.group=t,this.contextValue=o.DART_TEST_GROUP_NODE_CONTEXT,this.resourceUri=s.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_group_${this.group.id}`,this.status=a.TestStatus.Unknown,this.command={command:"_dart.displayGroup",arguments:[this],title:""}}get testCount(){return this.children.map(e=>e.testCount).reduce((e,t)=>e+t,0)}get testPassCount(){return this.children.map(e=>e.testPassCount).reduce((e,t)=>e+t,0)}get duration(){return this.children.map(e=>e.duration).filter(c.notUndefined).reduce((e,t)=>e+t,0)}get isPhantomGroup(){return!this.group.name&&this.parent instanceof y}get hidden(){return this.children.every(e=>e instanceof b&&e.hidden||e instanceof C&&e.hidden)}get parent(){const e=this.group.parentID?this.suite.getMyGroup(this.suiteRunNumber,this.group.parentID):this.suite.node;return e instanceof b&&e.isPhantomGroup?e.parent:e}get children(){return[].concat(this.groups.filter(e=>!e.hidden)).concat(this.tests.filter(e=>!e.hidden))}get group(){return this._group}set group(e){this._group=e;const t=this.parent;this.label=t&&t instanceof b&&t.fullName&&e.name&&e.name.startsWith(t.fullName+" ")?e.name.substr(t.fullName.length+1):e.name}get fullName(){return this._group.name}}class C extends v{constructor(e,t,i=!1){super(t.name||"<unnamed>",s.TreeItemCollapsibleState.None),this.suite=e,this.hidden=i,this.outputEvents=[],this.suiteRunNumber=e.currentRunNumber,this._test=t,this.test=t,this.contextValue=o.DART_TEST_TEST_NODE_CONTEXT,this.resourceUri=s.Uri.file(e.path),this.id=`suite_${this.suite.path}_${this.suiteRunNumber}_test_${this.test.id}`,this.status=a.TestStatus.Unknown,this.command={command:"_dart.displayTest",arguments:[this],title:""}}get testCount(){return 1}get testPassCount(){return this.status===a.TestStatus.Passed?1:0}get parent(){const e=this.test.groupIDs&&this.test.groupIDs.length?this.suite.getMyGroup(this.suiteRunNumber,this.test.groupIDs[this.test.groupIDs.length-1]):this.suite.node;return e instanceof b&&e.isPhantomGroup?e.parent:e}get test(){return this._test}set test(e){this._test=e,this.outputEvents.length=0;const t=this.parent;this.label=t&&t instanceof b&&t.fullName&&e.name&&e.name.startsWith(t.fullName+" ")?e.name.substr(t.fullName.length+1):e.name||"<unnamed>"}get fullName(){return this._test.name}}function w(e,t){let i;switch(e){case a.TestStatus.Running:i="running";break;case a.TestStatus.Passed:i=t?"pass_stale":"pass";break;case a.TestStatus.Failed:case a.TestStatus.Errored:i=t?"fail_stale":"fail";break;case a.TestStatus.Skipped:i=t?"skip_stale":"skip";break;case a.TestStatus.Unknown:i="unknown";break;case a.TestStatus.Waiting:i="loading";break;default:i=void 0}return i&&h.extensionPath?s.Uri.file(r.join(h.extensionPath,`media/icons/tests/${i}.svg`)):void 0}var S;!function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(S||(S={}))},,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebClient=void 0;const n=i(56),r=i(39),s=i(29);t.WebClient=class{constructor(e){this.userAgent=`Dart-Code/${e} (https://dartcode.org/)`}fetch(e,t){const i=s.parse(e);if("https:"===i.protocol&&i.hostname)return this.fetchHttps(i.hostname,i.port||"443",i.path||"",t);if("http:"===i.protocol&&i.hostname)return this.fetchHttp(i.hostname,i.port||"80",i.path||"",t);throw new Error("Cannot fetch URL "+e)}fetchHttps(e,t,i,n={}){return new Promise((s,o)=>{const a={headers:Object.assign(Object.assign({},n),{"User-Agent":this.userAgent}),hostname:e,method:"GET",path:i,port:t};r.request(a,e=>{if(!e||!e.statusCode||e.statusCode<200||e.statusCode>300)o({message:`Failed to get ${i}: ${e&&e.statusCode}: ${e&&e.statusMessage}`});else{const t=[];e.on("data",e=>t.push(e.toString())),e.on("end",()=>{const e=t.join("");s(e)})}}).end()})}fetchHttp(e,t,i,r={}){return new Promise((s,o)=>{const a={headers:Object.assign(Object.assign({},r),{"User-Agent":this.userAgent}),hostname:e,method:"GET",path:i,port:t};n.request(a,e=>{if(!e||!e.statusCode||e.statusCode<200||e.statusCode>300)o({message:`Failed to get ${i}: ${e&&e.statusCode}: ${e&&e.statusMessage}`});else{const t=[];e.on("data",e=>t.push(e.toString())),e.on("end",()=>{const e=t.join("");s(e)})}}).end()})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PubApi=void 0;t.PubApi=class{constructor(e){this.webClient=e,this.pubHost=process.env.PUB_HOSTED_URL||"https://pub.dev"}getPackage(e){return n(this,void 0,void 0,(function*(){return this.get("packages/"+e)}))}get(e){return n(this,void 0,void 0,(function*(){return JSON.parse(yield this.webClient.fetch(`${this.pubHost}/api/${e}`,{Accept:"application/vnd.pub.v2+json"}))}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.internalApiSymbol=void 0,t.internalApiSymbol="_privateApi"},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterDeviceManager=void 0;const r=i(0),s=i(3),o=i(1),a=i(6),c=i(4),l=i(8),u=i(13),d=i(40),h=i(21),f=i(6);t.FlutterDeviceManager=class{constructor(e,t,i){this.logger=e,this.daemon=t,this.config=i,this.subscriptions=[],this.devices=[],this.knownEmulatorNames={},this.statusBarItem=r.window.createStatusBarItem(r.StatusBarAlignment.Right,1),this.statusBarItem.tooltip="Flutter",this.statusBarItem.command="flutter.selectDevice",this.statusBarItem.show(),this.updateStatusBar(),this.getEmulators().then(()=>this.updateStatusBar()).catch(e=>console.error(e)),this.subscriptions.push(this.statusBarItem),t.registerForDeviceAdded(this.deviceAdded.bind(this)),t.registerForDeviceRemoved(this.deviceRemoved.bind(this))}dispose(){this.subscriptions.forEach(e=>e.dispose())}isSupported(e,t){return t&&(!e||!e.length||!t.platformType||-1!==e.indexOf(t.platformType))}deviceAdded(e){return n(this,void 0,void 0,(function*(){e=Object.assign(Object.assign({},e),{type:"device"}),this.devices.push(e);const t=!1!==e.ephemeral,i=()=>{var i;return!this.currentDevice||this.config.flutterSelectDeviceWhenConnected&&t||"web-server"===(null===(i=this.currentDevice)||void 0===i?void 0:i.id)&&"chrome"===e.id};if(i()){const t=yield this.getSupportedPlatformsForWorkspace();i()&&this.isSupported(t,e)&&(this.currentDevice=e,this.updateStatusBar())}}))}deviceRemoved(e){return n(this,void 0,void 0,(function*(){if(this.devices=this.devices.filter(t=>t.id!==e.id),this.currentDevice&&this.currentDevice.id===e.id){if(this.currentDevice=void 0,this.devices.length){const e=yield this.getSupportedPlatformsForWorkspace(),t=this.devices.filter(t=>this.isSupported(e,t));t&&t.length&&(this.currentDevice=t[0])}this.updateStatusBar()}}))}showDevicePicker(e){return n(this,void 0,void 0,(function*(){!e&&this.daemon.capabilities.providesPlatformTypes&&(e=yield this.getSupportedPlatformsForWorkspace());const t=r.window.createQuickPick();t.placeholder="Select a device to use",t.busy=!0;let i,s=!0;const o=()=>n(this,void 0,void 0,(function*(){s&&(t.items=yield this.getPickableDevices(e,i))}));this.getPickableEmulators(!0,e).then(e=>i=e).finally(()=>t.busy=!1).finally(()=>o()).catch(e=>console.error(e));const a=this.daemon.registerForDeviceAdded(e=>o()),c=this.daemon.registerForDeviceRemoved(e=>o());yield o();const l=yield new Promise(e=>{t.onDidAccept(()=>e(t.selectedItems&&t.selectedItems[0])),t.onDidHide(()=>e(void 0)),t.show()});if(s=!1,t.dispose(),a.dispose(),c.dispose(),l&&(yield this.selectDevice(l)))return this.currentDevice}))}selectDevice(e){return n(this,void 0,void 0,(function*(){const t=this.emulatorLabel(e.device.platformType);switch(e.device.type){case"emulator-creator":this.currentDevice=void 0,this.statusBarItem.text=`Creating ${t}...`,yield this.createEmulator(),this.updateStatusBar();break;case"emulator":this.currentDevice=void 0,this.statusBarItem.text=`Launching ${t}...`,yield this.launchEmulator(e.device),this.updateStatusBar();break;case"custom-emulator":this.currentDevice=void 0,this.statusBarItem.text=`Launching ${t}...`,yield this.launchCustomEmulator(e.device),this.updateStatusBar();break;case"device":if(!e.isSupported){if((yield r.window.showInformationMessage(c.runFlutterCreateDotPrompt(e.device.name),c.runFlutterCreateDotAction,c.cancelAction))!==c.runFlutterCreateDotAction)return!1;yield r.commands.executeCommand("_flutter.create")}this.currentDevice=e.device,this.updateStatusBar()}return!0}))}getDevice(e){return this.devices.find(t=>t.id===e)}getPickableDevices(e,t){return n(this,void 0,void 0,(function*(){const i=this.devices.sort(this.deviceSortComparer.bind(this));let n=i.filter(t=>this.isSupported(e,t)).map(e=>({description:e.category||e.platform,device:e,isSupported:!0,label:this.labelForDevice(e)}));if(t){const e=this.devices.map(e=>e.emulatorId).filter(e=>e);n=n.concat(t.filter(t=>-1===e.indexOf(t.device.id)))}return n=n.concat(i.filter(t=>!this.isSupported(e,t)).map(e=>({device:e,isSupported:!1,label:"Enable "+this.labelForDevice(e)}))),n}))}getSupportedPlatformsForWorkspace(){return n(this,void 0,void 0,(function*(){return this.shortCacheForSupportedPlatforms?(this.logger.info("Returning cached promise for getSupportedPlatforms()"),this.shortCacheForSupportedPlatforms):(this.shortCacheForSupportedPlatforms=new Promise(e=>n(this,void 0,void 0,(function*(){const t=a.getDartWorkspaceFolders().map(e=>o.fsPath(e.uri)),i=yield o.findProjectFolders(t,{requirePubspec:!0});this.logger.info(`Checking ${i.length} projects for supported platforms`);const n=i.map(e=>this.daemon.getSupportedPlatforms(e)),r=yield Promise.all(n).catch(e=>(this.logger.error(e),[])),c=h.unique(s.flatMap(r,e=>e.platforms));this.logger.info("Supported platforms for the workspace are "+c.join(", ")),e(c),setTimeout(()=>this.shortCacheForSupportedPlatforms=void 0,1e4)}))),this.shortCacheForSupportedPlatforms)}))}labelForDevice(e){return e.emulatorId&&this.knownEmulatorNames[e.emulatorId]&&"android"===e.platformType?this.knownEmulatorNames[e.emulatorId]:e.name}deviceSortComparer(e,t){return e===this.currentDevice?-1:t===this.currentDevice?1:e.name.localeCompare(t.name)}updateStatusBar(){if(this.currentDevice){const e=this.currentDevice.emulator?this.emulatorLabel(this.currentDevice.platformType):"",t=`${this.currentDevice.platform} ${e}`.trim();this.statusBarItem.text=`${this.labelForDevice(this.currentDevice)} (${t})`.trim()}else this.statusBarItem.text="No Device";this.devices.length>1?this.statusBarItem.tooltip=this.devices.length+" Devices Connected":1===this.devices.length?this.statusBarItem.tooltip="1 Device Connected":this.statusBarItem.tooltip=void 0}getEmulators(){return n(this,void 0,void 0,(function*(){try{const e=yield this.daemon.getEmulators(),t={};for(const i of e)t[i.id]={category:i.category,id:i.id,name:i.name||i.id,platformType:i.platformType,type:"emulator"};for(const e of this.config.flutterCustomEmulators){const i=t[e.id];t[e.id]=Object.assign(Object.assign(Object.assign({category:"custom"},i),e),{type:"custom-emulator"})}const i=Object.values(t);for(const e of i)this.knownEmulatorNames[e.id]=e.name;return i}catch(e){return this.logger.error({message:e}),[]}}))}promptForAndLaunchEmulator(e=!1){return n(this,void 0,void 0,(function*(){const t=yield this.getPickableEmulators(!1);if(e&&this.currentDevice)return!0;if(0===t.length)return!1;const i=new r.CancellationTokenSource,n=this.daemon.registerForDeviceAdded(()=>{i.cancel(),n.dispose()}),s=yield r.window.showQuickPick(t,{matchOnDescription:!0,placeHolder:"Connect a device or select an emulator to launch"},i.token);return n.dispose(),s&&s.device&&"emulator-creator"===s.device.type?this.createEmulator():s&&s.device&&"emulator"===s.device.type?this.launchEmulator(s.device):s&&s.device&&"custom-emulator"===s.device.type?this.launchCustomEmulator(s.device):!!this.currentDevice}))}createEmulator(){return n(this,void 0,void 0,(function*(){const e=this.daemon.createEmulator(void 0);r.window.withProgress({location:r.ProgressLocation.Notification,title:"Creating emulator ".trim()+"..."},()=>e);const t=yield e;return t.success?this.launchEmulator({id:t.emulatorName,name:t.emulatorName}):(r.window.showErrorMessage(t.error),!1)}))}emulatorLabel(e){return!e||"ios"!==e&&"macos"!==e?"emulator":"simulator"}getPickableEmulators(e,t){return n(this,void 0,void 0,(function*(){if(!f.isRunningLocally)return[];const i=(yield this.getEmulators()).filter(e=>this.isSupported(t,e)).map(t=>({alwaysShow:!1,description:e?`${t.category||"mobile"} ${this.emulatorLabel(t.platformType)}`:t.platformType||void 0,device:t,isSupported:!0,label:e?"Start "+t.name:t.name}));return this.daemon.capabilities.canCreateEmulators&&this.isSupported(t,{platformType:"android"})&&i.push({alwaysShow:!0,device:{type:"emulator-creator",platformType:"android",name:"Create Android emulator"},isSupported:!0,label:"Create Android emulator"}),i}))}launchEmulator(e){return n(this,void 0,void 0,(function*(){try{yield r.window.withProgress({location:r.ProgressLocation.Notification},t=>n(this,void 0,void 0,(function*(){t.report({message:`Launching ${e.name}...`}),yield this.daemon.launchEmulator(e.id),t.report({message:`Waiting for ${e.name} to connect...`});for(let e=0;e<120;e++)if(yield new Promise(e=>setTimeout(e,500)),this.currentDevice)return;throw new Error("Emulator didn't connect within 60 seconds")})))}catch(t){return r.window.showErrorMessage(`Failed to launch ${e.name}: ${t}`),!1}return yield new Promise(e=>setTimeout(e,1e3)),!0}))}launchCustomEmulator(e){return n(this,void 0,void 0,(function*(){try{yield r.window.withProgress({location:r.ProgressLocation.Notification},t=>n(this,void 0,void 0,(function*(){t.report({message:`Launching ${e.name}...`});const i=e.executable,n=e.args||[],r=d.safeSpawn(void 0,e.executable,n,{});this.logger.info(`(PROC ${r.pid}) Spawned ${i} ${n.join(" ")}`,l.LogCategory.CommandProcesses),u.logProcess(this.logger,l.LogCategory.CommandProcesses,r),t.report({message:`Waiting for ${e.name} to connect...`});for(let e=0;e<120;e++)if(yield new Promise(e=>setTimeout(e,500)),this.currentDevice)return;throw new Error("Emulator didn't connect within 60 seconds")})))}catch(t){return r.window.showErrorMessage(`Failed to launch ${e.name}: ${t}`),!1}return yield new Promise(e=>setTimeout(e,1e3)),!0}))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartUriHandler=void 0;const r=i(0),s=i(144);t.DartUriHandler=class{constructor(e){this.handlers={"/flutter/sample/":new s.FlutterSampleUriHandler(e)}}handleUri(e){return n(this,void 0,void 0,(function*(){const t=Object.keys(this.handlers).find(t=>e.path.startsWith(t));t?yield this.handlers[t].handle(e.path.substr(t.length)):r.window.showErrorMessage(`No handler for '${e.path}'. Check you have the latest version of the Dart plugin and try again.`)}))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterSampleUriHandler=void 0;const r=i(0),s=i(108);t.FlutterSampleUriHandler=class{constructor(e){this.flutterCapabilities=e,this.validSampleIdentifierPattern=new RegExp("^[\\w\\.]+$")}handle(e){return n(this,void 0,void 0,(function*(){this.isValidSampleName(e)?s.createFlutterSampleInTempFolder(this.flutterCapabilities,e):r.window.showErrorMessage(e+" is not a valid Flutter sample identifier")}))}isValidSampleName(e){return this.validSampleIdentifierPattern.test(e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;class n{constructor(e){this.context=e}static for(e){return new n(e)}get devToolsNotificationLastShown(){return this.context.globalState.get("devToolsNotificationLastShown")}set devToolsNotificationLastShown(e){this.context.globalState.update("devToolsNotificationLastShown",e)}get devToolsNotificationDoNotShow(){return!!this.context.globalState.get("devToolsNotificationDoNotShowAgain")}set devToolsNotificationDoNotShow(e){this.context.globalState.update("devToolsNotificationDoNotShowAgain",e)}get breakpointOutsideWorkspaceDoNotShow(){return!!this.context.globalState.get("breakpointOutsideWorkspaceDoNotShowAgain")}set breakpointOutsideWorkspaceDoNotShow(e){this.context.globalState.update("breakpointOutsideWorkspaceDoNotShowAgain",e)}getFlutterSurveyNotificationLastShown(e){return this.context.globalState.get(`flutterSurvey${e}NotificationLastShown`)}setFlutterSurveyNotificationLastShown(e,t){this.context.globalState.update(`flutterSurvey${e}NotificationLastShown`,t)}getFlutterSurveyNotificationDoNotShow(e){return!!this.context.globalState.get(`flutterSurvey${e}NotificationDoNotShowAgain`)}setFlutterSurveyNotificationDoNotShow(e,t){this.context.globalState.update(`flutterSurvey${e}NotificationDoNotShowAgain`,t)}get hasWarnedAboutFormatterSyntaxLimitation(){return!!this.context.globalState.get("hasWarnedAboutFormatterSyntaxLimitation")}set hasWarnedAboutFormatterSyntaxLimitation(e){this.context.globalState.update("hasWarnedAboutFormatterSyntaxLimitation",e)}get lastSeenVersion(){return this.context.globalState.get("lastSeenVersion")}set lastSeenVersion(e){this.context.globalState.update("lastSeenVersion",e)}getPackageLastCheckedForUpdates(e){return this.context.globalState.get("packageLastCheckedForUpdates:"+e)}setPackageLastCheckedForUpdates(e,t){this.context.globalState.update("packageLastCheckedForUpdates:"+e,t)}update(e,t){return this.context.globalState.update(e,t)}get(e){return this.context.globalState.get(e)}get subscriptions(){return this.context.subscriptions}}t.Context=n},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tryProcessBazelFlutterConfig=t.processBazelWorkspace=t.processFuchsiaWorkspace=t.processFlutterSnap=t.processKnownGitRepositories=void 0;const n=i(5),r=i(2),s=i(4);function o(e,t,i){var o,a;if(!s.isWin)try{const s=r.join(i,"dart/config/intellij-plugins/flutter.json");if(!n.existsSync(s))return;e.info("Loading Bazel Flutter config from "+s);const u=n.readFileSync(s,"utf8"),d=JSON.parse(u);function c(e){return r.isAbsolute(e)?e:r.join(i,e)}function l(e,t=1){if(e)return{replacesArgs:t,script:c(e)}}t.activateDevToolsEagerly=!!d.devtoolsActivateScript,t.dartSdkHomeLinux=c(null===(o=d.dartSdkHome)||void 0===o?void 0:o.linux),t.dartSdkHomeMac=c(null===(a=d.dartSdkHome)||void 0===a?void 0:a.macos),t.devtoolsActivateScript=l(d.devtoolsActivateScript,3),t.devtoolsRunScript=l(d.devtoolsRunScript,3),t.flutterDaemonScript=l(d.daemonScript),t.flutterDoctorScript=l(d.doctorScript),t.flutterRunScript=l(d.runScript),t.flutterSdkHome=c(d.sdkHome),t.flutterTestScript=l(d.testScript),t.flutterVersionFile=c(d.versionFile)}catch(t){e.error(t)}}t.processKnownGitRepositories=function(e,t,i){n.existsSync(r.join(i,"README.dart-sdk"))&&n.existsSync(r.join(i,".packages"))&&(t.disableAutomaticPackageGet=!0,t.useVmForTests=!0)},t.processFlutterSnap=function(e,t,i){t.flutterSdkHome=i,t.flutterScript={replacesArgs:0,script:s.flutterSnapScript}},t.processFuchsiaWorkspace=function(e,t,i){t.disableAutomaticPackageGet=!0,t.disableSdkUpdateChecks=!0},t.processBazelWorkspace=function(e,t,i,n){t.disableAutomaticPackageGet=!0,t.disableSdkUpdateChecks=!0,n&&o(e,t,i)},t.tryProcessBazelFlutterConfig=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkspaceContext=void 0;t.WorkspaceContext=class{constructor(e,t,i,n,r,s){this.sdks=e,this.config=t,this.hasAnyFlutterMobileProjects=i,this.hasAnyWebProjects=n,this.hasAnyStandardDartProjects=r,this.hasProjectsInFuchsiaTree=s,this.workspaceTypeDescription=this.buildWorkspaceTypeDescription()}get hasAnyFlutterProjects(){return this.hasAnyFlutterMobileProjects}get shouldLoadFlutterExtension(){return this.hasAnyFlutterProjects}buildWorkspaceTypeDescription(){const e=[];return this.hasAnyStandardDartProjects&&e.push("Dart"),this.hasAnyFlutterMobileProjects&&e.push("Flutter"),this.hasProjectsInFuchsiaTree&&e.push("Fuchsia"),0===e.length&&(this.sdks&&this.sdks.dartSdkIsFromFlutter?e.push("Unknown (Flutter SDK)"):this.sdks&&this.sdks.dart?e.push("Unknown (Dart SDK)"):e.push("Unknown (No SDK)")),e.join(", ")}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.initializeFlutterSdk=void 0;const r=i(0),s=i(4),o=i(8),a=i(13),c=i(15);t.initializeFlutterSdk=function(e,t,i){return n(this,void 0,void 0,(function*(){(i?yield r.window.showInformationMessage(i,s.yesAction,s.noAction):s.yesAction)===s.yesAction&&(e.info("Flutter is not initialized, running 'flutter config --machine'..."),yield r.window.withProgress({location:r.ProgressLocation.Notification,title:s.initializingFlutterMessage},(i,s)=>n(this,void 0,void 0,(function*(){const i=c.safeToolSpawn(void 0,t,["config","--machine"]);return s.onCancellationRequested(t=>{e.info("User canceled!"),i.kill()}),a.logProcess(e,o.LogCategory.CommandProcesses,i),new Promise((t,n)=>i.on("exit",i=>{i?(e.error(`Failed to initialize Flutter: Process exited with code ${i}.`),r.window.showErrorMessage(`Failed to initialize Flutter: Process exited with code ${i}.`),n()):t()}))}))),e.info("Flutter initialized!"))}))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerGen=void 0;const r=i(41);class s extends r.StdIOService{constructor(e,t){super(e,t),this.serverConnectedSubscriptions=[],this.serverErrorSubscriptions=[],this.serverStatusSubscriptions=[],this.analysisAnalyzedFilesSubscriptions=[],this.analysisClosingLabelsSubscriptions=[],this.analysisErrorsSubscriptions=[],this.analysisFlushResultsSubscriptions=[],this.analysisFoldingSubscriptions=[],this.analysisHighlightsSubscriptions=[],this.analysisImplementedSubscriptions=[],this.analysisInvalidateSubscriptions=[],this.analysisNavigationSubscriptions=[],this.analysisOccurrencesSubscriptions=[],this.analysisOutlineSubscriptions=[],this.analysisOverridesSubscriptions=[],this.completionResultsSubscriptions=[],this.completionAvailableSuggestionsSubscriptions=[],this.completionExistingImportsSubscriptions=[],this.searchResultsSubscriptions=[],this.executionLaunchDataSubscriptions=[],this.flutterOutlineSubscriptions=[]}buildRequest(e,t,i){return Object.assign(super.buildRequest(e,t,i),{clientRequestTime:Date.now()})}handleNotification(e){return n(this,void 0,void 0,(function*(){switch(e.event){case"server.connected":yield this.notify(this.serverConnectedSubscriptions,e.params);break;case"server.error":yield this.notify(this.serverErrorSubscriptions,e.params);break;case"server.status":yield this.notify(this.serverStatusSubscriptions,e.params);break;case"analysis.analyzedFiles":yield this.notify(this.analysisAnalyzedFilesSubscriptions,e.params);break;case"analysis.closingLabels":yield this.notify(this.analysisClosingLabelsSubscriptions,e.params);break;case"analysis.errors":yield this.notify(this.analysisErrorsSubscriptions,e.params);break;case"analysis.flushResults":yield this.notify(this.analysisFlushResultsSubscriptions,e.params);break;case"analysis.folding":yield this.notify(this.analysisFoldingSubscriptions,e.params);break;case"analysis.highlights":yield this.notify(this.analysisHighlightsSubscriptions,e.params);break;case"analysis.implemented":yield this.notify(this.analysisImplementedSubscriptions,e.params);break;case"analysis.invalidate":yield this.notify(this.analysisInvalidateSubscriptions,e.params);break;case"analysis.navigation":yield this.notify(this.analysisNavigationSubscriptions,e.params);break;case"analysis.occurrences":yield this.notify(this.analysisOccurrencesSubscriptions,e.params);break;case"analysis.outline":yield this.notify(this.analysisOutlineSubscriptions,e.params);break;case"analysis.overrides":yield this.notify(this.analysisOverridesSubscriptions,e.params);break;case"completion.results":yield this.notify(this.completionResultsSubscriptions,e.params);break;case"completion.availableSuggestions":yield this.notify(this.completionAvailableSuggestionsSubscriptions,e.params);break;case"completion.existingImports":yield this.notify(this.completionExistingImportsSubscriptions,e.params);break;case"search.results":yield this.notify(this.searchResultsSubscriptions,e.params);break;case"execution.launchData":yield this.notify(this.executionLaunchDataSubscriptions,e.params);break;case"flutter.outline":yield this.notify(this.flutterOutlineSubscriptions,e.params)}}))}registerForServerConnected(e){return this.subscribe(this.serverConnectedSubscriptions,e)}registerForServerError(e){return this.subscribe(this.serverErrorSubscriptions,e)}registerForServerStatus(e){return this.subscribe(this.serverStatusSubscriptions,e)}registerForAnalysisAnalyzedFiles(e){return this.subscribe(this.analysisAnalyzedFilesSubscriptions,e)}registerForAnalysisClosingLabels(e){return this.subscribe(this.analysisClosingLabelsSubscriptions,e)}registerForAnalysisErrors(e){return this.subscribe(this.analysisErrorsSubscriptions,e)}registerForAnalysisFlushResults(e){return this.subscribe(this.analysisFlushResultsSubscriptions,e)}registerForAnalysisFolding(e){return this.subscribe(this.analysisFoldingSubscriptions,e)}registerForAnalysisHighlights(e){return this.subscribe(this.analysisHighlightsSubscriptions,e)}registerForAnalysisImplemented(e){return this.subscribe(this.analysisImplementedSubscriptions,e)}registerForAnalysisInvalidate(e){return this.subscribe(this.analysisInvalidateSubscriptions,e)}registerForAnalysisNavigation(e){return this.subscribe(this.analysisNavigationSubscriptions,e)}registerForAnalysisOccurrences(e){return this.subscribe(this.analysisOccurrencesSubscriptions,e)}registerForAnalysisOutline(e){return this.subscribe(this.analysisOutlineSubscriptions,e)}registerForAnalysisOverrides(e){return this.subscribe(this.analysisOverridesSubscriptions,e)}registerForCompletionResults(e){return this.subscribe(this.completionResultsSubscriptions,e)}registerForCompletionAvailableSuggestions(e){return this.subscribe(this.completionAvailableSuggestionsSubscriptions,e)}registerForCompletionExistingImports(e){return this.subscribe(this.completionExistingImportsSubscriptions,e)}registerForSearchResults(e){return this.subscribe(this.searchResultsSubscriptions,e)}registerForExecutionLaunchData(e){return this.subscribe(this.executionLaunchDataSubscriptions,e)}registerForFlutterOutline(e){return this.subscribe(this.flutterOutlineSubscriptions,e)}serverGetVersion(){return this.sendRequest("server.getVersion")}serverShutdown(){return this.sendRequest("server.shutdown")}serverSetSubscriptions(e){return this.sendRequest("server.setSubscriptions",e)}analysisGetErrors(e){return this.sendRequest("analysis.getErrors",e)}analysisGetHover(e){return this.sendRequest("analysis.getHover",e)}analysisGetImportedElements(e){return this.sendRequest("analysis.getImportedElements",e)}analysisGetLibraryDependencies(){return this.sendRequest("analysis.getLibraryDependencies")}analysisGetNavigation(e){return this.sendRequest("analysis.getNavigation",e)}analysisGetReachableSources(e){return this.sendRequest("analysis.getReachableSources",e)}analysisGetSignature(e){return this.sendRequest("analysis.getSignature",e)}analysisReanalyze(){return this.sendRequest("analysis.reanalyze")}analysisSetAnalysisRoots(e){return this.sendRequest("analysis.setAnalysisRoots",e)}analysisSetGeneralSubscriptions(e){return this.sendRequest("analysis.setGeneralSubscriptions",e)}analysisSetPriorityFiles(e){return this.sendRequest("analysis.setPriorityFiles",e)}analysisSetSubscriptions(e){return this.sendRequest("analysis.setSubscriptions",e)}analysisUpdateContent(e){return this.sendRequest("analysis.updateContent",e)}analysisUpdateOptions(e){return this.sendRequest("analysis.updateOptions",e)}completionGetSuggestions(e){return this.sendRequest("completion.getSuggestions",e)}completionSetSubscriptions(e){return this.sendRequest("completion.setSubscriptions",e)}completionRegisterLibraryPaths(e){return this.sendRequest("completion.registerLibraryPaths",e)}completionGetSuggestionDetails(e){return this.sendRequest("completion.getSuggestionDetails",e)}completionListTokenDetails(e){return this.sendRequest("completion.listTokenDetails",e)}searchFindElementReferences(e){return this.sendRequest("search.findElementReferences",e)}searchFindMemberDeclarations(e){return this.sendRequest("search.findMemberDeclarations",e)}searchFindMemberReferences(e){return this.sendRequest("search.findMemberReferences",e)}searchFindTopLevelDeclarations(e){return this.sendRequest("search.findTopLevelDeclarations",e)}searchGetElementDeclarations(e){return this.sendRequest("search.getElementDeclarations",e)}searchGetTypeHierarchy(e){return this.sendRequest("search.getTypeHierarchy",e)}editFormat(e){return this.sendRequest("edit.format",e)}editGetAssists(e){return this.sendRequest("edit.getAssists",e)}editGetAvailableRefactorings(e){return this.sendRequest("edit.getAvailableRefactorings",e)}editGetDartfixInfo(){return this.sendRequest("edit.getDartfixInfo")}editDartfix(e){return this.sendRequest("edit.dartfix",e)}editGetFixes(e){return this.sendRequest("edit.getFixes",e)}editGetPostfixCompletion(e){return this.sendRequest("edit.getPostfixCompletion",e)}editGetRefactoring(e){return this.sendRequest("edit.getRefactoring",e)}editGetStatementCompletion(e){return this.sendRequest("edit.getStatementCompletion",e)}editIsPostfixCompletionApplicable(e){return this.sendRequest("edit.isPostfixCompletionApplicable",e)}editListPostfixCompletionTemplates(){return this.sendRequest("edit.listPostfixCompletionTemplates")}editImportElements(e){return this.sendRequest("edit.importElements",e)}editSortMembers(e){return this.sendRequest("edit.sortMembers",e)}editOrganizeDirectives(e){return this.sendRequest("edit.organizeDirectives",e)}executionCreateContext(e){return this.sendRequest("execution.createContext",e)}executionDeleteContext(e){return this.sendRequest("execution.deleteContext",e)}executionGetSuggestions(e){return this.sendRequest("execution.getSuggestions",e)}executionMapUri(e){return this.sendRequest("execution.mapUri",e)}executionSetSubscriptions(e){return this.sendRequest("execution.setSubscriptions",e)}diagnosticGetDiagnostics(){return this.sendRequest("diagnostic.getDiagnostics")}diagnosticGetServerPort(){return this.sendRequest("diagnostic.getServerPort")}analyticsIsEnabled(){return this.sendRequest("analytics.isEnabled")}analyticsEnable(e){return this.sendRequest("analytics.enable",e)}analyticsSendEvent(e){return this.sendRequest("analytics.sendEvent",e)}analyticsSendTiming(e){return this.sendRequest("analytics.sendTiming",e)}kytheGetKytheEntries(e){return this.sendRequest("kythe.getKytheEntries",e)}flutterSetSubscriptions(e){return this.sendRequest("flutter.setSubscriptions",e)}}t.AnalyzerGen=s},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DasFileTracker=void 0;const r=i(0),s=i(1),o=i(30),a=i(49),c=i(7);t.DasFileTracker=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.wsContext=i,this.disposables=[],this.outlines={},this.flutterOutlines={},this.occurrences={},this.folding={},this.pubRunTestSupport={},this.lastPriorityFiles=[],this.lastSubscribedFiles=[],this.lastPriorityFiles=[],this.lastSubscribedFiles=[],this.disposables.push(r.workspace.onDidOpenTextDocument(e=>n(this,void 0,void 0,(function*(){yield this.updateSubscriptions()})))),this.disposables.push(r.workspace.onDidCloseTextDocument(e=>n(this,void 0,void 0,(function*(){const t=s.fsPath(e.uri);delete this.outlines[t],delete this.flutterOutlines[t],delete this.occurrences[t],delete this.folding[t],delete this.pubRunTestSupport[t],yield this.updateSubscriptions()})))),this.disposables.push(r.window.onDidChangeVisibleTextEditors(e=>this.updatePriorityFiles())),this.disposables.push(this.analyzer.registerForAnalysisOutline(e=>this.outlines[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForFlutterOutline(e=>this.flutterOutlines[e.file]=e.outline)),this.disposables.push(this.analyzer.registerForAnalysisOccurrences(e=>this.occurrences[e.file]=e.occurrences)),this.disposables.push(this.analyzer.registerForAnalysisFolding(e=>this.folding[e.file]=e.regions)),this.disposables.push(this.analyzer.registerForServerConnected(e=>this.updateSubscriptions(!0))),this.updatePriorityFiles(),this.updateSubscriptions(),this.watchPubspec()}updatePriorityFiles(){return n(this,void 0,void 0,(function*(){const e=this.validPathsFor(r.window.visibleTextEditors.map(e=>e.document));if(this.pathsHaveChanged(this.lastPriorityFiles,e)){this.lastPriorityFiles=e;try{yield this.analyzer.analysisSetPriorityFiles({files:e})}catch(e){this.logger.error(e)}}}))}updateSubscriptions(e=!1){return n(this,void 0,void 0,(function*(){const t=this.validPathsFor(r.workspace.textDocuments);if(e||this.pathsHaveChanged(this.lastSubscribedFiles,t)){this.lastSubscribedFiles=t;try{yield this.analyzer.analysisSetSubscriptions({subscriptions:{CLOSING_LABELS:this.analyzer.capabilities.supportsClosingLabels?t:void 0,FOLDING:this.wsContext.config.useLsp?void 0:t,OCCURRENCES:this.wsContext.config.useLsp?void 0:t,OUTLINE:t}})}catch(e){this.logger.error(e)}if(this.wsContext.hasAnyFlutterProjects&&this.analyzer.capabilities.supportsFlutterOutline)try{yield this.analyzer.flutterSetSubscriptions({subscriptions:{OUTLINE:t}})}catch(e){this.logger.error(e)}}}))}pathsHaveChanged(e,t){return e.length!==t.length||e.some((e,i)=>e!==t[i])}validPathsFor(e){const t=this.analyzer.capabilities.supportsPriorityFilesOutsideAnalysisRoots?c.isAnalyzable:c.isAnalyzableAndInWorkspace;return e.filter(e=>!e.isClosed&&t(e)).map(e=>s.fsPath(e.uri)).sort((e,t)=>e.localeCompare(t))}getOutlineFor(e){return this.outlines[s.fsPath(e)]}waitForOutlineWithLength(e,t,i){return n(this,void 0,void 0,(function*(){return o.waitFor(()=>{const i=this.outlines[s.fsPath(e)];return(null==i?void 0:i.length)===t?i:void 0},50,5e3,i)}))}getFlutterOutlineFor(e){return this.flutterOutlines[s.fsPath(e)]}waitForFlutterOutlineWithLength(e,t,i){return n(this,void 0,void 0,(function*(){return o.waitFor(()=>{const i=this.flutterOutlines[s.fsPath(e)];return(null==i?void 0:i.length)===t?i:void 0},50,5e3,i)}))}getOccurrencesFor(e){return this.occurrences[s.fsPath(e)]}supportsPubRunTest(e){const t=s.fsPath(e);if(!c.isPubRunnableTestFile(t))return!1;if(void 0===this.pubRunTestSupport[t]){const e=a.locateBestProjectRoot(t);this.pubRunTestSupport[t]=!(!e||!c.projectShouldUsePubForTests(e,this.wsContext.config))}return this.pubRunTestSupport[s.fsPath(e)]}watchPubspec(){const e=()=>Object.keys(this.pubRunTestSupport).forEach(e=>delete this.pubRunTestSupport[e]),t=r.workspace.createFileSystemWatcher("**/pubspec.yaml");this.disposables.push(t),t.onDidChange(e,this),t.onDidCreate(e,this)}getFoldingRegionsFor(e){return this.folding[s.fsPath(e)]}getLastPriorityFiles(){return this.lastPriorityFiles.slice()}getLastSubscribedFiles(){return this.lastSubscribedFiles.slice()}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspAnalyzer=void 0;const r=i(2),s=i(58),o=i(0),a=i(93),c=i(96),l=i(110),u=i(4),d=i(8),h=i(13),f=i(10),g=i(15),p=i(112),m=i(187);class v extends l.Analyzer{constructor(e,t,i,n){super(new h.CategoryLogger(e,d.LogCategory.Analyzer)),this.client=function(e,t,i,n){const s={initializationOptions:{closingLabels:f.config.closingLabels,flutterOutline:n.hasAnyFlutterProjects,outline:!0},outputChannelName:"LSP"};return new a.LanguageClient("dartAnalysisLSP","Dart Analysis Server",()=>function(e,t,i){const n=r.join(t.dart,u.dartVMPath),s=p.getAnalyzerArgs(e,t,i,!0);e.info(`Spawning ${n} with args ${JSON.stringify(s)}`);const o=g.safeToolSpawn(void 0,n,s);e.info("    PID: "+o.pid);const a=o.stdout.pipe(new y(e,"<==")),c=new y(e,"==>");return c.pipe(o.stdin),o.stderr.on("data",t=>e.error(t.toString())),Promise.resolve({reader:a,writer:c})}(e,t,i),s)}(this.logger,t,i,n),this.fileTracker=new m.LspFileTracker(e,this.client,n),this.disposables.push(this.client.start()),this.disposables.push(this.fileTracker),this.client.onReady().then(()=>{this.client.onNotification(c.AnalyzerStatusNotification.type,e=>{this.onAnalysisStatusChangeEmitter.fire({isAnalyzing:e.isAnalyzing})}),this.onReadyCompleter.resolve()})}getDiagnosticServerPort(){return n(this,void 0,void 0,(function*(){return this.client.sendRequest(c.DiagnosticServerRequest.type,void 0)}))}forceReanalyze(){return n(this,void 0,void 0,(function*(){try{return yield this.client.sendRequest(c.ReanalyzeRequest.type,void 0)}catch(e){o.window.showErrorMessage("Reanalyze is not supported by this version of the Dart SDK's LSP server.")}}))}getSuper(e){return n(this,void 0,void 0,(function*(){return this.client.sendRequest(c.SuperRequest.type,e)}))}completeStatement(e){return n(this,void 0,void 0,(function*(){return this.client.sendRequest(c.CompleteStatementRequest.type,e)}))}}t.LspAnalyzer=v;class y extends s.Transform{constructor(e,t,i){super(i),this.logger=e,this.prefix=t}_transform(e,t,i){this.logger.info(`${this.prefix} ${e}`),this.push(e,t),i()}}},function(e,t){var i;t=e.exports=d,i="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var n=Number.MAX_SAFE_INTEGER||9007199254740991,r=t.re=[],s=t.src=[],o=t.tokens={},a=0;function c(e){o[e]=a++}c("NUMERICIDENTIFIER"),s[o.NUMERICIDENTIFIER]="0|[1-9]\\d*",c("NUMERICIDENTIFIERLOOSE"),s[o.NUMERICIDENTIFIERLOOSE]="[0-9]+",c("NONNUMERICIDENTIFIER"),s[o.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",c("MAINVERSION"),s[o.MAINVERSION]="("+s[o.NUMERICIDENTIFIER]+")\\.("+s[o.NUMERICIDENTIFIER]+")\\.("+s[o.NUMERICIDENTIFIER]+")",c("MAINVERSIONLOOSE"),s[o.MAINVERSIONLOOSE]="("+s[o.NUMERICIDENTIFIERLOOSE]+")\\.("+s[o.NUMERICIDENTIFIERLOOSE]+")\\.("+s[o.NUMERICIDENTIFIERLOOSE]+")",c("PRERELEASEIDENTIFIER"),s[o.PRERELEASEIDENTIFIER]="(?:"+s[o.NUMERICIDENTIFIER]+"|"+s[o.NONNUMERICIDENTIFIER]+")",c("PRERELEASEIDENTIFIERLOOSE"),s[o.PRERELEASEIDENTIFIERLOOSE]="(?:"+s[o.NUMERICIDENTIFIERLOOSE]+"|"+s[o.NONNUMERICIDENTIFIER]+")",c("PRERELEASE"),s[o.PRERELEASE]="(?:-("+s[o.PRERELEASEIDENTIFIER]+"(?:\\."+s[o.PRERELEASEIDENTIFIER]+")*))",c("PRERELEASELOOSE"),s[o.PRERELEASELOOSE]="(?:-?("+s[o.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+s[o.PRERELEASEIDENTIFIERLOOSE]+")*))",c("BUILDIDENTIFIER"),s[o.BUILDIDENTIFIER]="[0-9A-Za-z-]+",c("BUILD"),s[o.BUILD]="(?:\\+("+s[o.BUILDIDENTIFIER]+"(?:\\."+s[o.BUILDIDENTIFIER]+")*))",c("FULL"),c("FULLPLAIN"),s[o.FULLPLAIN]="v?"+s[o.MAINVERSION]+s[o.PRERELEASE]+"?"+s[o.BUILD]+"?",s[o.FULL]="^"+s[o.FULLPLAIN]+"$",c("LOOSEPLAIN"),s[o.LOOSEPLAIN]="[v=\\s]*"+s[o.MAINVERSIONLOOSE]+s[o.PRERELEASELOOSE]+"?"+s[o.BUILD]+"?",c("LOOSE"),s[o.LOOSE]="^"+s[o.LOOSEPLAIN]+"$",c("GTLT"),s[o.GTLT]="((?:<|>)?=?)",c("XRANGEIDENTIFIERLOOSE"),s[o.XRANGEIDENTIFIERLOOSE]=s[o.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",c("XRANGEIDENTIFIER"),s[o.XRANGEIDENTIFIER]=s[o.NUMERICIDENTIFIER]+"|x|X|\\*",c("XRANGEPLAIN"),s[o.XRANGEPLAIN]="[v=\\s]*("+s[o.XRANGEIDENTIFIER]+")(?:\\.("+s[o.XRANGEIDENTIFIER]+")(?:\\.("+s[o.XRANGEIDENTIFIER]+")(?:"+s[o.PRERELEASE]+")?"+s[o.BUILD]+"?)?)?",c("XRANGEPLAINLOOSE"),s[o.XRANGEPLAINLOOSE]="[v=\\s]*("+s[o.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+s[o.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+s[o.XRANGEIDENTIFIERLOOSE]+")(?:"+s[o.PRERELEASELOOSE]+")?"+s[o.BUILD]+"?)?)?",c("XRANGE"),s[o.XRANGE]="^"+s[o.GTLT]+"\\s*"+s[o.XRANGEPLAIN]+"$",c("XRANGELOOSE"),s[o.XRANGELOOSE]="^"+s[o.GTLT]+"\\s*"+s[o.XRANGEPLAINLOOSE]+"$",c("COERCE"),s[o.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",c("COERCERTL"),r[o.COERCERTL]=new RegExp(s[o.COERCE],"g"),c("LONETILDE"),s[o.LONETILDE]="(?:~>?)",c("TILDETRIM"),s[o.TILDETRIM]="(\\s*)"+s[o.LONETILDE]+"\\s+",r[o.TILDETRIM]=new RegExp(s[o.TILDETRIM],"g");c("TILDE"),s[o.TILDE]="^"+s[o.LONETILDE]+s[o.XRANGEPLAIN]+"$",c("TILDELOOSE"),s[o.TILDELOOSE]="^"+s[o.LONETILDE]+s[o.XRANGEPLAINLOOSE]+"$",c("LONECARET"),s[o.LONECARET]="(?:\\^)",c("CARETTRIM"),s[o.CARETTRIM]="(\\s*)"+s[o.LONECARET]+"\\s+",r[o.CARETTRIM]=new RegExp(s[o.CARETTRIM],"g");c("CARET"),s[o.CARET]="^"+s[o.LONECARET]+s[o.XRANGEPLAIN]+"$",c("CARETLOOSE"),s[o.CARETLOOSE]="^"+s[o.LONECARET]+s[o.XRANGEPLAINLOOSE]+"$",c("COMPARATORLOOSE"),s[o.COMPARATORLOOSE]="^"+s[o.GTLT]+"\\s*("+s[o.LOOSEPLAIN]+")$|^$",c("COMPARATOR"),s[o.COMPARATOR]="^"+s[o.GTLT]+"\\s*("+s[o.FULLPLAIN]+")$|^$",c("COMPARATORTRIM"),s[o.COMPARATORTRIM]="(\\s*)"+s[o.GTLT]+"\\s*("+s[o.LOOSEPLAIN]+"|"+s[o.XRANGEPLAIN]+")",r[o.COMPARATORTRIM]=new RegExp(s[o.COMPARATORTRIM],"g");c("HYPHENRANGE"),s[o.HYPHENRANGE]="^\\s*("+s[o.XRANGEPLAIN]+")\\s+-\\s+("+s[o.XRANGEPLAIN]+")\\s*$",c("HYPHENRANGELOOSE"),s[o.HYPHENRANGELOOSE]="^\\s*("+s[o.XRANGEPLAINLOOSE]+")\\s+-\\s+("+s[o.XRANGEPLAINLOOSE]+")\\s*$",c("STAR"),s[o.STAR]="(<|>)?=?\\s*\\*";for(var l=0;l<a;l++)i(l,s[l]),r[l]||(r[l]=new RegExp(s[l]));function u(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof d)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?r[o.LOOSE]:r[o.FULL]).test(e))return null;try{return new d(e,t)}catch(e){return null}}function d(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof d){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof d))return new d(e,t);i("SemVer",e,t),this.options=t,this.loose=!!t.loose;var s=e.trim().match(t.loose?r[o.LOOSE]:r[o.FULL]);if(!s)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>n||this.major<0)throw new TypeError("Invalid major version");if(this.minor>n||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>n||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<n)return t}return e})):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}t.parse=u,t.valid=function(e,t){var i=u(e,t);return i?i.version:null},t.clean=function(e,t){var i=u(e.trim().replace(/^[=v]+/,""),t);return i?i.version:null},t.SemVer=d,d.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},d.prototype.toString=function(){return this.version},d.prototype.compare=function(e){return i("SemVer.compare",this.version,this.options,e),e instanceof d||(e=new d(e,this.options)),this.compareMain(e)||this.comparePre(e)},d.prototype.compareMain=function(e){return e instanceof d||(e=new d(e,this.options)),f(this.major,e.major)||f(this.minor,e.minor)||f(this.patch,e.patch)},d.prototype.comparePre=function(e){if(e instanceof d||(e=new d(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],r=e.prerelease[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return f(n,r)}while(++t)},d.prototype.compareBuild=function(e){e instanceof d||(e=new d(e,this.options));var t=0;do{var n=this.build[t],r=e.build[t];if(i("prerelease compare",t,n,r),void 0===n&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===n)return-1;if(n!==r)return f(n,r)}while(++t)},d.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var i=this.prerelease.length;--i>=0;)"number"==typeof this.prerelease[i]&&(this.prerelease[i]++,i=-2);-1===i&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,i,n){"string"==typeof i&&(n=i,i=void 0);try{return new d(e,i).inc(t,n).version}catch(e){return null}},t.diff=function(e,t){if(v(e,t))return null;var i=u(e),n=u(t),r="";if(i.prerelease.length||n.prerelease.length){r="pre";var s="prerelease"}for(var o in i)if(("major"===o||"minor"===o||"patch"===o)&&i[o]!==n[o])return r+o;return s},t.compareIdentifiers=f;var h=/^[0-9]+$/;function f(e,t){var i=h.test(e),n=h.test(t);return i&&n&&(e=+e,t=+t),e===t?0:i&&!n?-1:n&&!i?1:e<t?-1:1}function g(e,t,i){return new d(e,i).compare(new d(t,i))}function p(e,t,i){return g(e,t,i)>0}function m(e,t,i){return g(e,t,i)<0}function v(e,t,i){return 0===g(e,t,i)}function y(e,t,i){return 0!==g(e,t,i)}function b(e,t,i){return g(e,t,i)>=0}function C(e,t,i){return g(e,t,i)<=0}function w(e,t,i,n){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e===i;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof i&&(i=i.version),e!==i;case"":case"=":case"==":return v(e,i,n);case"!=":return y(e,i,n);case">":return p(e,i,n);case">=":return b(e,i,n);case"<":return m(e,i,n);case"<=":return C(e,i,n);default:throw new TypeError("Invalid operator: "+t)}}function S(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof S){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof S))return new S(e,t);i("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===T?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}t.rcompareIdentifiers=function(e,t){return f(t,e)},t.major=function(e,t){return new d(e,t).major},t.minor=function(e,t){return new d(e,t).minor},t.patch=function(e,t){return new d(e,t).patch},t.compare=g,t.compareLoose=function(e,t){return g(e,t,!0)},t.compareBuild=function(e,t,i){var n=new d(e,i),r=new d(t,i);return n.compare(r)||n.compareBuild(r)},t.rcompare=function(e,t,i){return g(t,e,i)},t.sort=function(e,i){return e.sort((function(e,n){return t.compareBuild(e,n,i)}))},t.rsort=function(e,i){return e.sort((function(e,n){return t.compareBuild(n,e,i)}))},t.gt=p,t.lt=m,t.eq=v,t.neq=y,t.gte=b,t.lte=C,t.cmp=w,t.Comparator=S;var T={};function E(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof E)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new E(e.raw,t);if(e instanceof S)return new E(e.value,t);if(!(this instanceof E))return new E(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function P(e,t){for(var i=!0,n=e.slice(),r=n.pop();i&&n.length;)i=n.every((function(e){return r.intersects(e,t)})),r=n.pop();return i}function R(e){return!e||"x"===e.toLowerCase()||"*"===e}function D(e,t,i,n,r,s,o,a,c,l,u,d,h){return((t=R(i)?"":R(n)?">="+i+".0.0":R(r)?">="+i+"."+n+".0":">="+t)+" "+(a=R(c)?"":R(l)?"<"+(+c+1)+".0.0":R(u)?"<"+c+"."+(+l+1)+".0":d?"<="+c+"."+l+"."+u+"-"+d:"<="+a)).trim()}function k(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==T&&e[r].semver.prerelease.length>0){var s=e[r].semver;if(s.major===t.major&&s.minor===t.minor&&s.patch===t.patch)return!0}return!1}return!0}function x(e,t,i){try{t=new E(t,i)}catch(e){return!1}return t.test(e)}function F(e,t,i,n){var r,s,o,a,c;switch(e=new d(e,n),t=new E(t,n),i){case">":r=p,s=C,o=m,a=">",c=">=";break;case"<":r=m,s=b,o=p,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(x(e,t,n))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],h=null,f=null;if(u.forEach((function(e){e.semver===T&&(e=new S(">=0.0.0")),h=h||e,f=f||e,r(e.semver,h.semver,n)?h=e:o(e.semver,f.semver,n)&&(f=e)})),h.operator===a||h.operator===c)return!1;if((!f.operator||f.operator===a)&&s(e,f.semver))return!1;if(f.operator===c&&o(e,f.semver))return!1}return!0}S.prototype.parse=function(e){var t=this.options.loose?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],i=e.match(t);if(!i)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new d(i[2],this.options.loose):this.semver=T},S.prototype.toString=function(){return this.value},S.prototype.test=function(e){if(i("Comparator.test",e,this.options.loose),this.semver===T||e===T)return!0;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}return w(e,this.operator,this.semver,this.options)},S.prototype.intersects=function(e,t){if(!(e instanceof S))throw new TypeError("a Comparator is required");var i;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(i=new E(e.value,t),x(this.value,i,t));if(""===e.operator)return""===e.value||(i=new E(this.value,t),x(e.semver,i,t));var n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),s=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=w(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),c=w(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||s&&o||a||c},t.Range=E,E.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},E.prototype.toString=function(){return this.range},E.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?r[o.HYPHENRANGELOOSE]:r[o.HYPHENRANGE];e=e.replace(n,D),i("hyphen replace",e),e=e.replace(r[o.COMPARATORTRIM],"$1$2$3"),i("comparator trim",e,r[o.COMPARATORTRIM]),e=(e=(e=e.replace(r[o.TILDETRIM],"$1~")).replace(r[o.CARETTRIM],"$1^")).split(/\s+/).join(" ");var s=t?r[o.COMPARATORLOOSE]:r[o.COMPARATOR],a=e.split(" ").map((function(e){return function(e,t){return i("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){i("caret",e,t);var n=t.loose?r[o.CARETLOOSE]:r[o.CARET];return e.replace(n,(function(t,n,r,s,o){var a;return i("caret",e,t,n,r,s,o),R(n)?a="":R(r)?a=">="+n+".0.0 <"+(+n+1)+".0.0":R(s)?a="0"===n?">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":">="+n+"."+r+".0 <"+(+n+1)+".0.0":o?(i("replaceCaret pr",o),a="0"===n?"0"===r?">="+n+"."+r+"."+s+"-"+o+" <"+n+"."+r+"."+(+s+1):">="+n+"."+r+"."+s+"-"+o+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+s+"-"+o+" <"+(+n+1)+".0.0"):(i("no pr"),a="0"===n?"0"===r?">="+n+"."+r+"."+s+" <"+n+"."+r+"."+(+s+1):">="+n+"."+r+"."+s+" <"+n+"."+(+r+1)+".0":">="+n+"."+r+"."+s+" <"+(+n+1)+".0.0"),i("caret return",a),a}))}(e,t)})).join(" ")}(e,t),i("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var n=t.loose?r[o.TILDELOOSE]:r[o.TILDE];return e.replace(n,(function(t,n,r,s,o){var a;return i("tilde",e,t,n,r,s,o),R(n)?a="":R(r)?a=">="+n+".0.0 <"+(+n+1)+".0.0":R(s)?a=">="+n+"."+r+".0 <"+n+"."+(+r+1)+".0":o?(i("replaceTilde pr",o),a=">="+n+"."+r+"."+s+"-"+o+" <"+n+"."+(+r+1)+".0"):a=">="+n+"."+r+"."+s+" <"+n+"."+(+r+1)+".0",i("tilde return",a),a}))}(e,t)})).join(" ")}(e,t),i("tildes",e),e=function(e,t){return i("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var n=t.loose?r[o.XRANGELOOSE]:r[o.XRANGE];return e.replace(n,(function(n,r,s,o,a,c){i("xRange",e,n,r,s,o,a,c);var l=R(s),u=l||R(o),d=u||R(a),h=d;return"="===r&&h&&(r=""),c=t.includePrerelease?"-0":"",l?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(u&&(o=0),a=0,">"===r?(r=">=",u?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",u?s=+s+1:o=+o+1),n=r+s+"."+o+"."+a+c):u?n=">="+s+".0.0"+c+" <"+(+s+1)+".0.0"+c:d&&(n=">="+s+"."+o+".0"+c+" <"+s+"."+(+o+1)+".0"+c),i("xRange return",n),n}))}(e,t)})).join(" ")}(e,t),i("xrange",e),e=function(e,t){return i("replaceStars",e,t),e.trim().replace(r[o.STAR],"")}(e,t),i("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter((function(e){return!!e.match(s)}))),a=a.map((function(e){return new S(e,this.options)}),this)},E.prototype.intersects=function(e,t){if(!(e instanceof E))throw new TypeError("a Range is required");return this.set.some((function(i){return P(i,t)&&e.set.some((function(e){return P(e,t)&&i.every((function(i){return e.every((function(e){return i.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new E(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},E.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new d(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(k(this.set[t],e,this.options))return!0;return!1},t.satisfies=x,t.maxSatisfying=function(e,t,i){var n=null,r=null;try{var s=new E(t,i)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(n&&-1!==r.compare(e)||(r=new d(n=e,i)))})),n},t.minSatisfying=function(e,t,i){var n=null,r=null;try{var s=new E(t,i)}catch(e){return null}return e.forEach((function(e){s.test(e)&&(n&&1!==r.compare(e)||(r=new d(n=e,i)))})),n},t.minVersion=function(e,t){e=new E(e,t);var i=new d("0.0.0");if(e.test(i))return i;if(i=new d("0.0.0-0"),e.test(i))return i;i=null;for(var n=0;n<e.set.length;++n){e.set[n].forEach((function(e){var t=new d(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":i&&!p(i,t)||(i=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(i&&e.test(i))return i;return null},t.validRange=function(e,t){try{return new E(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,i){return F(e,t,"<",i)},t.gtr=function(e,t,i){return F(e,t,">",i)},t.outside=F,t.prerelease=function(e,t){var i=u(e,t);return i&&i.prerelease.length?i.prerelease:null},t.intersects=function(e,t,i){return e=new E(e,i),t=new E(t,i),e.intersects(t)},t.coerce=function(e,t){if(e instanceof d)return e;"number"==typeof e&&(e=String(e));if("string"!=typeof e)return null;var i=null;if((t=t||{}).rtl){for(var n;(n=r[o.COERCERTL].exec(e))&&(!i||i.index+i[0].length!==e.length);)i&&n.index+n[0].length===i.index+i[0].length||(i=n),r[o.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;r[o.COERCERTL].lastIndex=-1}else i=e.match(r[o.COERCE]);if(null===i)return null;return u(i[2]+"."+(i[3]||"0")+"."+(i[4]||"0"),t)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(50);var r;!function(e){e.ParseError=-32700,e.InvalidRequest=-32600,e.MethodNotFound=-32601,e.InvalidParams=-32602,e.InternalError=-32603,e.serverErrorStart=-32099,e.serverErrorEnd=-32e3,e.ServerNotInitialized=-32002,e.UnknownErrorCode=-32001,e.RequestCancelled=-32800,e.ContentModified=-32801,e.MessageWriteError=1,e.MessageReadError=2}(r=t.ErrorCodes||(t.ErrorCodes={}));class s extends Error{constructor(e,t,i){super(t),this.code=n.number(e)?e:r.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,s.prototype)}toJson(){return{code:this.code,message:this.message,data:this.data}}}t.ResponseError=s;class o{constructor(e,t){this._method=e,this._numberOfParams=t}get method(){return this._method}get numberOfParams(){return this._numberOfParams}}t.AbstractMessageType=o;t.RequestType0=class extends o{constructor(e){super(e,0)}};t.RequestType=class extends o{constructor(e){super(e,1)}};t.RequestType1=class extends o{constructor(e){super(e,1)}};t.RequestType2=class extends o{constructor(e){super(e,2)}};t.RequestType3=class extends o{constructor(e){super(e,3)}};t.RequestType4=class extends o{constructor(e){super(e,4)}};t.RequestType5=class extends o{constructor(e){super(e,5)}};t.RequestType6=class extends o{constructor(e){super(e,6)}};t.RequestType7=class extends o{constructor(e){super(e,7)}};t.RequestType8=class extends o{constructor(e){super(e,8)}};t.RequestType9=class extends o{constructor(e){super(e,9)}};t.NotificationType=class extends o{constructor(e){super(e,1),this._=void 0}};t.NotificationType0=class extends o{constructor(e){super(e,0)}};t.NotificationType1=class extends o{constructor(e){super(e,1)}};t.NotificationType2=class extends o{constructor(e){super(e,2)}};t.NotificationType3=class extends o{constructor(e){super(e,3)}};t.NotificationType4=class extends o{constructor(e){super(e,4)}};t.NotificationType5=class extends o{constructor(e){super(e,5)}};t.NotificationType6=class extends o{constructor(e){super(e,6)}};t.NotificationType7=class extends o{constructor(e){super(e,7)}};t.NotificationType8=class extends o{constructor(e){super(e,8)}};t.NotificationType9=class extends o{constructor(e){super(e,9)}},t.isRequestMessage=function(e){let t=e;return t&&n.string(t.method)&&(n.string(t.id)||n.number(t.id))},t.isNotificationMessage=function(e){let t=e;return t&&n.string(t.method)&&void 0===e.id},t.isResponseMessage=function(e){let t=e;return t&&(void 0!==t.result||!!t.error)&&(n.string(t.id)||n.number(t.id)||null===t.id)}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(59),r=i(50);var s;!function(e){e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:n.Event.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:n.Event.None}),e.is=function(t){let i=t;return i&&(i===e.None||i===e.Cancelled||r.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}}(s=t.CancellationToken||(t.CancellationToken={}));const o=Object.freeze((function(e,t){let i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}));class a{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?o:(this._emitter||(this._emitter=new n.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}t.CancellationTokenSource=class{get token(){return this._token||(this._token=new a),this._token}cancel(){this._token?this._token.cancel():this._token=s.Cancelled}dispose(){this._token?this._token instanceof a&&this._token.dispose():this._token=s.None}}},function(e,t,i){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.None=0,e.First=1,e.Last=2}(n=t.Touch||(t.Touch={}));t.LinkedMap=class{constructor(){this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}has(e){return this._map.has(e)}get(e){const t=this._map.get(e);if(t)return t.value}set(e,t,i=n.None){let r=this._map.get(e);if(r)r.value=t,i!==n.None&&this.touch(r,i);else{switch(r={key:e,value:t,next:void 0,previous:void 0},i){case n.None:this.addItemLast(r);break;case n.First:this.addItemFirst(r);break;case n.Last:default:this.addItemLast(r)}this._map.set(e,r),this._size++}}delete(e){const t=this._map.get(e);return!!t&&(this._map.delete(e),this.removeItem(t),this._size--,!0)}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let i=this._head;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.next}forEachReverse(e,t){let i=this._tail;for(;i;)t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),i=i.previous}values(){let e=[],t=this._head;for(;t;)e.push(t.value),t=t.next;return e}keys(){let e=[],t=this._head;for(;t;)e.push(t.key),t=t.next;return e}addItemFirst(e){if(this._head||this._tail){if(!this._head)throw new Error("Invalid list");e.next=this._head,this._head.previous=e}else this._tail=e;this._head=e}addItemLast(e){if(this._head||this._tail){if(!this._tail)throw new Error("Invalid list");e.previous=this._tail,this._tail.next=e}else this._head=e;this._tail=e}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head)this._head=e.next;else if(e===this._tail)this._tail=e.previous;else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(t===n.First||t===n.Last)if(t===n.First){if(e===this._head)return;const t=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(t.previous=i,i.next=t),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e}else if(t===n.Last){if(e===this._tail)return;const t=e.next,i=e.previous;e===this._head?(t.previous=void 0,this._head=t):(t.previous=i,i.next=t),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(2),r=i(18),s=i(51),o=i(52),a=i(94),c=i(95);t.generateRandomPipeName=function(){const e=s.randomBytes(21).toString("hex");return"win32"===process.platform?`\\\\.\\pipe\\vscode-jsonrpc-${e}-sock`:n.join(r.tmpdir(),`vscode-${e}.sock`)},t.createClientPipeTransport=function(e,t="utf-8"){let i,n=new Promise((e,t)=>{i=e});return new Promise((r,s)=>{let l=o.createServer(e=>{l.close(),i([new a.SocketMessageReader(e,t),new c.SocketMessageWriter(e,t)])});l.on("error",s),l.listen(e,()=>{l.removeListener("error",s),r({onConnected:()=>n})})})},t.createServerPipeTransport=function(e,t="utf-8"){const i=o.createConnection(e);return[new a.SocketMessageReader(i,t),new c.SocketMessageWriter(i,t)]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(52),r=i(94),s=i(95);t.createClientSocketTransport=function(e,t="utf-8"){let i,o=new Promise((e,t)=>{i=e});return new Promise((a,c)=>{let l=n.createServer(e=>{l.close(),i([new r.SocketMessageReader(e,t),new s.SocketMessageWriter(e,t)])});l.on("error",c),l.listen(e,"127.0.0.1",()=>{l.removeListener("error",c),a({onConnected:()=>o})})})},t.createServerSocketTransport=function(e,t="utf-8"){const i=n.createConnection(e,"127.0.0.1");return[new r.SocketMessageReader(i,t),new s.SocketMessageWriter(i,t)]}},function(e,t,i){"use strict";var n,r,s,o,a,c,l,u,d,h,f,g,p,m,v,y,b,C,w,S;i.r(t),i.d(t,"Position",(function(){return n})),i.d(t,"Range",(function(){return r})),i.d(t,"Location",(function(){return s})),i.d(t,"LocationLink",(function(){return o})),i.d(t,"Color",(function(){return a})),i.d(t,"ColorInformation",(function(){return c})),i.d(t,"ColorPresentation",(function(){return l})),i.d(t,"FoldingRangeKind",(function(){return u})),i.d(t,"FoldingRange",(function(){return d})),i.d(t,"DiagnosticRelatedInformation",(function(){return h})),i.d(t,"DiagnosticSeverity",(function(){return f})),i.d(t,"DiagnosticTag",(function(){return g})),i.d(t,"Diagnostic",(function(){return p})),i.d(t,"Command",(function(){return m})),i.d(t,"TextEdit",(function(){return v})),i.d(t,"TextDocumentEdit",(function(){return y})),i.d(t,"CreateFile",(function(){return b})),i.d(t,"RenameFile",(function(){return C})),i.d(t,"DeleteFile",(function(){return w})),i.d(t,"WorkspaceEdit",(function(){return S})),i.d(t,"WorkspaceChange",(function(){return Y})),i.d(t,"TextDocumentIdentifier",(function(){return T})),i.d(t,"VersionedTextDocumentIdentifier",(function(){return E})),i.d(t,"TextDocumentItem",(function(){return P})),i.d(t,"MarkupKind",(function(){return R})),i.d(t,"MarkupContent",(function(){return D})),i.d(t,"CompletionItemKind",(function(){return k})),i.d(t,"InsertTextFormat",(function(){return x})),i.d(t,"CompletionItemTag",(function(){return F})),i.d(t,"CompletionItem",(function(){return O})),i.d(t,"CompletionList",(function(){return _})),i.d(t,"MarkedString",(function(){return A})),i.d(t,"Hover",(function(){return I})),i.d(t,"ParameterInformation",(function(){return L})),i.d(t,"SignatureInformation",(function(){return N})),i.d(t,"DocumentHighlightKind",(function(){return M})),i.d(t,"DocumentHighlight",(function(){return j})),i.d(t,"SymbolKind",(function(){return U})),i.d(t,"SymbolTag",(function(){return q})),i.d(t,"SymbolInformation",(function(){return $})),i.d(t,"DocumentSymbol",(function(){return W})),i.d(t,"CodeActionKind",(function(){return G})),i.d(t,"CodeActionContext",(function(){return z})),i.d(t,"CodeAction",(function(){return H})),i.d(t,"CodeLens",(function(){return V})),i.d(t,"FormattingOptions",(function(){return K})),i.d(t,"DocumentLink",(function(){return B})),i.d(t,"SelectionRange",(function(){return X})),i.d(t,"EOL",(function(){return Z})),i.d(t,"TextDocument",(function(){return Q})),function(e){e.create=function(e,t){return{line:e,character:t}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.number(t.line)&&ee.number(t.character)}}(n||(n={})),function(e){e.create=function(e,t,i,r){if(ee.number(e)&&ee.number(t)&&ee.number(i)&&ee.number(r))return{start:n.create(e,t),end:n.create(i,r)};if(n.is(e)&&n.is(t))return{start:e,end:t};throw new Error("Range#create called with invalid arguments["+e+", "+t+", "+i+", "+r+"]")},e.is=function(e){var t=e;return ee.objectLiteral(t)&&n.is(t.start)&&n.is(t.end)}}(r||(r={})),function(e){e.create=function(e,t){return{uri:e,range:t}},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.range)&&(ee.string(t.uri)||ee.undefined(t.uri))}}(s||(s={})),function(e){e.create=function(e,t,i,n){return{targetUri:e,targetRange:t,targetSelectionRange:i,originSelectionRange:n}},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.targetRange)&&ee.string(t.targetUri)&&(r.is(t.targetSelectionRange)||ee.undefined(t.targetSelectionRange))&&(r.is(t.originSelectionRange)||ee.undefined(t.originSelectionRange))}}(o||(o={})),function(e){e.create=function(e,t,i,n){return{red:e,green:t,blue:i,alpha:n}},e.is=function(e){var t=e;return ee.number(t.red)&&ee.number(t.green)&&ee.number(t.blue)&&ee.number(t.alpha)}}(a||(a={})),function(e){e.create=function(e,t){return{range:e,color:t}},e.is=function(e){var t=e;return r.is(t.range)&&a.is(t.color)}}(c||(c={})),function(e){e.create=function(e,t,i){return{label:e,textEdit:t,additionalTextEdits:i}},e.is=function(e){var t=e;return ee.string(t.label)&&(ee.undefined(t.textEdit)||v.is(t))&&(ee.undefined(t.additionalTextEdits)||ee.typedArray(t.additionalTextEdits,v.is))}}(l||(l={})),function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(u||(u={})),function(e){e.create=function(e,t,i,n,r){var s={startLine:e,endLine:t};return ee.defined(i)&&(s.startCharacter=i),ee.defined(n)&&(s.endCharacter=n),ee.defined(r)&&(s.kind=r),s},e.is=function(e){var t=e;return ee.number(t.startLine)&&ee.number(t.startLine)&&(ee.undefined(t.startCharacter)||ee.number(t.startCharacter))&&(ee.undefined(t.endCharacter)||ee.number(t.endCharacter))&&(ee.undefined(t.kind)||ee.string(t.kind))}}(d||(d={})),function(e){e.create=function(e,t){return{location:e,message:t}},e.is=function(e){var t=e;return ee.defined(t)&&s.is(t.location)&&ee.string(t.message)}}(h||(h={})),function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4}(f||(f={})),function(e){e.Unnecessary=1,e.Deprecated=2}(g||(g={})),function(e){e.create=function(e,t,i,n,r,s){var o={range:e,message:t};return ee.defined(i)&&(o.severity=i),ee.defined(n)&&(o.code=n),ee.defined(r)&&(o.source=r),ee.defined(s)&&(o.relatedInformation=s),o},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.range)&&ee.string(t.message)&&(ee.number(t.severity)||ee.undefined(t.severity))&&(ee.number(t.code)||ee.string(t.code)||ee.undefined(t.code))&&(ee.string(t.source)||ee.undefined(t.source))&&(ee.undefined(t.relatedInformation)||ee.typedArray(t.relatedInformation,h.is))}}(p||(p={})),function(e){e.create=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r={title:e,command:t};return ee.defined(i)&&i.length>0&&(r.arguments=i),r},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.title)&&ee.string(t.command)}}(m||(m={})),function(e){e.replace=function(e,t){return{range:e,newText:t}},e.insert=function(e,t){return{range:{start:e,end:e},newText:t}},e.del=function(e){return{range:e,newText:""}},e.is=function(e){var t=e;return ee.objectLiteral(t)&&ee.string(t.newText)&&r.is(t.range)}}(v||(v={})),function(e){e.create=function(e,t){return{textDocument:e,edits:t}},e.is=function(e){var t=e;return ee.defined(t)&&E.is(t.textDocument)&&Array.isArray(t.edits)}}(y||(y={})),function(e){e.create=function(e,t){var i={kind:"create",uri:e};return void 0===t||void 0===t.overwrite&&void 0===t.ignoreIfExists||(i.options=t),i},e.is=function(e){var t=e;return t&&"create"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(b||(b={})),function(e){e.create=function(e,t,i){var n={kind:"rename",oldUri:e,newUri:t};return void 0===i||void 0===i.overwrite&&void 0===i.ignoreIfExists||(n.options=i),n},e.is=function(e){var t=e;return t&&"rename"===t.kind&&ee.string(t.oldUri)&&ee.string(t.newUri)&&(void 0===t.options||(void 0===t.options.overwrite||ee.boolean(t.options.overwrite))&&(void 0===t.options.ignoreIfExists||ee.boolean(t.options.ignoreIfExists)))}}(C||(C={})),function(e){e.create=function(e,t){var i={kind:"delete",uri:e};return void 0===t||void 0===t.recursive&&void 0===t.ignoreIfNotExists||(i.options=t),i},e.is=function(e){var t=e;return t&&"delete"===t.kind&&ee.string(t.uri)&&(void 0===t.options||(void 0===t.options.recursive||ee.boolean(t.options.recursive))&&(void 0===t.options.ignoreIfNotExists||ee.boolean(t.options.ignoreIfNotExists)))}}(w||(w={})),function(e){e.is=function(e){var t=e;return t&&(void 0!==t.changes||void 0!==t.documentChanges)&&(void 0===t.documentChanges||t.documentChanges.every((function(e){return ee.string(e.kind)?b.is(e)||C.is(e)||w.is(e):y.is(e)})))}}(S||(S={}));var T,E,P,R,D,k,x,F,O,_,A,I,L,N,M,j,U,q,$,W,G,z,H,V,K,B,X,J=function(){function e(e){this.edits=e}return e.prototype.insert=function(e,t){this.edits.push(v.insert(e,t))},e.prototype.replace=function(e,t){this.edits.push(v.replace(e,t))},e.prototype.delete=function(e){this.edits.push(v.del(e))},e.prototype.add=function(e){this.edits.push(e)},e.prototype.all=function(){return this.edits},e.prototype.clear=function(){this.edits.splice(0,this.edits.length)},e}(),Y=function(){function e(e){var t=this;this._textEditChanges=Object.create(null),e&&(this._workspaceEdit=e,e.documentChanges?e.documentChanges.forEach((function(e){if(y.is(e)){var i=new J(e.edits);t._textEditChanges[e.textDocument.uri]=i}})):e.changes&&Object.keys(e.changes).forEach((function(i){var n=new J(e.changes[i]);t._textEditChanges[i]=n})))}return Object.defineProperty(e.prototype,"edit",{get:function(){return this._workspaceEdit},enumerable:!0,configurable:!0}),e.prototype.getTextEditChange=function(e){if(E.is(e)){if(this._workspaceEdit||(this._workspaceEdit={documentChanges:[]}),!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.");var t=e;if(!(n=this._textEditChanges[t.uri])){var i={textDocument:t,edits:r=[]};this._workspaceEdit.documentChanges.push(i),n=new J(r),this._textEditChanges[t.uri]=n}return n}if(this._workspaceEdit||(this._workspaceEdit={changes:Object.create(null)}),!this._workspaceEdit.changes)throw new Error("Workspace edit is not configured for normal text edit changes.");var n;if(!(n=this._textEditChanges[e])){var r=[];this._workspaceEdit.changes[e]=r,n=new J(r),this._textEditChanges[e]=n}return n},e.prototype.createFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(b.create(e,t))},e.prototype.renameFile=function(e,t,i){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(C.create(e,t,i))},e.prototype.deleteFile=function(e,t){this.checkDocumentChanges(),this._workspaceEdit.documentChanges.push(w.create(e,t))},e.prototype.checkDocumentChanges=function(){if(!this._workspaceEdit||!this._workspaceEdit.documentChanges)throw new Error("Workspace edit is not configured for document changes.")},e}();!function(e){e.create=function(e){return{uri:e}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)}}(T||(T={})),function(e){e.create=function(e,t){return{uri:e,version:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&(null===t.version||ee.number(t.version))}}(E||(E={})),function(e){e.create=function(e,t,i,n){return{uri:e,languageId:t,version:i,text:n}},e.is=function(e){var t=e;return ee.defined(t)&&ee.string(t.uri)&&ee.string(t.languageId)&&ee.number(t.version)&&ee.string(t.text)}}(P||(P={})),function(e){e.PlainText="plaintext",e.Markdown="markdown"}(R||(R={})),function(e){e.is=function(t){var i=t;return i===e.PlainText||i===e.Markdown}}(R||(R={})),function(e){e.is=function(e){var t=e;return ee.objectLiteral(e)&&R.is(t.kind)&&ee.string(t.value)}}(D||(D={})),function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25}(k||(k={})),function(e){e.PlainText=1,e.Snippet=2}(x||(x={})),function(e){e.Deprecated=1}(F||(F={})),function(e){e.create=function(e){return{label:e}}}(O||(O={})),function(e){e.create=function(e,t){return{items:e||[],isIncomplete:!!t}}}(_||(_={})),function(e){e.fromPlainText=function(e){return e.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")},e.is=function(e){var t=e;return ee.string(t)||ee.objectLiteral(t)&&ee.string(t.language)&&ee.string(t.value)}}(A||(A={})),function(e){e.is=function(e){var t=e;return!!t&&ee.objectLiteral(t)&&(D.is(t.contents)||A.is(t.contents)||ee.typedArray(t.contents,A.is))&&(void 0===e.range||r.is(e.range))}}(I||(I={})),function(e){e.create=function(e,t){return t?{label:e,documentation:t}:{label:e}}}(L||(L={})),function(e){e.create=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var r={label:e};return ee.defined(t)&&(r.documentation=t),ee.defined(i)?r.parameters=i:r.parameters=[],r}}(N||(N={})),function(e){e.Text=1,e.Read=2,e.Write=3}(M||(M={})),function(e){e.create=function(e,t){var i={range:e};return ee.number(t)&&(i.kind=t),i}}(j||(j={})),function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26}(U||(U={})),function(e){e.Deprecated=1}(q||(q={})),function(e){e.create=function(e,t,i,n,r){var s={name:e,kind:t,location:{uri:n,range:i}};return r&&(s.containerName=r),s}}($||($={})),function(e){e.create=function(e,t,i,n,r,s){var o={name:e,detail:t,kind:i,range:n,selectionRange:r};return void 0!==s&&(o.children=s),o},e.is=function(e){var t=e;return t&&ee.string(t.name)&&ee.number(t.kind)&&r.is(t.range)&&r.is(t.selectionRange)&&(void 0===t.detail||ee.string(t.detail))&&(void 0===t.deprecated||ee.boolean(t.deprecated))&&(void 0===t.children||Array.isArray(t.children))}}(W||(W={})),function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"}(G||(G={})),function(e){e.create=function(e,t){var i={diagnostics:e};return null!=t&&(i.only=t),i},e.is=function(e){var t=e;return ee.defined(t)&&ee.typedArray(t.diagnostics,p.is)&&(void 0===t.only||ee.typedArray(t.only,ee.string))}}(z||(z={})),function(e){e.create=function(e,t,i){var n={title:e};return m.is(t)?n.command=t:n.edit=t,void 0!==i&&(n.kind=i),n},e.is=function(e){var t=e;return t&&ee.string(t.title)&&(void 0===t.diagnostics||ee.typedArray(t.diagnostics,p.is))&&(void 0===t.kind||ee.string(t.kind))&&(void 0!==t.edit||void 0!==t.command)&&(void 0===t.command||m.is(t.command))&&(void 0===t.isPreferred||ee.boolean(t.isPreferred))&&(void 0===t.edit||S.is(t.edit))}}(H||(H={})),function(e){e.create=function(e,t){var i={range:e};return ee.defined(t)&&(i.data=t),i},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.range)&&(ee.undefined(t.command)||m.is(t.command))}}(V||(V={})),function(e){e.create=function(e,t){return{tabSize:e,insertSpaces:t}},e.is=function(e){var t=e;return ee.defined(t)&&ee.number(t.tabSize)&&ee.boolean(t.insertSpaces)}}(K||(K={})),function(e){e.create=function(e,t,i){return{range:e,target:t,data:i}},e.is=function(e){var t=e;return ee.defined(t)&&r.is(t.range)&&(ee.undefined(t.target)||ee.string(t.target))}}(B||(B={})),function(e){e.create=function(e,t){return{range:e,parent:t}},e.is=function(t){var i=t;return void 0!==i&&r.is(i.range)&&(void 0===i.parent||e.is(i.parent))}}(X||(X={}));var Q,Z=["\n","\r\n","\r"];!function(e){e.create=function(e,t,i,n){return new te(e,t,i,n)},e.is=function(e){var t=e;return!!(ee.defined(t)&&ee.string(t.uri)&&(ee.undefined(t.languageId)||ee.string(t.languageId))&&ee.number(t.lineCount)&&ee.func(t.getText)&&ee.func(t.positionAt)&&ee.func(t.offsetAt))},e.applyEdits=function(e,t){for(var i=e.getText(),n=function e(t,i){if(t.length<=1)return t;var n=t.length/2|0,r=t.slice(0,n),s=t.slice(n);e(r,i),e(s,i);var o=0,a=0,c=0;for(;o<r.length&&a<s.length;){var l=i(r[o],s[a]);t[c++]=l<=0?r[o++]:s[a++]}for(;o<r.length;)t[c++]=r[o++];for(;a<s.length;)t[c++]=s[a++];return t}(t,(function(e,t){var i=e.range.start.line-t.range.start.line;return 0===i?e.range.start.character-t.range.start.character:i})),r=i.length,s=n.length-1;s>=0;s--){var o=n[s],a=e.offsetAt(o.range.start),c=e.offsetAt(o.range.end);if(!(c<=r))throw new Error("Overlapping edit");i=i.substring(0,a)+o.newText+i.substring(c,i.length),r=a}return i}}(Q||(Q={}));var ee,te=function(){function e(e,t,i,n){this._uri=e,this._languageId=t,this._version=i,this._content=n,this._lineOffsets=void 0}return Object.defineProperty(e.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageId",{get:function(){return this._languageId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!0,configurable:!0}),e.prototype.getText=function(e){if(e){var t=this.offsetAt(e.start),i=this.offsetAt(e.end);return this._content.substring(t,i)}return this._content},e.prototype.update=function(e,t){this._content=e.text,this._version=t,this._lineOffsets=void 0},e.prototype.getLineOffsets=function(){if(void 0===this._lineOffsets){for(var e=[],t=this._content,i=!0,n=0;n<t.length;n++){i&&(e.push(n),i=!1);var r=t.charAt(n);i="\r"===r||"\n"===r,"\r"===r&&n+1<t.length&&"\n"===t.charAt(n+1)&&n++}i&&t.length>0&&e.push(t.length),this._lineOffsets=e}return this._lineOffsets},e.prototype.positionAt=function(e){e=Math.max(Math.min(e,this._content.length),0);var t=this.getLineOffsets(),i=0,r=t.length;if(0===r)return n.create(0,e);for(;i<r;){var s=Math.floor((i+r)/2);t[s]>e?r=s:i=s+1}var o=i-1;return n.create(o,e-t[o])},e.prototype.offsetAt=function(e){var t=this.getLineOffsets();if(e.line>=t.length)return this._content.length;if(e.line<0)return 0;var i=t[e.line],n=e.line+1<t.length?t[e.line+1]:this._content.length;return Math.max(Math.min(i+e.character,n),i)},Object.defineProperty(e.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!0,configurable:!0}),e}();!function(e){var t=Object.prototype.toString;e.defined=function(e){return void 0!==e},e.undefined=function(e){return void 0===e},e.boolean=function(e){return!0===e||!1===e},e.string=function(e){return"[object String]"===t.call(e)},e.number=function(e){return"[object Number]"===t.call(e)},e.func=function(e){return"[object Function]"===t.call(e)},e.objectLiteral=function(e){return null!==e&&"object"==typeof e},e.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)}}(ee||(ee={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(160),r=i(23),s=i(20),o=i(161);t.ImplementationRequest=o.ImplementationRequest;const a=i(162);t.TypeDefinitionRequest=a.TypeDefinitionRequest;const c=i(163);t.WorkspaceFoldersRequest=c.WorkspaceFoldersRequest,t.DidChangeWorkspaceFoldersNotification=c.DidChangeWorkspaceFoldersNotification;const l=i(164);t.ConfigurationRequest=l.ConfigurationRequest;const u=i(165);t.DocumentColorRequest=u.DocumentColorRequest,t.ColorPresentationRequest=u.ColorPresentationRequest;const d=i(166);t.FoldingRangeRequest=d.FoldingRangeRequest;const h=i(167);t.DeclarationRequest=h.DeclarationRequest;const f=i(168);t.SelectionRangeRequest=f.SelectionRangeRequest;const g=i(169);var p,m;t.WorkDoneProgress=g.WorkDoneProgress,t.WorkDoneProgressCreateRequest=g.WorkDoneProgressCreateRequest,t.WorkDoneProgressCancelNotification=g.WorkDoneProgressCancelNotification,function(e){e.is=function(e){const t=e;return n.string(t.language)||n.string(t.scheme)||n.string(t.pattern)}}(p=t.DocumentFilter||(t.DocumentFilter={})),function(e){e.is=function(e){if(!Array.isArray(e))return!1;for(let t of e)if(!n.string(t)&&!p.is(t))return!1;return!0}}(m=t.DocumentSelector||(t.DocumentSelector={})),function(e){e.type=new s.ProtocolRequestType("client/registerCapability")}(t.RegistrationRequest||(t.RegistrationRequest={})),function(e){e.type=new s.ProtocolRequestType("client/unregisterCapability")}(t.UnregistrationRequest||(t.UnregistrationRequest={})),function(e){e.Create="create",e.Rename="rename",e.Delete="delete"}(t.ResourceOperationKind||(t.ResourceOperationKind={})),function(e){e.Abort="abort",e.Transactional="transactional",e.TextOnlyTransactional="textOnlyTransactional",e.Undo="undo"}(t.FailureHandlingKind||(t.FailureHandlingKind={})),function(e){e.hasId=function(e){const t=e;return t&&n.string(t.id)&&t.id.length>0}}(t.StaticRegistrationOptions||(t.StaticRegistrationOptions={})),function(e){e.is=function(e){const t=e;return t&&(null===t.documentSelector||m.is(t.documentSelector))}}(t.TextDocumentRegistrationOptions||(t.TextDocumentRegistrationOptions={})),function(e){e.is=function(e){const t=e;return n.objectLiteral(t)&&(void 0===t.workDoneProgress||n.boolean(t.workDoneProgress))},e.hasWorkDoneProgress=function(e){const t=e;return t&&n.boolean(t.workDoneProgress)}}(t.WorkDoneProgressOptions||(t.WorkDoneProgressOptions={})),function(e){e.type=new s.ProtocolRequestType("initialize")}(t.InitializeRequest||(t.InitializeRequest={})),function(e){e.unknownProtocolVersion=1}(t.InitializeError||(t.InitializeError={})),function(e){e.type=new s.ProtocolNotificationType("initialized")}(t.InitializedNotification||(t.InitializedNotification={})),function(e){e.type=new s.ProtocolRequestType0("shutdown")}(t.ShutdownRequest||(t.ShutdownRequest={})),function(e){e.type=new s.ProtocolNotificationType0("exit")}(t.ExitNotification||(t.ExitNotification={})),function(e){e.type=new s.ProtocolNotificationType("workspace/didChangeConfiguration")}(t.DidChangeConfigurationNotification||(t.DidChangeConfigurationNotification={})),function(e){e.Error=1,e.Warning=2,e.Info=3,e.Log=4}(t.MessageType||(t.MessageType={})),function(e){e.type=new s.ProtocolNotificationType("window/showMessage")}(t.ShowMessageNotification||(t.ShowMessageNotification={})),function(e){e.type=new s.ProtocolRequestType("window/showMessageRequest")}(t.ShowMessageRequest||(t.ShowMessageRequest={})),function(e){e.type=new s.ProtocolNotificationType("window/logMessage")}(t.LogMessageNotification||(t.LogMessageNotification={})),function(e){e.type=new s.ProtocolNotificationType("telemetry/event")}(t.TelemetryEventNotification||(t.TelemetryEventNotification={})),function(e){e.None=0,e.Full=1,e.Incremental=2}(t.TextDocumentSyncKind||(t.TextDocumentSyncKind={})),function(e){e.method="textDocument/didOpen",e.type=new s.ProtocolNotificationType(e.method)}(t.DidOpenTextDocumentNotification||(t.DidOpenTextDocumentNotification={})),function(e){e.method="textDocument/didChange",e.type=new s.ProtocolNotificationType(e.method)}(t.DidChangeTextDocumentNotification||(t.DidChangeTextDocumentNotification={})),function(e){e.method="textDocument/didClose",e.type=new s.ProtocolNotificationType(e.method)}(t.DidCloseTextDocumentNotification||(t.DidCloseTextDocumentNotification={})),function(e){e.method="textDocument/didSave",e.type=new s.ProtocolNotificationType(e.method)}(t.DidSaveTextDocumentNotification||(t.DidSaveTextDocumentNotification={})),function(e){e.Manual=1,e.AfterDelay=2,e.FocusOut=3}(t.TextDocumentSaveReason||(t.TextDocumentSaveReason={})),function(e){e.method="textDocument/willSave",e.type=new s.ProtocolNotificationType(e.method)}(t.WillSaveTextDocumentNotification||(t.WillSaveTextDocumentNotification={})),function(e){e.method="textDocument/willSaveWaitUntil",e.type=new s.ProtocolRequestType(e.method)}(t.WillSaveTextDocumentWaitUntilRequest||(t.WillSaveTextDocumentWaitUntilRequest={})),function(e){e.type=new s.ProtocolNotificationType("workspace/didChangeWatchedFiles")}(t.DidChangeWatchedFilesNotification||(t.DidChangeWatchedFilesNotification={})),function(e){e.Created=1,e.Changed=2,e.Deleted=3}(t.FileChangeType||(t.FileChangeType={})),function(e){e.Create=1,e.Change=2,e.Delete=4}(t.WatchKind||(t.WatchKind={})),function(e){e.type=new s.ProtocolNotificationType("textDocument/publishDiagnostics")}(t.PublishDiagnosticsNotification||(t.PublishDiagnosticsNotification={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.TriggerForIncompleteCompletions=3}(t.CompletionTriggerKind||(t.CompletionTriggerKind={})),function(e){e.method="textDocument/completion",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.CompletionRequest||(t.CompletionRequest={})),function(e){e.method="completionItem/resolve",e.type=new s.ProtocolRequestType(e.method)}(t.CompletionResolveRequest||(t.CompletionResolveRequest={})),function(e){e.method="textDocument/hover",e.type=new s.ProtocolRequestType(e.method)}(t.HoverRequest||(t.HoverRequest={})),function(e){e.Invoked=1,e.TriggerCharacter=2,e.ContentChange=3}(t.SignatureHelpTriggerKind||(t.SignatureHelpTriggerKind={})),function(e){e.method="textDocument/signatureHelp",e.type=new s.ProtocolRequestType(e.method)}(t.SignatureHelpRequest||(t.SignatureHelpRequest={})),function(e){e.method="textDocument/definition",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DefinitionRequest||(t.DefinitionRequest={})),function(e){e.method="textDocument/references",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.ReferencesRequest||(t.ReferencesRequest={})),function(e){e.method="textDocument/documentHighlight",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentHighlightRequest||(t.DocumentHighlightRequest={})),function(e){e.method="textDocument/documentSymbol",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentSymbolRequest||(t.DocumentSymbolRequest={})),function(e){e.method="textDocument/codeAction",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.CodeActionRequest||(t.CodeActionRequest={})),function(e){e.method="workspace/symbol",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.WorkspaceSymbolRequest||(t.WorkspaceSymbolRequest={})),function(e){e.type=new s.ProtocolRequestType("textDocument/codeLens"),e.resultType=new r.ProgressType}(t.CodeLensRequest||(t.CodeLensRequest={})),function(e){e.type=new s.ProtocolRequestType("codeLens/resolve")}(t.CodeLensResolveRequest||(t.CodeLensResolveRequest={})),function(e){e.method="textDocument/documentLink",e.type=new s.ProtocolRequestType(e.method),e.resultType=new r.ProgressType}(t.DocumentLinkRequest||(t.DocumentLinkRequest={})),function(e){e.type=new s.ProtocolRequestType("documentLink/resolve")}(t.DocumentLinkResolveRequest||(t.DocumentLinkResolveRequest={})),function(e){e.method="textDocument/formatting",e.type=new s.ProtocolRequestType(e.method)}(t.DocumentFormattingRequest||(t.DocumentFormattingRequest={})),function(e){e.method="textDocument/rangeFormatting",e.type=new s.ProtocolRequestType(e.method)}(t.DocumentRangeFormattingRequest||(t.DocumentRangeFormattingRequest={})),function(e){e.method="textDocument/onTypeFormatting",e.type=new s.ProtocolRequestType(e.method)}(t.DocumentOnTypeFormattingRequest||(t.DocumentOnTypeFormattingRequest={})),function(e){e.method="textDocument/rename",e.type=new s.ProtocolRequestType(e.method)}(t.RenameRequest||(t.RenameRequest={})),function(e){e.method="textDocument/prepareRename",e.type=new s.ProtocolRequestType(e.method)}(t.PrepareRenameRequest||(t.PrepareRenameRequest={})),function(e){e.type=new s.ProtocolRequestType("workspace/executeCommand")}(t.ExecuteCommandRequest||(t.ExecuteCommandRequest={})),function(e){e.type=new s.ProtocolRequestType("workspace/applyEdit")}(t.ApplyWorkspaceEditRequest||(t.ApplyWorkspaceEditRequest={}))},function(e,t,i){"use strict";function n(e){return"string"==typeof e||e instanceof String}function r(e){return Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.boolean=function(e){return!0===e||!1===e},t.string=n,t.number=function(e){return"number"==typeof e||e instanceof Number},t.error=function(e){return e instanceof Error},t.func=function(e){return"function"==typeof e},t.array=r,t.stringArray=function(e){return r(e)&&e.every(e=>n(e))},t.typedArray=function(e,t){return Array.isArray(e)&&e.every(t)},t.objectLiteral=function(e){return null!==e&&"object"==typeof e}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.method="textDocument/implementation",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.ImplementationRequest||(t.ImplementationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.method="textDocument/typeDefinition",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.TypeDefinitionRequest||(t.TypeDefinitionRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(20);!function(e){e.type=new n.ProtocolRequestType0("workspace/workspaceFolders")}(t.WorkspaceFoldersRequest||(t.WorkspaceFoldersRequest={})),function(e){e.type=new n.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")}(t.DidChangeWorkspaceFoldersNotification||(t.DidChangeWorkspaceFoldersNotification={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(20);!function(e){e.type=new n.ProtocolRequestType("workspace/configuration")}(t.ConfigurationRequest||(t.ConfigurationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.method="textDocument/documentColor",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DocumentColorRequest||(t.DocumentColorRequest={})),function(e){e.type=new r.ProtocolRequestType("textDocument/colorPresentation")}(t.ColorPresentationRequest||(t.ColorPresentationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.Comment="comment",e.Imports="imports",e.Region="region"}(t.FoldingRangeKind||(t.FoldingRangeKind={})),function(e){e.method="textDocument/foldingRange",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.FoldingRangeRequest||(t.FoldingRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.method="textDocument/declaration",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.DeclarationRequest||(t.DeclarationRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.method="textDocument/selectionRange",e.type=new r.ProtocolRequestType(e.method),e.resultType=new n.ProgressType}(t.SelectionRangeRequest||(t.SelectionRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(23),r=i(20);!function(e){e.type=new n.ProgressType}(t.WorkDoneProgress||(t.WorkDoneProgress={})),function(e){e.type=new r.ProtocolRequestType("window/workDoneProgress/create")}(t.WorkDoneProgressCreateRequest||(t.WorkDoneProgressCreateRequest={})),function(e){e.type=new r.ProtocolNotificationType("window/workDoneProgress/cancel")}(t.WorkDoneProgressCancelNotification||(t.WorkDoneProgressCancelNotification={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(20);!function(e){e.method="textDocument/prepareCallHierarchy",e.type=new n.ProtocolRequestType(e.method)}(t.CallHierarchyPrepareRequest||(t.CallHierarchyPrepareRequest={})),function(e){e.method="callHierarchy/incomingCalls",e.type=new n.ProtocolRequestType(e.method)}(t.CallHierarchyIncomingCallsRequest||(t.CallHierarchyIncomingCallsRequest={})),function(e){e.method="callHierarchy/outgoingCalls",e.type=new n.ProtocolRequestType(e.method)}(t.CallHierarchyOutgoingCallsRequest||(t.CallHierarchyOutgoingCallsRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(20);!function(e){e.comment="comment",e.keyword="keyword",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.namespace="namespace",e.type="type",e.struct="struct",e.class="class",e.interface="interface",e.enum="enum",e.typeParameter="typeParameter",e.function="function",e.member="member",e.property="property",e.macro="macro",e.variable="variable",e.parameter="parameter",e.label="label"}(t.SemanticTokenTypes||(t.SemanticTokenTypes={})),function(e){e.documentation="documentation",e.declaration="declaration",e.definition="definition",e.reference="reference",e.static="static",e.abstract="abstract",e.deprecated="deprecated",e.async="async",e.volatile="volatile",e.readonly="readonly"}(t.SemanticTokenModifiers||(t.SemanticTokenModifiers={})),function(e){e.is=function(e){const t=e;return void 0!==t&&(void 0===t.resultId||"string"==typeof t.resultId)&&Array.isArray(t.data)&&(0===t.data.length||"number"==typeof t.data[0])}}(t.SemanticTokens||(t.SemanticTokens={})),function(e){e.method="textDocument/semanticTokens",e.type=new n.ProtocolRequestType(e.method)}(t.SemanticTokensRequest||(t.SemanticTokensRequest={})),function(e){e.method="textDocument/semanticTokens/edits",e.type=new n.ProtocolRequestType(e.method)}(t.SemanticTokensEditsRequest||(t.SemanticTokensEditsRequest={})),function(e){e.method="textDocument/semanticTokens/range",e.type=new n.ProtocolRequestType(e.method)}(t.SemanticTokensRangeRequest||(t.SemanticTokensRangeRequest={}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(53),o=i(113),a=i(114),c=i(115);t.createConverter=function(e){const t=e||(e=>e.toString());function i(e){return t(e)}function l(e){return{uri:t(e.uri)}}function u(e){return{uri:t(e.uri),version:e.version}}function d(e){switch(e){case n.TextDocumentSaveReason.Manual:return r.TextDocumentSaveReason.Manual;case n.TextDocumentSaveReason.AfterDelay:return r.TextDocumentSaveReason.AfterDelay;case n.TextDocumentSaveReason.FocusOut:return r.TextDocumentSaveReason.FocusOut}return r.TextDocumentSaveReason.Manual}function h(e){switch(e){case n.CompletionTriggerKind.TriggerCharacter:return r.CompletionTriggerKind.TriggerCharacter;case n.CompletionTriggerKind.TriggerForIncompleteCompletions:return r.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return r.CompletionTriggerKind.Invoked}}function f(e){switch(e){case n.SignatureHelpTriggerKind.Invoke:return r.SignatureHelpTriggerKind.Invoked;case n.SignatureHelpTriggerKind.TriggerCharacter:return r.SignatureHelpTriggerKind.TriggerCharacter;case n.SignatureHelpTriggerKind.ContentChange:return r.SignatureHelpTriggerKind.ContentChange}}function g(e){return{label:e.label}}function p(e){return{label:e.label,parameters:(t=e.parameters,t.map(g))};var t}function m(e){return{line:e.line,character:e.character}}function v(e){return null==e?e:{line:e.line,character:e.character}}function y(e){if(null==e)return e;if(function(e){const t=e;return t&&!!t.inserting&&!!t.replacing}(e))throw new Error("Receving unknown insert replace range.");return{start:v(e.start),end:v(e.end)}}function b(e){return null==e?e:r.Location.create(i(e.uri),y(e.range))}function C(e){switch(e){case n.DiagnosticSeverity.Error:return r.DiagnosticSeverity.Error;case n.DiagnosticSeverity.Warning:return r.DiagnosticSeverity.Warning;case n.DiagnosticSeverity.Information:return r.DiagnosticSeverity.Information;case n.DiagnosticSeverity.Hint:return r.DiagnosticSeverity.Hint}}function w(e){switch(e){case n.DiagnosticTag.Unnecessary:return r.DiagnosticTag.Unnecessary;case n.DiagnosticTag.Deprecated:return r.DiagnosticTag.Deprecated;default:return}}function S(e){return{message:e.message,location:b(e.location)}}function T(e){let t=r.Diagnostic.create(y(e.range),e.message);return s.number(e.severity)&&(t.severity=C(e.severity)),(s.number(e.code)||s.string(e.code))&&(t.code=e.code),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=w(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(S)),e.source&&(t.source=e.source),t}function E(e){return null==e?e:e.map(T)}function P(e){switch(e){case n.CompletionItemTag.Deprecated:return r.CompletionItemTag.Deprecated}}function R(e){return{range:y(e.range),newText:e.newText}}function D(e){return e}function k(e){let t=r.Command.create(e.title,e.command);return e.arguments&&(t.arguments=e.arguments),t}return{asUri:i,asTextDocumentIdentifier:l,asVersionedTextDocumentIdentifier:u,asOpenTextDocumentParams:function(e){return{textDocument:{uri:t(e.uri),languageId:e.languageId,version:e.version,text:e.getText()}}},asChangeTextDocumentParams:function(e){if(function(e){let t=e;return!!t.uri&&!!t.version}(e)){return{textDocument:{uri:t(e.uri),version:e.version},contentChanges:[{text:e.getText()}]}}if(function(e){let t=e;return!!t.document&&!!t.contentChanges}(e)){let i=e.document;return{textDocument:{uri:t(i.uri),version:i.version},contentChanges:e.contentChanges.map(e=>{let t=e.range;return{range:{start:{line:t.start.line,character:t.start.character},end:{line:t.end.line,character:t.end.character}},rangeLength:e.rangeLength,text:e.text}})}}throw Error("Unsupported text document change parameter")},asCloseTextDocumentParams:function(e){return{textDocument:l(e)}},asSaveTextDocumentParams:function(e,t=!1){let i={textDocument:u(e)};return t&&(i.text=e.getText()),i},asWillSaveTextDocumentParams:function(e){return{textDocument:l(e.document),reason:d(e.reason)}},asTextDocumentPositionParams:function(e,t){return{textDocument:l(e),position:m(t)}},asCompletionParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{triggerKind:h(i.triggerKind),triggerCharacter:i.triggerCharacter}}},asSignatureHelpParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{isRetrigger:i.isRetrigger,triggerCharacter:i.triggerCharacter,triggerKind:f(i.triggerKind),activeSignatureHelp:(n=i.activeSignatureHelp,void 0===n?n:{signatures:(r=n.signatures,r.map(p)),activeSignature:n.activeSignature,activeParameter:n.activeParameter})}};var n,r},asWorkerPosition:m,asRange:y,asPosition:v,asPositions:function(e){let t=[];for(let i of e)t.push(v(i));return t},asLocation:b,asDiagnosticSeverity:C,asDiagnosticTag:w,asDiagnostic:T,asDiagnostics:E,asCompletionItem:function(e){let t={label:e.label},i=e instanceof o.default?e:void 0;var a,c;e.detail&&(t.detail=e.detail),e.documentation&&(i&&"$string"!==i.documentationFormat?t.documentation=function(e,t){switch(e){case"$string":return t;case r.MarkupKind.PlainText:return{kind:e,value:t};case r.MarkupKind.Markdown:return{kind:e,value:t.value};default:return"Unsupported Markup content received. Kind is: "+e}}(i.documentationFormat,e.documentation):t.documentation=e.documentation),e.filterText&&(t.filterText=e.filterText),function(e,t){let i=r.InsertTextFormat.PlainText,s=void 0,o=void 0;t.textEdit?(s=t.textEdit.newText,o=y(t.textEdit.range)):t.insertText instanceof n.SnippetString?(i=r.InsertTextFormat.Snippet,s=t.insertText.value):s=t.insertText;t.range&&(o=y(t.range));e.insertTextFormat=i,t.fromEdit&&void 0!==s&&void 0!==o?e.textEdit={newText:s,range:o}:e.insertText=s}(t,e),s.number(e.kind)&&(t.kind=(a=e.kind,void 0!==(c=i&&i.originalItemKind)?c:a+1)),e.sortText&&(t.sortText=e.sortText),e.additionalTextEdits&&(t.additionalTextEdits=function(e){if(null==e)return e;return e.map(R)}(e.additionalTextEdits)),e.commitCharacters&&(t.commitCharacters=e.commitCharacters.slice()),e.command&&(t.command=k(e.command)),!0!==e.preselect&&!1!==e.preselect||(t.preselect=e.preselect);const l=function(e){if(void 0===e)return e;const t=[];for(let i of e){const e=P(i);void 0!==e&&t.push(e)}return t}(e.tags);if(i&&(void 0!==i.data&&(t.data=i.data),!0===i.deprecated||!1===i.deprecated)){if(!0===i.deprecated&&void 0!==l&&l.length>0){const e=l.indexOf(n.CompletionItemTag.Deprecated);-1!==e&&l.splice(e,1)}t.deprecated=i.deprecated}return void 0!==l&&l.length>0&&(t.tags=l),t},asTextEdit:R,asSymbolKind:function(e){return e<=n.SymbolKind.TypeParameter?e+1:r.SymbolKind.Property},asSymbolTag:D,asSymbolTags:function(e){return e.map(D)},asReferenceParams:function(e,t,i){return{textDocument:l(e),position:m(t),context:{includeDeclaration:i.includeDeclaration}}},asCodeActionContext:function(e){if(null==e)return e;let t;return e.only&&s.string(e.only.value)&&(t=[e.only.value]),r.CodeActionContext.create(E(e.diagnostics),t)},asCommand:k,asCodeLens:function(e){let t=r.CodeLens.create(y(e.range));return e.command&&(t.command=k(e.command)),e instanceof a.default&&e.data&&(t.data=e.data),t},asFormattingOptions:function(e){return{tabSize:e.tabSize,insertSpaces:e.insertSpaces}},asDocumentSymbolParams:function(e){return{textDocument:l(e)}},asCodeLensParams:function(e){return{textDocument:l(e)}},asDocumentLink:function(e){let t=r.DocumentLink.create(y(e.range));e.target&&(t.target=i(e.target)),void 0!==e.tooltip&&(t.tooltip=e.tooltip);let n=e instanceof c.default?e:void 0;return n&&n.data&&(t.data=n.data),t},asDocumentLinkParams:function(e){return{textDocument:l(e)}}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(53),o=i(113),a=i(114),c=i(115);var l;!function(e){e.is=function(e){let t=e;return t&&s.string(t.language)&&s.string(t.value)}}(l||(l={})),t.createConverter=function(e){const t=e||(e=>n.Uri.parse(e));function i(e){return t(e)}function u(e){return e.map(d)}function d(e){let t=new n.Diagnostic(p(e.range),e.message,m(e.severity));return(s.number(e.code)||s.string(e.code))&&(t.code=e.code),e.source&&(t.source=e.source),e.relatedInformation&&(t.relatedInformation=e.relatedInformation.map(h)),Array.isArray(e.tags)&&(t.tags=function(e){if(!e)return;let t=[];for(let i of e){let e=f(i);void 0!==e&&t.push(e)}return t.length>0?t:void 0}(e.tags)),t}function h(e){return new n.DiagnosticRelatedInformation(R(e.location),e.message)}function f(e){switch(e){case r.DiagnosticTag.Unnecessary:return n.DiagnosticTag.Unnecessary;case r.DiagnosticTag.Deprecated:return n.DiagnosticTag.Deprecated;default:return}}function g(e){if(e)return new n.Position(e.line,e.character)}function p(e){if(e)return new n.Range(g(e.start),g(e.end))}function m(e){if(null==e)return n.DiagnosticSeverity.Error;switch(e){case r.DiagnosticSeverity.Error:return n.DiagnosticSeverity.Error;case r.DiagnosticSeverity.Warning:return n.DiagnosticSeverity.Warning;case r.DiagnosticSeverity.Information:return n.DiagnosticSeverity.Information;case r.DiagnosticSeverity.Hint:return n.DiagnosticSeverity.Hint}return n.DiagnosticSeverity.Error}function v(e){if(s.string(e))return e;switch(e.kind){case r.MarkupKind.Markdown:return new n.MarkdownString(e.value);case r.MarkupKind.PlainText:return e.value;default:return"Unsupported Markup content received. Kind is: "+e.kind}}function y(e){switch(e){case r.CompletionItemTag.Deprecated:return n.CompletionItemTag.Deprecated}}function b(e){let t=function(e){if(null==e)return[];const t=[];for(let i of e){const e=y(i);void 0!==e&&t.push(e)}return t}(e.tags),i=new o.default(e.label);e.detail&&(i.detail=e.detail),e.documentation&&(i.documentation=v(e.documentation),i.documentationFormat=s.string(e.documentation)?"$string":e.documentation.kind),e.filterText&&(i.filterText=e.filterText);let a=function(e){return e.textEdit?e.insertTextFormat===r.InsertTextFormat.Snippet?{text:new n.SnippetString(e.textEdit.newText),range:p(e.textEdit.range),fromEdit:!0}:{text:e.textEdit.newText,range:p(e.textEdit.range),fromEdit:!0}:e.insertText?e.insertTextFormat===r.InsertTextFormat.Snippet?{text:new n.SnippetString(e.insertText),fromEdit:!1}:{text:e.insertText,fromEdit:!1}:void 0}(e);if(a&&(i.insertText=a.text,i.range=a.range,i.fromEdit=a.fromEdit),s.number(e.kind)){let[t,s]=(c=e.kind,r.CompletionItemKind.Text<=c&&c<=r.CompletionItemKind.TypeParameter?[c-1,void 0]:[n.CompletionItemKind.Text,c]);i.kind=t,s&&(i.originalItemKind=s)}var c;return e.sortText&&(i.sortText=e.sortText),e.additionalTextEdits&&(i.additionalTextEdits=w(e.additionalTextEdits)),s.stringArray(e.commitCharacters)&&(i.commitCharacters=e.commitCharacters.slice()),e.command&&(i.command=L(e.command)),!0!==e.deprecated&&!1!==e.deprecated||(i.deprecated=e.deprecated,!0===e.deprecated&&t.push(n.CompletionItemTag.Deprecated)),!0!==e.preselect&&!1!==e.preselect||(i.preselect=e.preselect),void 0!==e.data&&(i.data=e.data),t.length>0&&(i.tags=t),i}function C(e){if(e)return new n.TextEdit(p(e.range),e.newText)}function w(e){if(e)return e.map(C)}function S(e){return e.map(T)}function T(e){let t=new n.SignatureInformation(e.label);return e.documentation&&(t.documentation=v(e.documentation)),e.parameters&&(t.parameters=E(e.parameters)),t}function E(e){return e.map(P)}function P(e){let t=new n.ParameterInformation(e.label);return e.documentation&&(t.documentation=v(e.documentation)),t}function R(e){if(e)return new n.Location(t(e.uri),p(e.range))}function D(e){if(!e)return;let i={targetUri:t(e.targetUri),targetRange:p(e.targetSelectionRange),originSelectionRange:p(e.originSelectionRange),targetSelectionRange:p(e.targetSelectionRange)};if(!i.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return i}function k(e){if(e){if(s.array(e)){if(0===e.length)return[];if(r.LocationLink.is(e[0])){return e.map(e=>D(e))}return e.map(e=>R(e))}return r.LocationLink.is(e)?[D(e)]:R(e)}}function x(e){let t=new n.DocumentHighlight(p(e.range));return s.number(e.kind)&&(t.kind=F(e.kind)),t}function F(e){switch(e){case r.DocumentHighlightKind.Text:return n.DocumentHighlightKind.Text;case r.DocumentHighlightKind.Read:return n.DocumentHighlightKind.Read;case r.DocumentHighlightKind.Write:return n.DocumentHighlightKind.Write}return n.DocumentHighlightKind.Text}function O(e){return e<=r.SymbolKind.TypeParameter?e-1:n.SymbolKind.Property}function _(e){return e}function A(e,i){let r=new n.SymbolInformation(e.name,O(e.kind),p(e.location.range),e.location.uri?t(e.location.uri):i);return e.containerName&&(r.containerName=e.containerName),r}function I(e){let t=new n.DocumentSymbol(e.name,e.detail||"",O(e.kind),p(e.range),p(e.selectionRange));if(void 0!==e.children&&e.children.length>0){let i=[];for(let t of e.children)i.push(I(t));t.children=i}return t}function L(e){let t={title:e.title,command:e.command};return e.arguments&&(t.arguments=e.arguments),t}const N=new Map;function M(e){if(null==e)return;let t=N.get(e);if(t)return t;let i=e.split(".");t=n.CodeActionKind.Empty;for(let e of i)t=t.append(e);return t}function j(e){if(!e)return;let t=new a.default(p(e.range));return e.command&&(t.command=L(e.command)),void 0!==e.data&&null!==e.data&&(t.data=e.data),t}function U(e){if(!e)return;let i=new n.WorkspaceEdit;return e.documentChanges?e.documentChanges.forEach(e=>{r.CreateFile.is(e)?i.createFile(t(e.uri),e.options):r.RenameFile.is(e)?i.renameFile(t(e.oldUri),t(e.newUri),e.options):r.DeleteFile.is(e)?i.deleteFile(t(e.uri),e.options):r.TextDocumentEdit.is(e)?i.set(t(e.textDocument.uri),w(e.edits)):console.error("Unknown workspace edit change received:\n"+JSON.stringify(e,void 0,4))}):e.changes&&Object.keys(e.changes).forEach(n=>{i.set(t(n),w(e.changes[n]))}),i}function q(e){let t=p(e.range),n=e.target?i(e.target):void 0,r=new c.default(t,n);return void 0!==e.tooltip&&(r.tooltip=e.tooltip),void 0!==e.data&&null!==e.data&&(r.data=e.data),r}function $(e){return new n.Color(e.red,e.green,e.blue,e.alpha)}function W(e){return new n.ColorInformation(p(e.range),$(e.color))}function G(e){let t=new n.ColorPresentation(e.label);return t.additionalTextEdits=w(e.additionalTextEdits),e.textEdit&&(t.textEdit=C(e.textEdit)),t}function z(e){if(e)switch(e){case r.FoldingRangeKind.Comment:return n.FoldingRangeKind.Comment;case r.FoldingRangeKind.Imports:return n.FoldingRangeKind.Imports;case r.FoldingRangeKind.Region:return n.FoldingRangeKind.Region}}function H(e){return new n.FoldingRange(e.startLine,e.endLine,z(e.kind))}function V(e){return new n.SelectionRange(p(e.range),e.parent?V(e.parent):void 0)}return N.set(r.CodeActionKind.Empty,n.CodeActionKind.Empty),N.set(r.CodeActionKind.QuickFix,n.CodeActionKind.QuickFix),N.set(r.CodeActionKind.Refactor,n.CodeActionKind.Refactor),N.set(r.CodeActionKind.RefactorExtract,n.CodeActionKind.RefactorExtract),N.set(r.CodeActionKind.RefactorInline,n.CodeActionKind.RefactorInline),N.set(r.CodeActionKind.RefactorRewrite,n.CodeActionKind.RefactorRewrite),N.set(r.CodeActionKind.Source,n.CodeActionKind.Source),N.set(r.CodeActionKind.SourceOrganizeImports,n.CodeActionKind.SourceOrganizeImports),{asUri:i,asDiagnostics:u,asDiagnostic:d,asRange:p,asRanges:function(e){return e.map(e=>p(e))},asPosition:g,asDiagnosticSeverity:m,asDiagnosticTag:f,asHover:function(e){if(e)return new n.Hover(function(e){if(s.string(e))return new n.MarkdownString(e);if(l.is(e)){return(new n.MarkdownString).appendCodeblock(e.value,e.language)}if(Array.isArray(e)){let t=[];for(let i of e){let e=new n.MarkdownString;l.is(i)?e.appendCodeblock(i.value,i.language):e.appendMarkdown(i),t.push(e)}return t}{let t;switch(e.kind){case r.MarkupKind.Markdown:return new n.MarkdownString(e.value);case r.MarkupKind.PlainText:return t=new n.MarkdownString,t.appendText(e.value),t;default:return t=new n.MarkdownString,t.appendText("Unsupported Markup content received. Kind is: "+e.kind),t}}}(e.contents),p(e.range))},asCompletionResult:function(e){if(!e)return;if(Array.isArray(e)){return e.map(b)}let t=e;return new n.CompletionList(t.items.map(b),t.isIncomplete)},asCompletionItem:b,asTextEdit:C,asTextEdits:w,asSignatureHelp:function(e){if(!e)return;let t=new n.SignatureHelp;return s.number(e.activeSignature)?t.activeSignature=e.activeSignature:t.activeSignature=0,s.number(e.activeParameter)?t.activeParameter=e.activeParameter:t.activeParameter=0,e.signatures&&(t.signatures=S(e.signatures)),t},asSignatureInformations:S,asSignatureInformation:T,asParameterInformations:E,asParameterInformation:P,asDeclarationResult:function(e){if(e)return k(e)},asDefinitionResult:function(e){if(e)return k(e)},asLocation:R,asReferences:function(e){if(e)return e.map(e=>R(e))},asDocumentHighlights:function(e){if(e)return e.map(x)},asDocumentHighlight:x,asDocumentHighlightKind:F,asSymbolKind:O,asSymbolTag:_,asSymbolTags:function(e){if(null!=e)return e.map(_)},asSymbolInformations:function(e,t){if(e)return e.map(e=>A(e,t))},asSymbolInformation:A,asDocumentSymbols:function(e){if(null!=e)return e.map(I)},asDocumentSymbol:I,asCommand:L,asCommands:function(e){if(e)return e.map(L)},asCodeAction:function(e){if(null==e)return;let t=new n.CodeAction(e.title);return void 0!==e.kind&&(t.kind=M(e.kind)),e.diagnostics&&(t.diagnostics=u(e.diagnostics)),e.edit&&(t.edit=U(e.edit)),e.command&&(t.command=L(e.command)),void 0!==e.isPreferred&&(t.isPreferred=e.isPreferred),t},asCodeActionKind:M,asCodeActionKinds:function(e){if(null!=e)return e.map(e=>M(e))},asCodeLens:j,asCodeLenses:function(e){if(e)return e.map(e=>j(e))},asWorkspaceEdit:U,asDocumentLink:q,asDocumentLinks:function(e){if(e)return e.map(q)},asFoldingRangeKind:z,asFoldingRange:H,asFoldingRanges:function(e){if(Array.isArray(e))return e.map(H)},asColor:$,asColorInformation:W,asColorInformations:function(e){if(Array.isArray(e))return e.map(W)},asColorPresentation:G,asColorPresentations:function(e){if(Array.isArray(e))return e.map(G)},asSelectionRange:V,asSelectionRanges:function(e){if(!Array.isArray(e))return[];let t=[];for(let i of e)t.push(V(i));return t}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Delayer=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(e=>{this.onSuccess=e}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var e=this.task();return this.task=void 0,e})),(t>=0||void 0===this.timeout)&&(this.timeout=setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return void 0!==this.timeout}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){void 0!==this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.DocumentColorRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.colorProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideColorPresentations:(e,t,i)=>{const n=this._client,s=(e,t,i)=>{const s={color:e,textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(t.document),range:n.code2ProtocolConverter.asRange(t.range)};return n.sendRequest(r.ColorPresentationRequest.type,s,i).then(this.asColorPresentations.bind(this),e=>(n.logFailedRequest(r.ColorPresentationRequest.type,e),Promise.resolve(null)))},o=n.clientOptions.middleware;return o.provideColorPresentations?o.provideColorPresentations(e,t,i,s):s(e,t,i)},provideDocumentColors:(e,t)=>{const i=this._client,n=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(r.DocumentColorRequest.type,n,t).then(this.asColorInformations.bind(this),e=>(i.logFailedRequest(r.ColorPresentationRequest.type,e),Promise.resolve(null)))},s=i.clientOptions.middleware;return s.provideDocumentColors?s.provideDocumentColors(e,t,n):n(e,t)}};return[n.languages.registerColorProvider(e.documentSelector,t),t]}asColor(e){return new n.Color(e.red,e.green,e.blue,e.alpha)}asColorInformations(e){return Array.isArray(e)?e.map(e=>new n.ColorInformation(this._client.protocol2CodeConverter.asRange(e.range),this.asColor(e.color))):[]}asColorPresentations(e){return Array.isArray(e)?e.map(e=>{let t=new n.ColorPresentation(e.label);return t.additionalTextEdits=this._client.protocol2CodeConverter.asTextEdits(e.additionalTextEdits),t.textEdit=this._client.protocol2CodeConverter.asTextEdit(e.textEdit),t}):[]}}t.ColorProviderFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14);t.ConfigurationFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(r.ConfigurationRequest.type,(t,i)=>{let n=e=>{let t=[];for(let i of e.items){let e=void 0!==i.scopeUri&&null!==i.scopeUri?this._client.protocol2CodeConverter.asUri(i.scopeUri):void 0;t.push(this.getConfiguration(e,null!==i.section?i.section:void 0))}return t},r=e.clientOptions.middleware.workspace;return r&&r.configuration?r.configuration(t,i,n):n(t)})}getConfiguration(e,t){let i=null;if(t){let r=t.lastIndexOf(".");if(-1===r)i=n.workspace.getConfiguration(void 0,e).get(t);else{let s=n.workspace.getConfiguration(t.substr(0,r),e);s&&(i=s.get(t.substr(r+1)))}}else{let t=n.workspace.getConfiguration(void 0,e);i={};for(let e of Object.keys(t))t.has(e)&&(i[e]=t.get(e))}return i||null}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.ImplementationRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.implementationProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideImplementation:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.ImplementationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDefinitionResult,e=>(n.logFailedRequest(r.ImplementationRequest.type,e),Promise.resolve(null))),o=n.clientOptions.middleware;return o.provideImplementation?o.provideImplementation(e,t,i,s):s(e,t,i)}};return[n.languages.registerImplementationProvider(e.documentSelector,t),t]}}t.ImplementationFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.TypeDefinitionRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=o(o(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.typeDefinitionProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideTypeDefinition:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.TypeDefinitionRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDefinitionResult,e=>(n.logFailedRequest(r.TypeDefinitionRequest.type,e),Promise.resolve(null))),o=n.clientOptions.middleware;return o.provideTypeDefinition?o.provideTypeDefinition(e,t,i,s):s(e,t,i)}};return[n.languages.registerTypeDefinitionProvider(e.documentSelector,t),t]}}t.TypeDefinitionFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(116),r=i(0),s=i(14);function o(e,t){if(void 0!==e)return e[t]}function a(e,t){return e.filter(e=>t.indexOf(e)<0)}t.arrayDiff=a;t.WorkspaceFoldersFeature=class{constructor(e){this._client=e,this._listeners=new Map}get messages(){return s.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=r.workspace.workspaceFolders;this.initializeWithFolders(t),e.workspaceFolders=void 0===t?null:t.map(e=>this.asProtocol(e))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(s.WorkspaceFoldersRequest.type,e=>{let i=()=>{let e=r.workspace.workspaceFolders;return void 0===e?null:e.map(e=>this.asProtocol(e))},n=t.clientOptions.middleware.workspace;return n&&n.workspaceFolders?n.workspaceFolders(e,i):i()});let i,a=o(o(o(e,"workspace"),"workspaceFolders"),"changeNotifications");"string"==typeof a?i=a:!0===a&&(i=n.generateUuid()),i&&this.register(this.messages,{id:i,registerOptions:void 0})}sendInitialEvent(e){if(this._initialFolders&&e){const t=a(this._initialFolders,e),i=a(e,this._initialFolders);(i.length>0||t.length>0)&&this.doSendEvent(i,t)}else this._initialFolders?this.doSendEvent([],this._initialFolders):e&&this.doSendEvent(e,[])}doSendEvent(e,t){let i={event:{added:e.map(e=>this.asProtocol(e)),removed:t.map(e=>this.asProtocol(e))}};this._client.sendNotification(s.DidChangeWorkspaceFoldersNotification.type,i)}register(e,t){let i=t.id,n=this._client,s=r.workspace.onDidChangeWorkspaceFolders(e=>{let t=e=>{this.doSendEvent(e.added,e.removed)},i=n.clientOptions.middleware.workspace;i&&i.didChangeWorkspaceFolders?i.didChangeWorkspaceFolders(e,t):t(e)});this._listeners.set(i,s),this.sendInitialEvent(r.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);void 0!==t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return void 0===e?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.foldingRangeProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideFoldingRanges:(e,t,i)=>{const n=this._client,s=(e,t,i)=>{const s={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e)};return n.sendRequest(r.FoldingRangeRequest.type,s,i).then(this.asFoldingRanges.bind(this),e=>(n.logFailedRequest(r.FoldingRangeRequest.type,e),Promise.resolve(null)))},o=n.clientOptions.middleware;return o.provideFoldingRanges?o.provideFoldingRanges(e,t,i,s):s(e,0,i)}};return[n.languages.registerFoldingRangeProvider(e.documentSelector,t),t]}asFoldingRangeKind(e){if(e)switch(e){case r.FoldingRangeKind.Comment:return n.FoldingRangeKind.Comment;case r.FoldingRangeKind.Imports:return n.FoldingRangeKind.Imports;case r.FoldingRangeKind.Region:return n.FoldingRangeKind.Region}}asFoldingRanges(e){return Array.isArray(e)?e.map(e=>new n.FoldingRange(e.startLine,e.endLine,this.asFoldingRangeKind(e.kind))):[]}}t.FoldingRangeFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.DeclarationRequest.type)}fillClientCapabilities(e){const t=o(o(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){const[i,n]=this.getRegistration(t,e.declarationProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideDeclaration:(e,t,i)=>{const n=this._client,s=(e,t,i)=>n.sendRequest(r.DeclarationRequest.type,n.code2ProtocolConverter.asTextDocumentPositionParams(e,t),i).then(n.protocol2CodeConverter.asDeclarationResult,e=>(n.logFailedRequest(r.DeclarationRequest.type,e),Promise.resolve(null))),o=n.clientOptions.middleware;return o.provideDeclaration?o.provideDeclaration(e,t,i,s):s(e,t,i)}};return[n.languages.registerDeclarationProvider(e.documentSelector,t),t]}}t.DeclarationFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]=Object.create(null)),e[t]}class a extends s.TextDocumentFeature{constructor(e){super(e,r.SelectionRangeRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"selectionRange").dynamicRegistration=!0}initialize(e,t){let[i,n]=this.getRegistration(t,e.selectionRangeProvider);i&&n&&this.register(this.messages,{id:i,registerOptions:n})}registerLanguageProvider(e){const t={provideSelectionRanges:(e,t,i)=>{const n=this._client,s=(e,t,i)=>{const s={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),positions:n.code2ProtocolConverter.asPositions(t)};return n.sendRequest(r.SelectionRangeRequest.type,s,i).then(e=>n.protocol2CodeConverter.asSelectionRanges(e),e=>(n.logFailedRequest(r.SelectionRangeRequest.type,e),Promise.resolve(null)))},o=n.clientOptions.middleware;return o.provideSelectionRanges?o.provideSelectionRanges(e,t,i,s):s(e,t,i)}};return[n.languages.registerSelectionRangeProvider(e.documentSelector,t),t]}}t.SelectionRangeFeature=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(14),r=i(117);t.ProgressFeature=class{constructor(e){this._client=e}fillClientCapabilities(e){var t,i;(t=e,i="window",void 0===t[i]&&(t[i]=Object.create(null)),t[i]).workDoneProgress=!0}initialize(){this._client.onRequest(n.WorkDoneProgressCreateRequest.type,e=>{new r.ProgressPart(this._client,e.token)})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(14),s=i(22);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var a,c;!function(e){function t(e,t){if(null===t)return;let i=new n.CallHierarchyItem(e.asSymbolKind(t.kind),t.name,t.detail||"",e.asUri(t.uri),e.asRange(t.range),e.asRange(t.selectionRange));return void 0!==t.tags&&(i.tags=e.asSymbolTags(t.tags)),i}function i(e,i){return new n.CallHierarchyIncomingCall(t(e,i.from),e.asRanges(i.fromRanges))}function r(e,i){return new n.CallHierarchyOutgoingCall(t(e,i.to),e.asRanges(i.fromRanges))}e.asCallHierarchyItem=t,e.asCallHierarchyItems=function(e,i){if(null===i)return;return i.map(i=>t(e,i))[0]},e.asCallHierarchyIncomingCall=i,e.asCallHierarchyIncomingCalls=function(e,t){if(null!==t)return t.map(t=>i(e,t))},e.asCallHierarchyOutgoingCall=r,e.asCallHierarchyOutgoingCalls=function(e,t){if(null!==t)return t.map(t=>r(e,t))}}(a||(a={})),function(e){e.asCallHierarchyItem=function(e,t){const i={name:t.name,kind:e.asSymbolKind(t.kind),uri:e.asUri(t.uri),range:e.asRange(t.range),selectionRange:e.asRange(t.selectionRange)};return void 0!==t.detail&&t.detail.length>0&&(i.detail=t.detail),void 0!==t.tags&&(i.tags=e.asSymbolTags(t.tags)),i}}(c||(c={}));class l{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,i){const n=this.client,s=this.middleware,o=(e,t,i)=>{const s=n.code2ProtocolConverter.asTextDocumentPositionParams(e,t);return n.sendRequest(r.Proposed.CallHierarchyPrepareRequest.type,s,i).then(e=>a.asCallHierarchyItems(this.client.protocol2CodeConverter,e),e=>(n.logFailedRequest(r.Proposed.CallHierarchyPrepareRequest.type,e),Promise.resolve(null)))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,i,o):o(e,t,i)}provideCallHierarchyIncomingCalls(e,t){const i=this.client,n=this.middleware,s=(e,t)=>{const n={item:c.asCallHierarchyItem(i.code2ProtocolConverter,e)};return i.sendRequest(r.Proposed.CallHierarchyIncomingCallsRequest.type,n,t).then(e=>a.asCallHierarchyIncomingCalls(i.protocol2CodeConverter,e),e=>(i.logFailedRequest(r.Proposed.CallHierarchyIncomingCallsRequest.type,e),Promise.resolve(null)))};return n.provideCallHierarchyIncomingCalls?n.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){const i=this.client,n=this.middleware,s=(e,t)=>{const n={item:c.asCallHierarchyItem(i.code2ProtocolConverter,e)};return i.sendRequest(r.Proposed.CallHierarchyOutgoingCallsRequest.type,n,t).then(e=>a.asCallHierarchyOutgoingCalls(i.protocol2CodeConverter,e),e=>(i.logFailedRequest(r.Proposed.CallHierarchyOutgoingCallsRequest.type,e),Promise.resolve(null)))};return n.provideCallHierarchyOutgingCalls?n.provideCallHierarchyOutgingCalls(e,t,s):s(e,t)}}class u extends s.TextDocumentFeature{constructor(e){super(e,r.Proposed.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){o(o(e,"textDocument"),"callHierarchy").dynamicRegistration=!0}initialize(e,t){const i=e,[n,r]=this.getRegistration(t,i.callHierarchyProvider);n&&r&&this.register(this.messages,{id:n,registerOptions:r})}registerLanguageProvider(e){const t=this._client,i=new l(t);return[n.languages.registerCallHierarchyProvider(e.documentSelector,i),i]}}t.CallHierarchyFeature=u},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(22),s=i(14);function o(e,t){return void 0===e[t]&&(e[t]={}),e[t]}var a;!function(e){function t(e){return new n.SemanticTokensEdit(e.start,e.deleteCount,void 0!==e.data?new Uint32Array(e.data):void 0)}e.asSemanticTokens=function(e){if(null!=e)return new n.SemanticTokens(new Uint32Array(e.data),e.resultId)},e.asSemanticTokensEdit=t,e.asSemanticTokensEdits=function(e){if(null!=e)return new n.SemanticTokensEdits(e.edits.map(t),e.resultId)},e.asLegend=function(e){return e}}(a||(a={}));class c extends r.TextDocumentFeature{constructor(e){super(e,s.Proposed.SemanticTokensRequest.type)}fillClientCapabilities(e){let t=o(o(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[s.Proposed.SemanticTokenTypes.comment,s.Proposed.SemanticTokenTypes.keyword,s.Proposed.SemanticTokenTypes.number,s.Proposed.SemanticTokenTypes.regexp,s.Proposed.SemanticTokenTypes.operator,s.Proposed.SemanticTokenTypes.namespace,s.Proposed.SemanticTokenTypes.type,s.Proposed.SemanticTokenTypes.struct,s.Proposed.SemanticTokenTypes.class,s.Proposed.SemanticTokenTypes.interface,s.Proposed.SemanticTokenTypes.enum,s.Proposed.SemanticTokenTypes.typeParameter,s.Proposed.SemanticTokenTypes.function,s.Proposed.SemanticTokenTypes.member,s.Proposed.SemanticTokenTypes.macro,s.Proposed.SemanticTokenTypes.variable,s.Proposed.SemanticTokenTypes.parameter,s.Proposed.SemanticTokenTypes.property,s.Proposed.SemanticTokenTypes.label],t.tokenModifiers=[s.Proposed.SemanticTokenModifiers.declaration,s.Proposed.SemanticTokenModifiers.documentation,s.Proposed.SemanticTokenModifiers.static,s.Proposed.SemanticTokenModifiers.abstract,s.Proposed.SemanticTokenModifiers.deprecated,s.Proposed.SemanticTokenModifiers.async,s.Proposed.SemanticTokenModifiers.readonly]}initialize(e,t){const i=e;let[n,r]=this.getRegistration(t,i.semanticTokensProvider);n&&r&&this.register(this.messages,{id:n,registerOptions:r})}registerLanguageProvider(e){const t={provideDocumentSemanticTokens:(e,t)=>{const i=this._client,n=i.clientOptions.middleware,r=(e,t)=>{const n={textDocument:i.code2ProtocolConverter.asTextDocumentIdentifier(e)};return i.sendRequest(s.Proposed.SemanticTokensRequest.type,n,t).then(e=>a.asSemanticTokens(e),e=>{i.logFailedRequest(s.Proposed.SemanticTokensRequest.type,e)})};return n.provideDocumentSemanticTokens?n.provideDocumentSemanticTokens(e,t,r):r(e,t)},provideDocumentSemanticTokensEdits:void 0!==e.documentProvider&&"boolean"!=typeof e.documentProvider&&!0===e.documentProvider.edits?(e,t,i)=>{const n=this._client,r=n.clientOptions.middleware,o=(e,t,i)=>{const r={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),previousResultId:t};return n.sendRequest(s.Proposed.SemanticTokensEditsRequest.type,r,i).then(e=>s.Proposed.SemanticTokens.is(e)?a.asSemanticTokens(e):a.asSemanticTokensEdits(e),e=>{n.logFailedRequest(s.Proposed.SemanticTokensEditsRequest.type,e)})};return r.provideDocumentSemanticTokensEdits?r.provideDocumentSemanticTokensEdits(e,t,i,o):o(e,t,i)}:void 0},i=!0===e.rangeProvider?{provideDocumentRangeSemanticTokens:(e,t,i)=>{const n=this._client,r=n.clientOptions.middleware,o=(e,t,i)=>{const r={textDocument:n.code2ProtocolConverter.asTextDocumentIdentifier(e),range:n.code2ProtocolConverter.asRange(t)};return n.sendRequest(s.Proposed.SemanticTokensRangeRequest.type,r,i).then(e=>a.asSemanticTokens(e),e=>{n.logFailedRequest(s.Proposed.SemanticTokensRangeRequest.type,e)})};return r.provideDocumentRangeSemanticTokens?r.provideDocumentRangeSemanticTokens(e,t,i,o):o(e,t,i)}}:void 0,r=[],o=a.asLegend(e.legend);return r.push(n.languages.registerDocumentSemanticTokensProvider(e.documentSelector,t,o)),void 0!==i&&r.push(n.languages.registerDocumentRangeSemanticTokensProvider(e.documentSelector,i,o)),[new n.Disposable(()=>r.forEach(e=>e.dispose())),{document:t,range:i}]}}t.SemanticTokensFeature=c},function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=i(47),r=i(2),s="win32"===process.platform,o="darwin"===process.platform,a="linux"===process.platform;t.terminate=function(t,i){if(s)try{let e={stdio:["pipe","pipe","ignore"]};return i&&(e.cwd=i),n.execFileSync("taskkill",["/T","/F","/PID",t.pid.toString()],e),!0}catch(e){return!1}else{if(!a&&!o)return t.kill("SIGKILL"),!0;try{var c=r.join(e,"terminateProcess.sh");return!n.spawnSync(c,[t.pid.toString()]).error}catch(e){return!1}}}}).call(this,"/")},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspFileTracker=void 0;const r=i(0),s=i(96),o=i(91),a=i(1),c=i(30),l=i(6),u=i(49),d=i(7);t.LspFileTracker=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.wsContext=i,this.disposables=[],this.outlines={},this.flutterOutlines={},this.pubRunTestSupport={},this.onOutlineEmitter=new o.EventEmitter,this.onOutline=this.onOutlineEmitter.event,this.onFlutterOutlineEmitter=new o.EventEmitter,this.onFlutterOutline=this.onFlutterOutlineEmitter.event,t.onReady().then(()=>{this.analyzer.onNotification(s.PublishOutlineNotification.type,e=>{const t=a.fsPath(r.Uri.parse(e.uri));this.outlines[t]=e.outline,this.onOutlineEmitter.fire(e)}),this.analyzer.onNotification(s.PublishFlutterOutlineNotification.type,e=>{const t=a.fsPath(r.Uri.parse(e.uri));this.flutterOutlines[t]=e.outline,this.onFlutterOutlineEmitter.fire(e)})}),this.watchPubspec()}getOutlineFor(e){return this.outlines[a.fsPath(e)]}waitForOutlineWithLength(e,t,i){return n(this,void 0,void 0,(function*(){return c.waitFor(()=>{const i=this.outlines[a.fsPath(e.uri)];return i&&e.offsetAt(l.lspToPosition(i.range.end))===t?i:void 0},50,5e3,i)}))}getFlutterOutlineFor(e){return this.flutterOutlines[a.fsPath(e)]}waitForFlutterOutlineWithLength(e,t,i){return n(this,void 0,void 0,(function*(){return c.waitFor(()=>{const i=this.flutterOutlines[a.fsPath(e.uri)];return i&&e.offsetAt(l.lspToPosition(i.range.end))===t?i:void 0},50,5e3,i)}))}supportsPubRunTest(e){const t=a.fsPath(e);if(!d.isPubRunnableTestFile(t))return!1;if(void 0===this.pubRunTestSupport[t]){const e=u.locateBestProjectRoot(t);this.pubRunTestSupport[t]=!(!e||!d.projectShouldUsePubForTests(e,this.wsContext.config))}return this.pubRunTestSupport[a.fsPath(e)]}watchPubspec(){const e=()=>Object.keys(this.pubRunTestSupport).forEach(e=>delete this.pubRunTestSupport[e]),t=r.workspace.createFileSystemWatcher("**/pubspec.yaml");this.disposables.push(t),t.onDidChange(e,this),t.onDidCreate(e,this)}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerStatusReporter=void 0;const n=i(0),r=i(8),s=i(3),o=i(19),a=i(10),c=i(7);let l=0;t.AnalyzerStatusReporter=class{constructor(e,t,i,n){this.logger=e,this.analyzer=t,this.workspaceContext=i,this.analytics=n,this.analysisInProgress=!1,t.registerForServerStatus(e=>this.handleServerStatus(e)),t.registerForServerError(e=>this.handleServerError(e)),t.registerForRequestError(e=>this.handleRequestError(e)),t.registerForServerTerminated(()=>this.handleServerTerminated())}handleServerStatus(e){e.analysis&&(this.analysisInProgress=e.analysis.isAnalyzing,this.analysisInProgress?setTimeout(()=>{this.analysisInProgress&&!this.analyzingPromise&&n.window.withProgress({location:n.ProgressLocation.Window,title:"Analyzingâ€¦"},e=>(this.analyzingPromise||(this.analyzingPromise=new s.PromiseCompleter),this.analyzingPromise.promise))},500):this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0))}handleServerTerminated(){this.analysisInProgress=!1,this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0)}handleRequestError(e){this.handleServerError({isFatal:!1,message:e.message,stackTrace:e.stackTrace||""},e.method)}handleServerError(e,t){if(this.logger.error(e.message,r.LogCategory.Analyzer),e.stackTrace&&this.logger.error(e.stackTrace,r.LogCategory.Analyzer),this.analytics.logError("Analyzer server error"+(t?` (${t})`:""),e.isFatal),l++,a.config.notifyAnalyzerErrors&&l<=3){const i="Show log";n.window.showErrorMessage("Exception from the Dart analysis server: "+e.message,i).then(n=>{n===i&&this.showErrorLog(e,t)})}}showErrorLog(e,t){const i=this.workspaceContext.sdks.dartVersion,r=this.workspaceContext.sdks.flutterVersion,s=this.analyzer.getAnalyzerLaunchArgs(),a=`\n${t?"### Request\n\nServer was responding to request: `"+t+"`\n":""}\n### Versions\n\n- ${n.env.appName} v${n.version}\n- Dart Code v${o.extensionVersion}\n- ${r?"Flutter SDK v"+r:"Dart SDK v"+i}\n\n### Analyzer Info\n\nThe analyzer was launched using the arguments:\n\n${s.map(e=>"- "+e).join("\n")}\n\n### Exception${e.isFatal?" (fatal)":""}\n\n${e.message}\n\n${e.stackTrace.trim()}\n`;c.openLogContents("md",a)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileChangeHandler=void 0;const n=i(0),r=i(1),s=i(7);t.FileChangeHandler=class{constructor(e){this.analyzer=e,this.disposables=[],this.filesWarnedAbout=new Set,this.disposables.push(n.workspace.onDidOpenTextDocument(e=>this.onDidOpenTextDocument(e)),n.workspace.onDidChangeTextDocument(e=>this.onDidChangeTextDocument(e)),n.workspace.onDidCloseTextDocument(e=>this.onDidCloseTextDocument(e))),n.workspace.textDocuments.forEach(e=>this.onDidOpenTextDocument(e))}onDidOpenTextDocument(e){if(!s.isAnalyzable(e))return;const t={};t[r.fsPath(e.uri)]={content:e.getText(),type:"add"},this.analyzer.analysisUpdateContent({files:t})}onDidChangeTextDocument(e){if(!s.isAnalyzable(e.document))return;if(0===e.contentChanges.length)return;const t={};t[r.fsPath(e.document.uri)]={edits:e.contentChanges.map(t=>this.convertChange(e.document,t)),type:"change"},this.analyzer.analysisUpdateContent({files:t})}onDidCloseTextDocument(e){if(!s.isAnalyzable(e))return;const t={};t[r.fsPath(e.uri)]={type:"remove"},this.analyzer.analysisUpdateContent({files:t})}convertChange(e,t){return{id:"",length:t.rangeLength,offset:t.rangeOffset,replacement:t.text}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FileChangeWarnings=void 0;const r=i(2),s=i(0),o=i(4),a=i(1),c=i(6),l=i(10),u=i(7);t.FileChangeWarnings=class{constructor(){this.disposables=[],this.filesWarnedAbout=new Set,this.disposables.push(s.workspace.onDidChangeTextDocument(e=>this.onDidChangeTextDocument(e)))}onDidChangeTextDocument(e){if(!u.isAnalyzable(e.document))return;if(0===e.contentChanges.length)return;const t=a.fsPath(e.document.uri);if(s.workspace.workspaceFolders&&s.workspace.workspaceFolders.length&&!u.isWithinWorkspace(t)&&!this.filesWarnedAbout.has(t)){const e=-1!==t.indexOf(`${r.sep}hosted${r.sep}pub.dartlang.org${r.sep}`),i=e?l.config.warnWhenEditingFilesInPubCache:l.config.warnWhenEditingFilesOutsideWorkspace,a=e?"You are modifying a file in the Pub cache!":"You are modifying a file outside of your open folders",u=e?()=>l.config.setWarnWhenEditingFilesInPubCache(!1):()=>l.config.setWarnWhenEditingFilesOutsideWorkspace(!1),d="Don't Warn Me";i&&(s.window.showWarningMessage(a,o.moreInfoAction,d).then(e=>n(this,void 0,void 0,(function*(){e===o.moreInfoAction?yield c.envUtils.openInBrowser(o.modifyingFilesOutsideWorkspaceInfoUrl):e===d&&u()}))),this.filesWarnedAbout.add(t))}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Analytics=void 0;const r=i(39),s=i(192),o=i(0),a=i(4),c=i(19),l=i(10),u="someValue.machineId"!==o.env.machineId?o.env.machineId:void 0;var d,h,f;!function(e){e[e.Extension=0]="Extension",e[e.Analyzer=1]="Analyzer",e[e.Debugger=2]="Debugger"}(d||(d={})),function(e){e[e.Activated=0]="Activated",e[e.SdkDetectionFailure=1]="SdkDetectionFailure",e[e.Deactivated=2]="Deactivated",e[e.Restart=3]="Restart",e[e.HotReload=4]="HotReload",e[e.OpenObservatory=5]="OpenObservatory",e[e.OpenTimeline=6]="OpenTimeline",e[e.OpenDevTools=7]="OpenDevTools"}(h||(h={})),function(e){e[e.Startup=0]="Startup",e[e.FirstAnalysis=1]="FirstAnalysis",e[e.SessionDuration=2]="SessionDuration"}(f||(f={}));t.Analytics=class{constructor(e,t){this.logger=e,this.workspaceContext=t,this.dummyDartFile=o.Uri.parse("untitled:foo.dart"),this.dartConfig=o.workspace.getConfiguration("",this.dummyDartFile).get("[dart]"),this.formatter=this.getFormatterSetting()}getFormatterSetting(){try{const e=this.getAppliedConfig("editor","defaultFormatter",!1);return e&&e!==a.dartCodeExtensionIdentifier?e:l.config.enableSdkFormatter?this.getAppliedConfig("editor","formatOnSave")?"Enabled on Save":"Enabled":"Disabled"}catch(e){return"Unknown"}}getAppliedConfig(e,t,i=!0){const n=this.dartConfig?this.dartConfig[`${e}.${t}`]:void 0;return null!=n?n:o.workspace.getConfiguration(e,i?this.dummyDartFile:void 0).get(t)}logExtensionStartup(e){this.event(d.Extension,h.Activated).catch(e=>this.logger.info(e)),this.time(d.Extension,f.Startup,e).catch(e=>this.logger.info(e))}logExtensionRestart(e){this.event(d.Extension,h.Restart).catch(e=>this.logger.info(e)),this.time(d.Extension,f.Startup,e).catch(e=>this.logger.info(e))}logAnalyzerRestart(){this.event(d.Analyzer,h.Restart).catch(e=>this.logger.info(e))}logExtensionShutdown(){return this.event(d.Extension,h.Deactivated)}logSdkDetectionFailure(){this.event(d.Extension,h.SdkDetectionFailure).catch(e=>this.logger.info(e))}logError(e,t){this.error(e,t).catch(e=>this.logger.info(e))}logAnalyzerStartupTime(e){this.time(d.Analyzer,f.Startup,e).catch(e=>this.logger.info(e))}logDebugSessionDuration(e,t){this.time(d.Debugger,f.SessionDuration,t,e).catch(e=>this.logger.info(e))}logAnalyzerFirstAnalysisTime(e){this.time(d.Analyzer,f.FirstAnalysis,e).catch(e=>this.logger.info(e))}logDebuggerStart(e,t,i){const n={cd15:t,cd16:i};this.event(d.Debugger,h.Activated,e,n).catch(e=>this.logger.info(e))}logDebuggerRestart(){this.event(d.Debugger,h.Restart).catch(e=>this.logger.info(e))}logDebuggerHotReload(){this.event(d.Debugger,h.HotReload).catch(e=>this.logger.info(e))}logDebuggerOpenObservatory(){this.event(d.Debugger,h.OpenObservatory).catch(e=>this.logger.info(e))}logDebuggerOpenTimeline(){this.event(d.Debugger,h.OpenTimeline).catch(e=>this.logger.info(e))}logDebuggerOpenDevTools(){this.event(d.Debugger,h.OpenDevTools).catch(e=>this.logger.info(e))}event(e,t,i,n){const r={ea:h[t],ec:d[e],t:"event"};return Object.assign(r,n),e===d.Extension&&t===h.Activated&&(r.sc="start"),e===d.Extension&&t===h.Deactivated&&(r.sc="end"),this.send(r,i)}time(e,t,i,n){const r={t:"timing",utc:d[e],utl:n,utt:Math.round(i),utv:f[t]};return this.logger.info(`${r.utc}:${r.utv} timing: ${Math.round(i)}ms ${n?`(${n})`:""}`),this.send(r)}error(e,t){const i={exd:e.trim(),exf:t?1:0,t:"exception"};return this.send(i)}send(e,t){return n(this,void 0,void 0,(function*(){if(!u||!l.config.allowAnalytics||process.env.DART_CODE_IS_TEST_RUN)return;const i={aip:1,an:"Dart Code",av:c.extensionVersion,cd1:c.isDevExtension,cd10:l.config.showTodos?"On":"Off",cd11:this.workspaceContext.config.useLsp?"LSP":"DAS",cd12:this.formatter,cd13:this.flutterSdkVersion,cd14:c.hasFlutterExtension?"Installed":"Not Installed",cd17:this.workspaceContext.hasAnyFlutterProjects?l.config.previewFlutterUiGuides?l.config.previewFlutterUiGuidesCustomTracking?"On + Custom Tracking":"On":"Off":null,cd18:this.workspaceContext.hasAnyFlutterProjects&&t?l.config.for(t).flutterStructuredErrors?"On":"Off":null,cd19:o.env.remoteName||"None",cd2:a.isChromeOS?process.platform+" (ChromeOS)":process.platform,cd20:o.env.appName||"Unknown",cd3:this.sdkVersion,cd4:this.analysisServerVersion,cd5:o.version,cd6:t?this.getDebuggerPreference():null,cd7:this.workspaceContext.workspaceTypeDescription,cd8:l.config.closingLabels?"On":"Off",cd9:this.workspaceContext.hasAnyFlutterProjects?l.config.flutterHotReloadOnSave?"On":"Off":null,cid:u,tid:"UA-2201586-19",ul:o.env.language,v:"1"};Object.assign(i,e);const n={headers:{"Content-Type":"application/x-www-form-urlencoded"},hostname:"www.google-analytics.com",method:"POST",path:"/collect",port:443};yield new Promise(e=>{try{const t=r.request(n,t=>{(!t||!t.statusCode||t.statusCode<200||t.statusCode>300)&&this.logger.info(`Failed to send analytics ${t&&t.statusCode}: ${t&&t.statusMessage}`),e()});t.write(s.stringify(i)),t.end()}catch(t){this.logger.error("Failed to send analytics: "+t),e()}})}))}getDebuggerPreference(){return l.config.debugSdkLibraries&&l.config.debugExternalLibraries?"All code":l.config.debugSdkLibraries?"My code + SDK":l.config.debugExternalLibraries?"My code + Libraries":"My code"}}},function(e,t){e.exports=require("querystring")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartExtensionApi=void 0;const n=i(0);t.DartExtensionApi=class{constructor(){this.version=1,this.flutterCreateSampleProject=()=>n.commands.executeCommand("_dart.flutter.createSampleProject")}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterDartPadSamplesCodeLensProvider=void 0;const r=i(2),s=i(0),o=i(1),a=i(97),c=i(6),l=new RegExp("\\{@tool\\s+dartpad");t.FlutterDartPadSamplesCodeLensProvider=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.sdks=i,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()})),this.disposables.push(s.commands.registerCommand("_dart.openDartPadSample",e=>n(this,void 0,void 0,(function*(){const t=`#${e.libraryName}.${e.className}.1`,i=`https://api.flutter.dev/flutter/${e.libraryName}/${e.className}-class.html${t}`;yield c.envUtils.openInBrowser(i)})))),this.flutterPackagesFolder=r.join(i.flutter,"packages/flutter/lib/src/").toLowerCase()}provideCodeLenses(e,t){return n(this,void 0,void 0,(function*(){const i=o.fsPath(e.uri);if(!i.toLowerCase().startsWith(this.flutterPackagesFolder))return;const n=e.getText().length,r=yield this.analyzer.fileTracker.waitForOutlineWithLength(e.uri,n,t);if(!r||!r.children||!r.children.length)return;const u=i.substr(this.flutterPackagesFolder.length).replace("\\","/").split("/")[0],d=new a.ClassOutlineVisitor(this.logger);d.visit(r);return d.classes.filter(t=>{const i=e.getText(c.toRange(e,t.offset,t.codeOffset-t.offset));return l.test(i)}).map(e=>Object.assign(Object.assign({},e),{libraryName:u})).filter(e=>e.codeOffset&&e.codeLength).map(t=>new s.CodeLens(c.toRange(e,t.codeOffset,t.codeLength),{arguments:[t],command:"_dart.openDartPadSample",title:"Open online interactive samples for "+t.className}))}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspFlutterDartPadSamplesCodeLensProvider=void 0;const r=i(2),s=i(0),o=i(1),a=i(98),c=i(6),l=new RegExp("\\{@tool\\s+dartpad");t.LspFlutterDartPadSamplesCodeLensProvider=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.sdks=i,this.disposables=[],this.onDidChangeCodeLensesEmitter=new s.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.fileTracker.onOutline.listen(e=>{this.onDidChangeCodeLensesEmitter.fire()})),this.disposables.push(s.commands.registerCommand("_dart.openDartPadSample",e=>n(this,void 0,void 0,(function*(){const t=`#${e.libraryName}.${e.className}.1`,i=`https://api.flutter.dev/flutter/${e.libraryName}/${e.className}-class.html${t}`;yield c.envUtils.openInBrowser(i)})))),this.flutterPackagesFolder=r.join(i.flutter,"packages/flutter/lib/src/").toLowerCase()}provideCodeLenses(e,t){return n(this,void 0,void 0,(function*(){const i=o.fsPath(e.uri);if(!i.toLowerCase().startsWith(this.flutterPackagesFolder))return;const n=e.getText().length,r=yield this.analyzer.fileTracker.waitForOutlineWithLength(e,n,t);if(!r||!r.children||!r.children.length)return;const u=i.substr(this.flutterPackagesFolder.length).replace("\\","/").split("/")[0],d=new a.LspClassOutlineVisitor(this.logger);d.visit(r);return d.classes.filter(t=>{const i=e.getText(new s.Range(c.lspToPosition(t.range.start),c.lspToPosition(t.codeRange.start)));return l.test(i)}).map(e=>Object.assign(Object.assign({},e),{libraryName:u})).filter(e=>e.codeRange).map(e=>new s.CodeLens(c.lspToRange(e.codeRange),{arguments:[e],command:"_dart.openDartPadSample",title:"Open online interactive samples for "+e.className}))}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MainCodeLensProvider=void 0;const r=i(0),s=i(1),o=i(60),a=i(6),c=i(7);t.MainCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){var i;return n(this,void 0,void 0,(function*(){const n=e.getText().length,l=yield this.analyzer.fileTracker.waitForOutlineWithLength(e.uri,n,t);if(!l||!l.children||!l.children.length)return;const u=c.isTestFile(s.fsPath(e.uri))?"test-file":"file",d=o.getTemplatedLaunchConfigs(e,u),h=null===(i=l.children)||void 0===i?void 0:i.find(e=>"main"===e.element.name);return h?[new r.CodeLens(a.toRange(e,h.offset,h.length),{arguments:[e.uri],command:"dart.startWithoutDebugging",title:"Run"}),new r.CodeLens(a.toRange(e,h.offset,h.length),{arguments:[e.uri],command:"dart.startDebugging",title:"Debug"})].concat(d.map(t=>new r.CodeLens(a.toRange(e,h.offset,h.length),{arguments:[e.uri,t],command:t.template==="run-"+u?"dart.startWithoutDebugging":"dart.startDebugging",title:t.name}))):void 0}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspMainCodeLensProvider=void 0;const r=i(0),s=i(1),o=i(60),a=i(6),c=i(7);t.LspMainCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.fileTracker.onOutline.listen(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){var i;return n(this,void 0,void 0,(function*(){const n=e.getText().length,l=yield this.analyzer.fileTracker.waitForOutlineWithLength(e,n,t);if(!l||!l.children||!l.children.length)return;const u=c.isTestFile(s.fsPath(e.uri))?"test-file":"file",d=o.getTemplatedLaunchConfigs(e,u),h=null===(i=l.children)||void 0===i?void 0:i.find(e=>"main"===e.element.name);return h?[new r.CodeLens(a.lspToRange(h.range),{arguments:[e.uri],command:"dart.startWithoutDebugging",title:"Run"}),new r.CodeLens(a.lspToRange(h.range),{arguments:[e.uri],command:"dart.startDebugging",title:"Debug"})].concat(d.map(t=>new r.CodeLens(a.lspToRange(h.range),{arguments:[e.uri,t],command:t.template==="run-"+u?"dart.startWithoutDebugging":"dart.startDebugging",title:t.name}))):void 0}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TestCodeLensProvider=void 0;const r=i(0),s=i(3),o=i(1),a=i(97),c=i(60),l=i(6),u=i(7);t.TestCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.client.registerForAnalysisOutline(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){return n(this,void 0,void 0,(function*(){const i=e.getText().length,n=yield this.analyzer.fileTracker.waitForOutlineWithLength(e.uri,i,t);if(!n||!n.children||!n.children.length)return;if(!this.analyzer.fileTracker.supportsPubRunTest(e.uri))return;if(!u.isTestFile(o.fsPath(e.uri)))return;const d=c.getTemplatedLaunchConfigs(e,"test"),h=new a.TestOutlineVisitor(this.logger);return h.visit(n),s.flatMap(h.tests.filter(e=>e.offset&&e.length).map(t=>[new r.CodeLens(l.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startWithoutDebuggingTestFromOutline",title:"Run"}),new r.CodeLens(l.toRange(e,t.offset,t.length),{arguments:[t],command:"_dart.startDebuggingTestFromOutline",title:"Debug"})].concat(d.map(i=>new r.CodeLens(l.toRange(e,t.offset,t.length),{arguments:[t,i],command:"run-test"===i.template?"_dart.startWithoutDebuggingTestFromOutline":"_dart.startDebuggingTestFromOutline",title:i.name})))),e=>e)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspTestCodeLensProvider=void 0;const r=i(0),s=i(3),o=i(1),a=i(98),c=i(60),l=i(6),u=i(7);t.LspTestCodeLensProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.onDidChangeCodeLensesEmitter=new r.EventEmitter,this.onDidChangeCodeLenses=this.onDidChangeCodeLensesEmitter.event,this.disposables.push(this.analyzer.fileTracker.onOutline.listen(e=>{this.onDidChangeCodeLensesEmitter.fire()}))}provideCodeLenses(e,t){return n(this,void 0,void 0,(function*(){const i=e.getText().length,n=yield this.analyzer.fileTracker.waitForOutlineWithLength(e,i,t);if(!n||!n.children||!n.children.length)return;if(!this.analyzer.fileTracker.supportsPubRunTest(e.uri))return;if(!u.isTestFile(o.fsPath(e.uri)))return;const d=c.getTemplatedLaunchConfigs(e,"test"),h=new a.LspTestOutlineVisitor(this.logger,o.fsPath(e.uri));return h.visit(n),s.flatMap(h.tests.filter(e=>e.range).map(e=>[new r.CodeLens(l.lspToRange(e.range),{arguments:[e],command:"_dart.startWithoutDebuggingTestFromOutline",title:"Run"}),new r.CodeLens(l.lspToRange(e.range),{arguments:[e],command:"_dart.startDebuggingTestFromOutline",title:"Debug"})].concat(d.map(t=>new r.CodeLens(l.lspToRange(e.range),{arguments:[e,t],command:"run-test"===t.template?"_dart.startWithoutDebuggingTestFromOutline":"_dart.startDebuggingTestFromOutline",title:t.name})))),e=>e)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyzerCommands=void 0;const r=i(0),s=i(4),o=i(6);let a=0;t.AnalyzerCommands=class{constructor(e,t,i,s){this.logger=t,e.subscriptions.push(r.commands.registerCommand("dart.openAnalyzerDiagnostics",()=>n(this,void 0,void 0,(function*(){const e=yield i.getDiagnosticServerPort();yield o.envUtils.openInBrowser(`http://127.0.0.1:${e.port}/`)})))),e.subscriptions.push(r.commands.registerCommand("dart.restartAnalysisServer",()=>n(this,void 0,void 0,(function*(){a++,10===a&&this.showServerRestartPrompt().catch(e=>t.error(e)),s.logAnalyzerRestart(),r.commands.executeCommand("_dart.reloadExtension")})))),e.subscriptions.push(r.commands.registerCommand("dart.forceReanalyze",()=>n(this,void 0,void 0,(function*(){a++,10===a&&this.showServerRestartPrompt().catch(e=>t.error(e)),s.logAnalyzerRestart(),yield i.forceReanalyze()}))))}showServerRestartPrompt(){return n(this,void 0,void 0,(function*(){(yield r.window.showInformationMessage("Needing to reanalyze a lot? Please consider filing a bug with a server instrumentation log",s.issueTrackerAction))===s.issueTrackerAction&&(yield o.envUtils.openInBrowser(s.issueTrackerUri,this.logger))}))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.VmServiceExtensions=t.timeDilationSlow=t.timeDilationNormal=t.IS_INSPECTING_WIDGET_CONTEXT=void 0;const r=i(0),s=i(4),o=i(8),a=i(44);t.IS_INSPECTING_WIDGET_CONTEXT="dart-code:flutter.isInspectingWidget";const c={[o.VmServiceExtension.PlatformOverride]:"value",[o.VmServiceExtension.DebugBanner]:"enabled",[o.VmServiceExtension.CheckElevations]:"enabled",[o.VmServiceExtension.DebugPaint]:"enabled",[o.VmServiceExtension.PaintBaselines]:"enabled",[o.VmServiceExtension.InspectorSelectMode]:"enabled",[o.VmServiceExtension.BrightnessOverride]:"value",[o.VmServiceExtension.RepaintRainbow]:"enabled",[o.VmServiceExtension.PerformanceOverlay]:"enabled",[o.VmServiceExtension.SlowAnimations]:"timeDilation"};t.timeDilationNormal=1,t.timeDilationSlow=5;const l={[o.VmServiceExtension.PlatformOverride]:null,[o.VmServiceExtension.DebugBanner]:!0,[o.VmServiceExtension.CheckElevations]:!1,[o.VmServiceExtension.DebugPaint]:!1,[o.VmServiceExtension.PaintBaselines]:!1,[o.VmServiceExtension.InspectorSelectMode]:!1,[o.VmServiceExtension.BrightnessOverride]:null,[o.VmServiceExtension.RepaintRainbow]:!1,[o.VmServiceExtension.PerformanceOverlay]:!1,[o.VmServiceExtension.SlowAnimations]:t.timeDilationNormal};t.VmServiceExtensions=class{constructor(e,t){this.logger=e,this.registeredServices={},this.loadedServiceExtensions=[],this.currentExtensionState=Object.assign({},l),this.sendValueToVM=e=>{if(-1!==this.loadedServiceExtensions.indexOf(e)&&void 0!==c[e]){const i={[c[e]]:this.currentExtensionState[e]};t({type:e,params:i}),this.syncInspectingWidgetContext(e)}}}handleDebugEvent(e,t){return n(this,void 0,void 0,(function*(){if("dart.serviceExtensionAdded"===t.event){this.handleServiceExtensionLoaded(e,t.body.id);try{if("ext.flutter.inspector.isWidgetCreationTracked"===t.body.id)yield t.session.customRequest("checkIsWidgetCreationTracked");else if(t.body.id===o.VmServiceExtension.PlatformOverride)yield t.session.customRequest("checkPlatformOverride");else if(t.body.id===o.VmServiceExtension.BrightnessOverride)yield t.session.customRequest("checkBrightnessOverride");else if(t.body.id===o.VmServiceExtension.InspectorSetPubRootDirectories){t.session.configuration.debuggerType!==o.DebuggerType.Web&&(yield t.session.customRequest("serviceExtension",{params:{arg0:this.formatPathForPubRootDirectories(t.session.configuration.cwd),arg1:t.session.configuration.cwd,isolateId:t.body.isolateId},type:"ext.flutter.inspector.setPubRootDirectories"}))}}catch(e){this.logger.error(e)}}else if("dart.serviceRegistered"===t.event)this.handleServiceRegistered(t.body.service,t.body.method);else if("dart.flutter.firstFrame"===t.event)for(const e in o.VmServiceExtension)this.sendValueToVM(e);else"dart.flutter.updateIsWidgetCreationTracked"===t.event?r.commands.executeCommand("setContext",s.TRACK_WIDGET_CREATION_ENABLED,t.body.isWidgetCreationTracked):"dart.flutter.updatePlatformOverride"===t.event?this.currentExtensionState[o.VmServiceExtension.PlatformOverride]=t.body.platform:"dart.flutter.updateBrightnessOverride"===t.event?this.currentExtensionState[o.VmServiceExtension.BrightnessOverride]=t.body.brightness:"dart.flutter.serviceExtensionStateChanged"===t.event&&this.handleRemoteValueUpdate(t.body.extension,t.body.value)}))}formatPathForPubRootDirectories(e){return s.isWin?e&&"file:///"+e.replace(/\\/g,"/"):e}toggle(e,t=!0,i=!1){this.currentExtensionState[e]=this.currentExtensionState[e]!==t?t:i,this.sendValueToVM(e)}syncInspectingWidgetContext(e){r.commands.executeCommand("setContext",t.IS_INSPECTING_WIDGET_CONTEXT,this.currentExtensionState[o.VmServiceExtension.InspectorSelectMode])}handleRemoteValueUpdate(e,t){if(void 0!==this.currentExtensionState[e]){if("string"==typeof t)try{t=JSON.parse(t)}catch(e){}this.currentExtensionState[e]=t,this.syncInspectingWidgetContext(e)}}resetToDefaults(){this.currentExtensionState=Object.assign({},l)}handleServiceRegistered(e,t){this.registeredServices[e]=t,r.commands.executeCommand("setContext",`${a.SERVICE_CONTEXT_PREFIX}${e}`,!0)}handleServiceExtensionLoaded(e,t){e.loadedServiceExtensions.push(t),this.loadedServiceExtensions.push(t),r.commands.executeCommand("setContext",`${a.SERVICE_EXTENSION_CONTEXT_PREFIX}${t}`,!0)}markAllServicesUnloaded(){for(const e of Object.keys(this.registeredServices))r.commands.executeCommand("setContext",`${a.SERVICE_CONTEXT_PREFIX}${e}`,void 0);this.registeredServices={};for(const e of this.loadedServiceExtensions)r.commands.executeCommand("setContext",`${a.SERVICE_EXTENSION_CONTEXT_PREFIX}${e}`,void 0);this.loadedServiceExtensions.length=0,r.commands.executeCommand("setContext",s.TRACK_WIDGET_CREATION_ENABLED,!1)}serviceIsRegistered(e){return!!this.registeredServices[e]}getServiceMethodName(e){return this.registeredServices[e]}serviceExtensionIsLoaded(e){return!!this.loadedServiceExtensions.find(t=>t===e)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DevToolsManager=void 0;const r=i(5),s=i(18),o=i(2),a=i(0),c=i(0),l=i(203),u=i(4),d=i(8),h=i(13),f=i(41),g=i(3),p=i(21),m=i(1),v=i(30),y=i(6),b=i(99),C=i(10),w=i(15),S=i(204);let T;t.DevToolsManager=class{constructor(e,t,i,n,r){var s;this.logger=e,this.workspaceContext=t,this.debugCommands=i,this.analytics=n,this.pubGlobal=r,this.disposables=[],this.devToolsStatusBarItem=a.window.createStatusBarItem(a.StatusBarAlignment.Right,100),this.devToolsEmbeddedViews={},this.capabilities=l.DevToolsCapabilities.empty,this.disposables.push(this.devToolsStatusBarItem),(null===(s=t.config)||void 0===s?void 0:s.activateDevToolsEagerly)&&this.preActivate(!0).then(()=>{this.logger.info("Finished background activating DevTools")},e=>{this.logger.error("Failed to background activate DevTools"),this.logger.error(e),a.window.showErrorMessage("Failed to activate DevTools: "+e)})}get devToolsActivation(){return this.devToolsActivationPromise}preActivate(e){var t;return n(this,void 0,void 0,(function*(){this.devToolsActivationPromise=this.pubGlobal.backgroundActivate("Dart DevTools","devtools",e,null===(t=this.workspaceContext.config)||void 0===t?void 0:t.devtoolsActivateScript),yield this.devToolsActivationPromise}))}spawnForSession(e,t){var i,r;return n(this,void 0,void 0,(function*(){if(this.analytics.logDebuggerOpenDevTools(),yield this.devToolsActivationPromise,this.service&&!this.service.isValidForCurrentSettings&&(this.service.dispose(),this.service=void 0,this.devtoolsUrl=void 0),!this.devtoolsUrl){if(!(null===(i=this.workspaceContext.config)||void 0===i?void 0:i.activateDevToolsEagerly)){const e=yield this.pubGlobal.promptToInstallIfRequired("Dart DevTools","devtools",void 0,"0.8.0",null===(r=this.workspaceContext.config)||void 0===r?void 0:r.devtoolsActivateScript,!0);if(!e)return;this.capabilities.version=e}this.devtoolsUrl=a.window.withProgress({location:a.ProgressLocation.Notification,title:"Starting Dart DevTools..."},e=>n(this,void 0,void 0,(function*(){return this.startServer()})))}if(this.capabilities.supportsEmbedFlag||(t.embed=!1),t.embed&&!t.page){const e=yield this.promptForDevToolsPage();if(!e)return;"EXTERNAL"===e?t.embed=!1:t.page=e.page}try{const i=yield this.devtoolsUrl;return yield a.window.withProgress({location:a.ProgressLocation.Notification,title:"Opening Dart DevTools..."},i=>n(this,void 0,void 0,(function*(){const i=y.isRunningLocally&&!t.embed&&!process.env.DART_CODE_IS_TEST_RUN&&(yield v.waitFor(()=>this.debugCommands.vmServices.serviceIsRegistered(d.VmService.LaunchDevTools),500));yield this.launch(!!i,e,t)}))),this.devToolsStatusBarItem.text="Dart DevTools",this.devToolsStatusBarItem.tooltip="Dart DevTools is running at "+i,this.devToolsStatusBarItem.command="dart.openDevTools",this.devToolsStatusBarItem.show(),{url:i,dispose:()=>this.dispose()}}catch(e){this.devToolsStatusBarItem.hide(),this.showError(e)}}))}promptForDevToolsPage(){return n(this,void 0,void 0,(function*(){const e=[...u.devToolsPages.map(e=>({label:`Open ${e} Page`,page:e.toLowerCase()})),{label:"Open DevTools in Web Browser",isExternal:!0}],t=yield a.window.showQuickPick(e,{placeHolder:"Which DevTools page?"});return t?t.isExternal?"EXTERNAL":t.page?{page:t.page}:void 0:void 0}))}showError(e){this.logger.error(e),a.window.showErrorMessage(""+e)}reconnectDisconnectedEmbeddedViews(e){return n(this,void 0,void 0,(function*(){if(this.devtoolsUrl)for(const t of Object.keys(this.devToolsEmbeddedViews)){const i=this.devToolsEmbeddedViews[t];if(!i)continue;const n=i.find(e=>e.session.hasEnded);n&&(n.session=e,yield this.launch(!1,e,{embed:!0,page:t}))}}))}launch(e,t,i){return n(this,void 0,void 0,(function*(){const n=yield this.devtoolsUrl;if(!n)return void this.showError("DevTools URL not available");const r={hide:"debugger",ide:"VSCode",theme:C.config.useDevToolsDarkTheme&&!i.embed?"dark":void 0};if(e&&(yield this.launchThroughService(t,Object.assign(Object.assign({},i),{queryParams:r}))))return!0;i.page&&(r.page=i.page),i.embed&&(r.embed="true");const s=yield this.buildDevToolsUrl(r,t,n);i.embed?this.launchInEmbeddedWebView(s,t,i.page||"inspector"):yield y.envUtils.openInBrowser(s.toString(),this.logger)}))}buildDevToolsUrl(e,t,i){return n(this,void 0,void 0,(function*(){const n=Object.keys(e).filter(t=>void 0!==e[t]).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&"),r=a.Uri.parse(t.vmServiceUri),s=yield y.envUtils.exposeUrl(r,this.logger);return a.Uri.parse(`${i}?${n}&uri=${encodeURIComponent(s)}`)}))}launchInEmbeddedWebView(e,t,i){var n,r;this.devToolsEmbeddedViews[i]||(this.devToolsEmbeddedViews[i]=[]);let s=null===(n=this.devToolsEmbeddedViews[i])||void 0===n?void 0:n.find(e=>e.session===t||e.session.hasEnded);s||(s=new S.DevToolsEmbeddedView(t,e,i),s.onDispose.listen(()=>delete this.devToolsEmbeddedViews[i]),null===(r=this.devToolsEmbeddedViews[i])||void 0===r||r.push(s)),null==s||s.load(t,e)}launchThroughService(e,t){return n(this,void 0,void 0,(function*(){try{return yield e.session.customRequest("service",{params:t,type:this.debugCommands.vmServices.getServiceMethodName(d.VmService.LaunchDevTools)}),!0}catch(e){return this.logger.error("DevTools failed to launch Chrome, will launch default browser locally instead: "+e.message),a.window.showWarningMessage("Dart DevTools was unable to launch Chrome so your default browser was launched instead.","Show Full Error").then(t=>{if(t){const t=`bug-${m.getRandomInt(4096,65536).toString(16)}.txt`,i=o.join(s.tmpdir(),t);r.writeFileSync(i,e.message||e),c.workspace.openTextDocument(i).then(e=>{c.window.showTextDocument(e)})}}),!1}}))}startServer(e=!1){return new Promise((t,i)=>{if(this.service)try{this.service.dispose(),this.service=void 0,this.devtoolsUrl=void 0}catch(e){this.logger.error(e)}this.service=new E(this.logger,this.workspaceContext,this.capabilities);const r=this.service;this.disposables.push(r),r.registerForServerStarted(e=>{this.disposables.push(this.debugCommands.onDebugSessionVmServiceAvailable(e=>n(this,void 0,void 0,(function*(){r.vmRegister({uri:e.vmServiceUri}),e.vmServiceUri&&(yield this.reconnectDisconnectedEmbeddedViews(e))}))));for(const e of b.debugSessions)e.vmServiceUri&&r.vmRegister({uri:e.vmServiceUri});T=e.port,t(`http://${e.host}:${e.port}/`)}),r.process.on("close",r=>n(this,void 0,void 0,(function*(){var n;if(this.devtoolsUrl=void 0,this.devToolsStatusBarItem.hide(),r&&0!==r){T=0;const s=`Dart DevTools exited with code ${r}.`;if(this.logger.error(s),!e&&!(null===(n=this.workspaceContext.config)||void 0===n?void 0:n.devtoolsActivateScript)){if((yield a.window.showErrorMessage(s+" Would you like to try reactivating DevTools?",u.reactivateDevToolsAction,u.skipAction))===u.reactivateDevToolsAction){try{yield this.preActivate(!1),yield this.startServer(!0),t()}catch(e){i(e)}return}}i(s)}})))})}dispose(){this.disposables.forEach(e=>e.dispose())}};class E extends f.StdIOService{constructor(e,t,i){var n;super(new h.CategoryLogger(e,d.LogCategory.DevTools),C.config.maxLogLineLength),this.capabilities=i,this.serverStartedSubscriptions=[],this.spawnedArgs=this.getDevToolsArgs();const{binPath:r,binArgs:s}=g.usingCustomScript(o.join(t.sdks.dart,u.pubPath),this.spawnedArgs,null===(n=t.config)||void 0===n?void 0:n.devtoolsRunScript);T=C.config.devToolsPort||T||(u.isChromeOS&&C.config.useKnownChromeOSPorts?u.CHROME_OS_DEVTOOLS_PORT:void 0),T&&(s.push("--port"),s.push(T.toString())),this.registerForServerStarted(e=>this.additionalPidsToTerminate.push(e.pid)),this.createProcess(void 0,r,s,{toolEnv:w.getToolEnv()})}get isValidForCurrentSettings(){return this.spawnedArgs&&p.arraysEqual(this.spawnedArgs,this.getDevToolsArgs())}getDevToolsArgs(){const e=this.capabilities.supportsEmbedFlag?["--allow-embedding"]:["--enable-notifications"];return["global","run","devtools","--machine","--try-ports","10"].concat(e)}shouldHandleMessage(e){return e.startsWith("{")&&e.endsWith("}")}isNotification(e){return e.event||"server.started"===e.method}handleNotification(e){return n(this,void 0,void 0,(function*(){switch(e.method||e.event){case"server.started":yield this.notify(this.serverStartedSubscriptions,e.params)}}))}registerForServerStarted(e){return this.subscribe(this.serverStartedSubscriptions,e)}vmRegister(e){return this.sendRequest("vm.register",e)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DevToolsCapabilities=void 0;const n=i(3);class r{constructor(e){this.version=e}static get empty(){return new r("0.0.0")}get supportsEmbedFlag(){return n.versionIsAtLeast(this.version,"0.8.0")}}t.DevToolsCapabilities=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DevToolsEmbeddedView=void 0;const n=i(0),r=i(91),s=i(6),o={inspector:"Flutter Widget Inspector",memory:"Flutter Memory View",performance:"Flutter Performance View",timeline:"Flutter Timeline"},a="\nwindow.addEventListener('message', (event) => {\n\tconst message = event.data;\n\tconst devToolsFrame = document.getElementById('devToolsFrame');\n\tswitch (message.command) {\n\t\tcase \"setUrl\":\n\t\t\tconst theme = document.body.classList.contains('vscode-light') ? 'light': 'dark';\n\t\t\tconst background = getComputedStyle(document.documentElement).getPropertyValue('--vscode-editor-background');\n\t\t\tconst foreground = getComputedStyle(document.documentElement).getPropertyValue('--vscode-editor-foreground');\n\t\t\tconst url = `${message.url}&theme=${theme}&backgroundColor=${encodeURIComponent(background)}&foregroundColor=${encodeURIComponent(foreground)}`;\n\t\t\tif (devToolsFrame.src !== url)\n\t\t\t\tdevToolsFrame.src = url;\n\t\t\tbreak;\n\t}\n});\n",c=Buffer.from(a).toString("base64"),l="position: absolute; top: 0; left: 0; width: 100%; height: 100%",u=Buffer.from(l).toString("base64");t.DevToolsEmbeddedView=class{constructor(e,t,i){this.session=e,this.devToolsUri=t,this.page=i,this.onDisposeEmitter=new r.EventEmitter,this.onDispose=this.onDisposeEmitter.event;const d=o[i]||"Dart DevTools",h=s.firstNonEditorColumn()||n.ViewColumn.Beside;this.panel=n.window.createWebviewPanel("dartDevTools",d,h,{enableScripts:!0,localResourceRoots:[],retainContextWhenHidden:!0}),this.panel.onDidDispose(()=>this.dispose(!0)),this.panel.webview.html=`\n\t\t\t<html>\n\t\t\t<head>\n\t\t\t<meta http-equiv="Content-Security-Policy" content="default-src 'self' 'nonce-${c}' 'nonce-${u}' http://${t.authority};">\n\t\t\t<script nonce="${c}">${a}<\/script>\n\t\t\t<style nonce="${u}">#devToolsFrame { ${l} }</style>\n\t\t\t</head>\n\t\t\t<body><iframe id="devToolsFrame" src="about:blank" frameborder="0"></iframe></body>\n\t\t\t</html>\n\t\t\t`}load(e,t){this.session=e,this.panel.webview.postMessage({command:"setUrl",url:t.toString()}),this.panel.reveal()}dispose(e=!1){e||this.panel.dispose(),this.onDisposeEmitter.fire()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProgressMessage=t.DartDebugSessionInformation=void 0;t.DartDebugSessionInformation=class{constructor(e,t){this.session=e,this.debuggerType=t,this.sessionStart=new Date,this.hasEnded=!1,this.progress={},this.loadedServiceExtensions=[]}};t.ProgressMessage=class{constructor(e,t){this.reporter=e,this.completer=t}report(e){this.reporter.report({message:e})}complete(){this.completer.resolve()}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EditCommands=void 0;const r=i(0),s=i(4),o=i(6);t.EditCommands=class{constructor(){this.commands=[],this.commands.push(r.commands.registerCommand("_dart.jumpToLineColInUri",this.jumpToLineColInUri,this),r.commands.registerCommand("_dart.showCode",o.showCode,this),r.commands.registerCommand("dart.writeRecommendedSettings",this.writeRecommendedSettings,this))}jumpToLineColInUri(e,t,i,s){return n(this,void 0,void 0,(function*(){if(!e||"file"!==e.scheme)return;const n=s?o.firstEditorColumn()||r.ViewColumn.Beside:r.ViewColumn.Active,a=yield r.workspace.openTextDocument(e),c=yield r.window.showTextDocument(a,n,s);if(t&&i){const e=a.lineAt(t>0?t-1:0),i=e.range.start.translate({characterDelta:e.firstNonWhitespaceCharacterIndex});o.showCode(c,e.range,e.range,new r.Range(i,i))}}))}writeRecommendedSettings(){return n(this,void 0,void 0,(function*(){const e=r.workspace.getConfiguration("",null),t=e.inspect("[dart]"),i=t?t.globalValue:void 0,n=Object.assign({},s.dartRecommendedConfig,i);yield e.update("[dart]",n,r.ConfigurationTarget.Global);(yield r.window.showInformationMessage("Recommended settings were written to the [dart] section of your global settings file",s.openSettingsAction))===s.openSettingsAction&&(yield r.commands.executeCommand("workbench.action.openSettingsJson"))}))}dispose(){for(const e of this.commands)e.dispose()}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspEditCommands=void 0;const r=i(0),s=i(93);t.LspEditCommands=class{constructor(e){this.analyzer=e,this.commands=[],this.commands.push(r.commands.registerCommand("dart.sortMembers",()=>this.runCodeAction("source.sortMembers")))}runCodeAction(e){return n(this,void 0,void 0,(function*(){return r.commands.executeCommand("editor.action.codeAction",{kind:e,apply:"ifSingle"})}))}completeStatement(){return n(this,void 0,void 0,(function*(){const e=r.window.activeTextEditor;if(!e||!e.selection)return;const t=yield this.analyzer.completeStatement({position:this.analyzer.client.code2ProtocolConverter.asPosition(e.selection.start),textDocument:this.analyzer.client.code2ProtocolConverter.asVersionedTextDocumentIdentifier(e.document)});if(t)if(yield this.validDocumentVersionsStillMatch(t)){const e=this.analyzer.client.protocol2CodeConverter.asWorkspaceEdit(t);(yield r.workspace.applyEdit(e))||r.window.showErrorMessage("VS Code failed to apply edits")}else r.window.showErrorMessage("Documents have been modified so edits could not be applied")}))}validDocumentVersionsStillMatch(e){return n(this,void 0,void 0,(function*(){if(!e.documentChanges)return!0;const t=new Map;r.workspace.textDocuments.forEach(e=>t.set(e.uri.toString(),e));for(const i of e.documentChanges)if(s.TextDocumentEdit.is(i)&&i.textDocument.version&&i.textDocument.version>=0&&s.TextDocumentEdit.is(i)&&i.textDocument.version&&i.textDocument.version>=0){const e=t.get(i.textDocument.uri);if(e&&e.version!==i.textDocument.version)return!1}return!0}))}dispose(){for(const e of this.commands)e.dispose()}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.GoToSuperCommand=void 0;const r=i(0),s=i(1),o=i(6),a=i(54),c=i(120);t.GoToSuperCommand=class{constructor(e){this.analyzer=e,this.disposables=[],this.disposables.push(r.commands.registerCommand("dart.goToSuper",this.goToSuper,this))}goToSuper(){return n(this,void 0,void 0,(function*(){const e=a.getActiveDartEditor();if(!e)return void r.window.showWarningMessage("No active Dart editor.");const t=e.document,i=e.selection.start,n=c.findNearestOutlineNode(this.analyzer.fileTracker,t,i),l=n&&n.element&&n.element.location?n.element.location.offset:t.offsetAt(i),u=yield this.analyzer.client.searchGetTypeHierarchy({file:s.fsPath(t.uri),offset:l,superOnly:!0});if(!u||!u.hierarchyItems||!u.hierarchyItems.length||1===u.hierarchyItems.length)return;const d=!u.hierarchyItems[0].memberElement,h=u.hierarchyItems.slice(1).find(e=>d?!!e.classElement:!!e.memberElement),f=d?h&&h.classElement:h&&h.memberElement;if(!f||!f.location)return;const g=yield r.workspace.openTextDocument(f.location.file),p=yield r.window.showTextDocument(g),m=o.toRangeOnLine(f.location);o.showCode(p,m,m,m)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.OpenInOtherEditorCommands=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(8),l=i(13),u=i(1),d=i(15);t.OpenInOtherEditorCommands=class{constructor(e,t){this.logger=e,this.sdks=t,this.disposables=[],this.disposables.push(o.commands.registerCommand("flutter.openInAndroidStudio",this.openInAndroidStudio,this),o.commands.registerCommand("flutter.openInXcode",this.openInXcode,this))}openInAndroidStudio(e){return n(this,void 0,void 0,(function*(){const t=u.fsPath(e);let i=yield this.getAndroidStudioDir(t);if(i){if(a.isMac&&i.endsWith("/Contents"))return i=i.substr(0,i.length-"/Contents".length),void d.safeToolSpawn(t,"open",["-a",i,t]);for(const e of a.androidStudioPaths){const n=s.join(i,e);if(r.existsSync(n))return void d.safeToolSpawn(t,n,[t])}o.window.showErrorMessage("Unable to locate Android Studio executable")}else o.window.showErrorMessage("Unable to find Android Studio")}))}openInXcode(e){return n(this,void 0,void 0,(function*(){const t=u.fsPath(e),i=r.readdirSync(t,{withFileTypes:!0}).filter(e=>e.isDirectory()).filter(e=>e.name.endsWith(".xcworkspace")||e.name.endsWith(".xcodeproj")).sort((e,t)=>e.name.endsWith(".xcworkspace")?-1:1);if(!i||!i.length)return void o.window.showErrorMessage("Unable to find an Xcode project in your 'ios' folder");const n=s.join(t,i[0].name);d.safeToolSpawn(t,"open",[n])}))}getAndroidStudioDir(e){return new Promise((t,i)=>{if(!this.sdks.flutter)return void i("Cannot find Android Studio without a Flutter SDK");const n=s.join(this.sdks.flutter,a.flutterPath),r=d.safeToolSpawn(e,n,["config","--machine"]);l.logProcess(this.logger,c.LogCategory.CommandProcesses,r);const o=[];r.stdout.on("data",e=>{o.push(e.toString())}),r.on("exit",()=>{try{if(o.length){const e=JSON.parse(o.join(""));return void t(e["android-studio-dir"])}}catch(e){this.logger.error(e)}i()})})}dispose(){for(const e of this.disposables)e.dispose()}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RefactorCommands=void 0;const r=i(5),s=i(0),o=i(4),a=i(3),c=i(21),l=i(1),u=i(30),d=i(10),h=i(100),f={EXTRACT_LOCAL_VARIABLE:function(e){return n(this,void 0,void 0,(function*(){const t=e;return{name:t&&t.names&&t.names.length?t.names[0]:"x",extractAll:!1}}))},EXTRACT_METHOD:function(e){return n(this,void 0,void 0,(function*(){const t=e,i=t&&t.names&&t.names.length?t.names[0]:void 0,n=yield s.window.showInputBox({prompt:"Enter a name for the method",value:i});if(n)return{createGetter:!1,extractAll:!1,name:n,parameters:t&&t.parameters,returnType:t&&t.returnType}}))},EXTRACT_WIDGET:function(e){return n(this,void 0,void 0,(function*(){const e=yield s.window.showInputBox({prompt:"Enter a name for the widget"});return e?{name:e}:void 0}))}};t.RefactorCommands=class{constructor(e,t,i){this.logger=e,this.context=t,this.analyzer=i,this.subscriptions=[],this.isProcessingMoveEvent=!1,this.inProgressRefactor=u.resolvedPromise,this.subscriptions.push(s.commands.registerCommand("_dart.performRefactor",this.performRefactor,this)),i.capabilities.supportsMoveFile&&d.config.updateImportsOnRename&&this.subscriptions.push(s.workspace.onWillRenameFiles(e=>this.onWillRenameFiles(e)))}performRefactor(e,t,i){return n(this,void 0,void 0,(function*(){if(!e||e.isClosed)return;const n=e.version,r=yield this.getRefactor(e,i,t,!0);if(this.shouldAbortRefactor(r))return;let o;if(f[i]&&(o=yield f[i](r.feedback),!o))return;const a=yield this.getRefactor(e,i,t,!1,o);(yield this.shouldApplyEdits(a,e,n))&&(yield s.commands.executeCommand("_dart.applySourceChange",e,a.change))}))}getRefactor(e,t,i,r,s){return n(this,void 0,void 0,(function*(){let n=3;for(;;)try{return n--,yield this.analyzer.editGetRefactoring({file:l.fsPath(e.uri),kind:t,length:e.offsetAt(i.end)-e.offsetAt(i.start),offset:e.offsetAt(i.start),options:s,validateOnly:r})}catch(e){if(this.logger.error(e),n<=0||"REFACTORING_REQUEST_CANCELLED"!==e.code)throw e;this.logger.info(`getRefactor failed, will try ${n} more times...`)}}))}shouldAbortRefactor(e){const t=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems).filter(e=>"FATAL"===e.severity);return!!t.length&&(s.window.showErrorMessage(t[0].message),!0)}shouldApplyEdits(e,t,i){return n(this,void 0,void 0,(function*(){const n=e.initialProblems.concat(e.optionsProblems).concat(e.finalProblems),r=n.filter(e=>"FATAL"===e.severity),a=n.filter(e=>"ERROR"===e.severity||"WARNING"===e.severity),l=!!n.find(e=>"ERROR"===e.severity);if(r.length)return s.window.showErrorMessage(c.unique(r.map(e=>e.message)).join("\n\n")+"\n\nYour refactor was not applied."),!1;if(!e.change)return!1;let u=!0;if(a.length){const e=l?s.window.showErrorMessage:s.window.showWarningMessage;u=o.REFACTOR_ANYWAY===(yield e(c.unique(a.map(e=>e.message)).join("\n\n"),o.REFACTOR_ANYWAY))}return u&&t&&t.version!==i?(s.window.showErrorMessage(o.REFACTOR_FAILED_DOC_MODIFIED),!1):u}))}onWillRenameFiles(e){if(this.isProcessingMoveEvent)this.logger.info("Skipping rename event for some files because another is in progress");else{this.isProcessingMoveEvent=!0;try{const t=a.flatMap(e.files,e=>this.getFilesToRename({oldPath:l.fsPath(e.oldUri),newPath:l.fsPath(e.newUri)})),i=this.getRenameEdits(t);e.waitUntil(i.finally(()=>this.isProcessingMoveEvent=!1))}catch(e){this.isProcessingMoveEvent=!1}}}runSequentially(e){return n(this,void 0,void 0,(function*(){return this.inProgressRefactor=this.inProgressRefactor.then(()=>e()),this.inProgressRefactor}))}getRenameEdits(e){return n(this,void 0,void 0,(function*(){const t=new s.WorkspaceEdit;for(const i of e){const e=yield this.runSequentially(()=>this.analyzer.editGetRefactoring({file:i.oldPath,kind:"MOVE_FILE",length:0,offset:0,options:{newFile:i.newPath},validateOnly:!1}));if(!e.change)continue;if(yield this.shouldApplyEdits(e)){if(h.hasOverlappingEdits(e.change))return s.window.showErrorMessage("Unable to update references; edits contain ambigious positions."),void this.logger.error("Unable to apply MOVE_FILE edits due to ambigious edits:\n\n"+JSON.stringify(e.change,void 0,4));for(const i of e.change.edits)for(const e of i.edits){const n=s.Uri.file(i.file),r=yield s.workspace.openTextDocument(n);t.replace(s.Uri.file(i.file),new s.Range(r.positionAt(e.offset),r.positionAt(e.offset+e.length)),e.replacement)}}}return t}))}getFilesToRename(e){const t=[];return r.statSync(e.oldPath).isFile()&&t.push(e),t}dispose(){for(const e of this.subscriptions)e.dispose()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promptToRunPubGet=t.isPubGetProbablyRequired=void 0;const n=i(5),r=i(2),s=i(0),o=i(1);t.isPubGetProbablyRequired=function(e){const t=o.fsPath(e),i=r.join(t,"pubspec.yaml"),s=r.join(t,".packages");return!(!t||!n.existsSync(i))&&(!!new RegExp("dependencies\\s*:","i").test(n.readFileSync(i).toString())&&(!n.existsSync(s)||n.statSync(i).mtime>n.statSync(s).mtime))},t.promptToRunPubGet=function(e){s.window.showInformationMessage("Some packages are missing or out of date, would you like to get them now?","Get packages").then(t=>{"Get packages"===t&&function(e){let t=s.commands.executeCommand("dart.getPackages",e[0]);for(let i=1;i<e.length;i++)t=t.then(t=>{if(0===t)return s.commands.executeCommand("dart.getPackages",e[i])})}(e)})}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Stagehand=void 0;const r=i(2),s=i(0),o=i(4),a=i(8),c=i(13),l=i(15);t.Stagehand=class{constructor(e,t,i){this.logger=e,this.sdks=t,this.pubGlobal=i}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired("Stagehand","stagehand",o.stagehandInstallationInstructionsUrl,"3.3.0")}getTemplates(){return n(this,void 0,void 0,(function*(){const e=yield this.getTemplateJson();return JSON.parse(e)}))}getTemplateJson(){return n(this,void 0,void 0,(function*(){return this.runCommandWithProgress("Fetching Stagehand templates...",["global","run","stagehand","--machine"])}))}runCommandWithProgress(e,t){return s.window.withProgress({location:s.ProgressLocation.Notification,title:e},e=>this.runCommand(t))}runCommand(e){const t=this.sdks.dart,i=r.join(t,o.pubPath);return new Promise((t,n)=>{const r=l.safeToolSpawn(void 0,i,e);c.logProcess(this.logger,a.LogCategory.CommandProcesses,r);const s=[],o=[];r.stdout.on("data",e=>s.push(e.toString())),r.stderr.on("data",e=>o.push(e.toString())),r.on("close",e=>{e?n(`Stagehand exited with code ${e}.\n\n${s.join("")}\n\n${o.join("")}`):t(s.join(""))})})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getFlutterSnippets=void 0;const r=i(5),s=i(39),o=i(18),a=i(2),c=i(4),l=i(1),u=i(15);t.getFlutterSnippets=function(e,t,i){return i.supportsFlutterCreateListSamples?function(e,t){return n(this,void 0,void 0,(function*(){if(!t.flutter)throw new Error("Flutter SDK not available");const i=a.join(t.flutter,c.flutterPath),n=`flutter-samples-${l.getRandomInt(4096,65536).toString(16)}.txt`,s=a.join(o.tmpdir(),n);try{const t=yield u.runProcess(e,void 0,i,["create","--list-samples",s]);if(0!==t.exitCode)throw new Error(`Failed to get Flutter samples from SDK (${t.exitCode})\n\n${t.stderr}\n\n${t.stdout}`);const n=r.readFileSync(s,{encoding:"utf8"});return JSON.parse(n)}finally{l.tryDeleteFile(s)}}))}(e,t):new Promise((e,t)=>{s.request({hostname:"api.flutter.dev",method:"GET",path:"/snippets/index.json",port:443},i=>{if(!i||!i.statusCode||i.statusCode<200||i.statusCode>300)t({message:`Failed to get Flutter samples ${i&&i.statusCode}: ${i&&i.statusMessage}`});else{const t=[];i.on("data",e=>t.push(e.toString())),i.on("end",()=>{const i=t.join("");e(JSON.parse(i))})}}).end()})}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterSdkManager=t.DartSdkManager=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(3),l=i(1),u=i(10),d=i(7);class h{constructor(e,t){this.logger=e,this.sdks=t}changeSdk(){this.sdkPaths?this.searchForSdks(this.sdkPaths).catch(e=>console.error(e)):o.window.showWarningMessage("Set `${configName}` to enable fast SDK switching.")}searchForSdks(e){return n(this,void 0,void 0,(function*(){let t=[];for(const i of e.filter(r.existsSync))t.push(i),t=t.concat(yield l.getChildFolders(i));this.currentSdk&&-1===t.indexOf(this.currentSdk)&&t.push(this.currentSdk);const i=t.filter(e=>r.existsSync(s.join(e,this.executablePath))).map(e=>{const t=r.realpathSync(s.join(e,this.executablePath)),i=s.dirname(s.dirname(t)),n=d.getSdkVersion(this.logger,{sdkRoot:i});return{description:e===this.currentSdk&&this.configuredSdk?"Current setting":"",detail:e,folder:e,label:n?this.getLabel(n):"Unknown version",version:n}}).sort((e,t)=>c.versionIsAtLeast(e.version||"0.0.0",t.version||"0.0.0")?1:-1);if(0===i.length)return;const n=[{description:this.configuredSdk?"":"Current setting",detail:this.configuredSdk?void 0:"Found at "+this.currentSdk,folder:void 0,label:"Auto-detect SDK location",version:void 0}].concat(i);o.window.showQuickPick(n,{placeHolder:"Select an SDK to use"}).then(e=>{e&&this.setSdk(e.folder)})}))}}t.DartSdkManager=class extends h{get sdkPaths(){return u.config.sdkPaths}get currentSdk(){return this.sdks.dart}get configuredSdk(){return u.config.sdkPath}get configName(){return"dart.sdkPaths"}get executablePath(){return a.dartVMPath}getLabel(e){return"Dart SDK "+e}setSdk(e){u.config.setSdkPath(e)}};t.FlutterSdkManager=class extends h{get sdkPaths(){return u.config.flutterSdkPaths}get currentSdk(){return this.sdks.flutter}get configuredSdk(){return u.config.flutterSdkPath}get configName(){return"dart.flutterSdkPaths"}get executablePath(){return a.flutterPath}getLabel(e){return"Flutter SDK "+e}setSdk(e){u.config.setFlutterSdkPath(e)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspTestCommands=t.DasTestCommands=t.isInImplementationFileThatCanHaveTest=t.isInTestFileThatHasImplementation=t.cursorIsInTest=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(3),l=i(1),u=i(97),d=i(98),h=i(124),f=i(54),g=i(7);t.cursorIsInTest=!1,t.isInTestFileThatHasImplementation=!1,t.isInImplementationFileThatCanHaveTest=!1;class p{constructor(e,t){this.logger=e,this.wsContext=t,this.disposables=[],this.disposables.push(o.commands.registerCommand("dart.runTestAtCursor",()=>this.runTestAtCursor(!1),this),o.commands.registerCommand("dart.goToTests",e=>this.goToTestOrImplementationFile(e),this),o.commands.registerCommand("dart.goToTestOrImplementationFile",()=>this.goToTestOrImplementationFile(),this),o.commands.registerCommand("dart.debugTestAtCursor",()=>this.runTestAtCursor(!0),this),o.window.onDidChangeTextEditorSelection(e=>this.updateSelectionContexts(e)),o.window.onDidChangeActiveTextEditor(e=>this.updateEditorContexts(e))),this.updateEditorContexts(o.window.activeTextEditor),this.disposables.push(o.commands.registerCommand("_dart.startDebuggingTestFromOutline",(e,t)=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(o.Uri.file(e.file)),h.getLaunchConfig(!1,e.file,e.fullName,e.isGroup,t))})),this.disposables.push(o.commands.registerCommand("_dart.startWithoutDebuggingTestFromOutline",(e,t)=>{o.debug.startDebugging(o.workspace.getWorkspaceFolder(o.Uri.file(e.file)),h.getLaunchConfig(!0,e.file,e.fullName,e.isGroup,t))}))}runTestAtCursor(e){return n(this,void 0,void 0,(function*(){const t=o.window.activeTextEditor,i=t&&t.selection&&this.testForCursor(t);if(i){const t=e?"_dart.startDebuggingTestFromOutline":"_dart.startWithoutDebuggingTestFromOutline";o.commands.executeCommand(t,i)}else o.window.showWarningMessage("There is no test at the current location.")}))}goToTestOrImplementationFile(e){var t;return n(this,void 0,void 0,(function*(){const i=e?yield o.workspace.openTextDocument(e):null===(t=o.window.activeTextEditor)||void 0===t?void 0:t.document;if(i&&f.isDartDocument(i)){const e=l.fsPath(i.uri),t=g.isTestFile(e),n=t?this.getImplementationFileForTest(e):this.getTestFileForImplementation(e);if(!n||t&&!r.existsSync(n))return;let u,d;if(!r.existsSync(n)){if(t)return;const e=o.workspace.asRelativePath(n,!1),i=h.createTestFileAction(e);if((yield o.window.showInformationMessage(`Would you like to create a test file at ${e}?`,i,a.noAction))!==i)return;l.mkDirRecursive(s.dirname(n));const f=h.defaultTestFileContents(this.wsContext.hasAnyFlutterProjects,c.escapeDartString(c.generateTestNameFromFileName(e)));r.writeFileSync(n,f.contents),u=f.selectionOffset,d=f.selectionLength}const f=yield o.workspace.openTextDocument(n),p=yield o.window.showTextDocument(f);u&&d&&(p.selection=new o.Selection(f.positionAt(u),f.positionAt(u+d)))}}))}updateSelectionContexts(e){const i=!!(e.textEditor&&e.selections&&1===e.selections.length&&this.testForCursor(e.textEditor));o.commands.executeCommand("setContext","dart-code:cursorIsInTest",i),t.cursorIsInTest=i}updateEditorContexts(e){if(t.isInTestFileThatHasImplementation=!1,t.isInImplementationFileThatCanHaveTest=!1,e&&e.document&&f.isDartDocument(e.document)){const i=l.fsPath(e.document.uri);if(g.isTestFile(i)){const e=this.getImplementationFileForTest(i);t.isInTestFileThatHasImplementation=!!e&&r.existsSync(e)}else t.isInImplementationFileThatCanHaveTest=!!this.getTestFileForImplementation(i)}o.commands.executeCommand("setContext","dart-code:canGoToTestOrImplementationFile",t.isInTestFileThatHasImplementation||t.isInImplementationFileThatCanHaveTest)}getImplementationFileForTest(e){const t=e.split(s.sep),i=t.lastIndexOf("test");return-1!==i&&(t[i]="lib"),t[t.length-1]=t[t.length-1].replace(/_test\.dart/,".dart"),t.join(s.sep)}getTestFileForImplementation(e){const t=e.split(s.sep),i=t.lastIndexOf("lib");if(-1!==i)return t[i]="test",t[t.length-1]=t[t.length-1].replace(/\.dart/,"_test.dart"),t.join(s.sep)}dispose(){for(const e of this.disposables)e.dispose()}}t.DasTestCommands=class extends p{constructor(e,t,i){super(e,t),this.fileTracker=i}testForCursor(e){const t=e.document,i=this.fileTracker.getOutlineFor(t.uri);if(!i||!i.children||!i.children.length)return;if(!this.fileTracker.supportsPubRunTest(t.uri))return;const n=new u.TestOutlineVisitor(this.logger);return n.visit(i),n.tests.reverse().find(i=>{let n=t.positionAt(i.offset),r=t.positionAt(i.offset+i.length);return n=t.lineAt(n.line).rangeIncludingLineBreak.start,r=t.lineAt(r.line).rangeIncludingLineBreak.end,new o.Range(n,r).contains(e.selection)})}};t.LspTestCommands=class extends p{constructor(e,t,i){super(e,t),this.fileTracker=i}testForCursor(e){const t=e.document,i=this.fileTracker.getOutlineFor(t.uri);if(!i||!i.children||!i.children.length)return;if(!this.fileTracker.supportsPubRunTest(t.uri))return;const n=new d.LspTestOutlineVisitor(this.logger,l.fsPath(t.uri));return n.visit(i),n.tests.reverse().find(i=>{let n=i.range.start,r=i.range.end;n=t.lineAt(n.line).rangeIncludingLineBreak.start,r=t.lineAt(r.line).rangeIncludingLineBreak.end;return new o.Range(n.line,n.character,r.line,r.character).contains(e.selection)})}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypeHierarchyCommand=void 0;const r=i(0),s=i(1),o=i(6),a=i(54);function c(e,t){return e[t].classElement.name}t.TypeHierarchyCommand=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.disposables.push(r.commands.registerCommand("dart.showTypeHierarchy",this.showTypeHierarchy,this))}showTypeHierarchy(){return n(this,void 0,void 0,(function*(){const e=a.getActiveDartEditor();if(!e)return void r.window.showWarningMessage("No active Dart editor.");const t=e.document,i=e.selection,n=(yield this.analyzer.searchGetTypeHierarchy({file:s.fsPath(t.uri),offset:t.offsetAt(e.selection.active)})).hierarchyItems;if(!n)return void r.window.showInformationMessage("Type hierarchy not available.");const o={onDidSelectItem:e=>this.openLocation(e,!0),placeHolder:c(n,0)},l=[],u=n[0];l.push(u),function e(t,i,n){if(n.superclass){const r=t[n.superclass];"Object"!==r.classElement.name&&(i.unshift(r),e(t,i,r))}}(n,l,u),function e(t,i,n){for(const e of n.subclasses){const n=t[e];i.push(n)}for(const r of n.subclasses){const n=t[r];n.subclasses.length>0&&e(t,i,n)}}(n,l,u);const d=yield r.window.showQuickPick(l.map(e=>function(e,t){let i="";void 0!==e.superclass&&"Object"!==c(t,e.superclass)&&(i+="extends "+c(t,e.superclass));e.interfaces.length>0&&(i.length>0&&(i+=", "),i+="implements "+e.interfaces.map(e=>c(t,e)).join(", "));e.mixins.length>0&&(i.length>0&&(i+=", "),i+="with "+e.mixins.map(e=>c(t,e)).join(", "));return{description:i,label:e.classElement.name,location:e.classElement.location}}(e,n)),o);if(d&&d.location)yield this.openLocation(d);else{const n=yield r.window.showTextDocument(t);n.revealRange(e.selection,r.TextEditorRevealType.InCenterIfOutsideViewport),n.selection=i}}))}openLocation(e,t=!1){return n(this,void 0,void 0,(function*(){if(!e.location)return void this.logger.warn("Unable to open item with no location");const i=e.location,n=yield r.workspace.openTextDocument(i.file),s=yield r.window.showTextDocument(n,{preserveFocus:t,preview:t}),a=o.toRangeOnLine(i);o.showCode(s,a,a,a)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterColorDecorations=void 0;const n=i(5),r=i(2),s=i(0),o=i(1),a=i(218),c=i(7);t.FlutterColorDecorations=class{constructor(e,t){this.logger=e,this.imageStoragePath=t,this.subscriptions=[],this.decorationTypes={},this.computer=new a.ColorRangeComputer,this.subscriptions.push(s.workspace.onDidChangeTextDocument(e=>{this.activeEditor&&e.document===this.activeEditor.document&&(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),1e3))})),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>{this.setTrackingFile(e),this.update()})),s.window.activeTextEditor&&(this.setTrackingFile(s.window.activeTextEditor),this.update())}update(){if(!this.activeEditor)return;const e=this.computer.compute(this.activeEditor.document);for(const t of Object.keys(e)){const e=this.createImageFile(t);e&&!this.decorationTypes[t]&&(this.decorationTypes[t]=s.window.createTextEditorDecorationType({gutterIconPath:s.Uri.file(e),gutterIconSize:"50%"}))}for(const t of Object.keys(this.decorationTypes))this.activeEditor.setDecorations(this.decorationTypes[t],e[t]||[])}setTrackingFile(e){e&&c.isAnalyzable(e.document)?this.activeEditor=e:this.activeEditor=void 0}createImageFile(e){const t=r.join(this.imageStoragePath,"v1");o.mkDirRecursive(t);const i=r.join(t,e+".svg");if(n.existsSync(i))return i;try{const t=e.substr(2),r=parseInt(e.substr(0,2),16)/255,s=l.replace("{HEX-6}",t).replace("{OPACITY}",r.toString());return n.writeFileSync(i,s),i}catch(e){this.logger.warn(e)}}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}};const l='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n\t<rect fill="#{HEX-6}" x="0" y="0" width="16" height="16" fill-opacity="{OPACITY}" />\n</svg>\n'},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorRangeComputer=void 0;const n=i(219),r=i(3),s=i(6);t.ColorRangeComputer=class{constructor(){this.materialNameColorPattern="Colors\\.(?<mc>[\\w_\\[\\]\\.]+)",this.cupertinoNameColorPattern="CupertinoColors\\.(?<cc>[\\w_\\[\\]\\.]+)",this.colorConstructorPattern="\\bColor\\(\\s*0x(?<cons>[A-Fa-f0-9]{8}),{0,1}\\s*\\)",this.colorConstructorRgbo="\\bColor\\.fromRGBO\\(\\s*(?<rgboR>[\\w_]+),\\s*(?<rgboG>[\\w_]+),\\s*(?<rgboB>[\\w_]+),\\s*(?<rgboA>[\\w_.]+),{0,1}\\s*\\)",this.colorConstructorArgb="\\bColor\\.fromARGB\\(\\s*(?<argbA>[\\w_]+),\\s*(?<argbR>[\\w_]+),\\s*(?<argbG>[\\w_]+),\\s*(?<argbB>[\\w_]+),{0,1}\\s*\\)",this.allColors=[this.materialNameColorPattern,this.cupertinoNameColorPattern,this.colorConstructorPattern,this.colorConstructorRgbo,this.colorConstructorArgb],this.allColorsPattern=new RegExp(`^.*?(?<range>${this.allColors.join("|")})`,"gm")}compute(e){const t=e.getText(),i={};let n;for(this.allColorsPattern.lastIndex=-1;n=this.allColorsPattern.exec(t);){if(!n.groups)continue;let t;if(n.groups.mc?t=this.extractMaterialColor(n.groups.mc):n.groups.cc?t=this.extractCupertinoColor(n.groups.cc):n.groups.cons?t=n.groups.cons.toLowerCase():n.groups.rgboR&&n.groups.rgboG&&n.groups.rgboB&&n.groups.rgboO?t=this.extractRgboColor(n.groups.rgboR,n.groups.rgboG,n.groups.rgboB,n.groups.rgboO):n.groups.argbA&&n.groups.argbR&&n.groups.argbG&&n.groups.argbB&&(t=this.extractArgbColor(n.groups.argbA,n.groups.argbR,n.groups.argbG,n.groups.argbB)),t){i[t]||(i[t]=[]);const r=n.index+n[0].length-n.groups.range.length;i[t].push(s.toRange(e,r,n.groups.range.length))}}return i}extractMaterialColor(e){const t=e.replace(/\.shade(\d+)/,"[$1]");if(t in n.flutterMaterialColors||t+".primary"in n.flutterMaterialColors)return(n.flutterMaterialColors[t]||n.flutterMaterialColors[t+".primary"]).toLowerCase()}extractCupertinoColor(e){const t=e.replace(/\.color/,"[$1]");if(t in n.flutterCupertinoColors||t+".color"in n.flutterCupertinoColors)return(n.flutterCupertinoColors[t]||n.flutterCupertinoColors[t+".color"]).toLowerCase()}extractRgboColor(e,t,i,n){const s=parseInt(e),o=parseInt(t),a=parseInt(i),c=parseFloat(n);if(!(isNaN(s)||isNaN(o)||isNaN(a)||isNaN(c)))return r.asHexColor({r:s,g:o,b:a,a:255*c})}extractArgbColor(e,t,i,n){const s=parseInt(e),o=parseInt(t),a=parseInt(i),c=parseInt(n);if(!(isNaN(s)||isNaN(o)||isNaN(a)||isNaN(c)))return r.asHexColor({a:s,r:o,g:a,b:c})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flutterCupertinoColors=t.flutterMaterialColors=void 0,t.flutterMaterialColors={"amber.primary":"ffffc107","amber[50]":"fffff8e1","amber[100]":"ffffecb3","amber[200]":"ffffe082","amber[300]":"ffffd54f","amber[400]":"ffffca28","amber[500]":"ffffc107","amber[600]":"ffffb300","amber[700]":"ffffa000","amber[800]":"ffff8f00","amber[900]":"ffff6f00","amberAccent.primary":"ffffd740","amberAccent[100]":"ffffe57f","amberAccent[200]":"ffffd740","amberAccent[400]":"ffffc400","amberAccent[700]":"ffffab00",black:"ff000000",black12:"1f000000",black26:"42000000",black38:"61000000",black45:"73000000",black54:"8a000000",black87:"dd000000","blue.primary":"ff2196f3","blue[50]":"ffe3f2fd","blue[100]":"ffbbdefb","blue[200]":"ff90caf9","blue[300]":"ff64b5f6","blue[400]":"ff42a5f5","blue[500]":"ff2196f3","blue[600]":"ff1e88e5","blue[700]":"ff1976d2","blue[800]":"ff1565c0","blue[900]":"ff0d47a1","blueAccent.primary":"ff448aff","blueAccent[100]":"ff82b1ff","blueAccent[200]":"ff448aff","blueAccent[400]":"ff2979ff","blueAccent[700]":"ff2962ff","blueGrey.primary":"ff607d8b","blueGrey[50]":"ffeceff1","blueGrey[100]":"ffcfd8dc","blueGrey[200]":"ffb0bec5","blueGrey[300]":"ff90a4ae","blueGrey[400]":"ff78909c","blueGrey[500]":"ff607d8b","blueGrey[600]":"ff546e7a","blueGrey[700]":"ff455a64","blueGrey[800]":"ff37474f","blueGrey[900]":"ff263238","brown.primary":"ff795548","brown[50]":"ffefebe9","brown[100]":"ffd7ccc8","brown[200]":"ffbcaaa4","brown[300]":"ffa1887f","brown[400]":"ff8d6e63","brown[500]":"ff795548","brown[600]":"ff6d4c41","brown[700]":"ff5d4037","brown[800]":"ff4e342e","brown[900]":"ff3e2723","cyan.primary":"ff00bcd4","cyan[50]":"ffe0f7fa","cyan[100]":"ffb2ebf2","cyan[200]":"ff80deea","cyan[300]":"ff4dd0e1","cyan[400]":"ff26c6da","cyan[500]":"ff00bcd4","cyan[600]":"ff00acc1","cyan[700]":"ff0097a7","cyan[800]":"ff00838f","cyan[900]":"ff006064","cyanAccent.primary":"ff18ffff","cyanAccent[100]":"ff84ffff","cyanAccent[200]":"ff18ffff","cyanAccent[400]":"ff00e5ff","cyanAccent[700]":"ff00b8d4","deepOrange.primary":"ffff5722","deepOrange[50]":"fffbe9e7","deepOrange[100]":"ffffccbc","deepOrange[200]":"ffffab91","deepOrange[300]":"ffff8a65","deepOrange[400]":"ffff7043","deepOrange[500]":"ffff5722","deepOrange[600]":"fff4511e","deepOrange[700]":"ffe64a19","deepOrange[800]":"ffd84315","deepOrange[900]":"ffbf360c","deepOrangeAccent.primary":"ffff6e40","deepOrangeAccent[100]":"ffff9e80","deepOrangeAccent[200]":"ffff6e40","deepOrangeAccent[400]":"ffff3d00","deepOrangeAccent[700]":"ffdd2c00","deepPurple.primary":"ff673ab7","deepPurple[50]":"ffede7f6","deepPurple[100]":"ffd1c4e9","deepPurple[200]":"ffb39ddb","deepPurple[300]":"ff9575cd","deepPurple[400]":"ff7e57c2","deepPurple[500]":"ff673ab7","deepPurple[600]":"ff5e35b1","deepPurple[700]":"ff512da8","deepPurple[800]":"ff4527a0","deepPurple[900]":"ff311b92","deepPurpleAccent.primary":"ff7c4dff","deepPurpleAccent[100]":"ffb388ff","deepPurpleAccent[200]":"ff7c4dff","deepPurpleAccent[400]":"ff651fff","deepPurpleAccent[700]":"ff6200ea","green.primary":"ff4caf50","green[50]":"ffe8f5e9","green[100]":"ffc8e6c9","green[200]":"ffa5d6a7","green[300]":"ff81c784","green[400]":"ff66bb6a","green[500]":"ff4caf50","green[600]":"ff43a047","green[700]":"ff388e3c","green[800]":"ff2e7d32","green[900]":"ff1b5e20","greenAccent.primary":"ff69f0ae","greenAccent[100]":"ffb9f6ca","greenAccent[200]":"ff69f0ae","greenAccent[400]":"ff00e676","greenAccent[700]":"ff00c853","grey.primary":"ff9e9e9e","grey[50]":"fffafafa","grey[100]":"fff5f5f5","grey[200]":"ffeeeeee","grey[300]":"ffe0e0e0","grey[350]":"ffd6d6d6","grey[400]":"ffbdbdbd","grey[500]":"ff9e9e9e","grey[600]":"ff757575","grey[700]":"ff616161","grey[800]":"ff424242","grey[850]":"ff303030","grey[900]":"ff212121","indigo.primary":"ff3f51b5","indigo[50]":"ffe8eaf6","indigo[100]":"ffc5cae9","indigo[200]":"ff9fa8da","indigo[300]":"ff7986cb","indigo[400]":"ff5c6bc0","indigo[500]":"ff3f51b5","indigo[600]":"ff3949ab","indigo[700]":"ff303f9f","indigo[800]":"ff283593","indigo[900]":"ff1a237e","indigoAccent.primary":"ff536dfe","indigoAccent[100]":"ff8c9eff","indigoAccent[200]":"ff536dfe","indigoAccent[400]":"ff3d5afe","indigoAccent[700]":"ff304ffe","lightBlue.primary":"ff03a9f4","lightBlue[50]":"ffe1f5fe","lightBlue[100]":"ffb3e5fc","lightBlue[200]":"ff81d4fa","lightBlue[300]":"ff4fc3f7","lightBlue[400]":"ff29b6f6","lightBlue[500]":"ff03a9f4","lightBlue[600]":"ff039be5","lightBlue[700]":"ff0288d1","lightBlue[800]":"ff0277bd","lightBlue[900]":"ff01579b","lightBlueAccent.primary":"ff40c4ff","lightBlueAccent[100]":"ff80d8ff","lightBlueAccent[200]":"ff40c4ff","lightBlueAccent[400]":"ff00b0ff","lightBlueAccent[700]":"ff0091ea","lightGreen.primary":"ff8bc34a","lightGreen[50]":"fff1f8e9","lightGreen[100]":"ffdcedc8","lightGreen[200]":"ffc5e1a5","lightGreen[300]":"ffaed581","lightGreen[400]":"ff9ccc65","lightGreen[500]":"ff8bc34a","lightGreen[600]":"ff7cb342","lightGreen[700]":"ff689f38","lightGreen[800]":"ff558b2f","lightGreen[900]":"ff33691e","lightGreenAccent.primary":"ffb2ff59","lightGreenAccent[100]":"ffccff90","lightGreenAccent[200]":"ffb2ff59","lightGreenAccent[400]":"ff76ff03","lightGreenAccent[700]":"ff64dd17","lime.primary":"ffcddc39","lime[50]":"fff9fbe7","lime[100]":"fff0f4c3","lime[200]":"ffe6ee9c","lime[300]":"ffdce775","lime[400]":"ffd4e157","lime[500]":"ffcddc39","lime[600]":"ffc0ca33","lime[700]":"ffafb42b","lime[800]":"ff9e9d24","lime[900]":"ff827717","limeAccent.primary":"ffeeff41","limeAccent[100]":"fff4ff81","limeAccent[200]":"ffeeff41","limeAccent[400]":"ffc6ff00","limeAccent[700]":"ffaeea00","orange.primary":"ffff9800","orange[50]":"fffff3e0","orange[100]":"ffffe0b2","orange[200]":"ffffcc80","orange[300]":"ffffb74d","orange[400]":"ffffa726","orange[500]":"ffff9800","orange[600]":"fffb8c00","orange[700]":"fff57c00","orange[800]":"ffef6c00","orange[900]":"ffe65100","orangeAccent.primary":"ffffab40","orangeAccent[100]":"ffffd180","orangeAccent[200]":"ffffab40","orangeAccent[400]":"ffff9100","orangeAccent[700]":"ffff6d00","pink.primary":"ffe91e63","pink[50]":"fffce4ec","pink[100]":"fff8bbd0","pink[200]":"fff48fb1","pink[300]":"fff06292","pink[400]":"ffec407a","pink[500]":"ffe91e63","pink[600]":"ffd81b60","pink[700]":"ffc2185b","pink[800]":"ffad1457","pink[900]":"ff880e4f","pinkAccent.primary":"ffff4081","pinkAccent[100]":"ffff80ab","pinkAccent[200]":"ffff4081","pinkAccent[400]":"fff50057","pinkAccent[700]":"ffc51162","purple.primary":"ff9c27b0","purple[50]":"fff3e5f5","purple[100]":"ffe1bee7","purple[200]":"ffce93d8","purple[300]":"ffba68c8","purple[400]":"ffab47bc","purple[500]":"ff9c27b0","purple[600]":"ff8e24aa","purple[700]":"ff7b1fa2","purple[800]":"ff6a1b9a","purple[900]":"ff4a148c","purpleAccent.primary":"ffe040fb","purpleAccent[100]":"ffea80fc","purpleAccent[200]":"ffe040fb","purpleAccent[400]":"ffd500f9","purpleAccent[700]":"ffaa00ff","red.primary":"fff44336","red[50]":"ffffebee","red[100]":"ffffcdd2","red[200]":"ffef9a9a","red[300]":"ffe57373","red[400]":"ffef5350","red[500]":"fff44336","red[600]":"ffe53935","red[700]":"ffd32f2f","red[800]":"ffc62828","red[900]":"ffb71c1c","redAccent.primary":"ffff5252","redAccent[100]":"ffff8a80","redAccent[200]":"ffff5252","redAccent[400]":"ffff1744","redAccent[700]":"ffd50000","teal.primary":"ff009688","teal[50]":"ffe0f2f1","teal[100]":"ffb2dfdb","teal[200]":"ff80cbc4","teal[300]":"ff4db6ac","teal[400]":"ff26a69a","teal[500]":"ff009688","teal[600]":"ff00897b","teal[700]":"ff00796b","teal[800]":"ff00695c","teal[900]":"ff004d40","tealAccent.primary":"ff64ffda","tealAccent[100]":"ffa7ffeb","tealAccent[200]":"ff64ffda","tealAccent[400]":"ff1de9b6","tealAccent[700]":"ff00bfa5",transparent:"00000000",white:"ffffffff",white10:"1affffff",white12:"1fffffff",white24:"3dffffff",white30:"4dffffff",white38:"62ffffff",white54:"8affffff",white60:"99ffffff",white70:"b3ffffff","yellow.primary":"ffffeb3b","yellow[50]":"fffffde7","yellow[100]":"fffff9c4","yellow[200]":"fffff59d","yellow[300]":"fffff176","yellow[400]":"ffffee58","yellow[500]":"ffffeb3b","yellow[600]":"fffdd835","yellow[700]":"fffbc02d","yellow[800]":"fff9a825","yellow[900]":"fff57f17","yellowAccent.primary":"ffffff00","yellowAccent[100]":"ffffff8d","yellowAccent[200]":"ffffff00","yellowAccent[400]":"ffffea00","yellowAccent[700]":"ffffd600"},t.flutterCupertinoColors={activeBlue:"ff007aff","activeBlue.darkColor":"ff0a84ff","activeBlue.darkElevatedColor":"ff0a84ff","activeBlue.darkHighContrastColor":"ff409cff","activeBlue.darkHighContrastElevatedColor":"ff409cff","activeBlue.elevatedColor":"ff007aff","activeBlue.highContrastColor":"ff0040dd","activeBlue.highContrastElevatedColor":"ff0040dd",activeGreen:"ff34c759","activeGreen.darkColor":"ff30d158","activeGreen.darkElevatedColor":"ff30d158","activeGreen.darkHighContrastColor":"ff30db5b","activeGreen.darkHighContrastElevatedColor":"ff30db5b","activeGreen.elevatedColor":"ff34c759","activeGreen.highContrastColor":"ff248a3d","activeGreen.highContrastElevatedColor":"ff248a3d",activeOrange:"ffff9500","activeOrange.darkColor":"ffff9f0a","activeOrange.darkElevatedColor":"ffff9f0a","activeOrange.darkHighContrastColor":"ffffb340","activeOrange.darkHighContrastElevatedColor":"ffffb340","activeOrange.elevatedColor":"ffff9500","activeOrange.highContrastColor":"ffc93400","activeOrange.highContrastElevatedColor":"ffc93400",black:"ff000000",darkBackgroundGray:"ff171717",destructiveRed:"ffff3b30","destructiveRed.darkColor":"ffff453a","destructiveRed.darkElevatedColor":"ffff453a","destructiveRed.darkHighContrastColor":"ffff6961","destructiveRed.darkHighContrastElevatedColor":"ffff6961","destructiveRed.elevatedColor":"ffff3b30","destructiveRed.highContrastColor":"ffd70015","destructiveRed.highContrastElevatedColor":"ffd70015",extraLightBackgroundGray:"ffefeff4",inactiveGray:"ff999999","inactiveGray.darkColor":"ff757575","inactiveGray.darkElevatedColor":"ff757575","inactiveGray.darkHighContrastColor":"ff757575","inactiveGray.darkHighContrastElevatedColor":"ff757575","inactiveGray.elevatedColor":"ff999999","inactiveGray.highContrastColor":"ff999999","inactiveGray.highContrastElevatedColor":"ff999999",label:"ff000000","label.darkColor":"ffffffff","label.darkElevatedColor":"ffffffff","label.darkHighContrastColor":"ffffffff","label.darkHighContrastElevatedColor":"ffffffff","label.elevatedColor":"ff000000","label.highContrastColor":"ff000000","label.highContrastElevatedColor":"ff000000",lightBackgroundGray:"ffe5e5ea",link:"ff007aff","link.darkColor":"ff0984ff","link.darkElevatedColor":"ff0984ff","link.darkHighContrastColor":"ff0984ff","link.darkHighContrastElevatedColor":"ff0984ff","link.elevatedColor":"ff007aff","link.highContrastColor":"ff007aff","link.highContrastElevatedColor":"ff007aff",opaqueSeparator:"ffc6c6c8","opaqueSeparator.darkColor":"ff38383a","opaqueSeparator.darkElevatedColor":"ff38383a","opaqueSeparator.darkHighContrastColor":"ff38383a","opaqueSeparator.darkHighContrastElevatedColor":"ff38383a","opaqueSeparator.elevatedColor":"ffc6c6c8","opaqueSeparator.highContrastColor":"ffc6c6c8","opaqueSeparator.highContrastElevatedColor":"ffc6c6c8",placeholderText:"4c3c3c43","placeholderText.darkColor":"4cebebf5","placeholderText.darkElevatedColor":"4cebebf5","placeholderText.darkHighContrastColor":"60ebebf5","placeholderText.darkHighContrastElevatedColor":"60ebebf5","placeholderText.elevatedColor":"4c3c3c43","placeholderText.highContrastColor":"603c3c43","placeholderText.highContrastElevatedColor":"603c3c43",quaternaryLabel:"2d3c3c43","quaternaryLabel.darkColor":"28ebebf5","quaternaryLabel.darkElevatedColor":"28ebebf5","quaternaryLabel.darkHighContrastColor":"3debebf5","quaternaryLabel.darkHighContrastElevatedColor":"3debebf5","quaternaryLabel.elevatedColor":"2d3c3c43","quaternaryLabel.highContrastColor":"423c3c43","quaternaryLabel.highContrastElevatedColor":"423c3c43",quaternarySystemFill:"14747480","quaternarySystemFill.darkColor":"2d767680","quaternarySystemFill.darkElevatedColor":"2d767680","quaternarySystemFill.darkHighContrastColor":"42767680","quaternarySystemFill.darkHighContrastElevatedColor":"42767680","quaternarySystemFill.elevatedColor":"14747480","quaternarySystemFill.highContrastColor":"28747480","quaternarySystemFill.highContrastElevatedColor":"28747480",secondaryLabel:"993c3c43","secondaryLabel.darkColor":"99ebebf5","secondaryLabel.darkElevatedColor":"99ebebf5","secondaryLabel.darkHighContrastColor":"adebebf5","secondaryLabel.darkHighContrastElevatedColor":"adebebf5","secondaryLabel.elevatedColor":"993c3c43","secondaryLabel.highContrastColor":"ad3c3c43","secondaryLabel.highContrastElevatedColor":"ad3c3c43",secondarySystemBackground:"fff2f2f7","secondarySystemBackground.darkColor":"ff1c1c1e","secondarySystemBackground.darkElevatedColor":"ff2c2c2e","secondarySystemBackground.darkHighContrastColor":"ff242426","secondarySystemBackground.darkHighContrastElevatedColor":"ff363638","secondarySystemBackground.elevatedColor":"fff2f2f7","secondarySystemBackground.highContrastColor":"ffebebf0","secondarySystemBackground.highContrastElevatedColor":"ffebebf0",secondarySystemFill:"28787880","secondarySystemFill.darkColor":"51787880","secondarySystemFill.darkElevatedColor":"51787880","secondarySystemFill.darkHighContrastColor":"66787880","secondarySystemFill.darkHighContrastElevatedColor":"66787880","secondarySystemFill.elevatedColor":"28787880","secondarySystemFill.highContrastColor":"3d787880","secondarySystemFill.highContrastElevatedColor":"3d787880",secondarySystemGroupedBackground:"ffffffff","secondarySystemGroupedBackground.darkColor":"ff1c1c1e","secondarySystemGroupedBackground.darkElevatedColor":"ff2c2c2e","secondarySystemGroupedBackground.darkHighContrastColor":"ff242426","secondarySystemGroupedBackground.darkHighContrastElevatedColor":"ff363638","secondarySystemGroupedBackground.elevatedColor":"ffffffff","secondarySystemGroupedBackground.highContrastColor":"ffffffff","secondarySystemGroupedBackground.highContrastElevatedColor":"ffffffff",separator:"493c3c43","separator.darkColor":"99545458","separator.darkElevatedColor":"99545458","separator.darkHighContrastColor":"ad545458","separator.darkHighContrastElevatedColor":"ad545458","separator.elevatedColor":"493c3c43","separator.highContrastColor":"5e3c3c43","separator.highContrastElevatedColor":"5e3c3c43",systemBackground:"ffffffff","systemBackground.darkColor":"ff000000","systemBackground.darkElevatedColor":"ff1c1c1e","systemBackground.darkHighContrastColor":"ff000000","systemBackground.darkHighContrastElevatedColor":"ff242426","systemBackground.elevatedColor":"ffffffff","systemBackground.highContrastColor":"ffffffff","systemBackground.highContrastElevatedColor":"ffffffff",systemBlue:"ff007aff","systemBlue.darkColor":"ff0a84ff","systemBlue.darkElevatedColor":"ff0a84ff","systemBlue.darkHighContrastColor":"ff409cff","systemBlue.darkHighContrastElevatedColor":"ff409cff","systemBlue.elevatedColor":"ff007aff","systemBlue.highContrastColor":"ff0040dd","systemBlue.highContrastElevatedColor":"ff0040dd",systemFill:"33787880","systemFill.darkColor":"5b787880","systemFill.darkElevatedColor":"5b787880","systemFill.darkHighContrastColor":"70787880","systemFill.darkHighContrastElevatedColor":"70787880","systemFill.elevatedColor":"33787880","systemFill.highContrastColor":"47787880","systemFill.highContrastElevatedColor":"47787880",systemGreen:"ff34c759","systemGreen.darkColor":"ff30d158","systemGreen.darkElevatedColor":"ff30d158","systemGreen.darkHighContrastColor":"ff30db5b","systemGreen.darkHighContrastElevatedColor":"ff30db5b","systemGreen.elevatedColor":"ff34c759","systemGreen.highContrastColor":"ff248a3d","systemGreen.highContrastElevatedColor":"ff248a3d",systemGrey:"ff8e8e93","systemGrey.darkColor":"ff8e8e93","systemGrey.darkElevatedColor":"ff8e8e93","systemGrey.darkHighContrastColor":"ffaeaeb2","systemGrey.darkHighContrastElevatedColor":"ffaeaeb2","systemGrey.elevatedColor":"ff8e8e93","systemGrey.highContrastColor":"ff6c6c70","systemGrey.highContrastElevatedColor":"ff6c6c70",systemGrey2:"ffaeaeb2","systemGrey2.darkColor":"ff636366","systemGrey2.darkElevatedColor":"ff636366","systemGrey2.darkHighContrastColor":"ff7c7c80","systemGrey2.darkHighContrastElevatedColor":"ff7c7c80","systemGrey2.elevatedColor":"ffaeaeb2","systemGrey2.highContrastColor":"ff8e8e93","systemGrey2.highContrastElevatedColor":"ff8e8e93",systemGrey3:"ffc7c7cc","systemGrey3.darkColor":"ff48484a","systemGrey3.darkElevatedColor":"ff48484a","systemGrey3.darkHighContrastColor":"ff545456","systemGrey3.darkHighContrastElevatedColor":"ff545456","systemGrey3.elevatedColor":"ffc7c7cc","systemGrey3.highContrastColor":"ffaeaeb2","systemGrey3.highContrastElevatedColor":"ffaeaeb2",systemGrey4:"ffd1d1d6","systemGrey4.darkColor":"ff3a3a3c","systemGrey4.darkElevatedColor":"ff3a3a3c","systemGrey4.darkHighContrastColor":"ff444446","systemGrey4.darkHighContrastElevatedColor":"ff444446","systemGrey4.elevatedColor":"ffd1d1d6","systemGrey4.highContrastColor":"ffbcbcc0","systemGrey4.highContrastElevatedColor":"ffbcbcc0",systemGrey5:"ffe5e5ea","systemGrey5.darkColor":"ff2c2c2e","systemGrey5.darkElevatedColor":"ff2c2c2e","systemGrey5.darkHighContrastColor":"ff363638","systemGrey5.darkHighContrastElevatedColor":"ff363638","systemGrey5.elevatedColor":"ffe5e5ea","systemGrey5.highContrastColor":"ffd8d8dc","systemGrey5.highContrastElevatedColor":"ffd8d8dc",systemGrey6:"fff2f2f7","systemGrey6.darkColor":"ff1c1c1e","systemGrey6.darkElevatedColor":"ff1c1c1e","systemGrey6.darkHighContrastColor":"ff242426","systemGrey6.darkHighContrastElevatedColor":"ff242426","systemGrey6.elevatedColor":"fff2f2f7","systemGrey6.highContrastColor":"ffebebf0","systemGrey6.highContrastElevatedColor":"ffebebf0",systemGroupedBackground:"fff2f2f7","systemGroupedBackground.darkColor":"ff000000","systemGroupedBackground.darkElevatedColor":"ff1c1c1e","systemGroupedBackground.darkHighContrastColor":"ff000000","systemGroupedBackground.darkHighContrastElevatedColor":"ff242426","systemGroupedBackground.elevatedColor":"fff2f2f7","systemGroupedBackground.highContrastColor":"ffebebf0","systemGroupedBackground.highContrastElevatedColor":"ffebebf0",systemIndigo:"ff5856d6","systemIndigo.darkColor":"ff5e5ce6","systemIndigo.darkElevatedColor":"ff5e5ce6","systemIndigo.darkHighContrastColor":"ff7d7aff","systemIndigo.darkHighContrastElevatedColor":"ff7d7aff","systemIndigo.elevatedColor":"ff5856d6","systemIndigo.highContrastColor":"ff3634a3","systemIndigo.highContrastElevatedColor":"ff3634a3",systemOrange:"ffff9500","systemOrange.darkColor":"ffff9f0a","systemOrange.darkElevatedColor":"ffff9f0a","systemOrange.darkHighContrastColor":"ffffb340","systemOrange.darkHighContrastElevatedColor":"ffffb340","systemOrange.elevatedColor":"ffff9500","systemOrange.highContrastColor":"ffc93400","systemOrange.highContrastElevatedColor":"ffc93400",systemPink:"ffff2d55","systemPink.darkColor":"ffff375f","systemPink.darkElevatedColor":"ffff375f","systemPink.darkHighContrastColor":"ffff6482","systemPink.darkHighContrastElevatedColor":"ffff6482","systemPink.elevatedColor":"ffff2d55","systemPink.highContrastColor":"ffd30f45","systemPink.highContrastElevatedColor":"ffd30f45",systemPurple:"ffaf52de","systemPurple.darkColor":"ffbf5af2","systemPurple.darkElevatedColor":"ffbf5af2","systemPurple.darkHighContrastColor":"ffda8fff","systemPurple.darkHighContrastElevatedColor":"ffda8fff","systemPurple.elevatedColor":"ffaf52de","systemPurple.highContrastColor":"ff8944ab","systemPurple.highContrastElevatedColor":"ff8944ab",systemRed:"ffff3b30","systemRed.darkColor":"ffff453a","systemRed.darkElevatedColor":"ffff453a","systemRed.darkHighContrastColor":"ffff6961","systemRed.darkHighContrastElevatedColor":"ffff6961","systemRed.elevatedColor":"ffff3b30","systemRed.highContrastColor":"ffd70015","systemRed.highContrastElevatedColor":"ffd70015",systemTeal:"ff5ac8fa","systemTeal.darkColor":"ff64d2ff","systemTeal.darkElevatedColor":"ff64d2ff","systemTeal.darkHighContrastColor":"ff70d7ff","systemTeal.darkHighContrastElevatedColor":"ff70d7ff","systemTeal.elevatedColor":"ff5ac8fa","systemTeal.highContrastColor":"ff0071a4","systemTeal.highContrastElevatedColor":"ff0071a4",systemYellow:"ffffcc00","systemYellow.darkColor":"ffffd60a","systemYellow.darkElevatedColor":"ffffd60a","systemYellow.darkHighContrastColor":"ffffd426","systemYellow.darkHighContrastElevatedColor":"ffffd426","systemYellow.elevatedColor":"ffffcc00","systemYellow.highContrastColor":"ffa05a00","systemYellow.highContrastElevatedColor":"ffa05a00",tertiaryLabel:"4c3c3c43","tertiaryLabel.darkColor":"4cebebf5","tertiaryLabel.darkElevatedColor":"4cebebf5","tertiaryLabel.darkHighContrastColor":"60ebebf5","tertiaryLabel.darkHighContrastElevatedColor":"60ebebf5","tertiaryLabel.elevatedColor":"4c3c3c43","tertiaryLabel.highContrastColor":"603c3c43","tertiaryLabel.highContrastElevatedColor":"603c3c43",tertiarySystemBackground:"ffffffff","tertiarySystemBackground.darkColor":"ff2c2c2e","tertiarySystemBackground.darkElevatedColor":"ff3a3a3c","tertiarySystemBackground.darkHighContrastColor":"ff363638","tertiarySystemBackground.darkHighContrastElevatedColor":"ff444446","tertiarySystemBackground.elevatedColor":"ffffffff","tertiarySystemBackground.highContrastColor":"ffffffff","tertiarySystemBackground.highContrastElevatedColor":"ffffffff",tertiarySystemFill:"1e767680","tertiarySystemFill.darkColor":"3d767680","tertiarySystemFill.darkElevatedColor":"3d767680","tertiarySystemFill.darkHighContrastColor":"51767680","tertiarySystemFill.darkHighContrastElevatedColor":"51767680","tertiarySystemFill.elevatedColor":"1e767680","tertiarySystemFill.highContrastColor":"33767680","tertiarySystemFill.highContrastElevatedColor":"33767680",tertiarySystemGroupedBackground:"fff2f2f7","tertiarySystemGroupedBackground.darkColor":"ff2c2c2e","tertiarySystemGroupedBackground.darkElevatedColor":"ff3a3a3c","tertiarySystemGroupedBackground.darkHighContrastColor":"ff363638","tertiarySystemGroupedBackground.darkHighContrastElevatedColor":"ff444446","tertiarySystemGroupedBackground.elevatedColor":"fff2f2f7","tertiarySystemGroupedBackground.highContrastColor":"ffebebf0","tertiarySystemGroupedBackground.highContrastElevatedColor":"ffebebf0",white:"ffffffff"}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterIconDecorationsDas=void 0;const r=i(1),s=i(126),o=i(127);class a extends o.FlutterIconDecorations{constructor(e,t){super(e),this.analyzer=t,this.computer=new s.IconRangeComputer(e),this.subscriptions.push(this.analyzer.client.registerForFlutterOutline(e=>n(this,void 0,void 0,(function*(){this.activeEditor&&r.fsPath(this.activeEditor.document.uri)===e.file&&this.update(e.outline)}))))}update(e){if(!this.activeEditor)return;if(e||(e=this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri)),!e)return;const t=this.computer.compute(this.activeEditor.document,e);this.render(t)}}t.FlutterIconDecorationsDas=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterOutlineVisitorLsp=t.FlutterOutlineVisitor=void 0;t.FlutterOutlineVisitor=class{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.kind){case"DART_ELEMENT":this.visitDartElement(e);break;case"GENERIC":this.visitGeneric(e);break;case"NEW_INSTANCE":this.visitNewInstance(e);break;case"INVOCATION":this.visitInvocation(e);break;case"VARIABLE":this.visitVariable(e);break;case"PLACEHOLDER":this.visitPlaceholder(e);break;default:this.logger.error("Unknown Flutter Outline item! "+(e&&e.kind))}if(e.attributes)for(const t of e.attributes)this.visitAttribute(t)}visitDartElement(e){this.visitChildren(e)}visitGeneric(e){this.visitChildren(e)}visitNewInstance(e){this.visitChildren(e)}visitInvocation(e){this.visitChildren(e)}visitVariable(e){this.visitChildren(e)}visitPlaceholder(e){this.visitChildren(e)}visitAttribute(e){}};t.FlutterOutlineVisitorLsp=class{constructor(e){this.logger=e}visit(e){this.visitNode(e)}visitChildren(e){if(e.children)for(const t of e.children)this.visit(t)}visitNode(e){switch(e&&e.kind){case"DART_ELEMENT":this.visitDartElement(e);break;case"GENERIC":this.visitGeneric(e);break;case"NEW_INSTANCE":this.visitNewInstance(e);break;case"INVOCATION":this.visitInvocation(e);break;case"VARIABLE":this.visitVariable(e);break;case"PLACEHOLDER":this.visitPlaceholder(e);break;default:this.logger.error("Unknown Flutter Outline item! "+(e&&e.kind))}if(e.attributes)for(const t of e.attributes)this.visitAttribute(t)}visitDartElement(e){this.visitChildren(e)}visitGeneric(e){this.visitChildren(e)}visitNewInstance(e){this.visitChildren(e)}visitInvocation(e){this.visitChildren(e)}visitVariable(e){this.visitChildren(e)}visitPlaceholder(e){this.visitChildren(e)}visitAttribute(e){}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterIconDecorationsLsp=void 0;const r=i(1),s=i(126),o=i(127);class a extends o.FlutterIconDecorations{constructor(e,t){super(e),this.analyzer=t,this.computer=new s.IconRangeComputerLsp(e),this.subscriptions.push(this.analyzer.fileTracker.onFlutterOutline.listen(e=>n(this,void 0,void 0,(function*(){this.activeEditor&&r.fsPath(this.activeEditor.document.uri)===r.fsPath(e.uri)&&this.update(e.outline)}))))}update(e){if(!this.activeEditor)return;if(e||(e=this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri)),!e)return;const t=this.computer.compute(e);this.render(t)}}t.FlutterIconDecorationsLsp=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterUiGuideDecorationsDas=void 0;const n=i(0),r=i(3),s=i(1),o=i(128);class a extends o.FlutterUiGuideDecorations{constructor(e){super(),this.analyzer=e,this.disposables.push(this.analyzer.client.registerForFlutterOutline(e=>{const t=n.window.activeTextEditor;t&&t.document&&s.fsPath(t.document.uri)===e.file&&this.buildFromOutline(t,e.outline)}))}buildForTextEditor(e){e&&e.document&&this.buildFromOutline(e,this.analyzer.fileTracker.getFlutterOutlineFor(e.document.uri))}buildFromOutline(e,t){if(this.tracker&&this.tracker.clear(),!e||!e.document||!t)return;if(e.document.getText().length!==t.length)return;const i=this.extractGuides(e.document,t);this.tracker&&this.tracker.trackDoc(e.document,i),this.renderGuides(e,i,"#A3A3A3")}extractGuides(e,t){let i=[];if("NEW_INSTANCE"===t.kind){const n=e.positionAt(t.offset).line,r=t.children&&t.children.map(t=>e.positionAt(t.offset).line).filter(e=>e>n);if(r){const t=this.firstNonWhitespace(e,n);r.forEach((n,r)=>{const s=this.firstNonWhitespace(e,n);i.push(new o.WidgetGuide(t,s))})}}return t.children&&(i=i.concat(r.flatMap(t.children,t=>this.extractGuides(e,t)))),i}}t.FlutterUiGuideDecorationsDas=a},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentOffsetTracker=t.DocumentPositionTracker=void 0;const n=i(0);t.DocumentPositionTracker=class{constructor(){this.disposables=[],this.tracker=new r,this.positionMap=new Map,this.onPositionsChangedEmitter=new n.EventEmitter,this.onPositionsChanged=this.onPositionsChangedEmitter.event,this.disposables.push(this.tracker),this.tracker.onOffsetsChanged(([e,t])=>{const i=new Map;for(const n of this.positionMap.keys()){const r=this.positionMap.get(n),s=t.get(r);s?i.set(n,e.positionAt(s)):i.delete(n)}this.onPositionsChangedEmitter.fire([e,i])})}clear(){this.positionMap.clear(),this.tracker.clear()}trackDoc(e,t){this.positionMap.clear();for(const i of t)this.positionMap.set(i,e.offsetAt(i));this.tracker.trackDoc(e,[...this.positionMap.values()])}dispose(){this.disposables.forEach(e=>e.dispose())}};class r{constructor(){this.disposables=[],this.offsetMap=new Map,this.onOffsetsChangedEmitter=new n.EventEmitter,this.onOffsetsChanged=this.onOffsetsChangedEmitter.event,this.disposables.push(n.workspace.onDidChangeTextDocument(e=>this.handleUpdate(e)))}trackDoc(e,t){this.document=e,this.offsetMap.clear();for(const e of t)this.offsetMap.set(e,e)}clear(){this.document=void 0,this.offsetMap.clear()}handleUpdate(e){if(e.document===this.document){for(const t of[...this.offsetMap.keys()]){const i=this.offsetMap.get(t),n=this.updateOffset(i,e);n?this.offsetMap.set(t,n):this.offsetMap.delete(t)}this.onOffsetsChangedEmitter.fire([e.document,this.offsetMap])}}updateOffset(e,t){if(t.contentChanges.find(t=>t.rangeOffset<e&&t.rangeOffset+t.rangeLength>e))return;const i=t.contentChanges.filter(t=>t.rangeOffset+t.rangeLength<=e).map(e=>e.text.length-e.rangeLength).reduce((e,t)=>e+t,0);return e+i}dispose(){this.disposables.forEach(e=>e.dispose())}}t.DocumentOffsetTracker=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterUiGuideDecorationsLsp=void 0;const n=i(0),r=i(3),s=i(1),o=i(6),a=i(128);class c extends a.FlutterUiGuideDecorations{constructor(e){super(),this.analyzer=e,this.disposables.push(this.analyzer.fileTracker.onFlutterOutline.listen(e=>{const t=n.window.activeTextEditor;t&&t.document&&s.fsPath(t.document.uri)===s.fsPath(e.uri)&&this.buildFromOutline(t,e.outline)}))}buildForTextEditor(e){e&&e.document&&this.buildFromOutline(e,this.analyzer.fileTracker.getFlutterOutlineFor(e.document.uri))}buildFromOutline(e,t){if(this.tracker&&this.tracker.clear(),!e||!e.document||!t)return;const i=e.document.offsetAt(o.lspToPosition(t.range.end));if(e.document.getText().length!==i)return;const n=this.extractGuides(e.document,t);this.tracker&&this.tracker.trackDoc(e.document,n),this.renderGuides(e,n,"#A3A3A3")}extractGuides(e,t){let i=[];if("NEW_INSTANCE"===t.kind){const n=t.codeRange.start.line,r=t.children&&t.children.map(e=>e.codeRange.start.line).filter(e=>e>n);if(r){const t=this.firstNonWhitespace(e,n);r.forEach((n,r)=>{const s=this.firstNonWhitespace(e,n);i.push(new a.WidgetGuide(t,s))})}}return t.children&&(i=i.concat(r.flatMap(t.children,t=>this.extractGuides(e,t)))),i}}t.FlutterUiGuideDecorationsLsp=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUpDaemonMessageHandler=void 0;const n=i(0),r=i(61);t.setUpDaemonMessageHandler=function(e,t,i){const s=r.createChannel("flutter daemon");t.subscriptions.push(i.registerForDaemonLog(e=>{s.appendLine(`${e.error?"[ERR] ":""}${e.log}`)})),t.subscriptions.push(i.registerForDaemonShowMessage(t=>{const i=`${t.title.trim().endsWith(".")?t.title.trim():t.title.trim()+"."} ${t.message}`.trim();switch(t.level){case"info":n.window.showInformationMessage(i);break;case"warning":n.window.showWarningMessage(i);break;case"error":n.window.showErrorMessage(i);break;default:e.warn("Unexpected daemon.showMessage type: "+t.level)}}))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterDaemon=void 0;const r=i(2),s=i(0),o=i(0),a=i(55),c=i(4),l=i(8),u=i(13),d=i(41),h=i(3),f=i(10),g=i(44),p=i(7),m=i(15);class v extends d.StdIOService{constructor(e,t){var i,n;super(new u.CategoryLogger(e,l.LogCategory.FlutterDaemon),f.config.maxLogLineLength,!0,!0),this.hasStarted=!1,this.daemonStartedCompleter=new h.PromiseCompleter,this.capabilities=a.DaemonCapabilities.empty,this.hasShownStartupError=!1,this.daemonConnectedSubscriptions=[],this.deviceAddedSubscriptions=[],this.deviceRemovedSubscriptions=[],this.daemonLogMessageSubscriptions=[],this.daemonLogSubscriptions=[],this.daemonShowMessageSubscriptions=[];const o=t.sdks.flutter;this.registerForDaemonConnected(e=>{this.additionalPidsToTerminate.push(e.pid),this.capabilities.version=e.version,s.commands.executeCommand("setContext",g.FLUTTER_SUPPORTS_ATTACH,this.capabilities.canFlutterAttach),this.deviceEnable()});const{binPath:d,binArgs:p}=h.usingCustomScript(r.join(t.sdks.flutter,c.flutterPath),["daemon"],(null===(i=t.config)||void 0===i?void 0:i.flutterDaemonScript)||(null===(n=t.config)||void 0===n?void 0:n.flutterScript)),v=f.config.for(s.Uri.file(o)).flutterAdditionalArgs,y=m.getGlobalFlutterArgs().concat(v).concat(p);if(this.createProcess(o,d,y,{toolEnv:m.getToolEnv()}),c.isChromeOS&&f.config.flutterAdbConnectOnChromeOs){e.info("Running ADB Connect on Chrome OS");const t=m.safeToolSpawn(void 0,"adb",["connect","100.115.92.2:5555"]);u.logProcess(e,l.LogCategory.General,t)}}dispose(){super.dispose()}sendMessage(e){try{super.sendMessage(e)}catch(e){throw p.promptToReloadExtension("The Flutter Daemon has terminated.",void 0,!0),e}}shouldHandleMessage(e){return!(!e.startsWith("[{")||!e.endsWith("}]"))&&(this.hasStarted||(this.hasStarted=!0,this.daemonStartedCompleter.resolve()),!0)}processUnhandledMessage(e){return n(this,void 0,void 0,(function*(){let t;const i=v.outOfDateWarning.exec(e);if(i&&2===i.length?t=`Your installation of Flutter is ${i[1]} days old.`:-1!==e.indexOf(v.newVersionMessage)&&(t="A new version of Flutter is available"),!t)return!this.hasShownStartupError&&e.startsWith("Flutter requires")?(this.logger.error(e,l.LogCategory.FlutterDaemon),s.window.showErrorMessage(e),void(this.hasShownStartupError=!0)):void((e.startsWith("Building ")||e.startsWith("Downloading ")||e.startsWith("Starting ")||e.startsWith("Running "))&&!e.startsWith("Starting device daemon")&&(this.hasStarted||(this.startupReporter?this.startupReporter.report({message:e}):s.window.withProgress({location:o.ProgressLocation.Notification,title:"Flutter Setup"},t=>(this.startupReporter=t,this.startupReporter.report({message:e}),this.daemonStartedCompleter.promise)))));(yield s.window.showWarningMessage(t,"Upgrade Flutter"))&&s.commands.executeCommand("flutter.upgrade")}))}handleNotification(e){return n(this,void 0,void 0,(function*(){switch(e.event){case"daemon.connected":yield this.notify(this.daemonConnectedSubscriptions,e.params);break;case"device.added":yield this.notify(this.deviceAddedSubscriptions,e.params);break;case"device.removed":yield this.notify(this.deviceRemovedSubscriptions,e.params);break;case"daemon.logMessage":yield this.notify(this.daemonLogMessageSubscriptions,e.params);break;case"daemon.log":yield this.notify(this.daemonLogSubscriptions,e.params);break;case"daemon.showMessage":yield this.notify(this.daemonShowMessageSubscriptions,e.params)}}))}deviceEnable(){return this.sendRequest("device.enable")}getEmulators(){return this.sendRequest("emulator.getEmulators")}launchEmulator(e){return this.sendRequest("emulator.launch",{emulatorId:e})}createEmulator(e){return this.sendRequest("emulator.create",{name:e})}getSupportedPlatforms(e){return this.sendRequest("daemon.getSupportedPlatforms",{projectRoot:e})}registerForDaemonConnected(e){return this.subscribe(this.daemonConnectedSubscriptions,e)}registerForDeviceAdded(e){return this.subscribe(this.deviceAddedSubscriptions,e)}registerForDeviceRemoved(e){return this.subscribe(this.deviceRemovedSubscriptions,e)}registerForDaemonLogMessage(e){return this.subscribe(this.daemonLogMessageSubscriptions,e)}registerForDaemonLog(e){return this.subscribe(this.daemonLogSubscriptions,e)}registerForDaemonShowMessage(e){return this.subscribe(this.daemonShowMessageSubscriptions,e)}}t.FlutterDaemon=v,v.outOfDateWarning=new RegExp("WARNING: .* Flutter is (\\d+) days old"),v.newVersionMessage="A new version of Flutter is available"},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FlutterWidgetItem=t.LspFlutterOutlineProvider=t.DasFlutterOutlineProvider=t.FlutterOutlineProvider=void 0;const r=i(2),s=i(0),o=i(13),a=i(1),c=i(19),l=i(229),u=i(6),d=i(48),h=i(119),f=i(7);class g{constructor(){this.subscriptions=[],this.treeNodesByLine=[],this.onDidChangeTreeDataEmitter=new s.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event}setTrackingFile(e){e&&f.isAnalyzable(e.document)?(this.activeEditor=e,this.loadExistingOutline()):e&&"file"===e.document.uri.scheme?(this.activeEditor=void 0,g.hideTree()):setTimeout(()=>{s.window.visibleTextEditors.filter(e=>f.isAnalyzable(e.document)).length||g.hideTree()},100)}setContexts(e){return n(this,void 0,void 0,(function*(){this.lastSelectedWidget&&(this.lastSelectedWidget.contextValue=void 0,this.refresh(this.lastSelectedWidget));for(const e of h.flutterOutlineCommands)s.commands.executeCommand("setContext","dart-code:widgetSupports:"+e,!1);if(this.activeEditor&&e&&1===e.length&&p(e[0].outline)){const t=(yield function(e,t){return n(this,void 0,void 0,(function*(){const i="range"in t?u.lspToPosition(t.range.start):e.document.positionAt(t.offset),n=new s.Range(i,i);return(yield s.commands.executeCommand("vscode.executeCodeActionProvider",e.document.uri,n))||[]}))}(this.activeEditor,e[0].outline)).filter(e=>e instanceof s.CodeAction).filter(e=>e.kind&&e.kind.value&&-1!==h.flutterOutlineCommands.indexOf(e.kind.value));e[0].fixes=t;for(const e of t)s.commands.executeCommand("setContext","dart-code:widgetSupports:"+(e.kind?e.kind.value:"NOKIND"),!0);e[0].contextValue="dart-code:isSelectedWidget",this.lastSelectedWidget=e[0],this.refresh(e[0])}}))}getNodeAt(e,t){if(!this.activeEditor||!this.flutterOutline||a.fsPath(this.activeEditor.document.uri)!==a.fsPath(e)||!this.treeNodesByLine[t.line])return;const i=this.treeNodesByLine[t.line];let n;for(const e of i){("range"in e.outline?u.lspToRange(e.outline.range):u.toRange(this.activeEditor.document,e.outline.offset,e.outline.length)).contains(t)&&(n=e)}return n!==this.rootNode?n:void 0}refresh(e){this.onDidChangeTreeDataEmitter.fire(e)}getTreeItem(e){return e}getChildren(e){return e?e.children:this.rootNode?this.rootNode.children:[]}getParent(e){return e.parent}static setTreeVisible(e){s.commands.executeCommand("setContext","dart-code:showFlutterOutline",e)}static showTree(){this.setTreeVisible(!0)}static hideTree(){this.setTreeVisible(!1)}dispose(){this.activeEditor=void 0,this.subscriptions.forEach(e=>e.dispose())}}t.FlutterOutlineProvider=g;t.DasFlutterOutlineProvider=class extends g{constructor(e){super(),this.analyzer=e,this.analyzer.client.registerForServerConnected(t=>{e.client.capabilities.supportsFlutterOutline&&(this.analyzer.client.registerForFlutterOutline(e=>{this.activeEditor&&e.file===a.fsPath(this.activeEditor.document.uri)&&(this.flutterOutline=e.outline,this.treeNodesByLine=[],this.updateTimeout&&clearTimeout(this.updateTimeout),this.rootNode?this.updateTimeout=setTimeout(()=>this.update(),200):this.update())}),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),s.window.activeTextEditor&&this.setTrackingFile(s.window.activeTextEditor))})}loadExistingOutline(){return n(this,void 0,void 0,(function*(){this.flutterOutline=this.activeEditor?this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri):void 0,this.flutterOutline?yield this.update():(this.rootNode=void 0,this.refresh()),this.activeEditor&&this.analyzer.client.forceNotificationsFor(a.fsPath(this.activeEditor.document.uri))}))}update(){return n(this,void 0,void 0,(function*(){this.flutterOutline?(this.rootNode=yield this.createTreeNode(void 0,this.flutterOutline,this.activeEditor),g.showTree()):(this.rootNode=void 0,g.hideTree()),this.refresh()}))}createTreeNode(e,t,i){return n(this,void 0,void 0,(function*(){if(i&&i.document&&!i.document.isClosed&&this.activeEditor===i){const n=new m(e,t,i),r=i.document.positionAt(t.offset).line,s=i.document.positionAt(t.offset+t.length).line;for(let e=r;e<=s;e++)this.treeNodesByLine[e]||(this.treeNodesByLine[e]=[]),this.treeNodesByLine[e].push(n);return t.children&&(n.children=(yield Promise.all(t.children.map(e=>this.createTreeNode(n,e,i)))).filter(e=>e).map(e=>e)),n}}))}};function p(e){return"DART_ELEMENT"!==e.kind}t.LspFlutterOutlineProvider=class extends g{constructor(e){super(),this.analyzer=e,this.analyzer.fileTracker.onFlutterOutline.listen(e=>{this.activeEditor&&a.fsPath(s.Uri.parse(e.uri))===a.fsPath(this.activeEditor.document.uri)&&(this.flutterOutline=e.outline,this.treeNodesByLine=[],this.updateTimeout&&clearTimeout(this.updateTimeout),this.rootNode?this.updateTimeout=setTimeout(()=>this.update(),200):this.update())}),this.subscriptions.push(s.window.onDidChangeActiveTextEditor(e=>this.setTrackingFile(e))),s.window.activeTextEditor&&this.setTrackingFile(s.window.activeTextEditor)}loadExistingOutline(){return n(this,void 0,void 0,(function*(){this.flutterOutline=this.activeEditor?this.analyzer.fileTracker.getFlutterOutlineFor(this.activeEditor.document.uri):void 0,this.flutterOutline?yield this.update():(this.rootNode=void 0,this.refresh())}))}update(){return n(this,void 0,void 0,(function*(){this.flutterOutline?(this.rootNode=yield this.createTreeNode(void 0,this.flutterOutline,this.activeEditor),g.showTree()):(this.rootNode=void 0,g.hideTree()),this.refresh()}))}createTreeNode(e,t,i){return n(this,void 0,void 0,(function*(){if(i&&i.document&&!i.document.isClosed&&this.activeEditor===i){const n=new m(e,t,i),r=t.range.start.line,s=t.range.end.line;for(let e=r;e<=s;e++)this.treeNodesByLine[e]||(this.treeNodesByLine[e]=[]),this.treeNodesByLine[e].push(n);return t.children&&(n.children=(yield Promise.all(t.children.map(e=>this.createTreeNode(n,e,i)))).filter(e=>e).map(e=>e)),n}}))}};class m extends s.TreeItem{constructor(e,t,i){if(super(m.getLabel(t),t.children&&t.children.length?s.TreeItemCollapsibleState.Expanded:s.TreeItemCollapsibleState.None),this.parent=e,this.outline=t,this.children=[],this.fixes=[],this.description=m.getDescription(t),p(t))this.iconPath=s.Uri.file(r.join(c.extensionPath,"media/icons/flutter_widget.svg"));else if(t.dartElement){const e=l.getIconForSymbolKind(d.getSymbolKindForElementKind(o.nullLogger,t.dartElement.kind));this.iconPath={dark:s.Uri.file(r.join(c.extensionPath,`media/icons/vscode_symbols/${e}-dark.svg`)),light:s.Uri.file(r.join(c.extensionPath,`media/icons/vscode_symbols/${e}-light.svg`))}}const n="range"in t?t.range:new s.Range(i.document.positionAt(t.offset),i.document.positionAt(t.offset+t.length)),a="codeRange"in t?t.codeRange:new s.Range(i.document.positionAt(t.codeOffset),i.document.positionAt(t.codeOffset+t.codeLength)),h="range"in t?t.dartElement&&t.dartElement.range?u.lspToPosition(t.dartElement.range.start):u.lspToPosition(t.range.start):t.dartElement&&t.dartElement.location&&t.dartElement.location.offset?i.document.positionAt(t.dartElement.location.offset):i.document.positionAt(t.offset);this.command={arguments:[i,n,a,new s.Range(h,h)],command:"_dart.showCode",title:""},this.tooltip=this.label,t.attributes&&t.attributes.length&&(this.tooltip+="\n  "+t.attributes.map(e=>`${e.name}: ${e.label}`).join("\n   "))}static getLabel(e){let t="";return e.dartElement&&(t+=" "+e.dartElement.name,e.dartElement.typeParameters&&(t+=e.dartElement.typeParameters)),e.variableName&&(t+=" "+e.variableName),e.className&&(t+=" "+e.className),e.label&&(t+=" "+e.label),t.trim()}static getDescription(e){var t,i;let n="";e.dartElement&&(e.dartElement.parameters&&(n+=e.dartElement.parameters),e.dartElement.returnType&&(n+=" â†’ "+e.dartElement.returnType));const r=(null===(t=e.attributes)||void 0===t?void 0:t.find(e=>"data"===e.name))||(null===(i=e.attributes)||void 0===i?void 0:i.find(e=>"icon"===e.name||"value"===e.name));return r&&(n+=" "+r.label),n.trim()}}t.FlutterWidgetItem=m},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIconForSymbolKind=void 0;const n=i(0),r={[n.SymbolKind.Array]:"indexer",[n.SymbolKind.Boolean]:"boolean",[n.SymbolKind.Class]:"class",[n.SymbolKind.Constant]:"constant",[n.SymbolKind.Constructor]:"method",[n.SymbolKind.Enum]:"enumerator",[n.SymbolKind.EnumMember]:"enumerator-item",[n.SymbolKind.Event]:"event",[n.SymbolKind.Field]:"field",[n.SymbolKind.File]:"file",[n.SymbolKind.Function]:"method",[n.SymbolKind.Interface]:"interface",[n.SymbolKind.Key]:"string",[n.SymbolKind.Method]:"method",[n.SymbolKind.Module]:"namespace",[n.SymbolKind.Namespace]:"namespace",[n.SymbolKind.Null]:"boolean",[n.SymbolKind.Number]:"numeric",[n.SymbolKind.Object]:"namespace",[n.SymbolKind.Operator]:"operator",[n.SymbolKind.Package]:"namespace",[n.SymbolKind.Property]:"property",[n.SymbolKind.String]:"string",[n.SymbolKind.Struct]:"structure",[n.SymbolKind.TypeParameter]:"type-parameter",[n.SymbolKind.Variable]:"variable"};t.getIconForSymbolKind=function(e){return r[e]||"field"}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HotReloadOnSaveHandler=void 0;const n=i(2),r=i(0),s=i(4),o=i(8),a=i(1),c=i(10),l=i(7);t.HotReloadOnSaveHandler=class{constructor(e,t){this.debugCommands=e,this.flutterCapabilities=t,this.disposables=[],this.disposables.push(r.workspace.onDidSaveTextDocument(e=>{c.config.previewHotReloadOnSaveWatcher||this.triggerReload(e)}));const i=r.workspace.createFileSystemWatcher("**/*.dart");this.disposables.push(i),i.onDidChange(this.handleFileSystemChange,this),i.onDidCreate(this.handleFileSystemChange,this)}handleFileSystemChange(e){c.config.previewHotReloadOnSaveWatcher&&this.triggerReload({uri:e})}triggerReload(e){if(-1!==a.fsPath(e.uri).indexOf(`${n.sep}.dart_tool${n.sep}`))return;const t=this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotReload)&&c.config.flutterHotReloadOnSave,i=!this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotReload)&&this.debugCommands.vmServices.serviceIsRegistered(o.VmService.HotRestart)&&c.config.flutterHotRestartOnSave;if(!t&&!i)return;const u=t?"flutter.hotReload":"flutter.hotRestart";if(!l.isWithinWorkspace(a.fsPath(e.uri))||!l.shouldHotReloadFor(e))return;const d=r.languages.getDiagnostics(e.uri);if(d&&null!=d.find(e=>"dart"===e.source&&e.severity===r.DiagnosticSeverity.Error))return;const h={reason:s.restartReasonSave,debounce:this.flutterCapabilities.supportsRestartDebounce};this.flutterCapabilities.supportsRestartDebounce?r.commands.executeCommand(u,h):(this.hotReloadDelayTimer&&clearTimeout(this.hotReloadDelayTimer),this.hotReloadDelayTimer=setTimeout(()=>{this.hotReloadDelayTimer=void 0,r.commands.executeCommand(u,h)},200))}dispose(){this.hotReloadDelayTimer&&clearTimeout(this.hotReloadDelayTimer),this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LspAnalyzerStatusReporter=void 0;const n=i(0),r=i(3);t.LspAnalyzerStatusReporter=class{constructor(e){this.analyzer=e,this.analysisInProgress=!1,e.onAnalysisStatusChange.listen(e=>this.handleServerStatus(e.isAnalyzing))}handleServerStatus(e){this.analysisInProgress=e,this.analysisInProgress?setTimeout(()=>{this.analysisInProgress&&!this.analyzingPromise&&n.window.withProgress({location:n.ProgressLocation.Window,title:"Analyzingâ€¦"},e=>(this.analyzingPromise||(this.analyzingPromise=new r.PromiseCompleter),this.analyzingPromise.promise))},100):this.analyzingPromise&&(this.analyzingPromise.resolve(),this.analyzingPromise=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LspClosingLabelsDecorations=void 0;const n=i(0),r=i(96),s=i(1),o=i(125);t.LspClosingLabelsDecorations=class{constructor(e){this.analyzer=e,this.subscriptions=[],this.closingLabels={},this.editors={},this.decorationType=n.window.createTextEditorDecorationType({after:{color:new n.ThemeColor("dart.closingLabels"),margin:"2px"},rangeBehavior:n.DecorationRangeBehavior.ClosedOpen}),e.onReady().then(()=>{this.analyzer.onNotification(r.PublishClosingLabelsNotification.type,e=>{const t=s.fsPath(n.Uri.parse(e.uri));this.closingLabels[t]=e,n.window.activeTextEditor&&n.window.activeTextEditor.document&&t===s.fsPath(n.window.activeTextEditor.document.uri)&&(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>this.update(),500))})}),this.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>this.update())),this.subscriptions.push(n.workspace.onDidCloseTextDocument(e=>{const t=s.fsPath(e.uri);delete this.closingLabels[t]})),n.window.activeTextEditor&&this.update()}update(){const e=n.window.activeTextEditor;if(!e||!e.document)return;const t=s.fsPath(e.document.uri);if(!this.closingLabels[t])return;const i=[];for(const r of this.closingLabels[t].labels){const t=this.analyzer.protocol2CodeConverter.asRange(r.range),s=t.end;if(s.character<1)return;const a=new n.Range(s.translate({characterDelta:-1}),s),c=e.document.getText(a);if(-1===o.validLastCharacters.indexOf(c))return;const l=e.document.lineAt(s).range.end,u=i[l.line];if(u)u.renderOptions.after.contentText=" // "+r.label+" "+u.renderOptions.after.contentText;else{const e={range:new n.Range(t.start,l),renderOptions:{after:{contentText:" // "+r.label}}};i[l.line]=e}}this.editors[t]=e,e.setDecorations(this.decorationType,Object.keys(i).map(e=>parseInt(e,10)).map(e=>i[e]))}dispose(){for(const e of Object.values(this.editors))try{e.setDecorations(this.decorationType,[])}catch(e){}this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LspGoToSuperCommand=void 0;const r=i(0),s=i(6),o=i(54);t.LspGoToSuperCommand=class{constructor(e){this.analyzer=e,this.disposables=[],this.disposables.push(r.commands.registerCommand("dart.goToSuper",this.goToSuper,this))}goToSuper(){return n(this,void 0,void 0,(function*(){const e=o.getActiveDartEditor();if(!e)return void r.window.showWarningMessage("No active Dart editor.");const t=yield this.analyzer.getSuper({position:this.analyzer.client.code2ProtocolConverter.asPosition(e.selection.start),textDocument:this.analyzer.client.code2ProtocolConverter.asVersionedTextDocumentIdentifier(e.document)});if(!t)return;const i=this.analyzer.client.protocol2CodeConverter.asLocation(t),n=yield r.workspace.openTextDocument(i.uri),a=yield r.window.showTextDocument(n);s.showCode(a,i.range,i.range,i.range)}))}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AssistCodeActionProvider=void 0;const r=i(0),s=i(1),o=i(7),a=i(101);t.AssistCodeActionProvider=class{constructor(e,t,i){this.logger=e,this.selector=t,this.analyzer=i,this.rank=10,this.metadata={providedCodeActionKinds:[r.CodeActionKind.Refactor]}}provideCodeActions(e,t,i,a){return n(this,void 0,void 0,(function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||r.CodeActionKind.Refactor.contains(i.only)))try{const n=e.offsetAt(t.start),r=e.offsetAt(t.end),o=(yield this.analyzer.editGetAssists({file:s.fsPath(e.uri),length:r-n,offset:n})).assists.map(t=>this.convertResult(e,t));return i.only?o.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):o}catch(e){this.logger.error(e)}}))}convertResult(e,t){const i=t.message,n=a.getKindFor(t.id,r.CodeActionKind.Refactor),s=new r.CodeAction(i,n);return s.command={arguments:[e,t],command:"_dart.applySourceChange",title:i},s}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartCompletionItemProvider=void 0;const r=i(2),s=i(0),o=i(0),a=i(3),c=i(1),l=i(30),u=i(19),d=i(100),h=i(10);t.DartCompletionItemProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.disposables=[],this.cachedCompletions={},this.existingImports={},this.disposables.push(t.registerForCompletionAvailableSuggestions(e=>this.storeCompletionSuggestions(e))),this.disposables.push(t.registerForCompletionExistingImports(e=>this.storeExistingImports(e)))}provideCompletionItems(e,t,i,r){return n(this,void 0,void 0,(function*(){const n=e.lineAt(t.line).text.slice(0,t.character),s=e.getText(new o.Range(t,t.translate({characterDelta:200}))).trim().substr(0,1),a=h.config.for(e.uri),u=a.enableCompletionCommitCharacters,d=!u&&a.insertArgumentPlaceholders&&this.shouldAllowArgPlaceholders(n);if(!this.shouldAllowCompletion(n,r))return;const f=e.offsetAt(t),g=yield this.analyzer.completionGetSuggestionsResults({file:c.fsPath(e.uri),offset:f});if(i&&i.isCancellationRequested)return;const p=g.results.map(t=>this.convertResult(e,f,s,u,d,g,t)),m=yield this.getCachedResults(e,i,s,u,d,e.offsetAt(t),g);if(yield l.resolvedPromise,i&&i.isCancellationRequested)return;const v=[...p,...m];return new o.CompletionList(v)}))}shouldAllowCompletion(e,t){if(e=e.trim(),t.triggerKind===o.CompletionTriggerKind.TriggerCharacter)switch(t.triggerCharacter){case"{":return e.endsWith("${");case"'":return e.endsWith("import '")||e.endsWith("export '");case'"':return e.endsWith('import "')||e.endsWith('export "');case"/":case"\\":return e.startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '")}return!0}shouldAllowArgPlaceholders(e){return!((e=e.trim()).startsWith('import "')||e.startsWith('export "')||e.startsWith("import '")||e.startsWith("export '"))}storeCompletionSuggestions(e){if(e.changedLibraries)for(const t of e.changedLibraries)this.cachedCompletions[t.id]=t;if(e.removedLibraries)for(const t of e.removedLibraries)delete this.cachedCompletions[t]}storeExistingImports(e){const t=e.imports,i={};for(const e of t.imports)for(const n of e.elements){const r=t.elements.strings[t.elements.names[n]],s=t.elements.strings[t.elements.uris[n]],o=t.elements.strings[e.uri],a=`${r}/${s}`;i[a]||(i[a]={}),i[a][o]=!0}this.existingImports[e.file]=i}resolveCompletionItem(e,t){return n(this,void 0,void 0,(function*(){if(!e.suggestion)return!e.documentation&&e._documentation&&(e.documentation=e._documentation),e;const i=yield this.analyzer.completionGetSuggestionDetails({file:e.filePath,id:e.suggestionSetID,label:e.suggestion.label,offset:e.offset});return t&&t.isCancellationRequested?void 0:this.createCompletionItemFromSuggestion(e.document,e.offset,e.nextCharacter,e.enableCommitCharacters,e.insertArgumentPlaceholders,e.replacementOffset,e.replacementLength,e.autoImportUri,e.relevance,e.suggestion,i)}))}createCompletionItemFromSuggestion(e,t,i,n,r,s,o,a,c,l,u){const d=this.makeCompletion(e,t,i,n,r,{autoImportUri:a,completionText:u&&u.completion||l.label,defaultArgumentListString:l.defaultArgumentListString,defaultArgumentListTextRanges:l.defaultArgumentListTextRanges,displayText:l.label,elementKind:l.element?l.element.kind:void 0,isDeprecated:!1,kind:void 0,parameterNames:l.parameterNames,parameterType:void 0,parameters:l.element?l.element.parameters:void 0,relevance:c,replacementLength:o,replacementOffset:s,requiredParameterCount:l.requiredParameterCount,returnType:l.element?l.element.returnType:void 0,selectionLength:u&&u.change&&u.change.selection?0:void 0,selectionOffset:u&&u.change&&u.change.selection?u.change.selection.offset:void 0});return u&&u.change&&u.change.edits&&u.change.edits.length&&(this.appendAdditionalEdits(d,e,u.change),a&&(d.detail=`Auto import from '${a}'`+(d.detail?"\n\n"+d.detail:""))),u&&!d.documentation&&d._documentation&&(d.documentation=d._documentation),d}getCachedResults(e,t,i,r,s,o,a){return n(this,void 0,void 0,(function*(){if(!a.includedSuggestionSets||!a.includedElementKinds)return[];const n=a.libraryFile?this.existingImports[a.libraryFile]:void 0,u={};a.includedElementKinds.forEach(e=>u[e]=!0);const d={};a.includedSuggestionRelevanceTags&&a.includedSuggestionRelevanceTags.forEach(e=>d[e.tag]=e.relevanceBoost);const h=c.fsPath(e.uri),f=[],g={},p={};for(const c of a.includedSuggestionSets){if(g[c.id])continue;if(g[c.id]=!0,yield l.resolvedPromise,t&&t.isCancellationRequested)return[];const m=this.cachedCompletions[c.id];if(!m)return this.logger.warn(`Suggestion set ${c.id} was not available and therefore not included in the completion results`),[];const v=m.items.filter(e=>u[e.element.kind]).filter(e=>{const t=`${e.label.split(".")[0]}/${e.declaringLibraryUri}`,i=n&&n[t];if(!i)return!0;if(!i[m.uri])return!1;const r=`${e.label}/${e.element.kind}/${e.declaringLibraryUri}`,s=p[r];return p[r]=!0,!s}).map(t=>{let n=0;t.relevanceTags&&t.relevanceTags.forEach(e=>n=Math.max(n,d[e]||0));const l=this.createCompletionItemFromSuggestion(e,o,i,r,s,a.replacementOffset,a.replacementLength,void 0,c.relevance+n,t,void 0);return Object.assign({autoImportUri:c.displayUri||m.uri,document:e,enableCommitCharacters:r,filePath:h,insertArgumentPlaceholders:s,nextCharacter:i,offset:o,relevance:c.relevance+n,replacementLength:a.replacementLength,replacementOffset:a.replacementOffset,suggestion:t,suggestionSetID:c.id},l)});f.push(v)}return[].concat(...f)}))}convertResult(e,t,i,n,r,s,o){return this.makeCompletion(e,t,i,n,r,{completionText:o.completion,defaultArgumentListString:o.defaultArgumentListString,defaultArgumentListTextRanges:o.defaultArgumentListTextRanges,displayText:o.displayText,docComplete:o.docComplete,elementKind:o.element?o.element.kind:void 0,isDeprecated:o.isDeprecated,kind:o.kind,parameterNames:o.parameterNames,parameterType:o.parameterType,parameters:o.element?o.element.parameters:void 0,relevance:o.relevance,replacementLength:s.replacementLength,replacementOffset:s.replacementOffset,requiredParameterCount:o.requiredParameterCount,returnType:o.returnType||(o.element?o.element.returnType:void 0),selectionLength:o.selectionLength,selectionOffset:o.selectionOffset})}makeCompletion(e,t,i,n,r,a){const c=a.elementKind?this.getElementKind(a.elementKind):void 0;let l,d=a.displayText||a.completionText;const h=new o.SnippetString;let f=!1;const g="("===i;if(a.parameters&&c!==o.CompletionItemKind.Property&&"OVERRIDE"!==a.kind&&-1===d.indexOf("(")){d+=2===a.parameters.length?"()":"(â€¦)",l=a.parameters;const e=a.parameterNames&&a.parameterNames.length>0||r&&!!a.defaultArgumentListString;if(r&&e&&!g){if(h.appendText(a.completionText),h.appendText("("),a.defaultArgumentListString)for(const e of this.extractTabstopDataForNamedArgs(a.defaultArgumentListString,a.defaultArgumentListTextRanges||[])){const t=a.defaultArgumentListString.substring(e.start,e.end);e.tabStop?h.appendPlaceholder(t):h.appendText(t)}else h.appendTabstop();h.appendText(")")}else if(r&&e&&!g){h.appendText(a.completionText);const e=a.parameterNames.slice(0,a.requiredParameterCount);if(h.appendText("("),e.length){h.appendPlaceholder(e[0]);for(const t of e.slice(1))h.appendText(", "),h.appendPlaceholder(t)}else h.appendTabstop(0);h.appendText(")")}else r&&!g?(h.appendText(a.completionText),h.appendText("()")):h.appendText(a.completionText)}else if(a.selectionOffset){const e=a.completionText.slice(0,a.selectionOffset),t=a.completionText.slice(a.selectionOffset,a.selectionOffset+(a.selectionLength||0));t||" "!==a.completionText.slice(a.selectionOffset-1,a.selectionOffset)||(f=!0);const i=a.completionText.slice(a.selectionOffset+(a.selectionLength||0));h.appendText(e),t?h.appendPlaceholder(t):h.appendTabstop(0),h.appendText(i)}else h.appendText(a.completionText);c===o.CompletionItemKind.Property?l="GETTER"===a.elementKind?a.returnType:a.parameters?a.parameters.substring(1,a.parameters.lastIndexOf(" ")):"":a.returnType?l=l?l+" â†’ "+a.returnType:a.returnType:a.parameterType&&(l=a.parameterType),d.endsWith(",")&&(d=d.substr(0,d.length-1).trim());const p=c||(a.kind?this.getSuggestionKind(a.kind,d):void 0),m=u.cleanDartdoc(a.docComplete),v=new o.CompletionItem(d,p);v.filterText=d.split("(")[0],a.isDeprecated&&(v.tags=[s.CompletionItemTag.Deprecated]),v.detail=l,v._documentation=m?new o.MarkdownString(m):void 0,v.insertText=h,v.keepWhitespace=!0,v.range={inserting:new o.Range(e.positionAt(a.replacementOffset),e.positionAt(Math.min(t,a.replacementOffset+a.replacementLength))),replacing:new o.Range(e.positionAt(a.replacementOffset),e.positionAt(a.replacementOffset+a.replacementLength))},n&&(v.commitCharacters=this.getCommitCharacters(a.kind));return-1!==["import '';"].indexOf(d)&&(f=!0),"IMPORT"===a.kind&&d.endsWith("/")&&(f=!0),f&&(v.command={command:"editor.action.triggerSuggest",title:"Suggest"}),v.sortText=(1e6-a.relevance).toString(),v}extractTabstopDataForNamedArgs(e,t){const i=[];let n=0;for(const e of this.extractOffsetLengthPairs(t))i.push({start:n,end:e[0],tabStop:!1}),i.push({start:e[0],end:e[1],tabStop:!0}),n=e[1];return n<e.length&&i.push({start:n,end:e.length,tabStop:!1}),i}extractOffsetLengthPairs(e){const t=[];for(let i=0;i<e.length-1;i+=2)t.push([e[i],e[i]+e[i+1]]);return t}getSuggestionKind(e,t){switch(e){case"ARGUMENT_LIST":return o.CompletionItemKind.Variable;case"IMPORT":return t.startsWith("dart:")?o.CompletionItemKind.Module:".dart"===r.extname(t.toLowerCase())?o.CompletionItemKind.File:o.CompletionItemKind.Folder;case"IDENTIFIER":return o.CompletionItemKind.Variable;case"INVOCATION":return o.CompletionItemKind.Method;case"KEYWORD":return o.CompletionItemKind.Keyword;case"NAMED_ARGUMENT":case"OPTIONAL_ARGUMENT":return o.CompletionItemKind.Variable;case"PARAMETER":return o.CompletionItemKind.Value}}getElementKind(e){switch(e){case"CLASS":case"CLASS_TYPE_ALIAS":return o.CompletionItemKind.Class;case"COMPILATION_UNIT":return o.CompletionItemKind.Module;case"CONSTRUCTOR":case"CONSTRUCTOR_INVOCATION":return o.CompletionItemKind.Constructor;case"ENUM":return o.CompletionItemKind.Enum;case"ENUM_CONSTANT":return o.CompletionItemKind.EnumMember;case"FIELD":return o.CompletionItemKind.Field;case"FILE":return o.CompletionItemKind.File;case"FUNCTION":case"FUNCTION_TYPE_ALIAS":return o.CompletionItemKind.Function;case"GETTER":return o.CompletionItemKind.Property;case"LABEL":case"LIBRARY":return o.CompletionItemKind.Module;case"LOCAL_VARIABLE":return o.CompletionItemKind.Variable;case"METHOD":return o.CompletionItemKind.Method;case"PARAMETER":case"PREFIX":return o.CompletionItemKind.Variable;case"SETTER":return o.CompletionItemKind.Property;case"TOP_LEVEL_VARIABLE":case"TYPE_PARAMETER":return o.CompletionItemKind.Variable;case"UNIT_TEST_GROUP":return o.CompletionItemKind.Module;case"UNIT_TEST_TEST":return o.CompletionItemKind.Method;case"UNKNOWN":return o.CompletionItemKind.Value}}getCommitCharacters(e){switch(e){case"IDENTIFIER":case"INVOCATION":return[".",",","(","["]}}appendAdditionalEdits(e,t,i){if(!i)return;if(d.hasOverlappingEdits(i))return this.logger.error("Unable to insert imports because of overlapping edits from the server."),void s.window.showErrorMessage("Unable to insert imports because of overlapping edits from the server");const n=c.fsPath(t.uri),r=i.edits.filter(e=>e.file===n),o=i.edits.filter(e=>e.file!==n);if(r.length&&(e.additionalTextEdits=a.flatMap(r,e=>e.edits.map(e=>{const i=new s.Range(t.positionAt(e.offset),t.positionAt(e.offset+e.length));return new s.TextEdit(i,e.replacement)}))),o.length){const n={edits:o,id:i.id,linkedEditGroups:[],message:i.message,selection:i.selection};e.command={arguments:[t,n],command:"_dart.applySourceChange",title:"Automatically add imports"}}}dispose(){this.disposables.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartDocumentSymbolProvider=void 0;const r=i(0),s=i(30),o=i(6),a=i(48);t.DartDocumentSymbolProvider=class{constructor(e,t){this.logger=e,this.fileTracker=t}provideDocumentSymbols(e,t){return n(this,void 0,void 0,(function*(){const i=yield s.waitFor(()=>this.fileTracker.getOutlineFor(e.uri),500,6e4,t);if(!t.isCancellationRequested&&i&&i.children&&i.children.length)return i.children.map(t=>this.convertResult(e,t))}))}convertResult(e,t){const i=t.element.name?t.element.name:"EXTENSION"===t.element.kind?"<unnamed extension>":"<unnamed>",n=t.element.location||t,s=new r.DocumentSymbol(i,this.getDetail(t.element),a.getSymbolKindForElementKind(this.logger,t.element.kind),this.getCodeOffset(e,t),o.toRange(e,n.offset,n.length));return 32&t.element.flags&&(s.tags=[r.SymbolTag.Deprecated]),t.children&&t.children.length&&(s.children=t.children.filter(this.shouldShow).map(t=>this.convertResult(e,t))),s}shouldShow(e){return"CONSTRUCTOR_INVOCATION"!==e.element.kind&&"FUNCTION_INVOCATION"!==e.element.kind}getDetail(e){let t="";return e.parameters&&(t+=e.parameters),e.returnType&&(t+=" â†’ "+e.returnType),t.trim()}getCodeOffset(e,t){return o.toRange(e,t.codeOffset||t.offset,t.codeLength||t.length)}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartFoldingProvider=void 0;const r=i(0);t.DartFoldingProvider=class{constructor(e){this.analyzer=e}provideFoldingRanges(e,t,i){return n(this,void 0,void 0,(function*(){if(yield this.analyzer.client.currentAnalysis,i&&i.isCancellationRequested)return;let t;for(let n=0;n<5&&(t=this.analyzer.fileTracker.getFoldingRegionsFor(e.uri),!t);n++)if(yield new Promise(e=>setTimeout(e,1e3*n).unref()),i&&i.isCancellationRequested)return;return!i.isCancellationRequested&&t?t.map(t=>new r.FoldingRange(e.positionAt(t.offset).line,e.positionAt(t.offset+t.length).line,this.getKind(t.kind))):void 0}))}getKind(e){switch(e){case"FILE_HEADER":case"DOCUMENTATION_COMMENT":return r.FoldingRangeKind.Comment;case"DIRECTIVES":return r.FoldingRangeKind.Imports}}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartFormattingEditProvider=void 0;const r=i(239),s=i(0),o=i(1),a=i(10);t.DartFormattingEditProvider=class{constructor(e,t,i){this.logger=e,this.analyzer=t,this.context=i,this.registeredFormatters=[],this.formatterRegisterFuncs=[],s.workspace.onDidChangeConfiguration(e=>{e.affectsConfiguration("dart.enableSdkFormatter")&&(a.config.enableSdkFormatter?this.registerAllFormatters():this.unregisterAllFormatters())})}registerDocumentFormatter(e){this.registerFormatter(()=>s.languages.registerDocumentFormattingEditProvider(e,this))}registerTypingFormatter(e,t,...i){this.registerFormatter(()=>s.languages.registerOnTypeFormattingEditProvider(e,this,t,...i))}registerFormatter(e){const t=()=>this.registeredFormatters.push(e());a.config.enableSdkFormatter&&t(),this.formatterRegisterFuncs.push(t)}registerAllFormatters(){for(const e of this.formatterRegisterFuncs)e()}unregisterAllFormatters(){this.registeredFormatters.forEach(e=>e.dispose()),this.registeredFormatters.length=0}provideDocumentFormattingEdits(e,t,i){return n(this,void 0,void 0,(function*(){try{return yield this.doFormat(e,!0)}catch(e){return void(this.context.hasWarnedAboutFormatterSyntaxLimitation||(this.context.hasWarnedAboutFormatterSyntaxLimitation=!0,s.window.showInformationMessage("The Dart formatter will not run if the file has syntax errors")))}}))}provideOnTypeFormattingEdits(e,t,i,r,s){return n(this,void 0,void 0,(function*(){try{return yield this.doFormat(e,!1)}catch(e){return}}))}doFormat(e,t=!0){return n(this,void 0,void 0,(function*(){if(this.shouldFormat(e))try{const t=yield this.analyzer.editFormat({file:o.fsPath(e.uri),lineLength:a.config.for(e.uri).lineLength,selectionLength:0,selectionOffset:0});return 0===t.edits.length?void 0:t.edits.map(t=>this.convertData(e,t))}catch(e){throw t&&this.logger.error(e),e}}))}shouldFormat(e){if(!e||!e.uri||"file"!==e.uri.scheme)return!1;const t=a.config.for(e.uri),i=o.fsPath(e.uri);return void 0===t.doNotFormat.find(e=>r(i,e,{dot:!0}))}convertData(e,t){return new s.TextEdit(new s.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)}dispose(){this.unregisterAllFormatters()}}},function(e,t,i){e.exports=u,u.Minimatch=d;var n={sep:"/"};try{n=i(2)}catch(e){}var r=u.GLOBSTAR=d.GLOBSTAR={},s=i(240),o={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{});var c=/\/+/;function l(e,t){e=e||{},t=t||{};var i={};return Object.keys(t).forEach((function(e){i[e]=t[e]})),Object.keys(e).forEach((function(t){i[t]=e[t]})),i}function u(e,t,i){if("string"!=typeof t)throw new TypeError("glob pattern string required");return i||(i={}),!(!i.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new d(t,i).match(e))}function d(e,t){if(!(this instanceof d))return new d(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==n.sep&&(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function h(e,t){if(t||(t=this instanceof d?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:s(e)}u.filter=function(e,t){return t=t||{},function(i,n,r){return u(i,e,t)}},u.defaults=function(e){if(!e||!Object.keys(e).length)return u;var t=u,i=function(i,n,r){return t.minimatch(i,n,l(e,r))};return i.Minimatch=function(i,n){return new t.Minimatch(i,l(e,n))},i},d.defaults=function(e){return e&&Object.keys(e).length?u.defaults(e).Minimatch:d},d.prototype.debug=function(){},d.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var i=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,i),i=this.globParts=i.map((function(e){return e.split(c)})),this.debug(this.pattern,i),i=i.map((function(e,t,i){return e.map(this.parse,this)}),this),this.debug(this.pattern,i),i=i.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,i),this.set=i},d.prototype.parseNegate=function(){var e=this.pattern,t=!1,i=this.options,n=0;if(i.nonegate)return;for(var r=0,s=e.length;r<s&&"!"===e.charAt(r);r++)t=!t,n++;n&&(this.pattern=e.substr(n));this.negate=t},u.braceExpand=function(e,t){return h(e,t)},d.prototype.braceExpand=h,d.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var i=this.options;if(!i.noglobstar&&"**"===e)return r;if(""===e)return"";var n,s="",c=!!i.nocase,l=!1,u=[],d=[],h=!1,g=-1,p=-1,m="."===e.charAt(0)?"":i.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function y(){if(n){switch(n){case"*":s+="[^/]*?",c=!0;break;case"?":s+="[^/]",c=!0;break;default:s+="\\"+n}v.debug("clearStateChar %j %j",n,s),n=!1}}for(var b,C=0,w=e.length;C<w&&(b=e.charAt(C));C++)if(this.debug("%s\t%s %s %j",e,C,s,b),l&&a[b])s+="\\"+b,l=!1;else switch(b){case"/":return!1;case"\\":y(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,C,s,b),h){this.debug("  in class"),"!"===b&&C===p+1&&(b="^"),s+=b;continue}v.debug("call clearStateChar %j",n),y(),n=b,i.noext&&y();continue;case"(":if(h){s+="(";continue}if(!n){s+="\\(";continue}u.push({type:n,start:C-1,reStart:s.length,open:o[n].open,close:o[n].close}),s+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,s),n=!1;continue;case")":if(h||!u.length){s+="\\)";continue}y(),c=!0;var S=u.pop();s+=S.close,"!"===S.type&&d.push(S),S.reEnd=s.length;continue;case"|":if(h||!u.length||l){s+="\\|",l=!1;continue}y(),s+="|";continue;case"[":if(y(),h){s+="\\"+b;continue}h=!0,p=C,g=s.length,s+=b;continue;case"]":if(C===p+1||!h){s+="\\"+b,l=!1;continue}if(h){var T=e.substring(p+1,C);try{RegExp("["+T+"]")}catch(e){var E=this.parse(T,f);s=s.substr(0,g)+"\\["+E[0]+"\\]",c=c||E[1],h=!1;continue}}c=!0,h=!1,s+=b;continue;default:y(),l?l=!1:!a[b]||"^"===b&&h||(s+="\\"),s+=b}h&&(T=e.substr(p+1),E=this.parse(T,f),s=s.substr(0,g)+"\\["+E[0],c=c||E[1]);for(S=u.pop();S;S=u.pop()){var P=s.slice(S.reStart+S.open.length);this.debug("setting tail",s,S),P=P.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,i){return i||(i="\\"),t+t+i+"|"})),this.debug("tail=%j\n   %s",P,P,S,s);var R="*"===S.type?"[^/]*?":"?"===S.type?"[^/]":"\\"+S.type;c=!0,s=s.slice(0,S.reStart)+R+"\\("+P}y(),l&&(s+="\\\\");var D=!1;switch(s.charAt(0)){case".":case"[":case"(":D=!0}for(var k=d.length-1;k>-1;k--){var x=d[k],F=s.slice(0,x.reStart),O=s.slice(x.reStart,x.reEnd-8),_=s.slice(x.reEnd-8,x.reEnd),A=s.slice(x.reEnd);_+=A;var I=F.split("(").length-1,L=A;for(C=0;C<I;C++)L=L.replace(/\)[+*?]?/,"");var N="";""===(A=L)&&t!==f&&(N="$"),s=F+O+A+N+_}""!==s&&c&&(s="(?=.)"+s);D&&(s=m+s);if(t===f)return[s,c];if(!c)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var M=i.nocase?"i":"";try{var j=new RegExp("^"+s+"$",M)}catch(e){return new RegExp("$.")}return j._glob=e,j._src=s,j};var f={};u.makeRe=function(e,t){return new d(e,t||{}).makeRe()},d.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,i=t.noglobstar?"[^/]*?":t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",n=t.nocase?"i":"",s=e.map((function(e){return e.map((function(e){return e===r?i:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src})).join("\\/")})).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,n)}catch(e){this.regexp=!1}return this.regexp},u.match=function(e,t,i){var n=new d(t,i=i||{});return e=e.filter((function(e){return n.match(e)})),n.options.nonull&&!e.length&&e.push(t),e},d.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var i=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/"));e=e.split(c),this.debug(this.pattern,"split",e);var r,s,o=this.set;for(this.debug(this.pattern,"set",o),s=e.length-1;s>=0&&!(r=e[s]);s--);for(s=0;s<o.length;s++){var a=o[s],l=e;if(i.matchBase&&1===a.length&&(l=[r]),this.matchOne(l,a,t))return!!i.flipNegate||!this.negate}return!i.flipNegate&&this.negate},d.prototype.matchOne=function(e,t,i){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,c=t.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var l,u=t[o],d=e[s];if(this.debug(t,u,d),!1===u)return!1;if(u===r){this.debug("GLOBSTAR",[t,u,d]);var h=s,f=o+1;if(f===c){for(this.debug("** at the end");s<a;s++)if("."===e[s]||".."===e[s]||!n.dot&&"."===e[s].charAt(0))return!1;return!0}for(;h<a;){var g=e[h];if(this.debug("\nglobstar while",e,h,t,f,g),this.matchOne(e.slice(h),t.slice(f),i))return this.debug("globstar found match!",h,a,g),!0;if("."===g||".."===g||!n.dot&&"."===g.charAt(0)){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!i||(this.debug("\n>>> no match, partial?",e,h,t,f),h!==a))}if("string"==typeof u?(l=n.nocase?d.toLowerCase()===u.toLowerCase():d===u,this.debug("string match",u,d,l)):(l=d.match(u),this.debug("pattern match",u,d,l)),!l)return!1}if(s===a&&o===c)return!0;if(s===a)return i;if(o===c)return s===a-1&&""===e[s];throw new Error("wtf?")}},function(e,t,i){var n=i(241),r=i(242);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,i){var s=[],o=r("{","}",t);if(!o||/\$$/.test(o.pre))return[t];var c,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(o.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(o.body),m=l||d,v=o.body.indexOf(",")>=0;if(!m&&!v)return o.post.match(/,.*\}/)?(t=o.pre+"{"+o.body+a+o.post,e(t)):[t];if(m)c=o.body.split(/\.\./);else{if(1===(c=function e(t){if(!t)return[""];var i=[],n=r("{","}",t);if(!n)return t.split(",");var s=n.pre,o=n.body,a=n.post,c=s.split(",");c[c.length-1]+="{"+o+"}";var l=e(a);a.length&&(c[c.length-1]+=l.shift(),c.push.apply(c,l));return i.push.apply(i,c),i}(o.body)).length)if(1===(c=e(c[0],!1).map(h)).length)return(C=o.post.length?e(o.post,!1):[""]).map((function(e){return o.pre+c[0]+e}))}var y,b=o.pre,C=o.post.length?e(o.post,!1):[""];if(m){var w=u(c[0]),S=u(c[1]),T=Math.max(c[0].length,c[1].length),E=3==c.length?Math.abs(u(c[2])):1,P=g;S<w&&(E*=-1,P=p);var R=c.some(f);y=[];for(var D=w;P(D,S);D+=E){var k;if(d)"\\"===(k=String.fromCharCode(D))&&(k="");else if(k=String(D),R){var x=T-k.length;if(x>0){var F=new Array(x+1).join("0");k=D<0?"-"+F+k.slice(1):F+k}}y.push(k)}}else y=n(c,(function(t){return e(t,!1)}));for(var O=0;O<y.length;O++)for(var _=0;_<C.length;_++){var A=b+y[O]+C[_];(!i||m||A)&&s.push(A)}return s}(function(e){return e.split("\\\\").join(s).split("\\{").join(o).split("\\}").join(a).split("\\,").join(c).split("\\.").join(l)}(e),!0).map(d)};var s="\0SLASH"+Math.random()+"\0",o="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(s).join("\\").split(o).join("{").split(a).join("}").split(c).join(",").split(l).join(".")}function h(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function g(e,t){return e<=t}function p(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var n=[],r=0;r<e.length;r++){var s=t(e[r],r);i(s)?n.push.apply(n,s):n.push(s)}return n};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,i){"use strict";function n(e,t,i){e instanceof RegExp&&(e=r(e,i)),t instanceof RegExp&&(t=r(t,i));var n=s(e,t,i);return n&&{start:n[0],end:n[1],pre:i.slice(0,n[0]),body:i.slice(n[0]+e.length,n[1]),post:i.slice(n[1]+t.length)}}function r(e,t){var i=t.match(e);return i?i[0]:null}function s(e,t,i){var n,r,s,o,a,c=i.indexOf(e),l=i.indexOf(t,c+1),u=c;if(c>=0&&l>0){for(n=[],s=i.length;u>=0&&!a;)u==c?(n.push(u),c=i.indexOf(e,u+1)):1==n.length?a=[n.pop(),l]:((r=n.pop())<s&&(s=r,o=l),l=i.indexOf(t,u+1)),u=c<l&&c>=0?c:l;n.length&&(a=[s,o])}return a}e.exports=n,n.range=s},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartDocumentHighlightProvider=void 0;const n=i(0);t.DartDocumentHighlightProvider=class{constructor(e){this.fileTracker=e}provideDocumentHighlights(e,t,i){const r=e.offsetAt(t),s=this.fileTracker.getOccurrencesFor(e.uri);if(s)for(const t of s)if(t.offsets.find(e=>e<=r&&e+t.length>=r))return t.offsets.map(i=>new n.DocumentHighlight(new n.Range(e.positionAt(i),e.positionAt(i+t.length))))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartHoverProvider=void 0;const r=i(0),s=i(1),o=i(19);t.DartHoverProvider=class{constructor(e,t){this.logger=e,this.analyzer=t}provideHover(e,t,i){return n(this,void 0,void 0,(function*(){try{const n=yield this.analyzer.analysisGetHover({file:s.fsPath(e.uri),offset:e.offsetAt(t)});if(i.isCancellationRequested||0===n.hovers.length)return;const o=n.hovers[0],a=this.getHoverData(e.uri,o);if(!a)return;const c=new r.Range(e.positionAt(o.offset),e.positionAt(o.offset+o.length));return new r.Hover([{language:"dart",value:a.displayString},a.documentation||void 0],c.isSingleLine?c:void 0)}catch(e){this.logger.error(e)}}))}getHoverData(e,t){if(!t.elementDescription)return;if("import prefix"===t.elementKind)return;const i=t.elementDescription,n=t.dartdoc,r=t.propagatedType;let s="";i&&(s+=(t.isDeprecated?"(deprecated) ":"")+i+"\n"),r&&(s+="propogated type: "+r.trim());let a=o.cleanDartdoc(n);if(this.analyzer.capabilities.hasNewHoverLibraryFormat)t.containingLibraryName&&(a=`*${t.containingLibraryName}*\n\n`+a);else{const e=t.containingLibraryName;e&&(a=`*${e}*\n\n`+a)}return{displayString:s.trim(),documentation:a.trim()}}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartImplementationProvider=void 0;const r=i(0),s=i(3),o=i(1),a=i(6),c=i(120);t.DartImplementationProvider=class{constructor(e){this.analyzer=e}provideImplementation(e,t,i){return n(this,void 0,void 0,(function*(){const n=c.findNearestOutlineNode(this.analyzer.fileTracker,e,t,!0),l=n&&n.element&&n.element.location?n.element.location.offset:e.offsetAt(t),u=yield this.analyzer.client.searchGetTypeHierarchy({file:o.fsPath(e.uri),offset:l});if(i.isCancellationRequested||!u||!u.hierarchyItems||!u.hierarchyItems.length||1===u.hierarchyItems.length)return;const d=u.hierarchyItems.find(e=>{const t=e.memberElement||e.classElement;return t.location&&t.location.offset<=l&&t.location.offset+t.location.length>=l})||u.hierarchyItems[0],h=!d.memberElement;const f=function e(t){return[...t.subclasses.map(e=>u.hierarchyItems[e]),...s.flatMap(t.subclasses,t=>e(u.hierarchyItems[t]))]}(d).map(e=>h?e.classElement:e.memberElement).filter(s.notUndefined),g=[];for(const e of f){if(!e.location)continue;const t=a.toRange(yield r.workspace.openTextDocument(e.location.file),e.location.offset,e.location.length);g.push(new r.Location(r.Uri.file(e.location.file),t))}return g}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartLanguageConfiguration=void 0;const n=i(0);t.DartLanguageConfiguration=class{constructor(){this.onEnterRules=[{action:{indentAction:n.IndentAction.None,appendText:"/// "},beforeText:/^\s*\/\/\/ /},{action:{indentAction:n.IndentAction.None,appendText:"///"},beforeText:/^\s*\/\/\//},{action:{indentAction:n.IndentAction.IndentOutdent,appendText:" * "},afterText:/^\s*\*\/$/,beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:n.IndentAction.None,appendText:" * "},beforeText:/^\s*\/\*\*(?!\/)([^\*]|\*(?!\/))*$/},{action:{indentAction:n.IndentAction.None,appendText:"* "},beforeText:/^(\t|(\ \ ))*\ \*(\ ([^\*]|\*(?!\/))*)?$/},{action:{indentAction:n.IndentAction.None,removeText:1},beforeText:/^(\t|(\ \ ))*\ \*\/\s*$/}]}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartReferenceProvider=void 0;const r=i(0),s=i(3),o=i(1),a=i(6);t.DartReferenceProvider=class{constructor(e){this.analyzer=e}provideReferences(e,t,i,s){return n(this,void 0,void 0,(function*(){const n=i.includeDeclaration?yield this.provideDefinition(e,t,s):void 0,c=yield this.analyzer.searchFindElementReferencesResults({file:o.fsPath(e.uri),includePotential:!0,offset:e.offsetAt(t)});if(s&&s.isCancellationRequested)return;const l=c.results.map(e=>new r.Location(r.Uri.file(e.location.file),a.toRangeOnLine(e.location)));return n?l.concat(n.map(e=>new r.Location(e.targetUri,e.targetRange))):l}))}provideDefinition(e,t,i){return n(this,void 0,void 0,(function*(){const n=yield this.analyzer.analysisGetNavigation({file:o.fsPath(e.uri),length:0,offset:e.offsetAt(t)});if(i&&i.isCancellationRequested)return;const c=s.flatMap(n.regions,t=>t.targets.map(i=>{const s=n.targets[i];return 0===s.startColumn&&(s.startColumn=1),{originSelectionRange:a.toRange(e,t.offset,t.length),targetRange:a.toRangeOnLine(s),targetUri:r.Uri.file(n.files[s.fileIndex])}})),l=c.filter(i=>o.fsPath(i.targetUri)!==o.fsPath(e.uri)||i.targetRange.start.line!==t.line);return l.length?l:c}))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartRenameProvider=void 0;const r=i(0),s=i(1),o=i(6),a=i(61);t.DartRenameProvider=class{constructor(e){this.analyzer=e}provideRenameEdits(e,t,i,n){return this.doRename(e,t,i,n)}prepareRename(e,t,i){return this.getLocation(e,t,i)}doRename(e,t,i,o){return n(this,void 0,void 0,(function*(){const n=a.getChannel("Refactorings");n.appendLine("");const c=yield this.analyzer.editGetRefactoring({file:s.fsPath(e.uri),kind:"RENAME",length:1,offset:e.offsetAt(t),options:{newName:i},validateOnly:!1});if(o&&o.isCancellationRequested)return void n.appendLine("[INFO] Rename cancelled.");const l=new r.WorkspaceEdit;c.change&&c.change.message&&n.appendLine(`[INFO] ${c.change.message}â€¦`),this.handleProblem(c.initialProblems.concat(c.optionsProblems).concat(c.finalProblems),n);const u=[];if(c.change&&c.change.edits.forEach(e=>{e.edits.forEach(t=>{const i=r.Uri.file(e.file),n=r.workspace.openTextDocument(i);u.push(n.then(e=>l.replace(i,new r.Range(e.positionAt(t.offset),e.positionAt(t.offset+t.length)),t.replacement)))})}),yield Promise.all(u),!o||!o.isCancellationRequested)return n.appendLine("[INFO] Rename successful."),l;n.appendLine("[INFO] Rename cancelled.")}))}handleProblem(e,t){e.forEach(e=>t.appendLine(`[${e.severity}] ${e.message}`));const i=e.filter(e=>"INFO"!==e.severity&&"WARNING"!==e.severity).sort((e,t)=>t.severity.localeCompare(e.severity));if(0!==i.length)throw t.appendLine("[INFO] Rename aborted."),i[0].message}getLocation(e,t,i){return n(this,void 0,void 0,(function*(){const n=yield this.analyzer.editGetRefactoring({file:s.fsPath(e.uri),kind:"RENAME",length:0,offset:e.offsetAt(t),validateOnly:!0});if(i&&i.isCancellationRequested)return;if(!n.feedback)throw new Error("You cannot rename this element.");const a=n.feedback,c=-1===a.offset?new r.Range(t,t):o.toRange(e,a.offset,a.length);if(a)return{placeholder:a.oldName,range:c};{const e=n.initialProblems.concat(n.optionsProblems).concat(n.finalProblems).filter(e=>"FATAL"===e.severity);throw e&&e.length?new Error(e[0].message):new Error("This rename is not supported.")}}))}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartSignatureHelpProvider=void 0;const r=i(0),s=i(1),o=i(19);t.DartSignatureHelpProvider=class{constructor(e){this.analyzer=e}provideSignatureHelp(e,t,i){return n(this,void 0,void 0,(function*(){try{const n=yield this.analyzer.analysisGetSignature({file:s.fsPath(e.uri),offset:e.offsetAt(t)});if(i&&i.isCancellationRequested)return;const a=new r.SignatureInformation(this.getSignatureLabel(n),new r.MarkdownString(o.cleanDartdoc(n.dartdoc)));a.parameters=n.parameters.map(e=>new r.ParameterInformation(this.getLabel(e)));const c=new r.SignatureHelp;return c.signatures=[a],c.activeSignature=0,c.activeParameter=-1,c}catch(e){return}}))}getSignatureLabel(e){const t=e.parameters.filter(e=>"REQUIRED"===e.kind),i=e.parameters.filter(e=>"OPTIONAL"===e.kind),n=e.parameters.filter(e=>"NAMED"===e.kind),r=[];return t.length&&r.push(t.map(this.getLabel).join(", ")),i.length&&r.push("["+i.map(this.getLabel).join(", ")+"]"),n.length&&r.push("{"+n.map(this.getLabel).join(", ")+"}"),`${e.name}(${r.join(", ")})`}getLabel(e){const t=e.defaultValue?" = "+e.defaultValue:"";return`${e.type} ${e.name}${t}`}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DartWorkspaceSymbolProvider=void 0;const r=i(0),s=i(6),o=i(48);t.DartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t,this.badChars=new RegExp("[^0-9a-z-]","gi")}provideWorkspaceSymbols(e,t){return n(this,void 0,void 0,(function*(){if(0===e.length)return;const i=".*"+e.replace(this.badChars,"").split("").map(e=>`[${e.toUpperCase()}${e.toLowerCase()}]`).join(".*")+".*",n=yield this.analyzer.searchGetElementDeclarations({pattern:i,maxResults:500});return t&&t.isCancellationRequested?void 0:n.declarations.map(e=>this.convertWorkspaceResult(e,n.files[e.fileIndex]))}))}resolveWorkspaceSymbol(e,t){return n(this,void 0,void 0,(function*(){if(!(e instanceof a))return;const t=yield r.workspace.openTextDocument(r.Uri.file(e.locationData.file));return e.location=new r.Location(t.uri,s.toRange(t,e.locationData.offset,e.locationData.length)),e}))}convertWorkspaceResult(e,t){const i=e.parameters?"()"===e.parameters?"()":"(â€¦)":"";return new a(e.name+i,o.getSymbolKindForElementKind(this.logger,e.kind),e.className||"",new r.Location(r.Uri.file(t),void 0),{file:t,length:e.codeLength,offset:e.codeOffset||e.offset})}};class a extends r.SymbolInformation{constructor(e,t,i,n,r){super(e,t,i,n),this.locationData=r}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DartDebugAdapterDescriptorFactory=void 0;const n=i(0),r=i(4),s=i(252);t.DartDebugAdapterDescriptorFactory=class{constructor(e){this.extensionContext=e}createDebugAdapterDescriptor(e,t){const i=s.getDebugAdapterName(e.configuration.debuggerType);return process.env.DART_CODE_USE_DEBUG_SERVERS?new n.DebugAdapterServer(s.getDebugAdapterPort(i)):new n.DebugAdapterExecutable("node",[this.extensionContext.asAbsolutePath(r.debugAdapterPath),i])}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDebugAdapterPort=t.getDebugAdapterName=void 0;const n=i(8);t.getDebugAdapterName=function(e){let t;switch(e){case n.DebuggerType.Flutter:t="flutter";break;case n.DebuggerType.FlutterTest:t="flutter_test";break;case n.DebuggerType.Web:t="web";break;case n.DebuggerType.WebTest:t="web_test";break;case n.DebuggerType.Dart:t="dart";break;case n.DebuggerType.PubTest:t="dart_test";break;default:throw new Error("Unknown debugger type: "+e)}return t},t.getDebugAdapterPort=function(e){const t=["flutter","flutter_test","web","web_test","dart","dart_test"].indexOf(e);if(-1===t)throw new Error("Unknown debugger type: "+e);return 4711+t}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DynamicDebugConfigProvider=t.InitialLaunchJsonDebugConfigProvider=t.DebugConfigProvider=void 0;const r=i(5),s=i(2),o=i(0),a=i(0),c=i(4),l=i(8),u=i(3),d=i(1),h=i(6),f=i(99),g=i(121),p=i(10),m=i(49),v=i(254),y=i(7),b=i(15),C=i(129);process.env.CI;t.DebugConfigProvider=class{constructor(e,t,i,n,r,s,o,a){this.logger=e,this.wsContext=t,this.analytics=i,this.pubGlobal=n,this.daemon=r,this.deviceManager=s,this.dartCapabilities=o,this.flutterCapabilities=a}resolveDebugConfiguration(e,t,i){return t.type=t.type||"dart",t.request=t.request||"launch",t}resolveDebugConfigurationWithSubstitutedVariables(e,t,i){var u,g,v;return n(this,void 0,void 0,(function*(){const n=this.logger,b=a.window.activeTextEditor&&a.window.activeTextEditor.document&&"file"===a.window.activeTextEditor.document.uri.scheme?d.fsPath(a.window.activeTextEditor.document.uri):void 0;function w(e,t){if(!t)return!1;const i=function(e){if(!e)return;const t=/\${\w+}/.exec(e);return t?t[0]:void 0}(t);return!!i&&(n.error(`Launch config property '${e}' has unresolvable variable ${i}`),a.window.showErrorMessage(`Launch config property '${e}' has unresolvable variable ${i}`),!0)}if(n.info("Starting debug session..."),e&&n.info("    workspace: "+d.fsPath(e.uri)),t.program&&n.info("    program  : "+t.program),t.cwd&&n.info("    cwd      : "+t.cwd),w("program",t.program)||w("cwd",t.cwd))return null;b&&!e?(e=a.workspace.getWorkspaceFolder(a.Uri.file(b)))&&n.info("Setting workspace based on open file: "+d.fsPath(e.uri)):!e&&o.workspace.workspaceFolders&&1===o.workspace.workspaceFolders.length&&(e=o.workspace.workspaceFolders[0])&&n.info("Setting workspace based on single open workspace: "+d.fsPath(e.uri)),t.cwd&&!s.isAbsolute(t.cwd)&&e&&(t.cwd=s.join(d.fsPath(e.uri),t.cwd),n.info("Converted cwd to absolute path: "+t.cwd)),t.program&&!s.isAbsolute(t.program)&&(t.cwd||e)&&(t.program=s.join(t.cwd||d.fsPath(e.uri),t.program),n.info("Converted program to absolute path: "+t.program));const S="attach"===t.request;if(!S){if(!t.program){const i=t.cwd?t.cwd:e?d.fsPath(e.uri):void 0,n=!i||b&&d.isWithinPath(b,i)?b:void 0;t.program=t.program||this.guessBestEntryPoint(n,i)}if(!t.program){n.warn("No program was set in launch config");const e=this.wsContext.hasAnyFlutterProjects?"lib/main.dart":"bin/main.dart";return a.window.showInformationMessage(`Set the 'program' value in your launch config (eg '${e}') then launch again`),null}}if(!t.cwd&&e&&(t.cwd=d.fsPath(e.uri),n.info("Using workspace as cwd: "+t.cwd),t.program)){const i=m.locateBestProjectRoot(t.program);i&&d.isWithinPath(i,d.fsPath(e.uri))&&(t.cwd=i,n.info("Found better project root to use as cwd: "+t.cwd))}t.program&&t.cwd&&!s.isAbsolute(t.program)&&(t.program=s.join(t.cwd,t.program)),t.program&&s.isAbsolute(t.program)&&!r.existsSync(t.program)&&(n.warn("Launch config references non-existant file "+t.program),a.window.showWarningMessage('Your launch config references a program that does not exist. If you have problems launching, check the "program" field in your ".vscode/launch.json" file.'));let T=l.DebuggerType.Dart;!t.cwd||y.isInsideFolderNamed(t.program,"bin")||y.isInsideFolderNamed(t.program,"tool")||y.isInsideFolderNamed(t.program,".dart_tool")||(y.isFlutterProjectFolder(t.cwd)?T=l.DebuggerType.Flutter:y.isInsideFolderNamed(t.program,"web")&&!y.isInsideFolderNamed(t.program,"test")?T=l.DebuggerType.Web:n.info(`Project (${t.program}) not recognised as Flutter or Web, will use Dart debugger`)),n.info("Detected launch project as "+l.DebuggerType[T]);const E=T===l.DebuggerType.Flutter||T===l.DebuggerType.Web,P=T===l.DebuggerType.Flutter,R=t.program&&y.isTestFileOrFolder(t.program),D=R&&t.args&&(-1!==t.args.indexOf("--name")||-1!==t.args.indexOf("--pname"));R&&n.info("Detected launch project as a Test project");const k=R&&t.cwd&&y.projectShouldUsePubForTests(t.cwd,this.wsContext.config);if(R&&!k&&n.info("Project does not appear to support 'pub run test', will use VM directly"),R)switch(T){case l.DebuggerType.Dart:k&&(T=l.DebuggerType.PubTest);break;case l.DebuggerType.Flutter:!t.runTestsOnDevice||D?(t.runTestsOnDevice&&D&&(o.window.showWarningMessage("Running with 'flutter test' as 'runTestsOnDevice' is not supported for individual tests."),n.info("runTestsOnDevice is set but args have test filter so will still use Flutter")),T=l.DebuggerType.FlutterTest):n.info("runTestsOnDevice is set, so will use Flutter instead of FlutterTest");break;case l.DebuggerType.Web:T=l.DebuggerType.WebTest;break;default:n.info("Unknown debugType, unable to switch to test debugger")}if(n.info(`Using ${l.DebuggerType[T]} debug adapter for this session`),T===l.DebuggerType.FlutterTest&&y.isInsideFolderNamed(t.program,"test_driver")&&!(null===(u=t.env)||void 0===u?void 0:u.VM_SERVICE_URL)){const e=f.debugSessions.filter(e=>-1!==e.loadedServiceExtensions.indexOf(l.VmServiceExtension.Driver));if(0===e.length)return this.errorWithoutOpeningLaunchConfig("Could not find a running Flutter app that was instrumented with enableFlutterDriverExtension. Run your instrumented app before running driver tests.");if(e.length>1)return this.errorWithoutOpeningLaunchConfig("More than one Flutter app instrumented with enableFlutterDriverExtension is running. Please run only one app before running driver tests.");{const i=e[0];if(!i.vmServiceUri)return this.errorWithoutOpeningLaunchConfig("The Flutter app instrumented with enableFlutterDriverExtension is not fully initialised yet.");yield i.session.customRequest("hotRestart"),t.env=t.env||{},t.env.VM_SERVICE_URL=i.vmServiceUri}}if(T===l.DebuggerType.WebTest)return n.error("Tests in web projects are not currently supported"),void a.window.showErrorMessage("Tests in web projects are not currently supported");if(T===l.DebuggerType.FlutterTest&&y.isTestFolder(t.program)&&!t.noDebug&&(n.warn("Setting noDebug=true for Flutter test run because it's a folder"),t.noDebug=!0),S&&!t.serviceInfoFile&&(P||(t.vmServiceUri=yield this.getFullVmServiceUri(t.vmServiceUri||t.observatoryUri)),!t.vmServiceUri&&!P))return n.warn("No VM service URI/port was provided"),void a.window.showInformationMessage("You must provide a VM service URI/port to attach a debugger");if(i&&i.isCancellationRequested)return;let x=(null===(g=this.deviceManager)||void 0===g?void 0:g.getDevice(t.deviceId))||(null===(v=this.deviceManager)||void 0===v?void 0:v.currentDevice);if(T===l.DebuggerType.Flutter&&this.deviceManager&&this.daemon&&"flutter-tester"!==t.deviceId){let e=this.daemon.capabilities.providesPlatformTypes&&t.cwd?(yield this.daemon.getSupportedPlatforms(t.cwd)).platforms:[];if(this.deviceManager.isSupported(e,x)||(x=yield this.deviceManager.showDevicePicker(e)),e=this.daemon.capabilities.providesPlatformTypes&&t.cwd?(yield this.daemon.getSupportedPlatforms(t.cwd)).platforms:[],!this.deviceManager.isSupported(e,x))return n.warn("Unable to launch due to no active device"),void a.window.showInformationMessage("Cannot launch without an active device")}if(i&&i.isCancellationRequested)return;if(!(yield this.installDependencies(T,this.pubGlobal)))return;if(i&&i.isCancellationRequested)return;if(this.setupDebugConfig(e,t,E,x,this.deviceManager),t.program=d.forceWindowsDriveLetterToUppercase(t.program),t.cwd=d.forceWindowsDriveLetterToUppercase(t.cwd),!S&&t.cwd&&p.config.promptToRunIfErrors){n.info("Checking for errors before launching");const e=e=>"dart"===e.source&&e.severity===o.DiagnosticSeverity.Error,i=o.languages.getDiagnostics().filter(t=>t[1].find(e)).find(e=>{const i=d.fsPath(e[0]);return d.isWithinPath(i,t.cwd)&&(!y.isInsideFolderNamed(i,"test")||i===t.program)});if(i){n.warn("Project has errors, prompting user");const t=i[1].find(e),r=t.range;n.warn(`    ${d.fsPath(i[0])}:${r.start.line}:${r.start.character}`),n.warn("    "+t.message.split("\n")[0].trim());const s=yield a.window.showErrorMessage("Build errors exist in your project.",{modal:!0},c.debugAnywayAction,c.showErrorsAction);if(s!==c.debugAnywayAction)return n.info("Aborting!"),void(s===c.showErrorsAction&&o.commands.executeCommand("workbench.action.showErrorsWarnings"));n.info("Debugging anyway!")}}if(i&&i.isCancellationRequested)return;return!(!(!t.cwd||!s.isAbsolute(t.cwd))&&h.warnIfPathCaseMismatch(n,t.cwd,"the launch script working directory","check the 'cwd' field in your launch configuration file (.vscode/launch.json)"))&&t.program&&s.isAbsolute(t.program)&&h.warnIfPathCaseMismatch(n,t.program,"the launch script","check the 'program' field in your launch configuration file (.vscode/launch.json)"),this.analytics.logDebuggerStart(e&&e.uri,l.DebuggerType[T],t.noDebug?"Run":"Debug"),T!==l.DebuggerType.FlutterTest&&T!==l.DebuggerType.PubTest||C.TestResultsProvider.flagSuiteStart(t.program,!D),t.debuggerType=T,n.info("Debug session starting...\n    "+JSON.stringify(t,void 0,4).replace(/\n/g,"\n    ")),f.LastDebugSession.workspaceFolder=e,f.LastDebugSession.debugConfig=Object.assign({},t),o.commands.executeCommand("setContext",c.HAS_LAST_DEBUG_CONFIG,!0),R&&(f.LastTestDebugSession.workspaceFolder=e,f.LastTestDebugSession.debugConfig=Object.assign({},t),o.commands.executeCommand("setContext",c.HAS_LAST_TEST_DEBUG_CONFIG,!0)),t}))}errorWithoutOpeningLaunchConfig(e){this.logger.error(e),a.window.showErrorMessage(e)}installDependencies(e,t){return e!==l.DebuggerType.Web||new v.WebDev(t).promptToInstallIfRequired()}guessBestEntryPoint(e,t){if(y.isValidEntryFile(e))return this.logger.info("Using open file as entry point: "+e),e;const i=e&&m.locateBestProjectRoot(e)||t;if(!i)return;const n=[s.join(i,"lib","main.dart"),s.join(i,"bin","main.dart")];for(const e of n)if(r.existsSync(e))return this.logger.info("Using found common entry point: "+e),e;return r.existsSync(s.join(i,"bin"))||r.existsSync(s.join(i,"web"))||!r.existsSync(s.join(i,"example"))?void 0:this.guessBestEntryPoint(void 0,s.join(i,"example"))}getFullVmServiceUri(e){return n(this,void 0,void 0,(function*(){return(e=(e=e||(yield o.commands.executeCommand("dart.promptForVmService")))&&e.trim())&&/^[0-9]+$/.exec(e)&&(e="http://127.0.0.1:"+e),e}))}setupDebugConfig(e,t,i,n,r){const o=p.config.for(e&&e.uri);t.name||(i&&t.deviceId?t.name=`Flutter (${t.deviceId})`:t.name=i&&n?`Flutter (${r?r.labelForDevice(n):n.name})`:i?"Flutter":"Dart"),t.dartVersion=this.dartCapabilities.version,t.toolEnv=b.getToolEnv(),t.sendLogsToClient=!0,t.cwd=t.cwd||e&&d.fsPath(e.uri),t.args=t.args||[],t.vmAdditionalArgs=t.vmAdditionalArgs||o.vmAdditionalArgs,t.vmServicePort=t.vmServicePort||(c.isChromeOS&&p.config.useKnownChromeOSPorts?c.CHROME_OS_VM_SERVICE_PORT:0),t.dartPath=t.dartPath||s.join(this.wsContext.sdks.dart,c.dartVMPath),t.vmServiceLogFile=this.insertSessionName(t,t.vmServiceLogFile||o.vmServiceLogFile),t.webDaemonLogFile=this.insertSessionName(t,t.webDaemonLogFile||o.webDaemonLogFile),t.maxLogLineLength=t.maxLogLineLength||p.config.maxLogLineLength,t.pubPath=t.pubPath||s.join(this.wsContext.sdks.dart,c.pubPath),t.pubSnapshotPath=t.pubSnapshotPath||s.join(this.wsContext.sdks.dart,c.pubSnapshotPath),t.pubTestLogFile=this.insertSessionName(t,t.pubTestLogFile||o.pubTestLogFile),t.debugSdkLibraries=void 0!==t.debugSdkLibraries&&null!==t.debugSdkLibraries?t.debugSdkLibraries:!!p.config.debugSdkLibraries,t.debugExternalLibraries=void 0!==t.debugExternalLibraries&&null!==t.debugExternalLibraries?t.debugExternalLibraries:p.config.debugExternalLibraries,t.showDartDeveloperLogs=o.showDartDeveloperLogs,t.evaluateGettersInDebugViews=t.evaluateGettersInDebugViews||o.evaluateGettersInDebugViews,t.evaluateToStringInDebugViews=t.evaluateToStringInDebugViews||p.config.evaluateToStringInDebugViews,i&&this.wsContext.sdks.flutter&&(t.globalFlutterArgs=b.getGlobalFlutterArgs(),t.useFlutterStructuredErrors=o.flutterStructuredErrors,t.debugExtensionBackendProtocol=p.config.debugExtensionBackendProtocol,t.flutterVersion=this.flutterCapabilities.version,t.args=o.flutterAdditionalArgs.concat(t.args),t.forceFlutterVerboseMode=g.isLogging,t.flutterTrackWidgetCreation=void 0!==t.flutterTrackWidgetCreation&&null!==t.flutterTrackWidgetCreation?t.flutterTrackWidgetCreation:o.flutterTrackWidgetCreation,t.flutterMode=t.flutterMode||"debug",t.flutterPlatform=t.flutterPlatform||"default",t.flutterPath=t.flutterPath||s.join(this.wsContext.sdks.flutter,c.flutterPath),t.workspaceConfig=this.wsContext.config,t.flutterRunLogFile=this.insertSessionName(t,t.flutterRunLogFile||o.flutterRunLogFile),t.flutterTestLogFile=this.insertSessionName(t,t.flutterTestLogFile||o.flutterTestLogFile),!t.deviceId&&n&&(t.deviceId=n.id,t.deviceName=`${r?r.labelForDevice(n):n.name} (${n.platform})`),t.showMemoryUsage=t.showMemoryUsage||!1===t.showMemoryUsage?t.showMemoryUsage:"profile"===t.flutterMode)}insertSessionName(e,t){return t?t.replace(/\${name}/,u.filenameSafe(e.name||"unnamed-session")):t}};t.InitialLaunchJsonDebugConfigProvider=class{provideDebugConfigurations(e,t){return n(this,void 0,void 0,(function*(){const t=e?d.fsPath(e.uri):void 0,i=t?yield d.findProjectFolders([t],{requirePubspec:!0}):[];return i.length?i.map(e=>{const i=t&&s.relative(t,e)||void 0;return{name:s.basename(e),cwd:i,request:"launch",type:"dart"}}):[{name:"Dart & Flutter",request:"launch",type:"dart"}]}))}};t.DynamicDebugConfigProvider=class{provideDebugConfigurations(e,t){return n(this,void 0,void 0,(function*(){const t=[],i=e?d.fsPath(e.uri):void 0,n=i?yield d.findProjectFolders([i],{requirePubspec:!0}):[];for(const o of n){const n=y.isFlutterProjectFolder(o),a=s.basename(o),c=i&&s.relative(i,o)||void 0,l=t=>e&&r.existsSync(s.join(o,t));n&&l("lib/main.dart")&&t.push({name:a+" (Flutter)",program:"lib/main.dart",cwd:c,request:"launch",type:"dart"}),!n&&l("web")&&t.push({name:a+" (Dart Web)",program:"web",cwd:c,request:"launch",type:"dart"}),l("bin/main.dart")&&t.push({name:a+" (Dart)",program:"bin/main.dart",cwd:c,request:"launch",type:"dart"}),l("test")&&t.push({name:`${a} (${n?"Flutter":"Dart"} Tests)`,program:"test",cwd:c,request:"launch",type:"dart"})}return t}))}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebDev=void 0;t.WebDev=class{constructor(e){this.pubGlobal=e}promptToInstallIfRequired(){return this.pubGlobal.promptToInstallIfRequired("webdev","webdev",void 0,"2.5.4")}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.FixCodeActionProvider=void 0;const r=i(0),s=i(1),o=i(7),a=i(102),c=i(101);t.FixCodeActionProvider=class{constructor(e,t,i){this.logger=e,this.selector=t,this.analyzer=i,this.rank=1,this.metadata={providedCodeActionKinds:[r.CodeActionKind.QuickFix]}}provideCodeActions(e,t,i,a){return n(this,void 0,void 0,(function*(){if(o.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||r.CodeActionKind.QuickFix.contains(i.only)))try{const n="active"in t?t.active:t.start,r=yield this.analyzer.editGetFixes({file:s.fsPath(e.uri),offset:e.offsetAt(n)});if(a&&a.isCancellationRequested)return;const o={};for(const t of r.fixes)for(const i of t.fixes)o[JSON.stringify(i.edits)]=this.convertResult(e,i,t.error);const c=Object.keys(o).map(e=>o[e]);return i.only?c.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):c}catch(e){throw this.logger.error(e),e}}))}convertResult(e,t,i){const n=t.message,s=i?[a.DartDiagnosticProvider.createDiagnostic(i)]:void 0,o=c.getKindFor(t.id,r.CodeActionKind.QuickFix),l=new r.CodeAction(n,o);return l.command={arguments:[e,t],command:"_dart.applySourceChange",title:n},l.diagnostics=s,l}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IgnoreLintCodeActionProvider=void 0;const n=i(0),r=i(10),s=i(7),o=i(102);t.IgnoreLintCodeActionProvider=class{constructor(e){this.selector=e,this.rank=100,this.metadata={providedCodeActionKinds:[n.CodeActionKind.QuickFix]}}provideCodeActions(e,t,i,a){if(!s.isAnalyzableAndInWorkspace(e))return;if(i&&i.only&&!n.CodeActionKind.QuickFix.contains(i.only))return;if(!(r.config.showIgnoreQuickFixes&&i&&i.diagnostics&&i.diagnostics.length))return;const c=i.diagnostics.filter(e=>e.range.intersection(t)&&(e instanceof o.DartDiagnostic&&("LINT"===e.type||"HINT"===e.type)||"dart"===e.source&&e.severity===n.DiagnosticSeverity.Information));return c.length?c.map(t=>this.convertResult(e,t)):void 0}convertResult(e,t){const i=t instanceof o.DartDiagnostic?t.type.toLowerCase()+" ":"",r=t.code||"",s="string"==typeof r?r:r.value,a=new n.WorkspaceEdit,c=e.lineAt(t.range.start.line);a.insert(e.uri,c.range.start,`${" ".repeat(c.firstNonWhitespaceCharacterIndex)}// ignore: ${s}\n`);const l=`Ignore ${i}'${s}' for this line`,u=new n.CodeAction(l,n.CodeActionKind.QuickFix);return u.edit=a,u}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyDartWorkspaceSymbolProvider=void 0;const r=i(2),s=i(0),o=i(1),a=i(6),c=i(48),l=i(7);t.LegacyDartWorkspaceSymbolProvider=class{constructor(e,t){this.logger=e,this.analyzer=t}provideWorkspaceSymbols(e,t){return n(this,void 0,void 0,(function*(){if(0===e.length)return;e=this.sanitizeUserQuery(e);const t=this.makeCaseInsensitiveFuzzyRegex(e),i=yield Promise.all([this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t}),this.analyzer.searchFindMemberDeclarationsResults({name:t})]);return this.combineResults(i)}))}combineResults(e){return e[0].results.concat(e[1].results).filter(e=>this.shouldIncludeResult(e)).map(e=>this.convertResult(e))}searchTopLevelSymbols(e){return n(this,void 0,void 0,(function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindTopLevelDeclarationsResults({pattern:t})).results}))}searchMemberDeclarations(e){return n(this,void 0,void 0,(function*(){const t=this.makeCaseInsensitiveFuzzyRegex(e);return(yield this.analyzer.searchFindMemberDeclarationsResults({name:t})).results}))}sanitizeUserQuery(e){let t=Array.from(e);return t=t.filter(e=>-1==="[](){}\\|./<>?+".indexOf(e)),t.join("")}makeCaseInsensitiveFuzzyRegex(e){let t=Array.from(e);t=t.map(e=>e.toUpperCase()===e.toLowerCase()?e:`[${e.toUpperCase()}${e.toLowerCase()}]`);return`.*${t.join(".*")}.*`}shouldIncludeResult(e){const t=e.path[0].name.startsWith("_")||e.path[1].name.startsWith("_");return l.isWithinWorkspace(e.location.file)||!t}convertResult(e){const t=this.createDisplayPath(e.location.file);let i=e.path.slice(0,e.path.length-2).reverse().map(e=>e.name).join(".");"SETTER"===e.path[0].kind&&(i+=" set"),"GETTER"===e.path[0].kind&&(i+=" get");const n=e.path[0].parameters&&"SETTER"!==e.path[0].kind?e.path[0].parameters:"";return new s.SymbolInformation(i+n,c.getSymbolKindForElementKind(this.logger,e.path[0].kind),t||"",new s.Location(s.Uri.file(e.location.file),a.toRangeOnLine(e.location)))}createDisplayPath(e){if(!e)return;const t="hosted"+r.sep+"pub.dartlang.org",i=e.indexOf(t);if(i>-1){const n=e.substring(i+t.length+1).split(r.sep);n[0]=n[0].split("-")[0],"lib"===n[1]&&n.splice(1,1),e=`package:${n[0]}/${n.slice(1).join("/")}`}else{const t=s.workspace.getWorkspaceFolder(s.Uri.file(e));e=t&&r.relative(o.fsPath(t.uri),e)}return e}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.RefactorCodeActionProvider=void 0;const r=i(0),s=i(3),o=i(1),a=i(7),c={CONVERT_METHOD_TO_GETTER:"Convert Method to Getter",EXTRACT_LOCAL_VARIABLE:"Extract Local Variable",EXTRACT_METHOD:"Extract Method",EXTRACT_WIDGET:"Extract Widget"};t.RefactorCodeActionProvider=class{constructor(e,t){this.selector=e,this.analyzer=t,this.rank=50,this.metadata={providedCodeActionKinds:[r.CodeActionKind.Refactor]}}provideCodeActions(e,t,i,c){return n(this,void 0,void 0,(function*(){if(a.isAnalyzableAndInWorkspace(e)&&(!i||!i.only||r.CodeActionKind.Refactor.contains(i.only)))try{const n=e.offsetAt(t.start),r=e.offsetAt(t.end),a=yield this.analyzer.editGetAvailableRefactorings({file:o.fsPath(e.uri),length:r-n,offset:n});if(c&&c.isCancellationRequested)return;const l=a.kinds.map(i=>this.getSupportedRefactorForKind(e,t,i)).filter(s.notUndefined);return i.only?l.filter(e=>{var t;return null===(t=i.only)||void 0===t?void 0:t.contains(e.kind)}):l}catch(e){return[]}}))}getSupportedRefactorForKind(e,t,i){if(!c[i])return;const n=c[i],s=new r.CodeAction(n,r.CodeActionKind.Refactor);return s.command={arguments:[e,t,i],command:"_dart.performRefactor",title:n},s}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SnippetCompletionItemProvider=void 0;const n=i(2),r=i(0),s=i(19),o=i(10);t.SnippetCompletionItemProvider=class{constructor(e,t){this.completions=new r.CompletionList,this.shouldRender=t;const i=s.readJson(n.join(s.extensionPath,e));for(const e of Object.keys(i))for(const t of Object.keys(i[e])){const n=i[e][t],s=new r.CompletionItem(t,r.CompletionItemKind.Snippet);s.filterText=n.prefix,s.insertText=new r.SnippetString(Array.isArray(n.body)?n.body.join("\n"):n.body),s.detail=n.description,s.documentation=(new r.MarkdownString).appendCodeblock(s.insertText.value),s.sortText="zzzzzzzzzzzzzzzzzzzzzz",this.completions.items.push(s)}}provideCompletionItems(e,t,i,n){if(!o.config.enableSnippets)return;const r=e.lineAt(t.line).text.slice(0,t.character);return this.shouldAllowCompletion(r,n)&&this.shouldRender(e.uri)?this.completions:void 0}shouldAllowCompletion(e,t){return-1===(e=e.trim()).indexOf("//")}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SourceCodeActionProvider=void 0;const n=i(0),r=i(6),s=i(7);class o{provideCodeActions(e,t,i,o){if(!s.isAnalyzableAndInWorkspace(e))return;const a=[];return i&&i.only&&!i.only.contains(n.CodeActionKind.Source)&&!i.only.contains(n.CodeActionKind.SourceOrganizeImports)||a.push({command:{arguments:[e],command:"_dart.organizeImports",title:"Organize Imports"},kind:n.CodeActionKind.SourceOrganizeImports,title:"Organize Imports"}),i&&i.only&&!i.only.contains(n.CodeActionKind.Source)&&!i.only.contains(r.SourceSortMembersCodeActionKind)||a.push({command:{arguments:[e],command:"dart.sortMembers",title:"Sort Members"},kind:r.SourceSortMembersCodeActionKind,title:"Sort Members"}),a}}t.SourceCodeActionProvider=o,o.metadata={providedCodeActionKinds:[n.CodeActionKind.Source,n.CodeActionKind.SourceOrganizeImports,r.SourceSortMembersCodeActionKind]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PubBuildRunnerTaskProvider=void 0;const n=i(2),r=i(0),s=i(4),o=i(1),a=i(6),c=i(10),l=i(92),u=i(7),d=i(15);t.PubBuildRunnerTaskProvider=class{constructor(e){this.sdks=e,this.type="pub"}provideTasks(e){const t=a.getDartWorkspaceFolders(),i=[];return t.forEach(e=>{l.referencesBuildRunner(o.fsPath(e.uri))&&(i.push(this.createBuildRunnerCommandBackgroundTask(e,"watch",r.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"build",r.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"serve",r.TaskGroup.Build)),i.push(this.createBuildRunnerCommandBackgroundTask(e,"test",r.TaskGroup.Test)))}),i}createBuildRunnerCommandBackgroundTask(e,t,i){const a=u.isFlutterWorkspaceFolder(e)&&this.sdks.flutter,l=this.type,h=a?n.join(this.sdks.flutter,s.flutterPath):n.join(this.sdks.dart,s.pubPath),f=a?["pub","run","build_runner",t]:["run","build_runner",t];c.config.buildRunnerAdditionalArgs&&f.push(...c.config.buildRunnerAdditionalArgs);const g=new r.Task({command:t,type:l},e,"build_runner "+t,l,new r.ProcessExecution(h,f,{cwd:o.fsPath(e.uri),env:d.getToolEnv()}),"$dart-pub-build_runner");return g.group=i,g.isBackground=!0,g.name="build_runner "+t,g}resolveTask(e,t){}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PubGlobal=void 0;const r=i(2),s=i(0),o=i(4),a=i(8),c=i(13),l=i(3),u=i(6),d=i(15);t.PubGlobal=class{constructor(e,t,i,n){this.logger=e,this.context=t,this.sdks=i,this.pubApi=n}promptToInstallIfRequired(e,t,i=o.pubGlobalDocsUrl,r,c,l=!1){return n(this,void 0,void 0,(function*(){let n=yield this.getInstalledVersion(e,t);const d=c?a.VersionStatus.UpdateRequired:yield this.checkVersionStatus(t,n,r);if(d===a.VersionStatus.Valid)return n;c&&(l=!0);const h=d===a.VersionStatus.NotInstalled?"Activate "+e:"Update "+e,f=d===a.VersionStatus.NotInstalled?`${e} needs to be installed with 'pub global activate ${t}' to use this feature.`:d===a.VersionStatus.UpdateRequired?`${e} needs to be updated with 'pub global activate ${t}' to use this feature.`:`A new version of ${e} is available and can be installed with 'pub global activate ${t}'.`;let g=!l||d!==a.VersionStatus.UpdateRequired&&d!==a.VersionStatus.UpdateAvailable?yield s.window.showWarningMessage(f,h,o.moreInfoAction):h;if(g!==o.moreInfoAction){if(g===h){const r=d===a.VersionStatus.NotInstalled?"Activating "+e:"Updating "+e,l=["global","activate",t];return yield this.runCommandWithProgress(e,r+"...",l,c),n=yield this.getInstalledVersion(e,t),(yield this.checkVersionStatus(t,n))===a.VersionStatus.Valid?n:(g=yield s.window.showErrorMessage(`${r} failed. Please try running 'pub global activate ${t}' manually.`,o.moreInfoAction),void(g===o.moreInfoAction&&(yield u.envUtils.openInBrowser(i))))}}else yield u.envUtils.openInBrowser(i)}))}backgroundActivate(e,t,i,r){return n(this,void 0,void 0,(function*(){const n="Activating "+e,s=["global","activate",t];i?yield this.runCommand(e,s,r):yield this.runCommandWithProgress(e,n+"...",s,r)}))}uninstall(e){return n(this,void 0,void 0,(function*(){const t=["global","deactivate",e];yield this.runCommand(e,t)}))}checkVersionStatus(e,t,i){return n(this,void 0,void 0,(function*(){if(!t)return a.VersionStatus.NotInstalled;if(i&&!l.pubVersionIsAtLeast(t,i))return a.VersionStatus.UpdateRequired;const n=this.context.getPackageLastCheckedForUpdates(e);if(!n||n<=Date.now()-o.noRepeatPromptThreshold){this.context.setPackageLastCheckedForUpdates(e,Date.now());try{const i=yield this.pubApi.getPackage(e);if(!l.pubVersionIsAtLeast(t,i.latest.version))return a.VersionStatus.UpdateAvailable}catch(t){return this.logger.warn(`Failed to check for new version of ${e}: ${t}`,a.LogCategory.CommandProcesses),a.VersionStatus.Valid}}return a.VersionStatus.Valid}))}getInstalledVersion(e,t){return n(this,void 0,void 0,(function*(){const i=yield this.runCommand(e,["global","list"]),n=new RegExp(`^${t} (\\d+\\.\\d+\\.\\d+[\\w.\\-+]*)(?: |$)`,"m").exec(i);return n?n[1]:void 0}))}runCommandWithProgress(e,t,i,n){return s.window.withProgress({location:s.ProgressLocation.Notification,title:t},t=>this.runCommand(e,i,n))}runCommand(e,t,i){const{binPath:n,binArgs:s}=l.usingCustomScript(r.join(this.sdks.dart,o.pubPath),t,i);return new Promise((t,i)=>{this.logger.info(`Spawning ${n} with args ${JSON.stringify(s)}`);const r=d.safeToolSpawn(void 0,n,s);c.logProcess(this.logger,a.LogCategory.CommandProcesses,r);const o=[],l=[];r.stdout.on("data",e=>o.push(e.toString())),r.stderr.on("data",e=>l.push(e.toString())),r.on("close",n=>{n?i(`${e} exited with code ${n}.\n\n${o.join("")}\n\n${l.join("")}`):t(o.join(""))})})}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusBarVersionTracker=void 0;const n=i(0),r=i(10),s=i(7);t.StatusBarVersionTracker=class{constructor(e,t){this.subscriptions=[];const i=e.sdks.dartSdkIsFromFlutter,n=e.hasAnyFlutterProjects?r.config.flutterSdkPaths&&r.config.flutterSdkPaths.length>0?"dart.changeFlutterSdk":void 0:r.config.sdkPaths&&r.config.sdkPaths.length>0?"dart.changeSdk":void 0,s=e.hasAnyFlutterProjects?"Flutter":i?"Dart from Flutter":"Dart",o=e.hasAnyFlutterProjects||i?e.sdks.flutterVersion:e.sdks.dartVersion;o&&this.addStatusBarItem(s+": "+(o.length>20?o.substr(0,17)+"â€¦":o),`${s} SDK (${t?"LSP":"DAS"}): ${o}`,n)}addStatusBarItem(e,t,i){const r=n.window.createStatusBarItem(n.StatusBarAlignment.Right,2);r.text=e,r.tooltip=t,r.command=i,this.subscriptions.push(r),this.subscriptions.push(n.window.onDidChangeActiveTextEditor(e=>{e&&e.document&&s.isAnalyzable(e.document)?r.show():r.hide()})),n.window.activeTextEditor&&n.window.activeTextEditor.document&&s.isAnalyzable(n.window.activeTextEditor.document)&&r.show()}dispose(){this.subscriptions.forEach(e=>e.dispose())}}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.checkForStandardDartSdkUpdates=void 0;const r=i(0),s=i(4),o=i(3),a=i(6),c=i(10),l=i(7);t.checkForStandardDartSdkUpdates=function(e,t){return n(this,void 0,void 0,(function*(){if(!c.config.checkForSdkUpdates||t.config.disableSdkUpdateChecks)return;if(t.sdks.dartSdkIsFromFlutter)return;const i=t.sdks.dartVersion;try{const e=yield l.getLatestSdkVersion();if(!i||o.versionIsAtLeast(i,e))return;const t="Go to Dart Downloads",n="Disable Update Checks",u=`Version ${e} of the Dart SDK is available (you have ${i}). Some features of Dart Code may not work correctly with an old SDK.`,d=yield r.window.showWarningMessage(u,t,n);d===t?yield a.envUtils.openInBrowser(s.DART_DOWNLOAD_URL):d===n&&c.config.setCheckForSdkUpdates(!1)}catch(t){e.error(t)}}))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.showUserPrompts=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(8),l=i(1),u=i(19),d=i(118),h=i(6),f=i(123),g=i(7);function p(){return n(this,void 0,void 0,(function*(){const e=yield o.window.showInformationMessage("Would you like to use recommended VS Code settings for Dart & Flutter?",a.yesAction,a.noAction,a.showRecommendedSettingsAction);return e===a.yesAction?yield o.commands.executeCommand("dart.writeRecommendedSettings"):e===a.showRecommendedSettingsAction&&(yield h.envUtils.openInBrowser(a.recommendedSettingsUrl)),!0}))}function m(){return n(this,void 0,void 0,(function*(){return"Install Flutter Extension"===(yield o.window.showInformationMessage("The Flutter extension is required to work with Flutter projects.","Install Flutter Extension"))&&(yield o.window.withProgress({location:o.ProgressLocation.Notification},e=>(e.report({message:"Installing Flutter extension"}),new Promise(e=>{o.extensions.onDidChange(t=>e()),o.commands.executeCommand("workbench.extensions.installExtension",a.flutterExtensionIdentifier)}))),g.promptToReloadExtension()),!1}))}function v(e){o.window.showErrorMessage(e.message)}function y(e){r.existsSync(e)&&setTimeout(()=>{o.commands.executeCommand("vscode.open",o.Uri.file(e))},100)}t.showUserPrompts=function(e,t,i,g){return n(this,void 0,void 0,(function*(){function b(e){const i=`${a.userPromptContextPrefix}${e}`;return!0===t.get(i)}function C(e,i){const n=`${a.userPromptContextPrefix}${e}`;i().then(e=>t.update(n,e),v)}if(function(e,t){n(this,void 0,void 0,(function*(){process.env.DART_CODE_IS_TEST_RUN&&(yield new Promise(e=>setTimeout(e,5e3))),h.getDartWorkspaceFolders().forEach(t=>{!function(e,t,i){n(this,void 0,void 0,(function*(){const a=s.join(l.fsPath(t.uri),i);if(r.existsSync(a)){const i=r.readFileSync(a).toString().trim();let u;try{u=JSON.parse(i)}catch(e){return void o.window.showErrorMessage("Failed to run Stagehand to create project")}r.unlinkSync(a),e.info("Creating Dart project for "+l.fsPath(t.uri),c.LogCategory.CommandProcesses);try{f.markProjectCreationStarted();(yield function(e,t){return n(this,void 0,void 0,(function*(){return 0===(yield o.commands.executeCommand("_dart.create",e,t))}))}(l.fsPath(t.uri),u.name))?(e.info("Fetching packages for newly-created project",c.LogCategory.CommandProcesses),yield o.commands.executeCommand("dart.getPackages",t.uri),function(e,t){const i=l.fsPath(e.uri),n=s.basename(i);y(s.join(i,t.entrypoint.replace("__projectName__",n))),o.window.showInformationMessage(t.label+" project ready!")}(t,u),e.info("Finished creating new project!",c.LogCategory.CommandProcesses)):e.info("Failed to create new project",c.LogCategory.CommandProcesses)}finally{f.markProjectCreationEnded()}}}))}(e,t,a.DART_STAGEHAND_PROJECT_TRIGGER_FILE),function(e){n(this,void 0,void 0,(function*(){const t=s.join(l.fsPath(e.uri),a.FLUTTER_CREATE_PROJECT_TRIGGER_FILE);if(r.existsSync(t)){let i=r.readFileSync(t).toString().trim();i=i||void 0,r.unlinkSync(t);try{f.markProjectCreationStarted();(yield function(e,t){return n(this,void 0,void 0,(function*(){const i=t?"sample":void 0;return 0===(yield o.commands.executeCommand("_flutter.create",e,i,t))}))}(l.fsPath(e.uri),i))&&function(e,t){y(s.join(l.fsPath(e.uri),"lib/main.dart")),t?o.window.showInformationMessage(t+" sample ready! Connect a device and press F5 to run."):o.window.showInformationMessage("Your Flutter project is ready! Connect a device and press F5 to start running.")}(e,i)}finally{f.markProjectCreationEnded()}}}))}(t)})}))}(e),g.hasAnyFlutterProjects&&!u.hasFlutterExtension&&!b(a.installFlutterExtensionPromptKey)&&(yield new Promise(e=>setTimeout(e,2e4)),!u.checkHasFlutterExtension()))return C(a.installFlutterExtensionPromptKey,m);if(g.hasAnyFlutterProjects&&g.sdks.flutter&&a.isWin){const t=[process.env.COMMONPROGRAMFILES,process.env["COMMONPROGRAMFILES(x86)"],process.env.CommonProgramW6432,process.env.PROGRAMFILES,process.env.ProgramW6432,process.env["PROGRAMFILES(X86)"]].find(e=>{var t;return e&&(null===(t=g.sdks.flutter)||void 0===t?void 0:t.toLowerCase().startsWith(e.toLowerCase()))});t&&(e.error("Flutter is installed in protected folder: "+t),o.window.showErrorMessage("The Flutter SDK is installed in a protected folder and may not function correctly. Please move the SDK to a location that is user-writable without Administration permissions and restart."))}const w=t.lastSeenVersion;if(w){if(!u.isDevExtension&&w!==u.extensionVersion){const e=u.extensionVersion.split(".").slice(0,2).join(".").replace(".","-");return void function(e,t){return n(this,void 0,void 0,(function*(){return(yield o.window.showInformationMessage("Dart Code has been updated to v"+e,"Show Release Notes"))&&(yield h.envUtils.openInBrowser(`https://dartcode.org/releases/v${t}/`)),!0}))}(u.extensionVersion,e).then(()=>t.lastSeenVersion=u.extensionVersion)}}else t.lastSeenVersion=u.extensionVersion;g.hasAnyFlutterProjects&&(yield d.showFlutterSurveyNotificationIfAppropriate(t,i,h.envUtils.openInBrowser,Date.now(),e))||b(a.useRecommendedSettingsPromptKey)||C(a.useRecommendedSettingsPromptKey,p)}))}},function(e,t,i){"use strict";var n=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PackageDepPackage=t.PackageDepProject=t.PackageDepFolder=t.PackageDepFile=t.PackageDep=t.DartPackagesProvider=void 0;const r=i(5),s=i(2),o=i(0),a=i(4),c=i(57),l=i(21),u=i(1),d=i(6);t.DartPackagesProvider=class{constructor(e){this.logger=e,this.onDidChangeTreeDataEmitter=new o.EventEmitter,this.onDidChangeTreeData=this.onDidChangeTreeDataEmitter.event,this.watcher=o.workspace.createFileSystemWatcher("**/.packages"),this.watcher.onDidChange(this.refresh,this),this.watcher.onDidCreate(this.refresh,this),this.watcher.onDidDelete(this.refresh,this)}refresh(){this.onDidChangeTreeDataEmitter.fire(void 0)}getTreeItem(e){return e}getChildren(e){return n(this,void 0,void 0,(function*(){if(e)return e instanceof p?this.getPackages(e):e instanceof m||e instanceof g?this.getFilesAndFolders(e):(e instanceof f||this.logger.warn(`Don't know how to show children of ${e.label}/${e.resourceUri}`),[]);{const e=d.getDartWorkspaceFolders().map(e=>u.fsPath(e.uri)),t=(yield u.findProjectFolders(e,{requirePubspec:!0})).map(e=>new p(o.Uri.file(e)));return 1===t.length?this.getChildren(t[0]):t}}))}getPackages(e){const t=u.fsPath(e.resourceUri),i=c.PackageMap.load(this.logger,c.PackageMap.findPackagesFile(t)).packages;return l.sortBy(Object.keys(i),e=>e.toLowerCase()).filter(e=>i[e]&&!u.areSameFolder(i[e],s.join(t,"lib"))).map(e=>{const t=i[e];return new m(""+e,o.Uri.file(t))})}getFilesAndFolders(e){const t=l.sortBy(r.readdirSync(u.fsPath(e.resourceUri),{withFileTypes:!0}),e=>e.name.toLowerCase()),i=[],n=[];if(!e.resourceUri)return[];const a=u.fsPath(e.resourceUri);return t.forEach(e=>{const t=s.join(a,e.name);e.isFile()?n.push(new f(o.Uri.file(t))):e.isDirectory()&&i.push(new g(o.Uri.file(t)))}),[...i,...n]}dispose(){this.watcher.dispose()}};class h extends o.TreeItem{constructor(e,t,i){e?(super(e,i),this.resourceUri=t):super(t,i)}}t.PackageDep=h;class f extends h{constructor(e){super(void 0,e,o.TreeItemCollapsibleState.None),this.contextValue=a.DART_DEP_FILE_NODE_CONTEXT,this.command={arguments:[e],command:"dart.package.openFile",title:"Open File"}}}t.PackageDepFile=f;class g extends h{constructor(e){super(void 0,e,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_FOLDER_NODE_CONTEXT}}t.PackageDepFolder=g;class p extends h{constructor(e){const t=u.fsPath(e);super(s.basename(t),e,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_PROJECT_NODE_CONTEXT;const i=o.workspace.getWorkspaceFolder(e);if(i){const e=u.fsPath(i.uri);this.description=s.relative(s.dirname(e),s.dirname(t))}}}t.PackageDepProject=p;class m extends h{constructor(e,t){super(e,t,o.TreeItemCollapsibleState.Collapsed),this.contextValue=a.DART_DEP_PACKAGE_NODE_CONTEXT}}t.PackageDepPackage=m}]);
//# sourceMappingURL=extension.js.map